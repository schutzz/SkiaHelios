aion_tuning:
  scavenger_keywords:
  - \"Performance\"
  - \"Monitor\"
  - \"Extension\"
  - \"Service\"
  - \"Driver\"
  - \"Security\"
  - \"Update\"
  - \"Helper\"
  - \"System\"
  - \"Install\"
  - \"Shell\"
  - \"Run\"
  - \"Global\"
  - \"Proxy\"
  - \"PowerShell\"
  - \"Remote\"
  - \"Putty\"
  - \"WinSCP\"
  - \"SetMACE\"
  - \"SDelete\"
anti_forensics:
  evidence_wiping:
  - (?i)fsutil.*usn.*deletejournal
  - (?i)\$usnjrnl.*delete
  - (?i)\$mft.*delete
  - '(?i)format\s+c:'
  - (?i)cipher\s+/w
  - (?i)vssadmin.*delete.*shadows
  - (?i)wbadmin.*delete.*catalog
  - (?i)wbadmin.*delete.*systemstatebackup
  - (?i)MpCmdRun.*-RemoveDefinitions
  - (?i)MpCmdRun.*-AddExclusion
  - (?i)bcdedit.*/set.*recoveryenabled.*no
  log_deletion:
  # Event ID 1102 (Security Log Clear) - require EventLog context to avoid SyncEngine false positives (.1102. = timestamp 11:02)
  - (?i)(event\s*(id)?[:=\s]*1102|eventlog.*1102|security.*log.*clear.*1102)
  # Event ID 104 (Log Clear) - require EventLog context to avoid SyncEngine false positives
  - (?i)(event\s*(id)?[:=\s]*104|eventlog.*104|104.*log.*clear)
  - (?i)wevtutil.*cl
  - (?i)clear-eventlog
  - (?i)clearev
  - (?i)\bdel\b.*\.evtx
  - (?i)\bremove\b.*\.evtx
  - (?i)auditpol.*/clear
  tools:
    bcwipe.exe: BCWIPE_WIPING
    ccleaner.exe: CCLEANER_WIPING
    cipher.exe: CIPHER_WIPING
    eraser.exe: ERASER_WIPING
    sdelete.exe: SDELETE_WIPING
anti_forensics_tools:
  timestompers:
  - pat: (?i)setmace
    score: 400
    tag: CRITICAL_TIMESTOMP
  - pat: (?i)timestomp
    score: 400
    tag: CRITICAL_TIMESTOMP
  - pat: (?i)nircmd.*setfiletime
    score: 350
    tag: CRITICAL_TIMESTOMP
  wipers:
  - pat: (?i)sdelete(64)?\.exe
    score: 350
    tag: CRITICAL_EVIDENCE_WIPE
  - pat: (?i)eraser\.exe
    score: 300
    tag: CRITICAL_EVIDENCE_WIPE
  - pat: (?i)bcwipe\.exe
    score: 350
    tag: CRITICAL_EVIDENCE_WIPE
  - pat: (?i)ultradefrag
    score: 150
    tag: SUSPICIOUS_DEFRAG
context_scoring:
  path_penalties:
  - path: windowsapps
    penalty: -260
  - path: infusedapps
    penalty: -260
  - path: winsxs
    penalty: -250
  - path: servicing
    penalty: -250
  - path: assembly
    penalty: -250
  - path: microsoft.net
    penalty: -200
  - path: system32
    penalty: -150
  - path: syswow64
    penalty: -150
correlation_rules:
- action:
    insight_template: 'üö® **Traffic Confirmed**: SRUM„Å´„Çà„Çä {value_mb} MB „ÅÆÈÄö‰ø°„ÅåÁ¢∫Ë™ç„Åï„Çå„Åæ„Åó„Åü„ÄÇÂÆüË°å„Å†„Åë„Åß„Å™„Åè„ÄÅÂÆüË≥™ÁöÑ„Å™„Éá„Éº„ÇøËª¢ÈÄÅ„Çí‰º¥„ÅÜÊ¥ªÂãï„Åß„Åô„ÄÇ'
    note_append: ' [üì° TRAFFIC: {value_mb} MB]'
    score_override: 500
    tag_append: TRAFFIC_CONFIRMED,DATA_EXFIL_LIKELY
  description: Verify Lateral Movement tools with actual network traffic
  id: CORR_LATERAL_TRAFFIC
  triggers:
    tags:
    - LATERAL_MOVEMENT
    - REMOTE_ACCESS
    - UNC_EXECUTION
    - NETWORK_SHARE_EXECUTION
  validator:
    key_field: Process
    metric_field: BytesSent
    operator: '>'
    source: Plutos_Srum
    target_field: Value
    threshold: 1000000
- action:
    note_append: ' [üì° Active]'
    score_min: 300
    tag_append: TRAFFIC_ACTIVE
  description: Confirm active network connection for tools
  id: CORR_ACTIVE_CONN
  triggers:
    tags:
    - REMOTE_ACCESS
    - DOWNLOADER
  validator:
    key_field: Process
    metric_field: BytesSent
    operator: '>'
    source: Plutos_Srum
    target_field: Value
    threshold: 0
devops_tools:
  package_managers:
  - pat: (?i)choco(latey)?\.exe
    score: 60
    tag: PACKAGE_MANAGER
  - pat: (?i)\\puppet
    score: 80
    tag: CONFIG_MANAGEMENT
  - pat: (?i)\\chef
    score: 80
    tag: CONFIG_MANAGEMENT
  - pat: (?i)\\ansible
    score: 80
    tag: CONFIG_MANAGEMENT
dual_use:
  execution_artifacts:
  - Process
  - EventLog
  - Shimcache
  - Amcache
  - Prefetch
  - UserAssist
  tools:
  - python
  - nmap
  - teamviewer
  - putty
  - winscp
  - powershell
  - cmd.exe
  - net.exe
  - ipconfig
  - choco.exe
execution_hunting:
  targets:
    '@wanadecryptor@.exe': 500
    autoruns.exe: 100
    autorunsc.exe: 100
    cobaltstrike.exe: 500
    lazagne.exe: 400
    mimikatz.exe: 500
    paexec.exe: 200
    procdump.exe: 250
    procdump64.exe: 250
    procexp.exe: 80
    procexp64.exe: 80
    procmon.exe: 100
    procmon64.exe: 100
    psexec.exe: 200
    psexec64.exe: 200
    psexesvc.exe: 250
    remcomsvc.exe: 250
    sekurlsa.exe: 500
    sysinternals.exe: 300
    tasksche.exe: 400
    vmtoolsio.exe: 300
    vssadmin.exe: 150
    7za.exe: 500
    wannacry.exe: 500
internal_recon:
  patterns:
  - 192\\.168\\.
  - 10\\.
  - 172\\.(1[6-9]|2[0-9]|3[0-1])\\.
  - 127\\.0\\.0\\.1
  - localhost
  - phpMyAdmin
  - XAMPP
  - htdocs
  score: 200
  tag: INTERNAL_RECON
lachesis_config:
  force_include_tags:
  - TIME_PARADOX
  - MASQUERADE
  - PHISHING
  - SUSPICIOUS_CMDLINE
  - ROLLBACK
  force_include_types:
  - TIME_PARADOX
  - CRITICAL_MASQUERADE
  - CRITICAL_PHISHING
  - TIMESTOMP
  - CREDENTIALS
  garbage_paths:
  - appdata/local/google/chrome
  - appdata/roaming/microsoft/spelling
  - appdata/roaming/skype
  - appdata/local/packages
  - windows/assembly
  - windows/servicing
  - windows/prefetch
  - inetcache
  - tkdata
  - thumbcache
  - iconcache
  - windows/notifications
  - appdata/local/microsoft/windows/notifications
  - winsxs/catalogs
  - winsxs/manifests
  - windows/assembly/nativeimages
  - windows/servicing/packages
  - windows/installer
  - driverstore/filerepository
  infra_ips:
  - 10.0.2.15
  - 10.0.2.2
  - 127.0.0.1
  - 0.0.0.0
  - ::1
  - 1.1.1.1
  - 8.8.8.8
  - 8.8.4.4
  suspicious_subdirs:
  - /temp
  - /tmp
  - /users/public
  - /appdata
  - /programdata
  - downloads
  - documents
  - desktop
  trusted_system_roots:
  - c:/windows/
  - c:/program files/
  - c:/program files (x86)/
  - '{windows}'
  - '{system32}'
  - '{program files'
  - '{common program files'
lnk_threats:
- pat: powershell.*-enc
  score: 50
  tag: PS_ENCODED
- pat: powershell.*-w.*hidden
  score: 40
  tag: PS_HIDDEN
- pat: powershell.*iex
  score: 50
  tag: PS_IEX
- pat: bypass
  score: 30
  tag: PS_BYPASS
- pat: downloadstring
  score: 45
  tag: PS_DOWNLOAD
- pat: invoke-expression
  score: 50
  tag: PS_IEX
- pat: cmd\.exe.*/c.*powershell
  score: 40
  tag: CMD_PS_CHAIN
- pat: cmd\.exe.*/c.*mshta
  score: 45
  tag: CMD_MSHTA_CHAIN
- pat: mshta.*http
  score: 50
  tag: MSHTA_REMOTE
- pat: rundll32.*javascript
  score: 50
  tag: RUNDLL_JS
- pat: regsvr32.*/s.*/u
  score: 45
  tag: REGSVR32_BYPASS
- pat: certutil.*-urlcache
  score: 45
  tag: CERTUTIL_DL
- pat: certutil.*-decode
  score: 40
  tag: CERTUTIL_DECODE
- pat: bitsadmin.*/transfer
  score: 45
  tag: BITS_JOB
- pat: curl.*http
  score: 40
  tag: CURL_DL
- pat: wget
  score: 40
  tag: WGET_DL
- pat: wscript
  score: 35
  tag: WSCRIPT
- pat: cscript
  score: 35
  tag: CSCRIPT
- pat: \.vbs
  score: 35
  tag: VBS_SCRIPT
- pat: \.js\b
  score: 35
  tag: JS_SCRIPT
- pat: \.hta\b
  score: 40
  tag: HTA_SCRIPT
- pat: vssadmin.*delete.*shadows
  score: 500
  tag: RANSOMWARE_VSS_DELETE
- pat: vssadmin.*resize.*shadowstorage
  score: 450
  tag: RANSOMWARE_VSS_RESIZE
- pat: wmic.*shadowcopy.*delete
  score: 500
  tag: RANSOMWARE_WMIC_SHADOW
- pat: wbadmin.*delete.*systemstatebackup
  score: 500
  tag: RANSOMWARE_BACKUP_DELETE
- pat: wbadmin.*delete.*catalog
  score: 450
  tag: RANSOMWARE_CATALOG_DELETE
- pat: bcdedit.*/set.*recoveryenabled.*no
  score: 500
  tag: RANSOMWARE_RECOVERY_DISABLE
- pat: bcdedit.*/set.*bootstatuspolicy.*ignoreallfailures
  score: 450
  tag: RANSOMWARE_BOOT_POLICY
masquerade:
  legit_crx_paths:
  - Google\\Chrome\\.*\\Extensions
  - Microsoft\\Edge\\.*\\Extensions
  - BraveSoftware\\Brave-Browser\\.*\\Extensions
  - Chromium\\.*\\Extensions
  - Opera Software\\Opera Stable\\Extensions
  - Vivaldi\\.*\\Extensions
  suspicious_execution:
  - pat: (?i)(sysinternals|vmtoolsio|vmware|psexec|procdump|procmon|autoruns)\.exe
    path_filter: ''
    score: 300
    tag: CRITICAL_MASQUERADE
  - pat: (?i)(tasksche|mssecsvc|wannacry|@wanadecryptor@|wcry)\.exe
    path_filter: ''
    score: 300
    tag: CRITICAL_RANSOMWARE
  - pat: (?i)(helper|installer|updater)\.exe
    path_filter: (?i)(users|temp)
    score: 150
    tag: SUSPICIOUS_GENERIC
network_config:
  forensic_noise:
  - accessdata
  - ftk imager
  - tableau
  - celebrite
  - magnet
  - axiom
  - encase
  json_noise:
  - HiveLength
  - FriendlyName
  - HiveName
  - KeysUpdated
  - DirtyPages
  - UsrClass.dat
  - ntuser.dat
  private_ip_ranges:
  - 192.168.
  - '10.'
  - 172.16.
  - 172.17.
  - 172.18.
  - 172.19.
  - 172.2[0-9].
  - 172.3[0-1].
  suspicious_ports:
  - 445
  - 3389
  - 5985
  - 5986
  - 8080
  - 4444
  - 443
  system_proc_noise:
  - wmpnetworksvc
  - tiworker
  - searchindexer
  - conhost
  - svchost
  - backgroundtaskhost
  - dllhost
  - runtimebroker
  - sihost
  - audiodg
  windows_apps_noise:
  - microsoft.windows
  - program files\windowsapps
  - windows communications apps
  - soundrecorder
  - windowsalarms
  - windowsscan
  - calc.exe
network_detection:
  c2_patterns:
  - (?i)beacon
  - (?i)callback
  - (?i)reverse.*shell
  - (?i)connect.*back
  - (?i)meterpreter
  - (?i)cobalt.*strike
  - (?i)empire
  - (?i)sliver
  - (?i)havoc
  - (?i)covenant
  lateral_patterns:
  - (?i)psexec
  - (?i)wmic.*process
  - (?i)winrm
  - (?i)invoke-command
  - (?i)enter-pssession
  - (?i)schtasks.*/create.*/s\s+[^/]
  - (?i)at\s+\\\\
  - (?i)net\s+use\s+\\\\
  - (?i)reg.*\\\\.*\\hklm
  - (?i)sc.*\\\\.*create
network_share_detection:
  unc_patterns:
  - pat: ^\\\\[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+
    score: 200
    tag: LATERAL_MOVEMENT,NETWORK_EXEC
  - pat: ^\\\\[a-zA-Z0-9-]+\\[a-zA-Z0-9$]+
    score: 150
    tag: SMB_SHARE_ACCESS
noise_filters:
  garbage_strings:
  - '%%'
  - have co
  - InputApp
  - Microsoft.Windows
  - Windows.System
  noisy_extensions_in_temp:
  - .psm1
  - .ps1
  - .tmp
  paths:
  - windows[\\/]notifications
  - microsoft[\\/]windows[\\/]notifications
  - appdata[\\/]local[\\/]microsoft[\\/]windows[\\/]notifications
  - windows[\\/]inetcache
  - inetcookies
  - windows[\\/]softwaredistribution
  - windows[\\/]servicing
  - appdata[\\/]local[\\/]temp
  - windows[\\/]temp
  - thumbcache
  - officefilecache
  - windows kit
  - setup.exe
  - install.exe
  - update.exe
  - finish-actions
  - start-winrm
  - windows[\\/]system32[\\/]oobe
  - oobe-
  - knockout-helpers.js
  - gifsequenceplayer.js
  - winjs
  - chakracore
persistence_noise:
  builtin_groups:
  - ^(Administrator|Administrators|Guests|Users|Backup Operators|Replicator)$
  - ^(Power Users|Network Configuration Operators|Remote Desktop Users)$
  - ^(WORKGROUP|Domain Users|Domain Admins|Enterprise Admins)$
  - ^(IIS_IUSRS|Event Log Readers|Cryptographic Operators)$
  - ^(Hyper-V Administrators|Performance Monitor Users|Distributed COM)$
  garbage_patterns:
  - ^[A-Z]{2,6}$
  - ^(ilege|nistrator|ation Operators|natePrivilege)$
  - ^-[A-Z0-9]+$
  privileges:
  - ^Se[A-Za-z]+Privilege$
  - ^(SidHistory|SamAccountName|LogonHours)$
  - ^(SubjectLogonId|SubjectDomainName|TargetDomainName)$
  - ^(TargetSid|OldUacValue|NewUacValue|PrivilegeList)$
  - ^(AllowedToDelegateTo|LogonHours)$
plutos_config:
  burst_threshold_bytes: 52428800
  exfil_domains:
  - drive\.google
  - docs\.google
  - dropbox
  - onedrive
  - sharepoint
  - box\.com
  - icloud
  - pcloud
  - kdrive
  - amazon\.com/clouddrive
  - wetransfer
  - sendspace
  - mediafire
  - mega\.nz
  - gofile\.io
  - anonfiles
  - file\.io
  - transfer\.sh
  - ufile\.io
  - sendgb
  - github\.com
  - gitlab\.com
  - bitbucket
  - pastebin
  - mail\.google
  - outlook\.live
  - mail\.yahoo
  - proton\.me
  - tutanota
  high_heat_processes:
  - mstsc.exe
  - svchost.exe
  - 7z.exe
  - rar.exe
  - curl.exe
  - wget.exe
  - powershell.exe
  - psexesvc.exe
  - chrome.exe
  - msedge.exe
  - rundll32.exe
  - regsvr32.exe
  - wmic.exe
  - git.exe
  - ssh.exe
  - outlook.exe
  - thunderbird.exe
  - hxoutlook.exe
  iis_attack_signatures:
  - (?i)union\s+select
  - (?i)xp_cmdshell
  - (?i)exec\s*\(
  - (?i)select\s+.*\s+from
  - '''\s*or\s*''1''\s*=\s*''1'
  - (?i)drop\s+table
  - (?i)insert\s+into
  - (?i)eval\s*\(
  - (?i)base64_decode
  - (?i)cmd\.exe
  - (?i)powershell
  - (?i)/c\+
  - (?i)%2Fc%2B
  - (?i)wscript
  - (?i)cscript
  - \.\./
  - \.\.%2f
  - '%2e%2e%2f'
  - (?i)\.\.\\
  - (?i)china\s*chopper
  - (?i)c99\.php
  - (?i)r57\.php
  - (?i)b374k
  - \.asp;\.
  - \.aspx;\.
  mail_action_keywords:
  - sent
  - compose
  - draft
  - outbox
  - send
  - attachment
  - upload
  network_noise_ips:
  - 0.0.0.0
  - 255.255.255.255
  - 127.0.0.1
  - ::1
  suspicious_url_keywords:
  - /upload
  - attachment
  - share
  - dl=0
  - export
  target_event_ids:
  - 3
  - 5156
  - 5154
  - 5157
privilege_escalation:
  sam_registry:
  - (?i)\\sam\\domains\\account\\users
  - (?i)\\sam\\sam\\domains\\account
  - (?i)hklm\\sam
  user_creation:
  - net user \S+ /add
  - net localgroup.*administrators.*/add
  - (?i)net\s+localgroup.*remote.*desktop.*/add
  - (?i)\b4720\b
  - (?i)\b4732\b
  - (?i)\b4728\b
  - (?i)new-localuser
  - (?i)add-localgroupmember
recon_indicators:
  suspicious_domains:
  - kali.org
  - kali-linux.com
  - metasploit.com
  - exploit-db.com
  - offensive-security.com
  - packetstormsecurity.com
  - rapid7.com/db
  - cvedetails.com
  - shodan.io
  - hackthebox.eu
  - tryhackme.com
  suspicious_downloads:
    patterns:
    - (?i)defcon.*\.(pdf|pptx?|zip)$
    - (?i)blackhat.*\.(pdf|pptx?|zip)$
    - (?i)ccc-congress.*\.(pdf|pptx?|zip)$
    - (?i)(exploit|rootkit|backdoor|shellcode|keylogger).*\.(pdf|zip|exe)$
    - (?i)(mimikatz|lazagne|procdump|psexec).*\.(pdf|zip|exe)$
    score: 100
    tag: RECON_SECTOOLS
  suspicious_search_terms:
  - (?i)exfiltrat
  - (?i)c2.*communication
  - (?i)data.*theft
  - (?i)credential.*dump
  - (?i)lateral.*movement
  - (?i)privilege.*escalat
  - (?i)reverse.*shell
  - (?i)bind.*shell
  - (?i)post.*exploit
  - (?i)payload.*generat
remote_access_tools:
  openssh:
  - pat: (?i)\\ssh\.exe
    score: 80
    tag: OPENSSH_ACTIVITY
  - pat: (?i)\\ssh-keygen\.exe
    score: 120
    tag: SSH_KEY_GEN
  - pat: (?i)\\ssh-add\.exe
    score: 100
    tag: SSH_KEY_AGENT
  - pat: (?i)\\scp\.exe
    score: 130
    tag: SSH_FILE_TRANSFER
  ssh_clients:
  - pat: (?i)putty\.exe
    score: 100
    tag: SSH_CLIENT
  - pat: (?i)puttygen\.exe
    score: 120
    tag: SSH_KEY_GEN
  - pat: (?i)(pscp|psftp|plink)\.exe
    score: 130
    tag: SSH_FILE_TRANSFER
  - pat: (?i)kitty\.exe
    score: 100
    tag: SSH_CLIENT
  - pat: (?i)winscp\.exe
    score: 100
    tag: SSH_CLIENT
sensitive_data:
  keywords:
  - confidential
  - secret
  - password
  - credential
  - private
  - internal
  - restricted
  - Á§æÂ§ñÁßò
  - Ê©üÂØÜ
  - ÂèñÊâ±Ê≥®ÊÑè
  - „Éë„Çπ„ÉØ„Éº„Éâ
  score: 300
  tag: SENSITIVE_DATA_ACCESS
shellbags:
  high_risk_zones:
  - downloads
  - temp
  - hash_suite
  - jetico
  - nmap
  - wireshark
silencer:
  noise_processes:
  - tmpidcrl.dll
  - mcafee.truekey
  - userinfo.dll
  - conhost.exe
  - svchost.exe
  - taskhost.exe
  time_agents:
  - vboxservice
  - vmtoolsd
  - w32tm
  - svchost
sysinternals_lolbas:
  credential_tools:
  - indicators:
    - -ma
    - -mm
    - -mp
    - lsass
    - csrss
    name: Procdump
    patterns:
    - procdump.exe
    - procdump64.exe
    score_base: 150
    score_lsass: 500
    tag: SYSINTERNALS_PROCDUMP
  download_sources:
  - live.sysinternals.com
  - download.sysinternals.com
  - technet.microsoft.com/sysinternals
  filesystem_tools:
  - name: PsFile
    patterns:
    - psfile.exe
    - psfile64.exe
    score_base: 80
    tag: SYSINTERNALS_PSFILE
  - name: Streams
    patterns:
    - streams.exe
    - streams64.exe
    score_base: 60
    tag: SYSINTERNALS_STREAMS
  - name: SDelete
    patterns:
    - sdelete.exe
    - sdelete64.exe
    score_base: 200
    tag: SYSINTERNALS_SDELETE
  process_tools:
  - name: PsKill
    patterns:
    - pskill.exe
    - pskill64.exe
    score_base: 150
    tag: SYSINTERNALS_PSKILL
  - name: PsSuspend
    patterns:
    - pssuspend.exe
    - pssuspend64.exe
    score_base: 100
    tag: SYSINTERNALS_PSSUSPEND
  - name: Handle
    patterns:
    - handle.exe
    - handle64.exe
    score_base: 60
    tag: SYSINTERNALS_HANDLE
  - name: ListDLLs
    patterns:
    - listdlls.exe
    - listdlls64.exe
    score_base: 60
    tag: SYSINTERNALS_LISTDLLS
  recon_tools:
  - indicators:
    - /Quiet
    - /BackingFile
    - /Minimized
    name: ProcMon
    patterns:
    - procmon.exe
    - procmon64.exe
    score_base: 80
    tag: SYSINTERNALS_PROCMON
  - name: ProcExp
    patterns:
    - procexp.exe
    - procexp64.exe
    score_base: 60
    tag: SYSINTERNALS_PROCEXP
  - indicators:
    - -a
    - -c
    - -m
    - -h
    name: Autoruns
    patterns:
    - autoruns.exe
    - autorunsc.exe
    - autoruns64.exe
    score_base: 80
    tag: SYSINTERNALS_AUTORUNS
  - indicators:
    - -uwcqv
    - -accepteula
    name: AccessChk
    patterns:
    - accesschk.exe
    - accesschk64.exe
    score_base: 100
    tag: SYSINTERNALS_ACCESSCHK
  remote_execution:
  - indicators:
    - -s
    - -i
    - -d
    - -c
    - -accepteula
    - \\\\.*\\
    name: PsExec
    patterns:
    - psexec.exe
    - psexec64.exe
    - paexec.exe
    score_base: 150
    score_elevated: 300
    service_name: PSEXESVC
    tag: SYSINTERNALS_PSEXEC
system_whitelist:
  files:
  - (?i)\.dll$
  - (?i)\.sys$
  - (?i)\.mui$
  - (?i)\.mum$
  - (?i)\.cat$
  - (?i)\.manifest$
  - (?i)\.inf$
  - (?i)^ntoskrnl
  - (?i)^hal\.dll
  - (?i)^kernel32
  paths:
  - (?i)\\Windows\\
  - (?i)\\System32\\
  - (?i)\\SysWOW64\\
  - (?i)\\WinSxS\\
  - (?i)\\servicing\\
  - (?i)\\Microsoft.NET\\
  - (?i)\\assembly\\
  - (?i)\\Installer\\
  - (?i)\\Program Files\\Windows
  - (?i)\\Program Files (x86)\\Windows
  - (?i)\\\\windowsapps\\\\
  - (?i)deletedalluserpackages
timestomp_whitelist:
  installers:
  - (?i).*setup.*\.exe$
  - (?i).*install.*\.exe$
  - (?i)chromesetup\.exe$
  - (?i)firefoxsetup\.exe$
  - (?i)python-[0-9]+\.[0-9]+.*\.exe$
  - (?i)node-v[0-9]+.*\.exe$
  virtualization:
  - (?i)vbox.*\.exe$
  - (?i)vmware.*\.exe$
  - (?i)vm.*additions.*\.exe$
v53_watcher_config:
  internal_recon_patterns:
  - 192\.168\.\d+\.\d+
  - 10\.\d+\.\d+\.\d+
  - 172\.(1[6-9]|2[0-9]|3[0-1])\.\d+\.\d+
  - 127\.0\.0\.1
  - localhost
  - phpMyAdmin
  - XAMPP
  - htdocs
  noise_exclusion_paths:
  - windows/microsoft.net/framework
  - windows/microsoft.net/framework64
  - windows/winsxs
  - windows/servicing
  - windows/assembly
  - windows/installer
  - windows/temp/cab_
  - windows/programdata/microsoft/windows/wer
  - windows/systemapps
  - ./windows/systemapps
  - .\\windows\\systemapps
  - systemapps
  sensitive_extensions:
  - .docx
  - .xlsx
  - .pdf
  - .doc
  - .xls
  - .pptx
  - .txt
  - .rtf
  sensitive_keywords:
  - confidential
  - secret
  - password
  - credential
  - private
  - internal
  - restricted
  - classified
  - proprietary
  - sensitive
web_intrusion:
  directories:
  - (?i)htdocs
  - (?i)wwwroot
  - (?i)inetpub
  - (?i)www
  - (?i)public_html
  - (?i)webapps
  - (?i)sites
  - (?i)html
  indicators:
  - (?i)w3wp\.exe
  - (?i)httpd\.exe
  - (?i)nginx\.exe
  - (?i)aspnet_compiler
  - (?i)csc\.exe.*temp
  - (?i)webshell
  - (?i)china.*chopper
  - (?i)b374k
  suspicious_files:
  - (?i)tmp[a-z0-9]+\.php
  - (?i)^\d+\.php
  - (?i)shell\.php
  - (?i)cmd\.php
  - (?i)c99\.php
  - (?i)r57\.php
  - (?i)b374k
  - (?i)wso\.php
  - (?i)chopper
  - (?i)backdoor
  - (?i)pwn
  - (?i)hack
  - (?i)phpshell
  - (?i)php-?cmd
  - (?i)phpspy
  - (?i)weevely
  - (?i)alfa.*shell
  - (?i)mini.*shell
  - (?i)p0wny
  - (?i)priv8
  vulnerable_apps:
  - (?i)\\dvwa\\|/dvwa/
  - (?i)mutillidae
  - (?i)webgoat
  - (?i)hackazon
  - (?i)juiceshop
  - (?i)bwapp
  - (?i)damn.*vulnerable

# ============================================================
# [Case 10 Fix] PowerShell History Detection Rules (Boosted)
# ============================================================
console_history_rules:
  # DefenderÁÑ°ÂäπÂåñ„ÅØÊîªÊíÉ„ÅÆÂâçÊèê„Å®„Å™„Çã„Åü„ÇÅ„ÄÅÊúÄÈ´ò„É¨„Éô„É´„Å´Âºï„Åç‰∏ä„Åí
  - pattern: "(?i)Add-MpPreference"
    score: 1000
    tag: "DEFENDER_DISABLE_ATTEMPT"
  - pattern: "(?i)Set-MpPreference"
    score: 1000
    tag: "DEFENDER_DISABLE_ATTEMPT"
    
  # HostsÊîπ„Åñ„Çì„ÅØC2ÈÄö‰ø°„ÅÆÈö†ËîΩ„ÉªË™òÂ∞é„ÅÆ„Åü„ÇÅËá¥ÂëΩÁöÑ
  - pattern: "(?i)Add-Content.*hosts"
    score: 900
    tag: "HOSTS_FILE_MODIFICATION"
    
  # A„Éâ„É©„Ç§„ÉñÂÆüË°å
  - pattern: "(?i)(A|B):\\\\"
    score: 800
    tag: "REMOVABLE_DRIVE_EXECUTION"
    
  # „ÉÄ„Ç¶„É≥„É≠„Éº„ÉÄ„Éº
  - pattern: "(?i)Invoke-WebRequest|iwr\\s"
    score: 500
    tag: "DOWNLOAD_ACTIVITY"
  - pattern: "(?i)Invoke-Expression|iex\\s"
    score: 600
    tag: "CODE_EXECUTION"
    
  # ÂÅΩË£Ö„Çπ„ÇØ„É™„Éó„Éà
  - pattern: "(?i)win-updates\\.ps1"
    score: 800
    tag: "SUSPICIOUS_UPDATE_SCRIPT"

# ============================================================
# [v2.0] WebShell Detector Configuration (YAMLÁµ±Âêà)
# ============================================================
webshell_detector:
  # Allowlist: WebShellÊ§úÁü•„Åã„ÇâÈô§Â§ñ„Åô„Çã„Ç∑„Çπ„ÉÜ„É†„Éï„Ç°„Ç§„É´„Éë„Çø„Éº„É≥
  allowlist_patterns:
    - description: "Windows SxS Component"
      pattern: "\\.cdf-ms$"
    - description: "Manifest Files"
      pattern: "\\.(mum|cat|manifest)$"
    - description: "GUID System Files (Pure GUID or prefix)"
      pattern: "\\{[0-9a-fA-F\\-]{8,}"
    - description: "GUID Suffix (e.g., file.ext.{GUID})"
      pattern: "\\.\\{[0-9a-fA-F\\-]+"
    - description: "Windows Component Signatures"
      pattern: "^[0-9a-f]{8,}_.*31bf3856ad364e35"
    - description: "Boot Manager UI (ÂâçÊñπ‰∏ÄËá¥)"
      pattern: "(?i)^bootmgr\\.exe\\.mui"
    - description: "Prefetch Files"
      pattern: "\\.pf$"
    - description: "WinSxS Path"
      pattern: "(?i)[\\\\/]winsxs[\\\\/]"
    - description: "Servicing Path"
      pattern: "(?i)[\\\\/]servicing[\\\\/]"
  
  scan_scope:
    force_web_dirs_only: true  # Web„Éá„Ç£„É¨„ÇØ„Éà„É™ÊåáÂÆö„Åå„Å™„ÅÑÂ†¥Âêà„ÅØ„Çπ„Ç≠„É£„É≥„Åó„Å™„ÅÑ
    default_paths:
      - "inetpub"
      - "htdocs"
      - "wwwroot"
      - "nginx"
      - "apache"
      - "xampp"
      - "public_html"

# ============================================================
# [v2.0] Suspicious Communication Tools (exe/pf ‚Üí NOT WebShell)
# ============================================================
suspicious_comm_tools:
  # exe/pf „ÅØ WEBSHELL „Çø„Ç∞„Çí‰ªò‰∏é„Åó„Å™„ÅÑ
  - name: "Suspicious Communication Tool (Potential Exfil)"
    tag: "SUSPICIOUS_COMM_TOOL"
    score: 500
    target: "FileName"
    condition: "regex"
    pattern: "(?i)(skype4life|teamviewer|anydesk|discord).*\\.(exe|pf)$"
  
  - name: "Suspicious Named Executable"
    tag: "SUSPICIOUS_EXE_NAME"
    score: 400
    target: "FileName"
    condition: "regex"
    pattern: "(?i)(backdoor|trojan|payload|malware|hacker).*\\.exe$"

# ============================================================
# [Case 9 Fix] Encryption & Privacy Tool Detection
# „Ç§„É≥„Çµ„Ç§„ÉÄ„ÉºËÑÖÂ®ÅÂØæÁ≠ñ: ÊöóÂè∑Âåñ„ÉÑ„Éº„É´„ÅÆÁõ£Ë¶ñÂº∑Âåñ
# ============================================================
encryption_tools:
  # --- [1] AESÊöóÂè∑Âåñ„ÉÑ„Éº„É´ ---
  aes_tools:
    - pat: "(?i)aescrypt(\\.exe)?$"
      score: 400
      tag: "ENCRYPTION_TOOL_DETECTED"
    - pat: "(?i)aescrypt.*setup"
      score: 350
      tag: "ENCRYPTION_TOOL_INSTALL"
    - pat: "(?i)axcrypt(\\.exe)?$"
      score: 350
      tag: "ENCRYPTION_TOOL_DETECTED"
    - pat: "(?i)veracrypt(\\.exe)?$"
      score: 400
      tag: "ENCRYPTION_TOOL_DETECTED"
    - pat: "(?i)truecrypt(\\.exe)?$"
      score: 500
      tag: "ENCRYPTION_TOOL_LEGACY"
    - pat: "(?i)7z.*-p"
      score: 300
      tag: "ARCHIVE_PASSWORD_PROTECTED"

  # --- [2] GPG/PGPÊöóÂè∑Âåñ„ÉÑ„Éº„É´ ---
  gpg_tools:
    - pat: "(?i)gpg(\\.exe)?$"
      score: 400
      tag: "GPG_ENCRYPTION"
    - pat: "(?i)gpg4win"
      score: 400
      tag: "GPG_SUITE_DETECTED"
    - pat: "(?i)kleopatra(\\.exe)?$"
      score: 450
      tag: "GPG_KEY_MANAGER"
    - pat: "(?i)gpg-agent(\\.exe)?$"
      score: 350
      tag: "GPG_AGENT"
    - pat: "(?i)gnupg"
      score: 350
      tag: "GPG_INSTALLATION"

  # --- [3] BitLockerÈñ¢ÈÄ£ ---
  bitlocker_tools:
    - pat: "(?i)bitlockerwizard(elev)?\\.exe$"
      score: 500
      tag: "BITLOCKER_WIZARD"
    - pat: "(?i)manage-bde(\\.exe)?$"
      score: 450
      tag: "BITLOCKER_CLI"
    - pat: "(?i)bdechangepin(\\.exe)?$"
      score: 400
      tag: "BITLOCKER_PIN_CHANGE"
    - pat: "(?i)fvenotify(\\.exe)?$"
      score: 300
      tag: "BITLOCKER_NOTIFICATION"
    - pat: "(?i)bdeunlock(\\.exe)?$"
      score: 450
      tag: "BITLOCKER_UNLOCK"

  # --- [4] ‰ªÆÊÉ≥„Éá„Ç£„Çπ„ÇØ/„Ç≥„É≥„ÉÜ„Éä ---
  virtual_disk_tools:
    - pat: "(?i)vhdattach(\\.exe)?$"
      score: 400
      tag: "VHD_ATTACH_TOOL"
    - pat: "(?i)diskmgmt\\.msc"
      score: 200
      tag: "DISK_MANAGEMENT"

# ============================================================
# ÊöóÂè∑Âåñ„Éï„Ç°„Ç§„É´Êã°ÂºµÂ≠ê„ÅÆÁõ£Ë¶ñ
# ============================================================
encryption_file_extensions:
  high_priority:
    - ext: ".aes"
      score: 500
      tag: "ENCRYPTED_FILE_AES"
      description: "AESCryptÊöóÂè∑Âåñ„Éï„Ç°„Ç§„É´"
    - ext: ".asc"
      score: 450
      tag: "ENCRYPTED_KEY_GPG"
      description: "GPGÂÖ¨ÈñãÈçµ/ÊöóÂè∑Âåñ„ÉÜ„Ç≠„Çπ„Éà"
    - ext: ".gpg"
      score: 500
      tag: "ENCRYPTED_FILE_GPG"
      description: "GPGÊöóÂè∑Âåñ„Éï„Ç°„Ç§„É´"
    - ext: ".pgp"
      score: 500
      tag: "ENCRYPTED_FILE_PGP"
      description: "PGPÊöóÂè∑Âåñ„Éï„Ç°„Ç§„É´"
    - ext: ".enc"
      score: 400
      tag: "ENCRYPTED_FILE_GENERIC"
      description: "Ê±éÁî®ÊöóÂè∑Âåñ„Éï„Ç°„Ç§„É´"
    - ext: ".crypt"
      score: 400
      tag: "ENCRYPTED_FILE_GENERIC"
      description: "ÊöóÂè∑Âåñ„Éï„Ç°„Ç§„É´"
    - ext: ".locked"
      score: 600
      tag: "RANSOMWARE_INDICATOR"
      description: "„É©„É≥„Çµ„É†„Ç¶„Çß„Ç¢ÁñëÊÉë"

  medium_priority:
    - ext: ".vhd"
      score: 350
      tag: "VIRTUAL_DISK"
      description: "‰ªÆÊÉ≥„Éè„Éº„Éâ„Éá„Ç£„Çπ„ÇØ"
      context_boost:
        - path_contains: "ProgramData"
          boost: 200
          reason: "Áï∞Â∏∏„Å™ÈÖçÁΩÆÂ†¥ÊâÄ"
        - path_contains: "Users"
          boost: 150
          reason: "„É¶„Éº„Ç∂„Éº„Éá„Ç£„É¨„ÇØ„Éà„É™ÈÖç‰∏ã"
    - ext: ".vhdx"
      score: 350
      tag: "VIRTUAL_DISK"
      description: "‰ªÆÊÉ≥„Éè„Éº„Éâ„Éá„Ç£„Çπ„ÇØ(Êñ∞ÂΩ¢Âºè)"
    - ext: ".vmdk"
      score: 350
      tag: "VIRTUAL_DISK"
      description: "VMware‰ªÆÊÉ≥„Éá„Ç£„Çπ„ÇØ"
    - ext: ".tc"
      score: 500
      tag: "TRUECRYPT_CONTAINER"
      description: "TrueCrypt/VeraCrypt„Ç≥„É≥„ÉÜ„Éä"
    - ext: ".hc"
      score: 500
      tag: "VERACRYPT_CONTAINER"
      description: "VeraCrypt„Ç≥„É≥„ÉÜ„Éä"

# ============================================================
# ÂõûÂæ©„Ç≠„Éº/„Éë„Çπ„ÉØ„Éº„Éâ„Éï„Ç°„Ç§„É´Ê§úÁü•
# ============================================================
recovery_key_detection:
  filename_patterns:
    - pat: "(?i)bitlocker.*recovery.*key"
      score: 800
      tag: "CRITICAL_RECOVERY_KEY"
      description: "BitLockerÂõûÂæ©„Ç≠„Éº"
    - pat: "(?i)recovery.*key.*\\.txt$"
      score: 700
      tag: "CRITICAL_RECOVERY_KEY"
      description: "ÂõûÂæ©„Ç≠„Éº„Éï„Ç°„Ç§„É´"
    - pat: "(?i)ÂõûÂæ©„Ç≠„Éº"
      score: 700
      tag: "CRITICAL_RECOVERY_KEY_JP"
      description: "ÂõûÂæ©„Ç≠„Éº(Êó•Êú¨Ë™û)"
    - pat: "(?i)keys?\\.txt$"
      score: 500
      tag: "SUSPICIOUS_KEY_FILE"
      description: "Èçµ„Éï„Ç°„Ç§„É´ÁñëÊÉë"
    - pat: "(?i)password[s]?\\.txt$"
      score: 600
      tag: "PASSWORD_FILE"
      description: "„Éë„Çπ„ÉØ„Éº„Éâ„Éï„Ç°„Ç§„É´"
    - pat: "(?i)credentials?\\.txt$"
      score: 600
      tag: "CREDENTIALS_FILE"
      description: "Ë™çË®ºÊÉÖÂ†±„Éï„Ç°„Ç§„É´"
    - pat: "(?i)secret[s]?\\.txt$"
      score: 550
      tag: "SECRET_FILE"
      description: "ÁßòÂØÜÊÉÖÂ†±„Éï„Ç°„Ç§„É´"
    - pat: "(?i)private.*key"
      score: 600
      tag: "PRIVATE_KEY_FILE"
      description: "ÁßòÂØÜÈçµ„Éï„Ç°„Ç§„É´"
    - pat: "(?i)_public\\.asc$"
      score: 500
      tag: "GPG_PUBLIC_KEY"
      description: "GPGÂÖ¨ÈñãÈçµ(„Ç®„ÇØ„Çπ„Éù„Éº„Éà)"
    - pat: "(?i)_secret\\.asc$"
      score: 700
      tag: "GPG_SECRET_KEY"
      description: "GPGÁßòÂØÜÈçµ(„Ç®„ÇØ„Çπ„Éù„Éº„Éà) - Âç±Èô∫"

