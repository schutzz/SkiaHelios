'#': Imported by SH_CharonBridge on process_creation
threat_signatures:
- name: '[Sigma] 7Zip Compressing Dump Files'
  tag: attack.collection,attack.t1560.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Description\|contains':\ '7\-Zip'\}|\{'Image\|endswith':\ \['\\\\7z\.exe',\
    '\\\\7zr\.exe',\ '\\\\7za\.exe'\]\}|\{'OriginalFileName':\ \['7z\.exe',\ '7za\.exe'\]\})
- name: '[Sigma] 7Zip Compressing Dump Files'
  tag: attack.collection,attack.t1560.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\.dmp|\.dump|\.hdmp)
- name: '[Sigma] Compress Data and Lock With Password for Exfiltration With 7-ZIP'
  tag: attack.collection,attack.t1560.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Description\|contains':\ '7\-Zip'\}|\{'Image\|endswith':\ \['\\\\7z\.exe',\
    '\\\\7zr\.exe',\ '\\\\7za\.exe'\]\}|\{'OriginalFileName':\ \['7z\.exe',\ '7za\.exe'\]\})
- name: '[Sigma] Compress Data and Lock With Password for Exfiltration With 7-ZIP'
  tag: attack.collection,attack.t1560.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-p
- name: '[Sigma] Compress Data and Lock With Password for Exfiltration With 7-ZIP'
  tag: attack.collection,attack.t1560.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ a\ |\ u\ )
- name: '[Sigma] Potential DLL Injection Via AccCheckConsole'
  tag: attack.execution,detection.threat-hunting
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\AccCheckConsole\.exe'\}|\{'OriginalFileName':\
    'AccCheckConsole\.exe'\})
- name: '[Sigma] Potential DLL Injection Via AccCheckConsole'
  tag: attack.execution,detection.threat-hunting
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-hwnd|\ \-process\ |\ \-window\ )
- name: '[Sigma] Suspicious AddinUtil.EXE CommandLine Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\addinutil\.exe'\}|\{'OriginalFileName':\
    'AddInUtil\.exe'\})
- name: '[Sigma] Suspicious AddinUtil.EXE CommandLine Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-AddInRoot:|\-PipelineRoot:)
- name: '[Sigma] Suspicious AddinUtil.EXE CommandLine Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\AppData\\Local\\Temp\\|\\Desktop\\|\\Downloads\\|\\Users\\Public\\|\\Windows\\Temp\\)
- name: '[Sigma] Suspicious AddinUtil.EXE CommandLine Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-AddInRoot:\.|\-AddInRoot:"\."|\-PipelineRoot:\.|\-PipelineRoot:"\.")
- name: '[Sigma] Suspicious AddinUtil.EXE CommandLine Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\AppData\\Local\\Temp\\|\\Desktop\\|\\Downloads\\|\\Users\\Public\\|\\Windows\\Temp\\)
- name: '[Sigma] Uncommon Child Process Of AddinUtil.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\addinutil\.exe$
- name: '[Sigma] Uncommon Child Process Of AddinUtil.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Windows\\System32\\conhost\.exe|:\\Windows\\System32\\werfault\.exe|:\\Windows\\SysWOW64\\werfault\.exe)$
- name: '[Sigma] Uncommon AddinUtil.EXE CommandLine Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\addinutil\.exe'\}|\{'OriginalFileName':\
    'AddInUtil\.exe'\})
- name: '[Sigma] Uncommon AddinUtil.EXE CommandLine Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-AddInRoot:|\-PipelineRoot:)
- name: '[Sigma] Uncommon AddinUtil.EXE CommandLine Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-AddInRoot:"C:\\Program\ Files\ \(x86\)\\Common\ Files\\Microsoft\
    Shared\\VSTA|\-AddInRoot:C:\\Program\ Files\ \(x86\)\\Common\ Files\\Microsoft\
    Shared\\VSTA|\-PipelineRoot:"C:\\Program\ Files\ \(x86\)\\Common\ Files\\Microsoft\
    Shared\\VSTA|\-PipelineRoot:C:\\Program\ Files\ \(x86\)\\Common\ Files\\Microsoft\
    Shared\\VSTA)
- name: '[Sigma] AddinUtil.EXE Execution From Uncommon Directory'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\addinutil\.exe'\}|\{'OriginalFileName':\
    'AddInUtil\.exe'\})
- name: '[Sigma] AddinUtil.EXE Execution From Uncommon Directory'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Windows\\Microsoft\.NET\\Framework\\|:\\Windows\\Microsoft\.NET\\Framework64\\|:\\Windows\\Microsoft\.NET\\FrameworkArm\\|:\\Windows\\Microsoft\.NET\\FrameworkArm64\\|:\\Windows\\WinSxS\\)
- name: '[Sigma] Potential Adplus.EXE Abuse'
  tag: attack.defense-evasion,attack.execution,attack.credential-access,attack.t1003.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\adplus\.exe'\}|\{'OriginalFileName':\ 'Adplus\.exe'\})
- name: '[Sigma] Potential Adplus.EXE Abuse'
  tag: attack.defense-evasion,attack.execution,attack.credential-access,attack.t1003.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-hang\ |\ \-pn\ |\ \-pmn\ |\ \-p\ |\ \-po\ |\ \-c\ |\ \-sc\ )
- name: '[Sigma] AgentExecutor PowerShell Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image':\ '\\\\AgentExecutor\.exe'\}|\{'OriginalFileName':\ 'AgentExecutor\.exe'\})
- name: '[Sigma] AgentExecutor PowerShell Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-powershell|\ \-remediationScript)
- name: '[Sigma] AgentExecutor PowerShell Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\Microsoft\.Management\.Services\.IntuneWindowsAgent\.exe$
- name: '[Sigma] Suspicious AgentExecutor PowerShell Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\AgentExecutor\.exe'\}|\{'OriginalFileName':\
    'AgentExecutor\.exe'\})
- name: '[Sigma] Suspicious AgentExecutor PowerShell Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-powershell|\ \-remediationScript)
- name: '[Sigma] Suspicious AgentExecutor PowerShell Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Windows\\System32\\WindowsPowerShell\\v1\.0\\|C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1\.0\\)
- name: '[Sigma] Suspicious AgentExecutor PowerShell Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\Microsoft\.Management\.Services\.IntuneWindowsAgent\.exe$
- name: '[Sigma] Uncommon Child Process Of Appvlp.EXE'
  tag: attack.t1218,attack.defense-evasion,attack.execution
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\appvlp\.exe$
- name: '[Sigma] Uncommon Child Process Of Appvlp.EXE'
  tag: attack.t1218,attack.defense-evasion,attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Windows\\SysWOW64\\rundll32\.exe|:\\Windows\\System32\\rundll32\.exe)$
- name: '[Sigma] Uncommon Child Process Of Appvlp.EXE'
  tag: attack.t1218,attack.defense-evasion,attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i):\\Program\ Files\\Microsoft\ Office
- name: '[Sigma] Uncommon Child Process Of Appvlp.EXE'
  tag: attack.t1218,attack.defense-evasion,attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\msoasb\.exe$
- name: '[Sigma] Uncommon Child Process Of Appvlp.EXE'
  tag: attack.t1218,attack.defense-evasion,attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Program\ Files\\Microsoft\ Office|\\SkypeSrv\\)
- name: '[Sigma] Uncommon Child Process Of Appvlp.EXE'
  tag: attack.t1218,attack.defense-evasion,attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\SKYPESERVER\.EXE$
- name: '[Sigma] Uncommon Child Process Of Appvlp.EXE'
  tag: attack.t1218,attack.defense-evasion,attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i):\\Program\ Files\\Microsoft\ Office
- name: '[Sigma] Uncommon Child Process Of Appvlp.EXE'
  tag: attack.t1218,attack.defense-evasion,attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\MSOUC\.EXE$
- name: '[Sigma] AspNetCompiler Execution'
  tag: attack.defense-evasion,attack.t1127
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Windows\\Microsoft\.NET\\Framework\\|:\\Windows\\Microsoft\.NET\\Framework64\\|:\\Windows\\Microsoft\.NET\\FrameworkArm\\|:\\Windows\\Microsoft\.NET\\FrameworkArm64\\)
- name: '[Sigma] AspNetCompiler Execution'
  tag: attack.defense-evasion,attack.t1127
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\aspnet_compiler\.exe$
- name: '[Sigma] Suspicious Child Process of AspNetCompiler'
  tag: attack.defense-evasion,attack.t1127
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\aspnet_compiler\.exe$
- name: '[Sigma] Suspicious Child Process of AspNetCompiler'
  tag: attack.defense-evasion,attack.t1127
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\calc\.exe',\ '\\\\notepad\.exe'\]\}|\{'Image\|contains':\
    \['\\\\Users\\\\Public\\\\',\ '\\\\AppData\\\\Local\\\\Temp\\\\',\ '\\\\AppData\\\\Local\\\\Roaming\\\\',\
    ':\\\\Temp\\\\',\ ':\\\\Windows\\\\Temp\\\\',\ ':\\\\Windows\\\\System32\\\\Tasks\\\\',\
    ':\\\\Windows\\\\Tasks\\\\'\]\})
- name: '[Sigma] Potentially Suspicious ASP.NET Compilation Via AspNetCompiler'
  tag: attack.defense-evasion,attack.t1127
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Windows\\Microsoft\.NET\\Framework\\|:\\Windows\\Microsoft\.NET\\Framework64\\|:\\Windows\\Microsoft\.NET\\FrameworkArm\\|:\\Windows\\Microsoft\.NET\\FrameworkArm64\\)
- name: '[Sigma] Potentially Suspicious ASP.NET Compilation Via AspNetCompiler'
  tag: attack.defense-evasion,attack.t1127
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\aspnet_compiler\.exe$
- name: '[Sigma] Potentially Suspicious ASP.NET Compilation Via AspNetCompiler'
  tag: attack.defense-evasion,attack.t1127
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\Users\\Public\\|\\AppData\\Local\\Temp\\|\\AppData\\Local\\Roaming\\|:\\Temp\\|:\\Windows\\Temp\\|:\\Windows\\System32\\Tasks\\|:\\Windows\\Tasks\\)
- name: '[Sigma] Uncommon  Assistive Technology Applications Execution Via AtBroker.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\AtBroker\.exe'\}|\{'OriginalFileName':\
    'AtBroker\.exe'\})
- name: '[Sigma] Uncommon  Assistive Technology Applications Execution Via AtBroker.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)start
- name: '[Sigma] Uncommon  Assistive Technology Applications Execution Via AtBroker.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(animations|audiodescription|caretbrowsing|caretwidth|colorfiltering|cursorindicator|cursorscheme|filterkeys|focusborderheight|focusborderwidth|highcontrast|keyboardcues|keyboardpref|livecaptions|magnifierpane|messageduration|minimumhitradius|mousekeys|Narrator|osk|overlappedcontent|showsounds|soundsentry|speechreco|stickykeys|togglekeys|voiceaccess|windowarranging|windowtracking|windowtrackingtimeout|windowtrackingzorder)
- name: '[Sigma] Uncommon  Assistive Technology Applications Execution Via AtBroker.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)Oracle_JavaAccessBridge
- name: '[Sigma] Hiding Files with Attrib.exe'
  tag: attack.defense-evasion,attack.t1564.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\attrib\.exe'\}|\{'OriginalFileName':\ 'ATTRIB\.EXE'\})
- name: '[Sigma] Hiding Files with Attrib.exe'
  tag: attack.defense-evasion,attack.t1564.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \+h\ '
- name: '[Sigma] Hiding Files with Attrib.exe'
  tag: attack.defense-evasion,attack.t1564.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\\desktop\.ini\ '
- name: '[Sigma] Hiding Files with Attrib.exe'
  tag: attack.defense-evasion,attack.t1564.001
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\cmd\.exe$
- name: '[Sigma] Hiding Files with Attrib.exe'
  tag: attack.defense-evasion,attack.t1564.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\+R\ \+H\ \+S\ \+A\ \\\\\\.*\.cui
- name: '[Sigma] Hiding Files with Attrib.exe'
  tag: attack.defense-evasion,attack.t1564.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)C:\\\\WINDOWS\\\\system32\\\\\\.*\.bat
- name: '[Sigma] Set Suspicious Files as System Files Using Attrib.EXE'
  tag: attack.defense-evasion,attack.t1564.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\attrib\.exe'\}|\{'OriginalFileName':\ 'ATTRIB\.EXE'\})
- name: '[Sigma] Set Suspicious Files as System Files Using Attrib.EXE'
  tag: attack.defense-evasion,attack.t1564.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\ \+s
- name: '[Sigma] Set Suspicious Files as System Files Using Attrib.EXE'
  tag: attack.defense-evasion,attack.t1564.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ %|\\Users\\Public\\|\\AppData\\Local\\|\\ProgramData\\|\\Downloads\\|\\Windows\\Temp\\)
- name: '[Sigma] Set Suspicious Files as System Files Using Attrib.EXE'
  tag: attack.defense-evasion,attack.t1564.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.bat|\.dll|\.exe|\.hta|\.ps1|\.vbe|\.vbs)
- name: '[Sigma] Set Suspicious Files as System Files Using Attrib.EXE'
  tag: attack.defense-evasion,attack.t1564.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\Windows\\TEMP\\|\.exe)
- name: '[Sigma] Interactive AT Job'
  tag: attack.persistence,attack.execution,attack.privilege-escalation,attack.t1053.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\at\.exe$
- name: '[Sigma] Interactive AT Job'
  tag: attack.persistence,attack.execution,attack.privilege-escalation,attack.t1053.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)interactive
- name: '[Sigma] Audit Policy Tampering Via NT Resource Kit Auditpol'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(/logon:none|/system:none|/sam:none|/privilege:none|/object:none|/process:none|/policy:none)
- name: '[Sigma] Audit Policy Tampering Via Auditpol'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\auditpol\.exe'\}|\{'OriginalFileName':\
    'AUDITPOL\.EXE'\})
- name: '[Sigma] Audit Policy Tampering Via Auditpol'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(disable|clear|remove|restore)
- name: '[Sigma] Indirect Inline Command Execution Via Bash.EXE'
  tag: attack.defense-evasion,attack.t1202
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \[':\\\\Windows\\\\System32\\\\bash\.exe',\
    ':\\\\Windows\\\\SysWOW64\\\\bash\.exe'\]\}|\{'OriginalFileName':\ 'Bash\.exe'\})
- name: '[Sigma] Indirect Inline Command Execution Via Bash.EXE'
  tag: attack.defense-evasion,attack.t1202
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-c\ '
- name: '[Sigma] Indirect Command Execution From Script File Via Bash.EXE'
  tag: attack.defense-evasion,attack.t1202
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \[':\\\\Windows\\\\System32\\\\bash\.exe',\
    ':\\\\Windows\\\\SysWOW64\\\\bash\.exe'\]\}|\{'OriginalFileName':\ 'Bash\.exe'\})
- name: '[Sigma] Indirect Command Execution From Script File Via Bash.EXE'
  tag: attack.defense-evasion,attack.t1202
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(bash\.exe\ \-|bash\ \-)
- name: '[Sigma] Indirect Command Execution From Script File Via Bash.EXE'
  tag: attack.defense-evasion,attack.t1202
  score: 50
  target: Target_Path
  condition: regex
  pattern: None
- name: '[Sigma] Indirect Command Execution From Script File Via Bash.EXE'
  tag: attack.defense-evasion,attack.t1202
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)
- name: '[Sigma] Indirect Command Execution From Script File Via Bash.EXE'
  tag: attack.defense-evasion,attack.t1202
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(bash\.exe|bash)
- name: '[Sigma] Boot Configuration Tampering Via Bcdedit.EXE'
  tag: attack.impact,attack.t1490
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\bcdedit\.exe'\}|\{'OriginalFileName':\
    'bcdedit\.exe'\})
- name: '[Sigma] Boot Configuration Tampering Via Bcdedit.EXE'
  tag: attack.impact,attack.t1490
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)set
- name: '[Sigma] Boot Configuration Tampering Via Bcdedit.EXE'
  tag: attack.impact,attack.t1490
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains\|all':\ \['bootstatuspolicy',\ 'ignoreallfailures'\]\}|\{'CommandLine\|contains\|all':\
    \['recoveryenabled',\ 'no'\]\})
- name: '[Sigma] Potential Ransomware or Unauthorized MBR Tampering Via Bcdedit.EXE'
  tag: attack.defense-evasion,attack.t1070,attack.persistence,attack.t1542.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\bcdedit\.exe'\}|\{'OriginalFileName':\
    'bcdedit\.exe'\})
- name: '[Sigma] Potential Ransomware or Unauthorized MBR Tampering Via Bcdedit.EXE'
  tag: attack.defense-evasion,attack.t1070,attack.persistence,attack.t1542.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(delete|deletevalue|import|safeboot|network)
- name: '[Sigma] Data Export From MSSQL Table Via BCP.EXE'
  tag: attack.execution,attack.exfiltration,attack.t1048
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\bcp\.exe'\}|\{'OriginalFileName':\ 'BCP\.exe'\})
- name: '[Sigma] Data Export From MSSQL Table Via BCP.EXE'
  tag: attack.execution,attack.exfiltration,attack.t1048
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ out\ |\ queryout\ )
- name: '[Sigma] Suspicious Child Process Of BgInfo.EXE'
  tag: attack.execution,attack.t1059.005,attack.defense-evasion,attack.t1218,attack.t1202
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\bginfo\.exe|\\bginfo64\.exe)$
- name: '[Sigma] Suspicious Child Process Of BgInfo.EXE'
  tag: attack.execution,attack.t1059.005,attack.defense-evasion,attack.t1218,attack.t1202
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\calc\.exe',\ '\\\\cmd\.exe',\ '\\\\cscript\.exe',\
    '\\\\mshta\.exe',\ '\\\\notepad\.exe',\ '\\\\powershell\.exe',\ '\\\\pwsh\.exe',\
    '\\\\wscript\.exe'\]\}|\{'Image\|contains':\ \['\\\\AppData\\\\Local\\\\',\ '\\\\AppData\\\\Roaming\\\\',\
    ':\\\\Users\\\\Public\\\\',\ ':\\\\Temp\\\\',\ ':\\\\Windows\\\\Temp\\\\',\ ':\\\\PerfLogs\\\\'\]\})
- name: '[Sigma] Uncommon Child Process Of BgInfo.EXE'
  tag: attack.execution,attack.t1059.005,attack.defense-evasion,attack.t1218,attack.t1202
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(\\bginfo\.exe|\\bginfo64\.exe)$
- name: '[Sigma] BitLockerTogo.EXE Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)\\BitLockerToGo\.exe$
- name: '[Sigma] File Download Via Bitsadmin'
  tag: attack.defense-evasion,attack.persistence,attack.t1197,attack.s0190,attack.t1036.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\bitsadmin\.exe'\}|\{'OriginalFileName':\
    'bitsadmin\.exe'\})
- name: '[Sigma] File Download Via Bitsadmin'
  tag: attack.defense-evasion,attack.persistence,attack.t1197,attack.s0190,attack.t1036.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ /transfer\ '
- name: '[Sigma] File Download Via Bitsadmin'
  tag: attack.defense-evasion,attack.persistence,attack.t1197,attack.s0190,attack.t1036.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /create\ |\ /addfile\ )
- name: '[Sigma] File Download Via Bitsadmin'
  tag: attack.defense-evasion,attack.persistence,attack.t1197,attack.s0190,attack.t1036.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)http
- name: '[Sigma] Suspicious Download From Direct IP Via Bitsadmin'
  tag: attack.defense-evasion,attack.persistence,attack.t1197,attack.s0190,attack.t1036.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\bitsadmin\.exe'\}|\{'OriginalFileName':\
    'bitsadmin\.exe'\})
- name: '[Sigma] Suspicious Download From Direct IP Via Bitsadmin'
  tag: attack.defense-evasion,attack.persistence,attack.t1197,attack.s0190,attack.t1036.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /transfer\ |\ /create\ |\ /addfile\ )
- name: '[Sigma] Suspicious Download From Direct IP Via Bitsadmin'
  tag: attack.defense-evasion,attack.persistence,attack.t1197,attack.s0190,attack.t1036.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(://1|://2|://3|://4|://5|://6|://7|://8|://9)
- name: '[Sigma] Suspicious Download From Direct IP Via Bitsadmin'
  tag: attack.defense-evasion,attack.persistence,attack.t1197,attack.s0190,attack.t1036.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)://7\-
- name: '[Sigma] Suspicious Download From File-Sharing Website Via Bitsadmin'
  tag: attack.defense-evasion,attack.persistence,attack.t1197,attack.s0190,attack.t1036.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\bitsadmin\.exe'\}|\{'OriginalFileName':\
    'bitsadmin\.exe'\})
- name: '[Sigma] Suspicious Download From File-Sharing Website Via Bitsadmin'
  tag: attack.defense-evasion,attack.persistence,attack.t1197,attack.s0190,attack.t1036.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /transfer\ |\ /create\ |\ /addfile\ )
- name: '[Sigma] Suspicious Download From File-Sharing Website Via Bitsadmin'
  tag: attack.defense-evasion,attack.persistence,attack.t1197,attack.s0190,attack.t1036.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.githubusercontent\.com|anonfiles\.com|cdn\.discordapp\.com|ddns\.net|dl\.dropboxusercontent\.com|ghostbin\.co|glitch\.me|gofile\.io|hastebin\.com|mediafire\.com|mega\.nz|onrender\.com|pages\.dev|paste\.ee|pastebin\.com|pastebin\.pl|pastetext\.net|privatlab\.com|privatlab\.net|send\.exploit\.in|sendspace\.com|storage\.googleapis\.com|storjshare\.io|supabase\.co|temp\.sh|transfer\.sh|trycloudflare\.com|ufile\.io|w3spaces\.com|workers\.dev)
- name: '[Sigma] File With Suspicious Extension Downloaded Via Bitsadmin'
  tag: attack.defense-evasion,attack.persistence,attack.t1197,attack.s0190,attack.t1036.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\bitsadmin\.exe'\}|\{'OriginalFileName':\
    'bitsadmin\.exe'\})
- name: '[Sigma] File With Suspicious Extension Downloaded Via Bitsadmin'
  tag: attack.defense-evasion,attack.persistence,attack.t1197,attack.s0190,attack.t1036.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /transfer\ |\ /create\ |\ /addfile\ )
- name: '[Sigma] File With Suspicious Extension Downloaded Via Bitsadmin'
  tag: attack.defense-evasion,attack.persistence,attack.t1197,attack.s0190,attack.t1036.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.7z|\.asax|\.ashx|\.asmx|\.asp|\.aspx|\.bat|\.cfm|\.cgi|\.chm|\.cmd|\.dll|\.gif|\.jpeg|\.jpg|\.jsp|\.jspx|\.log|\.png|\.ps1|\.psm1|\.rar|\.scf|\.sct|\.txt|\.vbe|\.vbs|\.war|\.wsf|\.wsh|\.xll|\.zip)
- name: '[Sigma] File Download Via Bitsadmin To A Suspicious Target Folder'
  tag: attack.defense-evasion,attack.persistence,attack.t1197,attack.s0190,attack.t1036.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\bitsadmin\.exe'\}|\{'OriginalFileName':\
    'bitsadmin\.exe'\})
- name: '[Sigma] File Download Via Bitsadmin To A Suspicious Target Folder'
  tag: attack.defense-evasion,attack.persistence,attack.t1197,attack.s0190,attack.t1036.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /transfer\ |\ /create\ |\ /addfile\ )
- name: '[Sigma] File Download Via Bitsadmin To A Suspicious Target Folder'
  tag: attack.defense-evasion,attack.persistence,attack.t1197,attack.s0190,attack.t1036.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Perflogs|:\\ProgramData\\|:\\Temp\\|:\\Users\\Public\\|:\\Windows\\|\\AppData\\Local\\Temp\\|\\AppData\\Roaming\\|\\Desktop\\|%ProgramData%|%public%)
- name: '[Sigma] File Download Via Bitsadmin To An Uncommon Target Folder'
  tag: attack.defense-evasion,attack.persistence,attack.t1197,attack.s0190,attack.t1036.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\bitsadmin\.exe'\}|\{'OriginalFileName':\
    'bitsadmin\.exe'\})
- name: '[Sigma] File Download Via Bitsadmin To An Uncommon Target Folder'
  tag: attack.defense-evasion,attack.persistence,attack.t1197,attack.s0190,attack.t1036.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /transfer\ |\ /create\ |\ /addfile\ )
- name: '[Sigma] File Download Via Bitsadmin To An Uncommon Target Folder'
  tag: attack.defense-evasion,attack.persistence,attack.t1197,attack.s0190,attack.t1036.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(%AppData%|%temp%|%tmp%|\\AppData\\Local\\|C:\\Windows\\Temp\\)
- name: '[Sigma] Monitoring For Persistence Via BITS'
  tag: attack.persistence,attack.defense-evasion,attack.t1197
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\bitsadmin\.exe'\}|\{'OriginalFileName':\
    'bitsadmin\.exe'\})
- name: '[Sigma] Monitoring For Persistence Via BITS'
  tag: attack.persistence,attack.defense-evasion,attack.t1197
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)/SetNotifyCmdLine
- name: '[Sigma] Monitoring For Persistence Via BITS'
  tag: attack.persistence,attack.defense-evasion,attack.t1197
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(%COMSPEC%|cmd\.exe|regsvr32\.exe)
- name: '[Sigma] Monitoring For Persistence Via BITS'
  tag: attack.persistence,attack.defense-evasion,attack.t1197
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)/Addfile
- name: '[Sigma] Monitoring For Persistence Via BITS'
  tag: attack.persistence,attack.defense-evasion,attack.t1197
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(http:|https:|ftp:|ftps:)
- name: '[Sigma] Potential Data Stealing Via Chromium Headless Debugging'
  tag: attack.defense-evasion,attack.credential-access,attack.collection,attack.t1185,attack.t1564.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-\-remote\-debugging\-|\-\-user\-data\-dir|\-\-headless)
- name: '[Sigma] Browser Execution In Headless Mode'
  tag: attack.defense-evasion,attack.command-and-control,attack.t1105,attack.t1564.003
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(\\brave\.exe|\\chrome\.exe|\\msedge\.exe|\\opera\.exe|\\vivaldi\.exe)$
- name: '[Sigma] Browser Execution In Headless Mode'
  tag: attack.defense-evasion,attack.command-and-control,attack.t1105,attack.t1564.003
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)\-\-headless
- name: '[Sigma] File Download with Headless Browser'
  tag: attack.defense-evasion,attack.command-and-control,attack.t1105,attack.t1564.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\brave\.exe|\\chrome\.exe|\\msedge\.exe|\\opera\.exe|\\vivaldi\.exe)$
- name: '[Sigma] File Download with Headless Browser'
  tag: attack.defense-evasion,attack.command-and-control,attack.t1105,attack.t1564.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-\-headless|dump\-dom|http)
- name: '[Sigma] File Download with Headless Browser'
  tag: attack.defense-evasion,attack.command-and-control,attack.t1105,attack.t1564.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^(C:\\Program\ Files\ \(x86\)\\Microsoft\\Edge\\Application\\|C:\\Program\
    Files\ \(x86\)\\Microsoft\\EdgeCore\\|C:\\Program\ Files\ \(x86\)\\Microsoft\\EdgeWebView\\|C:\\Program\
    Files\\Microsoft\\Edge\\Application\\|C:\\Program\ Files\\Microsoft\\EdgeCore\\|C:\\Program\
    Files\\Microsoft\\EdgeWebView\\|C:\\Program\ Files\\WindowsApps\\Microsoft\.MicrosoftEdge)
- name: '[Sigma] File Download with Headless Browser'
  tag: attack.defense-evasion,attack.command-and-control,attack.t1105,attack.t1564.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\msedge\.exe|\\msedgewebview2\.exe|\\MicrosoftEdge\.exe)$
- name: '[Sigma] File Download with Headless Browser'
  tag: attack.defense-evasion,attack.command-and-control,attack.t1105,attack.t1564.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\-\-headless\ \-\-disable\-gpu\ \-\-disable\-extensions\ \-\-disable\-plugins\
    \-\-mute\-audio\ \-\-no\-first\-run\ \-\-incognito\ \-\-aggressive\-cache\-discard\
    \-\-dump\-dom
- name: '[Sigma] File Download with Headless Browser'
  tag: attack.defense-evasion,attack.command-and-control,attack.t1105,attack.t1564.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\AppData\\Local\\Microsoft\\WindowsApps\\|\\Windows\\SystemApps\\Microsoft\.MicrosoftEdge)
- name: '[Sigma] File Download with Headless Browser'
  tag: attack.defense-evasion,attack.command-and-control,attack.t1105,attack.t1564.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\msedge\.exe|\\MicrosoftEdge\.exe)$
- name: '[Sigma] File Download with Headless Browser'
  tag: attack.defense-evasion,attack.command-and-control,attack.t1105,attack.t1564.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\-\-headless\ \-\-disable\-gpu\ \-\-disable\-extensions\ \-\-disable\-plugins\
    \-\-mute\-audio\ \-\-no\-first\-run\ \-\-incognito\ \-\-aggressive\-cache\-discard\
    \-\-dump\-dom
- name: '[Sigma] Chromium Browser Instance Executed With Custom Extension'
  tag: attack.persistence,attack.t1176.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\brave\.exe|\\chrome\.exe|\\msedge\.exe|\\opera\.exe|\\vivaldi\.exe)$
- name: '[Sigma] Chromium Browser Instance Executed With Custom Extension'
  tag: attack.persistence,attack.t1176.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\-\-load\-extension=
- name: '[Sigma] Chromium Browser Headless Execution To Mockbin Like Site'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\brave\.exe|\\chrome\.exe|\\msedge\.exe|\\opera\.exe|\\vivaldi\.exe)$
- name: '[Sigma] Chromium Browser Headless Execution To Mockbin Like Site'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\-\-headless
- name: '[Sigma] Chromium Browser Headless Execution To Mockbin Like Site'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(://run\.mocky|://mockbin)
- name: '[Sigma] Suspicious Chromium Browser Instance Executed With Custom Extension'
  tag: attack.persistence,attack.t1176.001
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\cmd\.exe|\\cscript\.exe|\\mshta\.exe|\\powershell\.exe|\\pwsh\.exe|\\regsvr32\.exe|\\rundll32\.exe|\\wscript\.exe)$
- name: '[Sigma] Suspicious Chromium Browser Instance Executed With Custom Extension'
  tag: attack.persistence,attack.t1176.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\brave\.exe|\\chrome\.exe|\\msedge\.exe|\\opera\.exe|\\vivaldi\.exe)$
- name: '[Sigma] Suspicious Chromium Browser Instance Executed With Custom Extension'
  tag: attack.persistence,attack.t1176.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\-\-load\-extension=
- name: '[Sigma] File Download From Browser Process Via Inline URL'
  tag: attack.command-and-control,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\brave\.exe|\\chrome\.exe|\\msedge\.exe|\\opera\.exe|\\vivaldi\.exe)$
- name: '[Sigma] File Download From Browser Process Via Inline URL'
  tag: attack.command-and-control,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)http
- name: '[Sigma] File Download From Browser Process Via Inline URL'
  tag: attack.command-and-control,attack.t1105
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|endswith':\ \['\.7z',\ '\.dat',\ '\.dll',\ '\.exe',\
    '\.hta',\ '\.ps1',\ '\.psm1',\ '\.txt',\ '\.vbe',\ '\.vbs',\ '\.zip'\]\}|\{'CommandLine\|contains':\
    \['\.7z"',\ '\.dat"',\ '\.dll"',\ '\.hta"',\ '\.ps1"',\ '\.psm1"',\ '\.txt"',\
    '\.vbe"',\ '\.vbs"',\ '\.zip"'\]\})
- name: '[Sigma] Browser Started with Remote Debugging'
  tag: attack.credential-access,attack.collection,attack.t1185
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-\-remote\-debugging\-
- name: '[Sigma] Browser Started with Remote Debugging'
  tag: attack.credential-access,attack.collection,attack.t1185
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\firefox\.exe$
- name: '[Sigma] Browser Started with Remote Debugging'
  tag: attack.credential-access,attack.collection,attack.t1185
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-start\-debugger\-server
- name: '[Sigma] Tor Client/Browser Execution'
  tag: attack.command-and-control,attack.t1090.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Description':\ 'Tor\ Browser'\}|\{'Product':\ 'Tor\ Browser'\}|\{'Image\|endswith':\
    \['\\\\tor\.exe',\ '\\\\Tor\ Browser\\\\Browser\\\\firefox\.exe'\]\})
- name: '[Sigma] Suspicious Calculator Usage'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\\calc\.exe\ '
- name: '[Sigma] Suspicious Calculator Usage'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\calc\.exe$
- name: '[Sigma] Suspicious Calculator Usage'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Windows\\System32\\|:\\Windows\\SysWOW64\\|:\\Windows\\WinSxS\\)
- name: '[Sigma] Potential Binary Proxy Execution Via Cdb.EXE'
  tag: attack.execution,attack.t1106,attack.defense-evasion,attack.t1218,attack.t1127
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\cdb\.exe'\}|\{'OriginalFileName':\ 'CDB\.Exe'\})
- name: '[Sigma] Potential Binary Proxy Execution Via Cdb.EXE'
  tag: attack.execution,attack.t1106,attack.defense-evasion,attack.t1218,attack.t1127
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-c\ |\ \-cf\ )
- name: '[Sigma] New Root Certificate Installed Via CertMgr.EXE'
  tag: attack.defense-evasion,attack.t1553.004
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\CertMgr\.exe'\}|\{'OriginalFileName':\
    'CERTMGT\.EXE'\})
- name: '[Sigma] New Root Certificate Installed Via CertMgr.EXE'
  tag: attack.defense-evasion,attack.t1553.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/add|root)
- name: '[Sigma] File Download via CertOC.EXE'
  tag: attack.command-and-control,attack.t1105
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\certoc\.exe'\}|\{'OriginalFileName':\ 'CertOC\.exe'\})
- name: '[Sigma] File Download via CertOC.EXE'
  tag: attack.command-and-control,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-GetCACAPS|http)
- name: '[Sigma] File Download From IP Based URL Via CertOC.EXE'
  tag: attack.command-and-control,attack.execution,attack.t1105
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\certoc\.exe'\}|\{'OriginalFileName':\ 'CertOC\.exe'\})
- name: '[Sigma] File Download From IP Based URL Via CertOC.EXE'
  tag: attack.command-and-control,attack.execution,attack.t1105
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)://\[0\-9\]\{1,3\}\\\.\[0\-9\]\{1,3\}\\\.\[0\-9\]\{1,3\}\\\.\[0\-9\]\{1,3\}
- name: '[Sigma] File Download From IP Based URL Via CertOC.EXE'
  tag: attack.command-and-control,attack.execution,attack.t1105
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\-GetCACAPS
- name: '[Sigma] DLL Loaded via CertOC.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\certoc\.exe'\}|\{'OriginalFileName':\ 'CertOC\.exe'\})
- name: '[Sigma] DLL Loaded via CertOC.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-LoadDLL\ '
- name: '[Sigma] Suspicious DLL Loaded via CertOC.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\certoc\.exe'\}|\{'OriginalFileName':\ 'CertOC\.exe'\})
- name: '[Sigma] Suspicious DLL Loaded via CertOC.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-LoadDLL\ '
- name: '[Sigma] Suspicious DLL Loaded via CertOC.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\Appdata\\Local\\Temp\\|\\Desktop\\|\\Downloads\\|\\Users\\Public\\|C:\\Windows\\Tasks\\|C:\\Windows\\Temp\\)
- name: '[Sigma] New Root Certificate Installed Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1553.004
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\certutil\.exe'\}|\{'OriginalFileName':\
    'CertUtil\.exe'\})
- name: '[Sigma] New Root Certificate Installed Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1553.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\-addstore
- name: '[Sigma] New Root Certificate Installed Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1553.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)root
- name: '[Sigma] File Decoded From Base64/Hex Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1027
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\certutil\.exe'\}|\{'OriginalFileName':\
    'CertUtil\.exe'\})
- name: '[Sigma] File Decoded From Base64/Hex Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1027
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-decode\ |\-decodehex\ )
- name: '[Sigma] Suspicious Download Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1027,attack.command-and-control,attack.t1105
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\certutil\.exe'\}|\{'OriginalFileName':\
    'CertUtil\.exe'\})
- name: '[Sigma] Suspicious Download Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1027,attack.command-and-control,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(urlcache\ |verifyctl\ |URL\ )
- name: '[Sigma] Suspicious Download Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1027,attack.command-and-control,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)http
- name: '[Sigma] Suspicious File Downloaded From Direct IP Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1027,attack.command-and-control,attack.t1105
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\certutil\.exe'\}|\{'OriginalFileName':\
    'CertUtil\.exe'\})
- name: '[Sigma] Suspicious File Downloaded From Direct IP Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1027,attack.command-and-control,attack.t1105
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(urlcache\ |verifyctl\ |URL\ )
- name: '[Sigma] Suspicious File Downloaded From Direct IP Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1027,attack.command-and-control,attack.t1105
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(://1|://2|://3|://4|://5|://6|://7|://8|://9)
- name: '[Sigma] Suspicious File Downloaded From Direct IP Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1027,attack.command-and-control,attack.t1105
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)://7\-
- name: '[Sigma] Suspicious File Downloaded From File-Sharing Website Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1027,attack.command-and-control,attack.t1105
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\certutil\.exe'\}|\{'OriginalFileName':\
    'CertUtil\.exe'\})
- name: '[Sigma] Suspicious File Downloaded From File-Sharing Website Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1027,attack.command-and-control,attack.t1105
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(urlcache\ |verifyctl\ |URL\ )
- name: '[Sigma] Suspicious File Downloaded From File-Sharing Website Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1027,attack.command-and-control,attack.t1105
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.githubusercontent\.com|anonfiles\.com|cdn\.discordapp\.com|ddns\.net|dl\.dropboxusercontent\.com|ghostbin\.co|github\.com|glitch\.me|gofile\.io|hastebin\.com|mediafire\.com|mega\.nz|onrender\.com|pages\.dev|paste\.ee|pastebin\.com|pastebin\.pl|pastetext\.net|privatlab\.com|privatlab\.net|send\.exploit\.in|sendspace\.com|storage\.googleapis\.com|storjshare\.io|supabase\.co|temp\.sh|transfer\.sh|trycloudflare\.com|ufile\.io|w3spaces\.com|workers\.dev)
- name: '[Sigma] File Encoded To Base64 Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1027
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\certutil\.exe'\}|\{'OriginalFileName':\
    'CertUtil\.exe'\})
- name: '[Sigma] File Encoded To Base64 Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1027
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\-encode
- name: '[Sigma] Suspicious File Encoded To Base64 Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1027
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\certutil\.exe'\}|\{'OriginalFileName':\
    'CertUtil\.exe'\})
- name: '[Sigma] Suspicious File Encoded To Base64 Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1027
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\-encode
- name: '[Sigma] Suspicious File Encoded To Base64 Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1027
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.acl|\.bat|\.doc|\.gif|\.jpeg|\.jpg|\.mp3|\.pdf|\.png|\.ppt|\.tmp|\.xls|\.xml)
- name: '[Sigma] File In Suspicious Location Encoded To Base64 Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1027
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\certutil\.exe'\}|\{'OriginalFileName':\
    'CertUtil\.exe'\})
- name: '[Sigma] File In Suspicious Location Encoded To Base64 Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1027
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\-encode
- name: '[Sigma] File In Suspicious Location Encoded To Base64 Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1027
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\AppData\\Roaming\\|\\Desktop\\|\\Local\\Temp\\|\\PerfLogs\\|\\Users\\Public\\|\\Windows\\Temp\\|\$Recycle\.Bin)
- name: '[Sigma] Certificate Exported Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1027
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\certutil\.exe'\}|\{'OriginalFileName':\
    'CertUtil\.exe'\})
- name: '[Sigma] Certificate Exported Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1027
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\-exportPFX\ '
- name: '[Sigma] Potential NTLM Coercion Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\certutil\.exe'\}|\{'OriginalFileName':\
    'CertUtil\.exe'\})
- name: '[Sigma] Potential NTLM Coercion Via Certutil.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-syncwithWU\ |\ \\\\\\\\)
- name: '[Sigma] Console CodePage Lookup Via CHCP'
  tag: attack.discovery,attack.t1614.001
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\cmd\.exe$
- name: '[Sigma] Console CodePage Lookup Via CHCP'
  tag: attack.discovery,attack.t1614.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\ \-c\ |\ \-r\ |\ \-k\ )
- name: '[Sigma] Console CodePage Lookup Via CHCP'
  tag: attack.discovery,attack.t1614.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\chcp\.com$
- name: '[Sigma] Console CodePage Lookup Via CHCP'
  tag: attack.discovery,attack.t1614.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(chcp|chcp\ |chcp\ \ )$
- name: '[Sigma] Suspicious CodePage Switch Via CHCP'
  tag: attack.t1036,attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\chcp\.com$
- name: '[Sigma] Suspicious CodePage Switch Via CHCP'
  tag: attack.t1036,attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ 936|\ 1258)$
- name: '[Sigma] Deleted Data Overwritten Via Cipher.EXE'
  tag: attack.impact,attack.t1485
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'CIPHER\.EXE'\}|\{'Image\|endswith':\ '\\\\cipher\.exe'\})
- name: '[Sigma] Deleted Data Overwritten Via Cipher.EXE'
  tag: attack.impact,attack.t1485
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ /w:'
- name: '[Sigma] Process Access via TrolleyExpress Exclusion'
  tag: attack.defense-evasion,attack.t1218.011,attack.credential-access,attack.t1003.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\TrolleyExpress\ 7|\\TrolleyExpress\ 8|\\TrolleyExpress\ 9|\\TrolleyExpress\.exe\
    7|\\TrolleyExpress\.exe\ 8|\\TrolleyExpress\.exe\ 9|\\TrolleyExpress\.exe\ \-ma\
    )
- name: '[Sigma] Process Access via TrolleyExpress Exclusion'
  tag: attack.defense-evasion,attack.t1218.011,attack.credential-access,attack.t1003.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\TrolleyExpress\.exe$
- name: '[Sigma] Process Access via TrolleyExpress Exclusion'
  tag: attack.defense-evasion,attack.t1218.011,attack.credential-access,attack.t1003.001
  score: 80
  target: FileName
  condition: regex
  pattern: (?i)CtxInstall
- name: '[Sigma] Process Access via TrolleyExpress Exclusion'
  tag: attack.defense-evasion,attack.t1218.011,attack.credential-access,attack.t1003.001
  score: 80
  target: FileName
  condition: regex
  pattern: None
- name: '[Sigma] Data Copied To Clipboard Via Clip.EXE'
  tag: attack.collection,attack.t1115
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\clip\.exe'\}|\{'OriginalFileName':\ 'clip\.exe'\})
- name: '[Sigma] Cloudflared Portable Execution'
  tag: attack.command-and-control,attack.t1090.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\cloudflared\.exe$
- name: '[Sigma] Cloudflared Portable Execution'
  tag: attack.command-and-control,attack.t1090.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Program\ Files\ \(x86\)\\cloudflared\\|:\\Program\ Files\\cloudflared\\)
- name: '[Sigma] Cloudflared Quick Tunnel Execution'
  tag: attack.command-and-control,attack.t1090.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\cloudflared\.exe',\ '\\\\cloudflared\-windows\-386\.exe',\
    '\\\\cloudflared\-windows\-amd64\.exe'\]\}|\{'Hashes\|contains':\ \['SHA256=2fb6c04c4f95fb8d158af94c137f90ac820716deaf88d8ebec956254e046cb29',\
    'SHA256=b3d21940a10fdef5e415ad70331ce257c24fe3bcf7722262302e0421791f87e8',\ 'SHA256=1fbd8362b2d2d2e6a5750ae3db69cd1815e6c1d31da48a98b796450971a8e039',\
    'SHA256=0409c9b12f9d0eda86e461ed9bdabeefb00172b26322079681a0bdf48e68dc28',\ 'SHA256=7cfb411d04bac42ef93d1f0c93c0a481e38c6f4612b97ae89d4702595988edc7',\
    'SHA256=5b3c2d846ab162dc6bc595cce3a49de5731afde5d6060be7066d21b013a28373',\ 'SHA256=ce95df7f69664c3df19b76028e115931919a71517b776da7b42d353e2ff4a670',\
    'SHA256=1293525a19cfe3bc8296b62fbfe19f083632ed644a1c18c10b045a1d3030d81a',\ 'SHA256=af2b9161cfcb654b16408cd6b098afe9d1fb61a037d18d7090a119d4c0c8e0f0',\
    'SHA256=39ddceb56a15798826a5fc4892fa2b474c444bb4d7a8bf2fa95e41cab10fa7a1',\ 'SHA256=ccd11f2328023a0e7929e845d5b6e7bc783fb4650d65faef3ae090239d4bbce2',\
    'SHA256=b6e5c5d2567ae8c69cc012ebcae30e6c9b5359d64a58d17ba75ec89f8bce71ac',\ 'SHA256=f813484ea441404f18caad96f28138e8aaf0cb256163c09c2ab8a3acab87f69f',\
    'SHA256=fc4a0802ab9c7409b892ca00636bec61e2acfc911bccfdeb9978b8ab5a2f828d',\ 'SHA256=083150724b49604c8765c1ba19541fa260b133be0acb0647fcd936d81f054499',\
    'SHA256=44303d6572956f28a0f2e4b188934fb9874f2584f5c81fa431a463cfbf28083b',\ 'SHA256=5d38c46032a58e28ae5f7d174d8761ec3d64d186677f3ec53af5f51afb9bfd2f',\
    'SHA256=e1e70fa42059911bc6685fafef957f9a73fc66f214d0704a9b932683a5204032',\ 'SHA256=c01356092a365b84f84f0e66870bd1a05ba3feb53cafd973fa5fea2534bee234',\
    'SHA256=b3f9c06151e30ee43d39e788a79cd918a314f24e04fe87f3de8272a2057b624f',\ 'SHA256=cd81b2792f0739f473c31c9cb7cf2313154bfa28b839975802b90e8790bb5058',\
    'SHA256=9ec7e6c8e1bfd883663d8d9d62c9e4f9ae373b731407181e32491b27a7218a2c',\ 'SHA256=c2cfd23fdc6c0e1b1ffa0e545cbe556f18d11b362b4a89ba0713f6ab01c4827f',\
    'SHA256=53f8adbd76c0eb16f5e43cadde422474d8a06f9c8f959389c1930042ad8beaa5',\ 'SHA256=648c8d2f8001c113d2986dd00b7bbd181593d462bef73522cee212c4f71f95b3',\
    'SHA256=ae047e2095e46c3f9c518b2be67ec753f4f0aad23b261a361fcb6144dcdb63b4',\ 'SHA256=3153d2baa462978dd22ab33d1c2274ecc88c200225d6a3327f98d5b752d08f5c',\
    'SHA256=f49cde976e628012c9db73e1c8d76081944ecf2297cdafeb78bb13290da274c4',\ 'SHA256=d2513e58bb03ccc83affde685c6ef987924c37ce6707d8e9857e2524b0d7e90f',\
    'SHA256=bb67c7623ba92fe64ffd9816b8d5b3b1ea3013960a30bd4cf6e295b3eb5b1bad',\ 'SHA256=b34b3c3a91e3165d1481f0b3ec23eab93a1cfba94345a6cbfe5b18ddbd48eac7',\
    'SHA256=f7848034e010d55f15e474ca998f96391e320ff29b00cfcc4c5e536529703e75',\ 'SHA256=b6fc9493778cbe3bfc062d73f5cc604bc0ff058bc5e5dc6aac87f3a4008b54b6',\
    'SHA256=f5c5e962577e2293c4ad10603816dce7cc273585969615fbf4e4bfa9eaff1688',\ 'SHA256=d14c52d9220b606f428a8fe9f7c108b0d6f14cf71e7384749e98e6a95962e68f',\
    'SHA256=d3a0e1a79158f3985cd49607ebe0cdfcc49cb9af96b8f43aefd0cdfe2f22e663',\ 'SHA256=2fbbfc8299537ff80cadf9d0e27c223fe0ccb9052bf9d8763ad717bbfa521c77',\
    'SHA256=19074674c6fbdaa573b3081745e5e26144fdf7a086d14e0e220d1814f1f13078'\]\})
- name: '[Sigma] Cloudflared Quick Tunnel Execution'
  tag: attack.command-and-control,attack.t1090.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains\|all':\ \['\-url',\ 'tunnel'\]\}|\{'CommandLine\|contains':\
    \['\.exe\ \-url',\ '\.exe\ \-\-url'\]\})
- name: '[Sigma] Cloudflared Quick Tunnel Execution'
  tag: attack.command-and-control,attack.t1090.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-url|\-no\-autoupdate)
- name: '[Sigma] Cloudflared Tunnel Connections Cleanup'
  tag: attack.command-and-control,attack.t1102,attack.t1090,attack.t1572
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ tunnel\ |cleanup\ )
- name: '[Sigma] Cloudflared Tunnel Connections Cleanup'
  tag: attack.command-and-control,attack.t1102,attack.t1090,attack.t1572
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-config\ |\-connector\-id\ )
- name: '[Sigma] Cloudflared Tunnel Execution'
  tag: attack.command-and-control,attack.t1102,attack.t1090,attack.t1572
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ tunnel\ |\ run\ )
- name: '[Sigma] Cloudflared Tunnel Execution'
  tag: attack.command-and-control,attack.t1102,attack.t1090,attack.t1572
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-config\ |\-credentials\-contents\ |\-credentials\-file\ |\-token\
    )
- name: '[Sigma] New Generic Credentials Added Via Cmdkey.EXE'
  tag: attack.credential-access,attack.t1003.005
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\cmdkey\.exe'\}|\{'OriginalFileName':\ 'cmdkey\.exe'\})
- name: '[Sigma] New Generic Credentials Added Via Cmdkey.EXE'
  tag: attack.credential-access,attack.t1003.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-g
- name: '[Sigma] New Generic Credentials Added Via Cmdkey.EXE'
  tag: attack.credential-access,attack.t1003.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-u
- name: '[Sigma] New Generic Credentials Added Via Cmdkey.EXE'
  tag: attack.credential-access,attack.t1003.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-p
- name: '[Sigma] Potential Reconnaissance For Cached Credentials Via Cmdkey.EXE'
  tag: attack.credential-access,attack.t1003.005
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\cmdkey\.exe'\}|\{'OriginalFileName':\ 'cmdkey\.exe'\})
- name: '[Sigma] Potential Reconnaissance For Cached Credentials Via Cmdkey.EXE'
  tag: attack.credential-access,attack.t1003.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-l
- name: '[Sigma] Potential Arbitrary File Download Via Cmdl32.EXE'
  tag: attack.execution,attack.defense-evasion,attack.t1218,attack.t1202
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\cmdl32\.exe'\}|\{'OriginalFileName':\ 'CMDL32\.EXE'\})
- name: '[Sigma] Potential Arbitrary File Download Via Cmdl32.EXE'
  tag: attack.execution,attack.defense-evasion,attack.t1218,attack.t1202
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/vpn|/lan)
- name: '[Sigma] Change Default File Association Via Assoc'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.001
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\cmd\.exe'\}|\{'OriginalFileName':\ 'Cmd\.Exe'\})
- name: '[Sigma] Change Default File Association Via Assoc'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.001
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)assoc
- name: '[Sigma] Change Default File Association To Executable Via Assoc'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\cmd\.exe'\}|\{'OriginalFileName':\ 'Cmd\.Exe'\})
- name: '[Sigma] Change Default File Association To Executable Via Assoc'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(assoc\ |exefile)
- name: '[Sigma] Change Default File Association To Executable Via Assoc'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\.exe=exefile
- name: '[Sigma] Copy .DMP/.DUMP Files From Remote Share Via Cmd.EXE'
  tag: attack.credential-access
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\cmd\.exe'\}|\{'OriginalFileName':\ 'Cmd\.Exe'\})
- name: '[Sigma] Copy .DMP/.DUMP Files From Remote Share Via Cmd.EXE'
  tag: attack.credential-access
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(copy\ |\ \\\\\\\\)
- name: '[Sigma] Copy .DMP/.DUMP Files From Remote Share Via Cmd.EXE'
  tag: attack.credential-access
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.dmp|\.dump|\.hdmp)
- name: '[Sigma] Curl Download And Execute Combination'
  tag: attack.defense-evasion,attack.t1218,attack.command-and-control,attack.t1105
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-c\ '
- name: '[Sigma] Curl Download And Execute Combination'
  tag: attack.defense-evasion,attack.t1218,attack.command-and-control,attack.t1105
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(curl\ |http|\-o|\&)
- name: '[Sigma] File Deletion Via Del'
  tag: attack.defense-evasion,attack.t1070.004
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\cmd\.exe'\}|\{'OriginalFileName':\ 'Cmd\.Exe'\})
- name: '[Sigma] File Deletion Via Del'
  tag: attack.defense-evasion,attack.t1070.004
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(del\ |erase\ )
- name: '[Sigma] File Deletion Via Del'
  tag: attack.defense-evasion,attack.t1070.004
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-f|\ \-s|\ \-q)
- name: '[Sigma] Greedy File Deletion Using Del'
  tag: attack.defense-evasion,attack.t1070.004
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\cmd\.exe'\}|\{'OriginalFileName':\ 'Cmd\.Exe'\})
- name: '[Sigma] Greedy File Deletion Using Del'
  tag: attack.defense-evasion,attack.t1070.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(del\ |erase\ )
- name: '[Sigma] Greedy File Deletion Using Del'
  tag: attack.defense-evasion,attack.t1070.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\\\\\.*\.au3|\\\\\\.*\.dll|\\\\\\.*\.exe|\\\\\\.*\.js)
- name: '[Sigma] File And SubFolder Enumeration Via Dir Command'
  tag: attack.discovery,attack.t1217
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\cmd\.exe'\}|\{'OriginalFileName':\ 'Cmd\.Exe'\})
- name: '[Sigma] File And SubFolder Enumeration Via Dir Command'
  tag: attack.discovery,attack.t1217
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)dir.*\-s
- name: '[Sigma] Potential Dosfuscation Activity'
  tag: attack.execution,attack.t1059
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\^\^|\^\|\^|,;,|;;;;|;;\ ;;|\(,\(,|%COMSPEC:\~|\ c\^m\^d|\^c\^m\^d|\
    c\^md|\ cm\^d|\^cm\^d|\ s\^et\ |\ s\^e\^t\ |\ se\^t\ )
- name: '[Sigma] Command Line Execution with Suspicious URL and AppData Strings'
  tag: attack.execution,attack.command-and-control,attack.t1059.003,attack.t1059.001,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\cmd\.exe$
- name: '[Sigma] Command Line Execution with Suspicious URL and AppData Strings'
  tag: attack.execution,attack.command-and-control,attack.t1059.003,attack.t1059.001,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(http|://|%AppData%)
- name: '[Sigma] Potential Privilege Escalation Using Symlink Between Osk and Cmd'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.008
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\cmd\.exe'\}|\{'OriginalFileName':\ 'Cmd\.Exe'\})
- name: '[Sigma] Potential Privilege Escalation Using Symlink Between Osk and Cmd'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.008
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(mklink|\\osk\.exe|\\cmd\.exe)
- name: '[Sigma] VolumeShadowCopy Symlink Creation Via Mklink'
  tag: attack.credential-access,attack.t1003.002,attack.t1003.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(mklink|HarddiskVolumeShadowCopy)
- name: '[Sigma] Suspicious File Execution From Internet Hosted WebDav Share'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|contains':\ '\\\\cmd\.exe'\}|\{'OriginalFileName':\ 'Cmd\.EXE'\})
- name: '[Sigma] Suspicious File Execution From Internet Hosted WebDav Share'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ net\ use\ http|\&\ start\ /b\ |\\DavWWWRoot\\)
- name: '[Sigma] Suspicious File Execution From Internet Hosted WebDav Share'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.exe\ |\.dll\ |\.bat\ |\.vbs\ |\.ps1\ )
- name: '[Sigma] Cmd.EXE Missing Space Characters Execution Anomaly'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(cmd\.exe/c|\\cmd/c|"cmd/c|cmd\.exe/k|\\cmd/k|"cmd/k|cmd\.exe/r|\\cmd/r|"cmd/r)
- name: '[Sigma] Cmd.EXE Missing Space Characters Execution Anomaly'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(/cwhoami|/cpowershell|/cschtasks|/cbitsadmin|/ccertutil|/kwhoami|/kpowershell|/kschtasks|/kbitsadmin|/kcertutil)
- name: '[Sigma] Cmd.EXE Missing Space Characters Execution Anomaly'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(cmd\.exe\ /c|cmd\ /c|cmd\.exe\ /k|cmd\ /k|cmd\.exe\ /r|cmd\ /r)
- name: '[Sigma] Cmd.EXE Missing Space Characters Execution Anomaly'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(cmd\.exe\ /c\ |cmd\ /c\ |cmd\.exe\ /k\ |cmd\ /k\ |cmd\.exe\ /r\ |cmd\
    /r\ )
- name: '[Sigma] Cmd.EXE Missing Space Characters Execution Anomaly'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains':\ 'AppData\\\\Local\\\\Programs\\\\Microsoft\
    VS\ Code\\\\resources\\\\app\\\\node_modules'\}|\{'CommandLine\|endswith':\ 'cmd\.exe/c\
    \.'\}|\{'CommandLine':\ 'cmd\.exe\ /c'\})
- name: '[Sigma] NtdllPipe Like Activity Execution'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(type\ %windir%\\system32\\ntdll\.dll|type\ %systemroot%\\system32\\ntdll\.dll|type\
    c:\\windows\\system32\\ntdll\.dll|\\\\ntdll\.dll\ >\ \\\\\\\\\.\\\\pipe\\\\)
- name: '[Sigma] Potential CommandLine Path Traversal Via Cmd.EXE'
  tag: attack.execution,attack.t1059.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'ParentImage\|endswith':\ '\\\\cmd\.exe'\}|\{'Image\|endswith':\
    '\\\\cmd\.exe'\}|\{'OriginalFileName':\ 'cmd\.exe'\})
- name: '[Sigma] Potential CommandLine Path Traversal Via Cmd.EXE'
  tag: attack.execution,attack.t1059.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'ParentCommandLine\|contains':\ \['/c',\ '/k',\ '/r'\]\}|\{'CommandLine\|contains':\
    \['/c',\ '/k',\ '/r'\]\})
- name: '[Sigma] Potential CommandLine Path Traversal Via Cmd.EXE'
  tag: attack.execution,attack.t1059.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'ParentCommandLine':\ '/\.\./\.\./'\}|\{'CommandLine\|contains':\
    '/\.\./\.\./'\})
- name: '[Sigma] Potential CommandLine Path Traversal Via Cmd.EXE'
  tag: attack.execution,attack.t1059.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\Tasktop\\keycloak\\bin\\/\.\./\.\./jre\\bin\\java
- name: '[Sigma] Potentially Suspicious Ping/Copy Command Combination'
  tag: attack.defense-evasion,attack.t1070.004
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\cmd\.exe'\}|\{'OriginalFileName':\ 'Cmd\.Exe'\})
- name: '[Sigma] Potentially Suspicious Ping/Copy Command Combination'
  tag: attack.defense-evasion,attack.t1070.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(ping|copy\ )
- name: '[Sigma] Potentially Suspicious Ping/Copy Command Combination'
  tag: attack.defense-evasion,attack.t1070.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-n\ '
- name: '[Sigma] Potentially Suspicious Ping/Copy Command Combination'
  tag: attack.defense-evasion,attack.t1070.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-y\ '
- name: '[Sigma] Suspicious Ping/Del Command Combination'
  tag: attack.defense-evasion,attack.t1070.004
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-n\ '
- name: '[Sigma] Suspicious Ping/Del Command Combination'
  tag: attack.defense-evasion,attack.t1070.004
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)Nul
- name: '[Sigma] Suspicious Ping/Del Command Combination'
  tag: attack.defense-evasion,attack.t1070.004
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-f\ |\ \-q\ )
- name: '[Sigma] Suspicious Ping/Del Command Combination'
  tag: attack.defense-evasion,attack.t1070.004
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(ping|del\ )
- name: '[Sigma] Potentially Suspicious CMD Shell Output Redirect'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\cmd\.exe'\}|\{'OriginalFileName':\ 'Cmd\.Exe'\})
- name: '[Sigma] Potentially Suspicious CMD Shell Output Redirect'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(>.%APPDATA%\\|>.%TEMP%\\|>.%TMP%\\|>.%USERPROFILE%\\|>.C:\\ProgramData\\|>.C:\\Temp\\|>.C:\\Users\\Public\\|>.C:\\Windows\\Temp\\)
- name: '[Sigma] Potentially Suspicious CMD Shell Output Redirect'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ >|">|'>)
- name: '[Sigma] Potentially Suspicious CMD Shell Output Redirect'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Users\\|\\AppData\\Local\\)
- name: '[Sigma] Directory Removal Via Rmdir'
  tag: attack.defense-evasion,attack.t1070.004
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\cmd\.exe'\}|\{'OriginalFileName':\ 'Cmd\.Exe'\})
- name: '[Sigma] Directory Removal Via Rmdir'
  tag: attack.defense-evasion,attack.t1070.004
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)rmdir
- name: '[Sigma] Directory Removal Via Rmdir'
  tag: attack.defense-evasion,attack.t1070.004
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(/s|/q)
- name: '[Sigma] Copy From VolumeShadowCopy Via Cmd.EXE'
  tag: attack.impact,attack.t1490
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(copy\ |\\\\\\\\\\.\\\\GLOBALROOT\\\\Device\\\\HarddiskVolumeShadowCopy)
- name: '[Sigma] Read Contents From Stdin Via Cmd.EXE'
  tag: attack.execution,attack.t1059.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'Cmd\.Exe'\}|\{'Image\|endswith':\ '\\\\cmd\.exe'\})
- name: '[Sigma] Read Contents From Stdin Via Cmd.EXE'
  tag: attack.execution,attack.t1059.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)<
- name: '[Sigma] Persistence Via Sticky Key Backdoor'
  tag: attack.persistence,attack.t1546.008,attack.privilege-escalation
  score: 100
  target: Target_Path
  condition: regex
  pattern: (?i)(copy\ |/y\ |C:\\windows\\system32\\cmd\.exe\ C:\\windows\\system32\\sethc\.exe)
- name: '[Sigma] Sticky Key Like Backdoor Execution'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.008,car.2014-11-003,car.2014-11-008
  score: 100
  target: ParentPath
  condition: regex
  pattern: (?i)\\winlogon\.exe$
- name: '[Sigma] Sticky Key Like Backdoor Execution'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.008,car.2014-11-003,car.2014-11-008
  score: 100
  target: Target_Path
  condition: regex
  pattern: (?i)(\\cmd\.exe|\\cscript\.exe|\\mshta\.exe|\\powershell\.exe|\\pwsh\.exe|\\regsvr32\.exe|\\rundll32\.exe|\\wscript\.exe|\\wt\.exe)$
- name: '[Sigma] Sticky Key Like Backdoor Execution'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.008,car.2014-11-003,car.2014-11-008
  score: 100
  target: Target_Path
  condition: regex
  pattern: (?i)(sethc\.exe|utilman\.exe|osk\.exe|Magnify\.exe|Narrator\.exe|DisplaySwitch\.exe)
- name: '[Sigma] Potential Download/Upload Activity Using Type Command'
  tag: attack.command-and-control,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(type\ |\ >\ \\\\\\\\)
- name: '[Sigma] Potential Download/Upload Activity Using Type Command'
  tag: attack.command-and-control,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(type\ \\\\\\\\|\ >\ )
- name: '[Sigma] Unusual Parent Process For Cmd.EXE'
  tag: attack.execution,attack.t1059
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\cmd\.exe$
- name: '[Sigma] Unusual Parent Process For Cmd.EXE'
  tag: attack.execution,attack.t1059
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(\\csrss\.exe|\\ctfmon\.exe|\\dllhost\.exe|\\epad\.exe|\\FlashPlayerUpdateService\.exe|\\GoogleUpdate\.exe|\\jucheck\.exe|\\jusched\.exe|\\LogonUI\.exe|\\lsass\.exe|\\regsvr32\.exe|\\SearchIndexer\.exe|\\SearchProtocolHost\.exe|\\SIHClient\.exe|\\sihost\.exe|\\slui\.exe|\\spoolsv\.exe|\\sppsvc\.exe|\\taskhostw\.exe|\\unsecapp\.exe|\\WerFault\.exe|\\wermgr\.exe|\\wlanext\.exe|\\WUDFHost\.exe)$
- name: '[Sigma] CMSTP Execution Process Creation'
  tag: attack.defense-evasion,attack.execution,attack.t1218.003,attack.g0069,car.2019-04-001
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\cmstp\.exe$
- name: '[Sigma] Arbitrary File Download Via ConfigSecurityPolicy.EXE'
  tag: attack.exfiltration,attack.t1567
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains':\ 'ConfigSecurityPolicy\.exe'\}|\{'Image\|endswith':\
    '\\\\ConfigSecurityPolicy\.exe'\}|\{'OriginalFileName':\ 'ConfigSecurityPolicy\.exe'\})
- name: '[Sigma] Arbitrary File Download Via ConfigSecurityPolicy.EXE'
  tag: attack.exfiltration,attack.t1567
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(ftp://|http://|https://)
- name: '[Sigma] Powershell Executed From Headless ConHost Process'
  tag: attack.defense-evasion,attack.execution,attack.t1059.001,attack.t1059.003,attack.t1564.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\conhost\.exe'\}|\{'OriginalFileName':\
    'CONHOST\.EXE'\})
- name: '[Sigma] Powershell Executed From Headless ConHost Process'
  tag: attack.defense-evasion,attack.execution,attack.t1059.001,attack.t1059.003,attack.t1564.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-\-headless|powershell)
- name: '[Sigma] Suspicious High IntegrityLevel Conhost Legacy Option'
  tag: attack.defense-evasion,attack.t1202
  score: 0
  target: Full_Path
  condition: regex
  pattern: (?i)(High|S\-1\-16\-12288)
- name: '[Sigma] Suspicious High IntegrityLevel Conhost Legacy Option'
  tag: attack.defense-evasion,attack.t1202
  score: 0
  target: Target_Path
  condition: regex
  pattern: (?i)(conhost\.exe|0xffffffff|\-ForceV1)
- name: '[Sigma] Conhost.exe CommandLine Path Traversal'
  tag: attack.execution,attack.t1059.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)conhost
- name: '[Sigma] Conhost.exe CommandLine Path Traversal'
  tag: attack.execution,attack.t1059.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)/\.\./\.\./
- name: '[Sigma] Uncommon Child Process Of Conhost.EXE'
  tag: attack.defense-evasion,attack.t1202
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\conhost\.exe$
- name: '[Sigma] Uncommon Child Process Of Conhost.EXE'
  tag: attack.defense-evasion,attack.t1202
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i):\\Windows\\System32\\conhost\.exe$
- name: '[Sigma] Uncommon Child Process Of Conhost.EXE'
  tag: attack.defense-evasion,attack.t1202
  score: 50
  target: Target_Path
  condition: regex
  pattern: None
- name: '[Sigma] Uncommon Child Process Of Conhost.EXE'
  tag: attack.defense-evasion,attack.t1202
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)
- name: '[Sigma] Uncommon Child Process Of Conhost.EXE'
  tag: attack.defense-evasion,attack.t1202
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)SystemTraceProvider\-Process
- name: '[Sigma] Conhost Spawned By Uncommon Parent Process'
  tag: attack.execution,attack.t1059
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\conhost\.exe$
- name: '[Sigma] Conhost Spawned By Uncommon Parent Process'
  tag: attack.execution,attack.t1059
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(\\explorer\.exe|\\lsass\.exe|\\regsvr32\.exe|\\rundll32\.exe|\\services\.exe|\\smss\.exe|\\spoolsv\.exe|\\svchost\.exe|\\userinit\.exe|\\wininit\.exe|\\winlogon\.exe)$
- name: '[Sigma] Conhost Spawned By Uncommon Parent Process'
  tag: attack.execution,attack.t1059
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\-k\ apphost\ \-s\ AppHostSvc|\-k\ imgsvc|\-k\ localService\ \-p\
    \-s\ RemoteRegistry|\-k\ LocalSystemNetworkRestricted\ \-p\ \-s\ NgcSvc|\-k\ NetSvcs\
    \-p\ \-s\ NcaSvc|\-k\ netsvcs\ \-p\ \-s\ NetSetupSvc|\-k\ netsvcs\ \-p\ \-s\ wlidsvc|\-k\
    NetworkService\ \-p\ \-s\ DoSvc|\-k\ wsappx\ \-p\ \-s\ AppXSvc|\-k\ wsappx\ \-p\
    \-s\ ClipSVC|\-k\ wusvcs\ \-p\ \-s\ WaaSMedicSvc)
- name: '[Sigma] Conhost Spawned By Uncommon Parent Process'
  tag: attack.execution,attack.t1059
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\ \(x86\)\\Dropbox\\Client\\|C:\\Program\ Files\\Dropbox\\Client\\)
- name: '[Sigma] Control Panel Items'
  tag: attack.privilege-escalation,attack.execution,attack.defense-evasion,attack.t1218.002,attack.persistence,attack.t1546
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\reg\.exe'\}|\{'OriginalFileName':\ 'reg\.exe'\})
- name: '[Sigma] Control Panel Items'
  tag: attack.privilege-escalation,attack.execution,attack.defense-evasion,attack.t1218.002,attack.persistence,attack.t1546
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(add|CurrentVersion\\Control\ Panel\\CPLs)
- name: '[Sigma] Control Panel Items'
  tag: attack.privilege-escalation,attack.execution,attack.defense-evasion,attack.t1218.002,attack.persistence,attack.t1546
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\.cpl$
- name: '[Sigma] Control Panel Items'
  tag: attack.privilege-escalation,attack.execution,attack.defense-evasion,attack.t1218.002,attack.persistence,attack.t1546
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\System32\\|%System%|\|C:\\Windows\\system32\|)
- name: '[Sigma] Control Panel Items'
  tag: attack.privilege-escalation,attack.execution,attack.defense-evasion,attack.t1218.002,attack.persistence,attack.t1546
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(regsvr32\ |\ /s\ |igfxCPL\.cpl)
- name: '[Sigma] CreateDump Process Dump'
  tag: attack.defense-evasion,attack.t1036,attack.t1003.001,attack.credential-access
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\createdump\.exe'\}|\{'OriginalFileName':\
    'FX_VER_INTERNALNAME_STR'\})
- name: '[Sigma] CreateDump Process Dump'
  tag: attack.defense-evasion,attack.t1036,attack.t1003.001,attack.credential-access
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-u\ |\ \-\-full\ |\ \-f\ |\ \-\-name\ |\.dmp\ )
- name: '[Sigma] Dynamic .NET Compilation Via Csc.EXE'
  tag: attack.defense-evasion,attack.t1027.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\csc\.exe$
- name: '[Sigma] Dynamic .NET Compilation Via Csc.EXE'
  tag: attack.defense-evasion,attack.t1027.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Perflogs\\|:\\Users\\Public\\|\\AppData\\Local\\Temp\\|\\Temporary\
    Internet|\\Windows\\Temp\\)
- name: '[Sigma] Dynamic .NET Compilation Via Csc.EXE'
  tag: attack.defense-evasion,attack.t1027.004
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains\|all':\ \[':\\\\Users\\\\',\ '\\\\Favorites\\\\'\]\}|\{'CommandLine\|contains\|all':\
    \[':\\\\Users\\\\',\ '\\\\Favourites\\\\'\]\}|\{'CommandLine\|contains\|all':\
    \[':\\\\Users\\\\',\ '\\\\Contacts\\\\'\]\}|\{'CommandLine\|contains\|all':\ \[':\\\\Users\\\\',\
    '\\\\Pictures\\\\'\]\})
- name: '[Sigma] Dynamic .NET Compilation Via Csc.EXE'
  tag: attack.defense-evasion,attack.t1027.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\(\[Pp\]rogram\[Dd\]ata\|%\(\[Ll\]ocal\).\[Aa\]pp\[Dd\]ata%\|\\\\\[Aa\]pp\[Dd\]ata\\\\\(\[Ll\]ocal\(\[Ll\]ow\).\|\[Rr\]oaming\)\)\\\\\[\^\\\\\]\{1,256\}\$
- name: '[Sigma] Dynamic .NET Compilation Via Csc.EXE'
  tag: attack.defense-evasion,attack.t1027.004
  score: 50
  target: ParentPath
  condition: regex
  pattern: ^(C:\\Program\ Files\ \(x86\)\\|C:\\Program\ Files\\)
- name: '[Sigma] Dynamic .NET Compilation Via Csc.EXE'
  tag: attack.defense-evasion,attack.t1027.004
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\sdiagnhost\.exe
- name: '[Sigma] Dynamic .NET Compilation Via Csc.EXE'
  tag: attack.defense-evasion,attack.t1027.004
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\inetsrv\\w3wp\.exe
- name: '[Sigma] Dynamic .NET Compilation Via Csc.EXE'
  tag: attack.defense-evasion,attack.t1027.004
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(C:\\ProgramData\\chocolatey\\choco\.exe|C:\\ProgramData\\chocolatey\\tools\\shimgen\.exe)
- name: '[Sigma] Dynamic .NET Compilation Via Csc.EXE'
  tag: attack.defense-evasion,attack.t1027.004
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\ProgramData\\Microsoft\\Windows\ Defender\ Advanced\ Threat\ Protection
- name: '[Sigma] Dynamic .NET Compilation Via Csc.EXE'
  tag: attack.defense-evasion,attack.t1027.004
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(JwB7ACIAZgBhAGkAbABlAGQAIgA6AHQAcgB1AGUALAAiAG0AcwBnACIAOgAiAEEAbgBzAGkAYgBsAGUAIAByAGUAcQB1AGkAcgBlAHMAIABQAG8AdwBlAHIAUwBoAGUAbABsACAAdgAzAC4AMAAgAG8AcgAgAG4AZQB3AGUAcgAiAH0AJw|cAewAiAGYAYQBpAGwAZQBkACIAOgB0AHIAdQBlACwAIgBtAHMAZwAiADoAIgBBAG4AcwBpAGIAbABlACAAcgBlAHEAdQBpAHIAZQBzACAAUABvAHcAZQByAFMAaABlAGwAbAAgAHYAMwAuADAAIABvAHIAIABuAGUAdwBlAHIAIgB9ACcA|nAHsAIgBmAGEAaQBsAGUAZAAiADoAdAByAHUAZQAsACIAbQBzAGcAIgA6ACIAQQBuAHMAaQBiAGwAZQAgAHIAZQBxAHUAaQByAGUAcwAgAFAAbwB3AGUAcgBTAGgAZQBsAGwAIAB2ADMALgAwACAAbwByACAAbgBlAHcAZQByACIAfQAnA)
- name: '[Sigma] Csc.EXE Execution Form Potentially Suspicious Parent'
  tag: attack.execution,attack.t1059.005,attack.t1059.007,attack.defense-evasion,attack.t1218.005,attack.t1027.004
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\csc\.exe'\}|\{'OriginalFileName':\ 'csc\.exe'\})
- name: '[Sigma] Csc.EXE Execution Form Potentially Suspicious Parent'
  tag: attack.execution,attack.t1059.005,attack.t1059.007,attack.defense-evasion,attack.t1218.005,attack.t1027.004
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\cscript\.exe|\\excel\.exe|\\mshta\.exe|\\onenote\.exe|\\outlook\.exe|\\powerpnt\.exe|\\winword\.exe|\\wscript\.exe)$
- name: '[Sigma] Csc.EXE Execution Form Potentially Suspicious Parent'
  tag: attack.execution,attack.t1059.005,attack.t1059.007,attack.defense-evasion,attack.t1218.005,attack.t1027.004
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\pwsh\.exe)$
- name: '[Sigma] Csc.EXE Execution Form Potentially Suspicious Parent'
  tag: attack.execution,attack.t1059.005,attack.t1059.007,attack.defense-evasion,attack.t1218.005,attack.t1027.004
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\-Encoded\ |FromBase64String)
- name: '[Sigma] Csc.EXE Execution Form Potentially Suspicious Parent'
  tag: attack.execution,attack.t1059.005,attack.t1059.007,attack.defense-evasion,attack.t1218.005,attack.t1027.004
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'ParentCommandLine\|re':\ '\(\[Pp\]rogram\[Dd\]ata\|%\(\[Ll\]ocal\).\[Aa\]pp\[Dd\]ata%\|\\\\\\\\\[Aa\]pp\[Dd\]ata\\\\\\\\\(\[Ll\]ocal\(\[Ll\]ow\).\|\[Rr\]oaming\)\)\\\\\\\\\[\^\\\\\\\\\]\{1,256\}\$'\}|\{'ParentCommandLine\|contains':\
    \[':\\\\PerfLogs\\\\',\ ':\\\\Users\\\\Public\\\\',\ ':\\\\Windows\\\\Temp\\\\',\
    '\\\\Temporary\ Internet'\]\}|\{'ParentCommandLine\|contains\|all':\ \[':\\\\Users\\\\',\
    '\\\\Favorites\\\\'\]\}|\{'ParentCommandLine\|contains\|all':\ \[':\\\\Users\\\\',\
    '\\\\Favourites\\\\'\]\}|\{'ParentCommandLine\|contains\|all':\ \[':\\\\Users\\\\',\
    '\\\\Contacts\\\\'\]\}|\{'ParentCommandLine\|contains\|all':\ \[':\\\\Users\\\\',\
    '\\\\Pictures\\\\'\]\})
- name: '[Sigma] Csc.EXE Execution Form Potentially Suspicious Parent'
  tag: attack.execution,attack.t1059.005,attack.t1059.007,attack.defense-evasion,attack.t1218.005,attack.t1027.004
  score: 80
  target: ParentPath
  condition: regex
  pattern: ^(C:\\Program\ Files\ \(x86\)\\|C:\\Program\ Files\\)
- name: '[Sigma] Csc.EXE Execution Form Potentially Suspicious Parent'
  tag: attack.execution,attack.t1059.005,attack.t1059.007,attack.defense-evasion,attack.t1218.005,attack.t1027.004
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\sdiagnhost\.exe
- name: '[Sigma] Csc.EXE Execution Form Potentially Suspicious Parent'
  tag: attack.execution,attack.t1059.005,attack.t1059.007,attack.defense-evasion,attack.t1218.005,attack.t1027.004
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\inetsrv\\w3wp\.exe
- name: '[Sigma] Csc.EXE Execution Form Potentially Suspicious Parent'
  tag: attack.execution,attack.t1059.005,attack.t1059.007,attack.defense-evasion,attack.t1218.005,attack.t1027.004
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\ProgramData\\chocolatey\\choco\.exe
- name: '[Sigma] Csc.EXE Execution Form Potentially Suspicious Parent'
  tag: attack.execution,attack.t1059.005,attack.t1059.007,attack.defense-evasion,attack.t1218.005,attack.t1027.004
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\ProgramData\\Microsoft\\Windows\ Defender\ Advanced\ Threat\ Protection
- name: '[Sigma] Csc.EXE Execution Form Potentially Suspicious Parent'
  tag: attack.execution,attack.t1059.005,attack.t1059.007,attack.defense-evasion,attack.t1218.005,attack.t1027.004
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(JwB7ACIAZgBhAGkAbABlAGQAIgA6AHQAcgB1AGUALAAiAG0AcwBnACIAOgAiAEEAbgBzAGkAYgBsAGUAIAByAGUAcQB1AGkAcgBlAHMAIABQAG8AdwBlAHIAUwBoAGUAbABsACAAdgAzAC4AMAAgAG8AcgAgAG4AZQB3AGUAcgAiAH0AJw|cAewAiAGYAYQBpAGwAZQBkACIAOgB0AHIAdQBlACwAIgBtAHMAZwAiADoAIgBBAG4AcwBpAGIAbABlACAAcgBlAHEAdQBpAHIAZQBzACAAUABvAHcAZQByAFMAaABlAGwAbAAgAHYAMwAuADAAIABvAHIAIABuAGUAdwBlAHIAIgB9ACcA|nAHsAIgBmAGEAaQBsAGUAZAAiADoAdAByAHUAZQAsACIAbQBzAGcAIgA6ACIAQQBuAHMAaQBiAGwAZQAgAHIAZQBxAHUAaQByAGUAcwAgAFAAbwB3AGUAcgBTAGgAZQBsAGwAIAB2ADMALgAwACAAbwByACAAbgBlAHcAZQByACIAfQAnA)
- name: '[Sigma] Suspicious Csi.exe Usage'
  tag: attack.lateral-movement,attack.execution,attack.t1072,attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\csi\.exe',\ '\\\\rcsi\.exe'\]\}|\{'OriginalFileName':\
    \['csi\.exe',\ 'rcsi\.exe'\]\})
- name: '[Sigma] Suspicious Csi.exe Usage'
  tag: attack.lateral-movement,attack.execution,attack.t1072,attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)Microsoft\ Corporation
- name: '[Sigma] Suspicious Use of CSharp Interactive Console'
  tag: attack.execution,attack.defense-evasion,attack.t1127
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\csi\.exe$
- name: '[Sigma] Suspicious Use of CSharp Interactive Console'
  tag: attack.execution,attack.defense-evasion,attack.t1127
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\pwsh\.exe|\\powershell_ise\.exe)$
- name: '[Sigma] Suspicious Use of CSharp Interactive Console'
  tag: attack.execution,attack.defense-evasion,attack.t1127
  score: 80
  target: FileName
  condition: regex
  pattern: (?i)csi\.exe
- name: '[Sigma] Active Directory Structure Export Via Csvde.EXE'
  tag: attack.exfiltration,attack.discovery,attack.t1087.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\csvde\.exe'\}|\{'OriginalFileName':\ 'csvde\.exe'\})
- name: '[Sigma] Active Directory Structure Export Via Csvde.EXE'
  tag: attack.exfiltration,attack.discovery,attack.t1087.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-f
- name: '[Sigma] Active Directory Structure Export Via Csvde.EXE'
  tag: attack.exfiltration,attack.discovery,attack.t1087.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-i
- name: '[Sigma] Potential Cookies Session Hijacking'
  tag: attack.execution
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\curl\.exe'\}|\{'OriginalFileName':\ 'curl\.exe'\})
- name: '[Sigma] Potential Cookies Session Hijacking'
  tag: attack.execution
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|re':\ '\\\\s\-c\\\\s'\}|\{'CommandLine\|contains':\
    '\-\-cookie\-jar'\})
- name: '[Sigma] Curl Web Request With Potential Custom User-Agent'
  tag: attack.execution
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\curl\.exe'\}|\{'OriginalFileName':\ 'curl\.exe'\})
- name: '[Sigma] Curl Web Request With Potential Custom User-Agent'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\s\-H\\s
- name: '[Sigma] Curl Web Request With Potential Custom User-Agent'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\-\-header
- name: '[Sigma] Curl Web Request With Potential Custom User-Agent'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)User\-Agent:'
- name: '[Sigma] File Download From IP URL Via Curl.EXE'
  tag: attack.execution
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\curl\.exe'\}|\{'OriginalFileName':\ 'curl\.exe'\})
- name: '[Sigma] File Download From IP URL Via Curl.EXE'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)://\[0\-9\]\{1,3\}\\\.\[0\-9\]\{1,3\}\\\.\[0\-9\]\{1,3\}\\\.\[0\-9\]\{1,3\}
- name: '[Sigma] File Download From IP URL Via Curl.EXE'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)http
- name: '[Sigma] File Download From IP URL Via Curl.EXE'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-O|\-\-remote\-name|\-\-output)
- name: '[Sigma] File Download From IP URL Via Curl.EXE'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\.bat|\.bat"|\.dat|\.dat"|\.dll|\.dll"|\.exe|\.exe"|\.gif|\.gif"|\.hta|\.hta"|\.jpeg|\.jpeg"|\.log|\.log"|\.msi|\.msi"|\.png|\.png"|\.ps1|\.ps1"|\.psm1|\.psm1"|\.vbe|\.vbe"|\.vbs|\.vbs"|\.bat'|\.dat'|\.dll'|\.exe'|\.gif'|\.hta'|\.jpeg'|\.log'|\.msi'|\.png'|\.ps1'|\.psm1'|\.vbe'|\.vbs')$
- name: '[Sigma] Suspicious File Download From IP Via Curl.EXE'
  tag: attack.execution
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\curl\.exe'\}|\{'OriginalFileName':\ 'curl\.exe'\})
- name: '[Sigma] Suspicious File Download From IP Via Curl.EXE'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)://\[0\-9\]\{1,3\}\\\.\[0\-9\]\{1,3\}\\\.\[0\-9\]\{1,3\}\\\.\[0\-9\]\{1,3\}
- name: '[Sigma] Suspicious File Download From IP Via Curl.EXE'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)http
- name: '[Sigma] Suspicious File Download From IP Via Curl.EXE'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-O|\-\-remote\-name|\-\-output)
- name: '[Sigma] Suspicious File Download From IP Via Curl.EXE'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.bat|\.bat"|\.dat|\.dat"|\.dll|\.dll"|\.exe|\.exe"|\.gif|\.gif"|\.hta|\.hta"|\.jpeg|\.jpeg"|\.log|\.log"|\.msi|\.msi"|\.png|\.png"|\.ps1|\.ps1"|\.psm1|\.psm1"|\.vbe|\.vbe"|\.vbs|\.vbs"|\.bat'|\.dat'|\.dll'|\.exe'|\.gif'|\.hta'|\.jpeg'|\.log'|\.msi'|\.png'|\.ps1'|\.psm1'|\.vbe'|\.vbs')$
- name: '[Sigma] Suspicious File Download From File Sharing Domain Via Curl.EXE'
  tag: attack.execution
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\curl\.exe'\}|\{'OriginalFileName':\ 'curl\.exe'\})
- name: '[Sigma] Suspicious File Download From File Sharing Domain Via Curl.EXE'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.githubusercontent\.com|anonfiles\.com|cdn\.discordapp\.com|ddns\.net|dl\.dropboxusercontent\.com|ghostbin\.co|github\.com|glitch\.me|gofile\.io|hastebin\.com|mediafire\.com|mega\.nz|onrender\.com|pages\.dev|paste\.ee|pastebin\.com|pastebin\.pl|pastetext\.net|pixeldrain\.com|privatlab\.com|privatlab\.net|send\.exploit\.in|sendspace\.com|storage\.googleapis\.com|storjshare\.io|supabase\.co|temp\.sh|transfer\.sh|trycloudflare\.com|ufile\.io|w3spaces\.com|workers\.dev)
- name: '[Sigma] Suspicious File Download From File Sharing Domain Via Curl.EXE'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)http
- name: '[Sigma] Suspicious File Download From File Sharing Domain Via Curl.EXE'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-O|\-\-remote\-name|\-\-output)
- name: '[Sigma] Suspicious File Download From File Sharing Domain Via Curl.EXE'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.ps1|\.ps1'|\.ps1"|\.dat|\.dat'|\.dat"|\.msi|\.msi'|\.msi"|\.bat|\.bat'|\.bat"|\.exe|\.exe'|\.exe"|\.vbs|\.vbs'|\.vbs"|\.vbe|\.vbe'|\.vbe"|\.hta|\.hta'|\.hta"|\.dll|\.dll'|\.dll"|\.psm1|\.psm1'|\.psm1")$
- name: '[Sigma] Insecure Transfer Via Curl.EXE'
  tag: attack.execution
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\curl\.exe'\}|\{'OriginalFileName':\ 'curl\.exe'\})
- name: '[Sigma] Insecure Transfer Via Curl.EXE'
  tag: attack.execution
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|re':\ '\\\\s\-k\\\\s'\}|\{'CommandLine\|contains':\
    '\-\-insecure'\})
- name: '[Sigma] Insecure Proxy/DOH Transfer Via Curl.EXE'
  tag: attack.execution
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\curl\.exe'\}|\{'OriginalFileName':\ 'curl\.exe'\})
- name: '[Sigma] Insecure Proxy/DOH Transfer Via Curl.EXE'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-\-doh\-insecure|\-\-proxy\-insecure)
- name: '[Sigma] Local File Read Using Curl.EXE'
  tag: attack.execution
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\curl\.exe'\}|\{'OriginalFileName':\ 'curl\.exe'\})
- name: '[Sigma] Local File Read Using Curl.EXE'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)file:///
- name: '[Sigma] Suspicious Curl.EXE Download'
  tag: attack.command-and-control,attack.t1105
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\curl\.exe'\}|\{'Product':\ 'The\ curl\
    executable'\})
- name: '[Sigma] Suspicious Curl.EXE Download'
  tag: attack.command-and-control,attack.t1105
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(%AppData%|%Public%|%Temp%|%tmp%|\\AppData\\|\\Desktop\\|\\Temp\\|\\Users\\Public\\|C:\\PerfLogs\\|C:\\ProgramData\\|C:\\Windows\\Temp\\)
- name: '[Sigma] Suspicious Curl.EXE Download'
  tag: attack.command-and-control,attack.t1105
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.dll|\.gif|\.jpeg|\.jpg|\.png|\.temp|\.tmp|\.txt|\.vbe|\.vbs)$
- name: '[Sigma] Suspicious Curl.EXE Download'
  tag: attack.command-and-control,attack.t1105
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Program\ Files\\Git\\usr\\bin\\sh\.exe
- name: '[Sigma] Suspicious Curl.EXE Download'
  tag: attack.command-and-control,attack.t1105
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Program\ Files\\Git\\mingw64\\bin\\curl\.exe
- name: '[Sigma] Suspicious Curl.EXE Download'
  tag: attack.command-and-control,attack.t1105
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-\-silent\ \-\-show\-error\ \-\-output\ |gfw\-httpget\-|AppData)
- name: '[Sigma] Suspicious CustomShellHost Execution'
  tag: attack.defense-evasion,attack.t1216
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\CustomShellHost\.exe$
- name: '[Sigma] Suspicious CustomShellHost Execution'
  tag: attack.defense-evasion,attack.t1216
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\explorer\.exe
- name: '[Sigma] ManageEngine Endpoint Central Dctask64.EXE Potential Abuse'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1055.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\dctask64\.exe'\}|\{'Hashes\|contains':\
    \['IMPHASH=6834B1B94E49701D77CCB3C0895E1AFD',\ 'IMPHASH=1BB6F93B129F398C7C4A76BB97450BBA',\
    'IMPHASH=FAA2AC19875FADE461C8D89DCF2710A3',\ 'IMPHASH=F1039CED4B91572AB7847D26032E6BBF'\]\})
- name: '[Sigma] ManageEngine Endpoint Central Dctask64.EXE Potential Abuse'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1055.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ executecmd64\ |\ invokeexe\ |\ injectDll\ )
- name: '[Sigma] Uncommon Child Process Of Defaultpack.EXE'
  tag: attack.t1218,attack.defense-evasion,attack.execution
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\DefaultPack\.exe$
- name: '[Sigma] Remote File Download Via Desktopimgdownldr Utility'
  tag: attack.command-and-control,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\desktopimgdownldr\.exe$
- name: '[Sigma] Remote File Download Via Desktopimgdownldr Utility'
  tag: attack.command-and-control,attack.t1105
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\desktopimgdownldr\.exe$
- name: '[Sigma] Remote File Download Via Desktopimgdownldr Utility'
  tag: attack.command-and-control,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)/lockscreenurl:http
- name: '[Sigma] Suspicious Desktopimgdownldr Command'
  tag: attack.command-and-control,attack.t1105
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ /lockscreenurl:'
- name: '[Sigma] Suspicious Desktopimgdownldr Command'
  tag: attack.command-and-control,attack.t1105
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.jpg|\.jpeg|\.png)
- name: '[Sigma] Suspicious Desktopimgdownldr Command'
  tag: attack.command-and-control,attack.t1105
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(reg\ delete|\\PersonalizationCSP)
- name: '[Sigma] Potential DLL Sideloading Via DeviceEnroller.EXE'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\deviceenroller\.exe'\}|\{'OriginalFileName':\
    'deviceenroller\.exe'\})
- name: '[Sigma] Potential DLL Sideloading Via DeviceEnroller.EXE'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)/PhoneDeepLink
- name: '[Sigma] DeviceCredentialDeployment Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\DeviceCredentialDeployment\.exe$
- name: '[Sigma] Arbitrary MSI Download Via Devinit.EXE'
  tag: attack.execution,attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-t\ msi\-install\ |\ \-i\ http)
- name: '[Sigma] Potentially Suspicious Child Process Of ClickOnce Application'
  tag: attack.execution,attack.defense-evasion
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\AppData\\Local\\Apps\\2\.0\\
- name: '[Sigma] Potentially Suspicious Child Process Of ClickOnce Application'
  tag: attack.execution,attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\calc\.exe|\\cmd\.exe|\\cscript\.exe|\\explorer\.exe|\\mshta\.exe|\\net\.exe|\\net1\.exe|\\nltest\.exe|\\notepad\.exe|\\powershell\.exe|\\pwsh\.exe|\\reg\.exe|\\regsvr32\.exe|\\rundll32\.exe|\\schtasks\.exe|\\werfault\.exe|\\wscript\.exe)$
- name: '[Sigma] DirLister Execution'
  tag: attack.discovery,attack.t1083
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'DirLister\.exe'\}|\{'Image\|endswith':\ '\\\\DirLister\.exe'\})
- name: '[Sigma] Potentially Suspicious Child Process Of DiskShadow.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\diskshadow\.exe$
- name: '[Sigma] Potentially Suspicious Child Process Of DiskShadow.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\certutil\.exe|\\cscript\.exe|\\mshta\.exe|\\powershell\.exe|\\pwsh\.exe|\\regsvr32\.exe|\\rundll32\.exe|\\wscript\.exe)$
- name: '[Sigma] Diskshadow Script Mode - Uncommon Script Extension Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'diskshadow\.exe'\}|\{'Image\|endswith':\ '\\\\diskshadow\.exe'\})
- name: '[Sigma] Diskshadow Script Mode - Uncommon Script Extension Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\-s\ '
- name: '[Sigma] Diskshadow Script Mode - Uncommon Script Extension Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\.txt
- name: '[Sigma] Diskshadow Script Mode - Execution From Potential Suspicious Location'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'diskshadow\.exe'\}|\{'Image\|endswith':\ '\\\\diskshadow\.exe'\})
- name: '[Sigma] Diskshadow Script Mode - Execution From Potential Suspicious Location'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\-s\ '
- name: '[Sigma] Diskshadow Script Mode - Execution From Potential Suspicious Location'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Temp\\|:\\Windows\\Temp\\|\\AppData\\Local\\|\\AppData\\Roaming\\|\\ProgramData\\|\\Users\\Public\\)
- name: '[Sigma] PowerShell Web Access Feature Enabled Via DISM'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.persistence,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\dism\.exe'\}|\{'OriginalFileName':\ 'DISM\.EXE'\})
- name: '[Sigma] PowerShell Web Access Feature Enabled Via DISM'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.persistence,attack.t1548.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(WindowsPowerShellWebAccess|/online|/enable\-feature)
- name: '[Sigma] Dism Remove Online Package'
  tag: attack.defense-evasion,attack.t1562.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\DismHost\.exe$
- name: '[Sigma] Dism Remove Online Package'
  tag: attack.defense-evasion,attack.t1562.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(/Online|/Disable\-Feature)
- name: '[Sigma] Dism Remove Online Package'
  tag: attack.defense-evasion,attack.t1562.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\Dism\.exe$
- name: '[Sigma] Dism Remove Online Package'
  tag: attack.defense-evasion,attack.t1562.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/Online|/Disable\-Feature)
- name: '[Sigma] Dllhost.EXE Execution Anomaly'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1055
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\dllhost\.exe$
- name: '[Sigma] Dllhost.EXE Execution Anomaly'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1055
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(dllhost\.exe|dllhost)
- name: '[Sigma] Dllhost.EXE Execution Anomaly'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1055
  score: 80
  target: Target_Path
  condition: regex
  pattern: None
- name: '[Sigma] DLL Sideloading by VMware Xfer Utility'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\VMwareXferlogs\.exe$
- name: '[Sigma] DLL Sideloading by VMware Xfer Utility'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^C:\\Program\ Files\\VMware\\
- name: '[Sigma] Potential Discovery Activity Via Dnscmd.EXE'
  tag: attack.discovery,attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\dnscmd\.exe$
- name: '[Sigma] Potential Discovery Activity Via Dnscmd.EXE'
  tag: attack.discovery,attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/enumrecords|/enumzones|/ZonePrint|/info)
- name: '[Sigma] New DNS ServerLevelPluginDll Installed Via Dnscmd.EXE'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574.001,attack.t1112
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\dnscmd\.exe$
- name: '[Sigma] New DNS ServerLevelPluginDll Installed Via Dnscmd.EXE'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574.001,attack.t1112
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(/config|/serverlevelplugindll)
- name: '[Sigma] DNS Exfiltration and Tunneling Tools Execution'
  tag: attack.exfiltration,attack.t1048.001,attack.command-and-control,attack.t1071.004,attack.t1132.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\iodine\.exe'\}|\{'Image\|contains':\ '\\\\dnscat2'\})
- name: '[Sigma] Unusual Child Process of dns.exe'
  tag: attack.persistence,attack.initial-access,attack.t1133
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\dns\.exe$
- name: '[Sigma] Unusual Child Process of dns.exe'
  tag: attack.persistence,attack.initial-access,attack.t1133
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\conhost\.exe$
- name: '[Sigma] Potential Application Whitelisting Bypass via Dnx.EXE'
  tag: attack.defense-evasion,attack.t1218,attack.t1027.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\dnx\.exe$
- name: '[Sigma] Process Memory Dump Via Dotnet-Dump'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\dotnet\-dump\.exe'\}|\{'OriginalFileName':\
    'dotnet\-dump\.dll'\})
- name: '[Sigma] Process Memory Dump Via Dotnet-Dump'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)collect
- name: '[Sigma] Arbitrary DLL or Csproj Code Execution Via Dotnet.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\dotnet\.exe'\}|\{'OriginalFileName':\ '\.NET\
    Host'\})
- name: '[Sigma] Arbitrary DLL or Csproj Code Execution Via Dotnet.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\.csproj|\.csproj"|\.dll|\.dll"|\.csproj'|\.dll')$
- name: '[Sigma] Arbitrary DLL or Csproj Code Execution Via Dotnet.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(C:\\Program\ Files\ \(x86\)\\Notepad\+\+\\notepad\+\+\.exe|C:\\Program\
    Files\\Notepad\+\+\\notepad\+\+\.exe)
- name: '[Sigma] Arbitrary DLL or Csproj Code Execution Via Dotnet.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\ProgramData\\CSScriptNpp\\|\-cscs_path:|\\cs\-script\\cscs\.dll)
- name: '[Sigma] Binary Proxy Execution Via Dotnet-Trace.EXE'
  tag: attack.execution,attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\dotnet\-trace\.exe'\}|\{'OriginalFileName':\
    'dotnet\-trace\.dll'\})
- name: '[Sigma] Binary Proxy Execution Via Dotnet-Trace.EXE'
  tag: attack.execution,attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-\-\ |collect)
- name: '[Sigma] Potential Recon Activity Using DriverQuery.EXE'
  tag: attack.discovery
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ 'driverquery\.exe'\}|\{'OriginalFileName':\
    'drvqry\.exe'\})
- name: '[Sigma] Potential Recon Activity Using DriverQuery.EXE'
  tag: attack.discovery
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'ParentImage\|endswith':\ \['\\\\cscript\.exe',\ '\\\\mshta\.exe',\
    '\\\\regsvr32\.exe',\ '\\\\rundll32\.exe',\ '\\\\wscript\.exe'\]\}|\{'ParentImage\|contains':\
    \['\\\\AppData\\\\Local\\\\',\ '\\\\Users\\\\Public\\\\',\ '\\\\Windows\\\\Temp\\\\'\]\})
- name: '[Sigma] DriverQuery.EXE Execution'
  tag: attack.discovery
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ 'driverquery\.exe'\}|\{'OriginalFileName':\
    'drvqry\.exe'\})
- name: '[Sigma] DriverQuery.EXE Execution'
  tag: attack.discovery
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'ParentImage\|endswith':\ \['\\\\cscript\.exe',\ '\\\\mshta\.exe',\
    '\\\\regsvr32\.exe',\ '\\\\rundll32\.exe',\ '\\\\wscript\.exe'\]\}|\{'ParentImage\|contains':\
    \['\\\\AppData\\\\Local\\\\',\ '\\\\Users\\\\Public\\\\',\ '\\\\Windows\\\\Temp\\\\'\]\})
- name: '[Sigma] Potentially Over Permissive Permissions Granted Using Dsacls.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\dsacls\.exe'\}|\{'OriginalFileName':\ 'DSACLS\.EXE'\})
- name: '[Sigma] Potentially Over Permissive Permissions Granted Using Dsacls.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ /G\ '
- name: '[Sigma] Potentially Over Permissive Permissions Granted Using Dsacls.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(GR|GE|GW|GA|WP|WD)
- name: '[Sigma] Potential Password Spraying Attempt Using Dsacls.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\dsacls\.exe'\}|\{'OriginalFileName':\ 'DSACLS\.EXE'\})
- name: '[Sigma] Potential Password Spraying Attempt Using Dsacls.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/user:|/passwd:)
- name: '[Sigma] Domain Trust Discovery Via Dsquery'
  tag: attack.discovery,attack.t1482
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\dsquery\.exe'\}|\{'OriginalFileName':\
    'dsquery\.exe'\})
- name: '[Sigma] Domain Trust Discovery Via Dsquery'
  tag: attack.discovery,attack.t1482
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)trustedDomain
- name: '[Sigma] Suspicious Kernel Dump Using Dtrace'
  tag: attack.discovery,attack.t1082
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\dtrace\.exe$
- name: '[Sigma] Suspicious Kernel Dump Using Dtrace'
  tag: attack.discovery,attack.t1082
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)lkd\(0\)
- name: '[Sigma] Suspicious Kernel Dump Using Dtrace'
  tag: attack.discovery,attack.t1082
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(syscall:::return|lkd\()
- name: '[Sigma] Potential Windows Defender AV Bypass Via Dump64.EXE Rename'
  tag: attack.credential-access,attack.t1003.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^:\\Program\ Files
- name: '[Sigma] Potential Windows Defender AV Bypass Via Dump64.EXE Rename'
  tag: attack.credential-access,attack.t1003.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\Microsoft\ Visual\ Studio\\
- name: '[Sigma] Potential Windows Defender AV Bypass Via Dump64.EXE Rename'
  tag: attack.credential-access,attack.t1003.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\dump64\.exe$
- name: '[Sigma] Potential Windows Defender AV Bypass Via Dump64.EXE Rename'
  tag: attack.credential-access,attack.t1003.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'procdump'\}|\{'CommandLine\|contains':\ \['\
    \-ma\ ',\ '\ \-mp\ '\]\})
- name: '[Sigma] DumpMinitool Execution'
  tag: attack.defense-evasion,attack.t1036,attack.t1003.001,attack.credential-access
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\DumpMinitool\.exe',\ '\\\\DumpMinitool\.x86\.exe',\
    '\\\\DumpMinitool\.arm64\.exe'\]\}|\{'OriginalFileName':\ \['DumpMinitool\.exe',\
    'DumpMinitool\.x86\.exe',\ 'DumpMinitool\.arm64\.exe'\]\})
- name: '[Sigma] DumpMinitool Execution'
  tag: attack.defense-evasion,attack.t1036,attack.t1003.001,attack.credential-access
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ Full|\ Mini|\ WithHeap)
- name: '[Sigma] Suspicious DumpMinitool Execution'
  tag: attack.defense-evasion,attack.credential-access,attack.t1036,attack.t1003.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\DumpMinitool\.exe',\ '\\\\DumpMinitool\.x86\.exe',\
    '\\\\DumpMinitool\.arm64\.exe'\]\}|\{'OriginalFileName':\ \['DumpMinitool\.exe',\
    'DumpMinitool\.x86\.exe',\ 'DumpMinitool\.arm64\.exe'\]\})
- name: '[Sigma] Suspicious DumpMinitool Execution'
  tag: attack.defense-evasion,attack.credential-access,attack.t1036,attack.t1003.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\Microsoft\ Visual\ Studio\\|\\Extensions\\)
- name: '[Sigma] Suspicious DumpMinitool Execution'
  tag: attack.defense-evasion,attack.credential-access,attack.t1036,attack.t1003.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\.txt
- name: '[Sigma] Suspicious DumpMinitool Execution'
  tag: attack.defense-evasion,attack.credential-access,attack.t1036,attack.t1003.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ Full|\ Mini|\ WithHeap)
- name: '[Sigma] Suspicious DumpMinitool Execution'
  tag: attack.defense-evasion,attack.credential-access,attack.t1036,attack.t1003.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\-\-dumpType
- name: '[Sigma] New Capture Session Launched Via DXCap.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\DXCap\.exe'\}|\{'OriginalFileName':\ 'DXCap\.exe'\})
- name: '[Sigma] New Capture Session Launched Via DXCap.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-c\ '
- name: '[Sigma] Esentutl Gather Credentials'
  tag: attack.credential-access,attack.t1003,attack.t1003.003,attack.s0404
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(esentutl|\ /p)
- name: '[Sigma] Copying Sensitive Files with Credential Data'
  tag: attack.credential-access,attack.t1003.002,attack.t1003.003,car.2013-07-001,attack.s0404
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\esentutl\.exe'\}|\{'OriginalFileName':\
    '\\\\esentutl\.exe'\})
- name: '[Sigma] Copying Sensitive Files with Credential Data'
  tag: attack.credential-access,attack.t1003.002,attack.t1003.003,car.2013-07-001,attack.s0404
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(vss|\ /m\ |\ /y\ )
- name: '[Sigma] Copying Sensitive Files with Credential Data'
  tag: attack.credential-access,attack.t1003.002,attack.t1003.003,car.2013-07-001,attack.s0404
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\config\\RegBack\\sam|\\config\\RegBack\\security|\\config\\RegBack\\system|\\config\\sam|\\config\\security|\\config\\system\
    |\\repair\\sam|\\repair\\security|\\repair\\system|\\windows\\ntds\\ntds\.dit)
- name: '[Sigma] Esentutl Steals Browser Information'
  tag: attack.collection,attack.t1005
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\esentutl\.exe'\}|\{'OriginalFileName':\
    'esentutl\.exe'\})
- name: '[Sigma] Esentutl Steals Browser Information'
  tag: attack.collection,attack.t1005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\-r
- name: '[Sigma] Esentutl Steals Browser Information'
  tag: attack.collection,attack.t1005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\Windows\\WebCache
- name: '[Sigma] Potentially Suspicious Event Viewer Child Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002,car.2019-04-001
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\eventvwr\.exe$
- name: '[Sigma] Potentially Suspicious Event Viewer Child Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002,car.2019-04-001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Windows\\System32\\mmc\.exe|:\\Windows\\System32\\WerFault\.exe|:\\Windows\\SysWOW64\\WerFault\.exe)$
- name: '[Sigma] Potentially Suspicious Cabinet File Expansion'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\expand\.exe$
- name: '[Sigma] Potentially Suspicious Cabinet File Expansion'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\-F:'
- name: '[Sigma] Potentially Suspicious Cabinet File Expansion'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Perflogs\\|:\\ProgramData|:\\Users\\Public\\|:\\Windows\\Temp\\|\\Admin\$\\|\\AppData\\Local\\Temp\\|\\AppData\\Roaming\\|\\C\$\\|\\Temporary\
    Internet)
- name: '[Sigma] Potentially Suspicious Cabinet File Expansion'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains\|all':\ \[':\\\\Users\\\\',\ '\\\\Favorites\\\\'\]\}|\{'CommandLine\|contains\|all':\
    \[':\\\\Users\\\\',\ '\\\\Favourites\\\\'\]\}|\{'CommandLine\|contains\|all':\
    \[':\\\\Users\\\\',\ '\\\\Contacts\\\\'\]\})
- name: '[Sigma] Potentially Suspicious Cabinet File Expansion'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Program\ Files\ \(x86\)\\Dell\\UpdateService\\ServiceShell\.exe
- name: '[Sigma] Potentially Suspicious Cabinet File Expansion'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\ProgramData\\Dell\\UpdateService\\Temp\\
- name: '[Sigma] Explorer Process Tree Break'
  tag: attack.defense-evasion,attack.t1036
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)/factory,\{75dff2b7\-6936\-4c06\-a8bb\-676a7b00b24b\}
- name: '[Sigma] Explorer Process Tree Break'
  tag: attack.defense-evasion,attack.t1036
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)explorer\.exe
- name: '[Sigma] Explorer Process Tree Break'
  tag: attack.defense-evasion,attack.t1036
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ /root,
- name: '[Sigma] File Explorer Folder Opened Using Explorer Folder Shortcut Via Shell'
  tag: attack.discovery,attack.t1135
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\cmd\.exe|\\powershell\.exe|\\pwsh\.exe)$
- name: '[Sigma] File Explorer Folder Opened Using Explorer Folder Shortcut Via Shell'
  tag: attack.discovery,attack.t1135
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\explorer\.exe$
- name: '[Sigma] File Explorer Folder Opened Using Explorer Folder Shortcut Via Shell'
  tag: attack.discovery,attack.t1135
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)shell:mycomputerfolder
- name: '[Sigma] Explorer NOUACCHECK Flag'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1548.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\explorer\.exe$
- name: '[Sigma] Explorer NOUACCHECK Flag'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1548.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)/NOUACCHECK
- name: '[Sigma] Explorer NOUACCHECK Flag'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'ParentCommandLine':\ 'C:\\\\Windows\\\\system32\\\\svchost\.exe\
    \-k\ netsvcs\ \-p\ \-s\ Schedule'\}|\{'ParentImage':\ 'C:\\\\Windows\\\\System32\\\\svchost\.exe'\})
- name: '[Sigma] Remote File Download Via Findstr.EXE'
  tag: attack.defense-evasion,attack.credential-access,attack.command-and-control,attack.t1218,attack.t1564.004,attack.t1552.001,attack.t1105
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains':\ 'findstr'\}|\{'Image\|endswith':\ 'findstr\.exe'\}|\{'OriginalFileName':\
    'FINDSTR\.EXE'\})
- name: '[Sigma] Remote File Download Via Findstr.EXE'
  tag: attack.defense-evasion,attack.credential-access,attack.command-and-control,attack.t1218,attack.t1564.004,attack.t1552.001,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-v\ '
- name: '[Sigma] Remote File Download Via Findstr.EXE'
  tag: attack.defense-evasion,attack.credential-access,attack.command-and-control,attack.t1218,attack.t1564.004,attack.t1552.001,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-l\ '
- name: '[Sigma] Remote File Download Via Findstr.EXE'
  tag: attack.defense-evasion,attack.credential-access,attack.command-and-control,attack.t1218,attack.t1564.004,attack.t1552.001,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\\\\\\\
- name: '[Sigma] Findstr GPP Passwords'
  tag: attack.credential-access,attack.t1552.006
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\find\.exe',\ '\\\\findstr\.exe'\]\}|\{'OriginalFileName':\
    \['FIND\.EXE',\ 'FINDSTR\.EXE'\]\})
- name: '[Sigma] Findstr GPP Passwords'
  tag: attack.credential-access,attack.t1552.006
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(cpassword|\\sysvol\\|\.xml)
- name: '[Sigma] Findstr Launching .lnk File'
  tag: attack.defense-evasion,attack.t1036,attack.t1202,attack.t1027.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\find\.exe',\ '\\\\findstr\.exe'\]\}|\{'OriginalFileName':\
    \['FIND\.EXE',\ 'FINDSTR\.EXE'\]\})
- name: '[Sigma] Findstr Launching .lnk File'
  tag: attack.defense-evasion,attack.t1036,attack.t1202,attack.t1027.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\.lnk|\.lnk"|\.lnk')$
- name: '[Sigma] LSASS Process Reconnaissance Via Findstr.EXE'
  tag: attack.credential-access,attack.t1552.006
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\find\.exe',\ '\\\\findstr\.exe'\]\}|\{'OriginalFileName':\
    \['FIND\.EXE',\ 'FINDSTR\.EXE'\]\})
- name: '[Sigma] LSASS Process Reconnaissance Via Findstr.EXE'
  tag: attack.credential-access,attack.t1552.006
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)lsass
- name: '[Sigma] LSASS Process Reconnaissance Via Findstr.EXE'
  tag: attack.credential-access,attack.t1552.006
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /i\ "lsass|\ /i\ lsass\.exe|findstr\ "lsass|findstr\ lsass|findstr\.exe\
    "lsass|findstr\.exe\ lsass)
- name: '[Sigma] Permission Misconfiguration Reconnaissance Via Findstr.EXE'
  tag: attack.credential-access,attack.t1552.006
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\find\.exe',\ '\\\\findstr\.exe'\]\}|\{'OriginalFileName':\
    \['FIND\.EXE',\ 'FINDSTR\.EXE'\]\})
- name: '[Sigma] Permission Misconfiguration Reconnaissance Via Findstr.EXE'
  tag: attack.credential-access,attack.t1552.006
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)("Everyone"|'Everyone'|"BUILTIN\\\\"|'BUILTIN\\')
- name: '[Sigma] Permission Misconfiguration Reconnaissance Via Findstr.EXE'
  tag: attack.credential-access,attack.t1552.006
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(icacls\ |findstr\ |Everyone)
- name: '[Sigma] Recon Command Output Piped To Findstr.EXE'
  tag: attack.discovery,attack.t1057
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(ipconfig.*\|.*find|net.*\|.*find|netstat.*\|.*find|ping.*\|.*find|systeminfo.*\|.*find|tasklist.*\|.*find|whoami.*\|.*find)
- name: '[Sigma] Recon Command Output Piped To Findstr.EXE'
  tag: attack.discovery,attack.t1057
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(cmd\.exe\ /c\ TASKLIST\ /V\ \||FIND\ /I|\\xampp\\|\\catalina_start\.bat)
- name: '[Sigma] Security Tools Keyword Lookup Via Findstr.EXE'
  tag: attack.discovery,attack.t1518.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\find\.exe',\ '\\\\findstr\.exe'\]\}|\{'OriginalFileName':\
    \['FIND\.EXE',\ 'FINDSTR\.EXE'\]\})
- name: '[Sigma] Security Tools Keyword Lookup Via Findstr.EXE'
  tag: attack.discovery,attack.t1518.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ avira|\ avira"|\ cb|\ cb"|\ cylance|\ cylance"|\ defender|\ defender"|\
    kaspersky|\ kaspersky"|\ kes|\ kes"|\ mc|\ mc"|\ sec|\ sec"|\ sentinel|\ sentinel"|\
    symantec|\ symantec"|\ virus|\ virus")$
- name: '[Sigma] Insensitive Subfolder Search Via Findstr.EXE'
  tag: attack.defense-evasion,attack.credential-access,attack.command-and-control,attack.t1218,attack.t1564.004,attack.t1552.001,attack.t1105
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains':\ 'findstr'\}|\{'Image\|endswith':\ 'findstr\.exe'\}|\{'OriginalFileName':\
    'FINDSTR\.EXE'\})
- name: '[Sigma] Insensitive Subfolder Search Via Findstr.EXE'
  tag: attack.defense-evasion,attack.credential-access,attack.command-and-control,attack.t1218,attack.t1564.004,attack.t1552.001,attack.t1105
  score: 20
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-s\ '
- name: '[Sigma] Insensitive Subfolder Search Via Findstr.EXE'
  tag: attack.defense-evasion,attack.credential-access,attack.command-and-control,attack.t1218,attack.t1564.004,attack.t1552.001,attack.t1105
  score: 20
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-i\ '
- name: '[Sigma] Sysmon Discovery Via Default Driver Altitude Using Findstr.EXE'
  tag: attack.discovery,attack.t1518.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\find\.exe',\ '\\\\findstr\.exe'\]\}|\{'OriginalFileName':\
    \['FIND\.EXE',\ 'FINDSTR\.EXE'\]\})
- name: '[Sigma] Sysmon Discovery Via Default Driver Altitude Using Findstr.EXE'
  tag: attack.discovery,attack.t1518.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\ 385201
- name: '[Sigma] Finger.EXE Execution'
  tag: attack.command-and-control,attack.t1105
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'finger\.exe'\}|\{'Image\|endswith':\ '\\\\finger\.exe'\})
- name: '[Sigma] Filter Driver Unloaded Via Fltmc.EXE'
  tag: attack.defense-evasion,attack.t1070,attack.t1562,attack.t1562.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\fltMC\.exe'\}|\{'OriginalFileName':\ 'fltMC\.exe'\})
- name: '[Sigma] Filter Driver Unloaded Via Fltmc.EXE'
  tag: attack.defense-evasion,attack.t1070,attack.t1562,attack.t1562.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)unload
- name: '[Sigma] Filter Driver Unloaded Via Fltmc.EXE'
  tag: attack.defense-evasion,attack.t1070,attack.t1562,attack.t1562.002
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(\\AppData\\Local\\Temp\\|:\\Windows\\Temp\\)
- name: '[Sigma] Filter Driver Unloaded Via Fltmc.EXE'
  tag: attack.defense-evasion,attack.t1070,attack.t1562,attack.t1562.002
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\endpoint\-protection\-installer\-x64\.tmp$
- name: '[Sigma] Filter Driver Unloaded Via Fltmc.EXE'
  tag: attack.defense-evasion,attack.t1070,attack.t1562,attack.t1562.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(unload\ rtp_filesystem_filter|unload\ rtp_filter)$
- name: '[Sigma] Filter Driver Unloaded Via Fltmc.EXE'
  tag: attack.defense-evasion,attack.t1070,attack.t1562,attack.t1562.002
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Program\ Files\ \(x86\)\\ManageEngine\\uems_agent\\bin\\dcfaservice64\.exe
- name: '[Sigma] Filter Driver Unloaded Via Fltmc.EXE'
  tag: attack.defense-evasion,attack.t1070,attack.t1562,attack.t1562.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)unload\ DFMFilter$
- name: '[Sigma] Sysmon Driver Unloaded Via Fltmc.EXE'
  tag: attack.defense-evasion,attack.t1070,attack.t1562,attack.t1562.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\fltMC\.exe'\}|\{'OriginalFileName':\ 'fltMC\.exe'\})
- name: '[Sigma] Sysmon Driver Unloaded Via Fltmc.EXE'
  tag: attack.defense-evasion,attack.t1070,attack.t1562,attack.t1562.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(unload|sysmon)
- name: '[Sigma] Forfiles.EXE Child Process Masquerading'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\.exe|\.exe")$
- name: '[Sigma] Forfiles.EXE Child Process Masquerading'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\cmd\.exe$
- name: '[Sigma] Forfiles.EXE Child Process Masquerading'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^/c\ echo\ "
- name: '[Sigma] Forfiles.EXE Child Process Masquerading'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(:\\Windows\\System32\\|:\\Windows\\SysWOW64\\)
- name: '[Sigma] Forfiles.EXE Child Process Masquerading'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\forfiles\.exe$
- name: '[Sigma] Forfiles.EXE Child Process Masquerading'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Windows\\System32\\|:\\Windows\\SysWOW64\\)
- name: '[Sigma] Forfiles.EXE Child Process Masquerading'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\cmd\.exe$
- name: '[Sigma] Forfiles Command Execution'
  tag: attack.execution,attack.t1059
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\forfiles\.exe'\}|\{'OriginalFileName':\
    'forfiles\.exe'\})
- name: '[Sigma] Forfiles Command Execution'
  tag: attack.execution,attack.t1059
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-c\ '
- name: '[Sigma] Uncommon FileSystem Load Attempt By Format.com'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\format\.com$
- name: '[Sigma] Uncommon FileSystem Load Attempt By Format.com'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)/fs:'
- name: '[Sigma] Uncommon FileSystem Load Attempt By Format.com'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(/fs:exFAT|/fs:FAT|/fs:NTFS|/fs:ReFS|/fs:UDF)
- name: '[Sigma] Use of FSharp Interpreters'
  tag: attack.execution,attack.t1059
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\fsi\.exe',\ '\\\\fsianycpu\.exe'\]\}|\{'OriginalFileName':\
    \['fsi\.exe',\ 'fsianycpu\.exe'\]\})
- name: '[Sigma] Fsutil Drive Enumeration'
  tag: attack.discovery,attack.t1120
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\fsutil\.exe'\}|\{'OriginalFileName':\ 'fsutil\.exe'\})
- name: '[Sigma] Fsutil Drive Enumeration'
  tag: attack.discovery,attack.t1120
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)drives
- name: '[Sigma] Potentially Suspicious NTFS Symlink Behavior Modification'
  tag: attack.execution,attack.t1059,attack.defense-evasion,attack.t1222.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\cmd\.exe',\ '\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\
    \['Cmd\.Exe',\ 'PowerShell\.EXE',\ 'pwsh\.dll'\]\})
- name: '[Sigma] Potentially Suspicious NTFS Symlink Behavior Modification'
  tag: attack.execution,attack.t1059,attack.defense-evasion,attack.t1222.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(fsutil|behavior|set|SymlinkEvaluation)
- name: '[Sigma] Potentially Suspicious NTFS Symlink Behavior Modification'
  tag: attack.execution,attack.t1059,attack.defense-evasion,attack.t1222.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(R2L:1|R2R:1|L2L:1)
- name: '[Sigma] Fsutil Suspicious Invocation'
  tag: attack.defense-evasion,attack.impact,attack.t1070,attack.t1485
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\fsutil\.exe'\}|\{'OriginalFileName':\ 'fsutil\.exe'\})
- name: '[Sigma] Fsutil Suspicious Invocation'
  tag: attack.defense-evasion,attack.impact,attack.t1070,attack.t1485
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(deletejournal|createjournal|setZeroData)
- name: '[Sigma] Potential Arbitrary Command Execution Via FTP.EXE'
  tag: attack.execution,attack.t1059,attack.defense-evasion,attack.t1202
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\ftp\.exe$
- name: '[Sigma] Potential Arbitrary Command Execution Via FTP.EXE'
  tag: attack.execution,attack.t1059,attack.defense-evasion,attack.t1202
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\ftp\.exe'\}|\{'OriginalFileName':\ 'ftp\.exe'\})
- name: '[Sigma] Potential Arbitrary Command Execution Via FTP.EXE'
  tag: attack.execution,attack.t1059,attack.defense-evasion,attack.t1202
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\-s:'
- name: '[Sigma] Arbitrary File Download Via GfxDownloadWrapper.EXE'
  tag: attack.command-and-control,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\GfxDownloadWrapper\.exe$
- name: '[Sigma] Arbitrary File Download Via GfxDownloadWrapper.EXE'
  tag: attack.command-and-control,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(http://|https://)
- name: '[Sigma] Arbitrary File Download Via GfxDownloadWrapper.EXE'
  tag: attack.command-and-control,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)https://gameplayapi\.intel\.com/
- name: '[Sigma] Github Self-Hosted Runner Execution'
  tag: attack.command-and-control,attack.t1102.002,attack.t1071
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\Runner\.Worker\.exe'\}|\{'OriginalFileName':\
    'Runner\.Worker\.dll'\})
- name: '[Sigma] Github Self-Hosted Runner Execution'
  tag: attack.command-and-control,attack.t1102.002,attack.t1071
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)spawnclient
- name: '[Sigma] Github Self-Hosted Runner Execution'
  tag: attack.command-and-control,attack.t1102.002,attack.t1071
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\Runner\.Listener\.exe'\}|\{'OriginalFileName':\
    'Runner\.Listener\.dll'\})
- name: '[Sigma] Github Self-Hosted Runner Execution'
  tag: attack.command-and-control,attack.t1102.002,attack.t1071
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(run|configure)
- name: '[Sigma] Suspicious Git Clone'
  tag: attack.reconnaissance,attack.t1593.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\git\.exe',\ '\\\\git\-remote\-https\.exe'\]\}|\{'OriginalFileName':\
    'git\.exe'\})
- name: '[Sigma] Suspicious Git Clone'
  tag: attack.reconnaissance,attack.t1593.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ clone\ |git\-remote\-https\ )
- name: '[Sigma] Suspicious Git Clone'
  tag: attack.reconnaissance,attack.t1593.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(exploit|Vulns|vulnerability|RemoteCodeExecution|Invoke\-|CVE\-|poc\-|ProofOfConcept|proxyshell|log4shell|eternalblue|eternal\-blue|MS17\-)
- name: '[Sigma] Potentially Suspicious GoogleUpdate Child Process'
  tag: attack.defense-evasion
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\GoogleUpdate\.exe$
- name: '[Sigma] Potentially Suspicious GoogleUpdate Child Process'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|contains':\ '\\\\Google'\}|\{'Image\|endswith':\ \['\\\\setup\.exe',\
    'chrome_updater\.exe',\ 'chrome_installer\.exe'\]\})
- name: '[Sigma] Potentially Suspicious GoogleUpdate Child Process'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: None
- name: '[Sigma] File Decryption Using Gpg4win'
  tag: attack.execution
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\gpg\.exe',\ '\\\\gpg2\.exe'\]\}|\{'Description':\
    'GnuPGs\ OpenPGP\ tool'\})
- name: '[Sigma] File Decryption Using Gpg4win'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-d\ |passphrase)
- name: '[Sigma] File Encryption Using Gpg4win'
  tag: attack.execution
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\gpg\.exe',\ '\\\\gpg2\.exe'\]\}|\{'Description':\
    'GnuPGs\ OpenPGP\ tool'\})
- name: '[Sigma] File Encryption Using Gpg4win'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-c\ |passphrase)
- name: '[Sigma] Portable Gpg.EXE Execution'
  tag: attack.impact,attack.t1486
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\gpg\.exe',\ '\\\\gpg2\.exe'\]\}|\{'OriginalFileName':\
    'gpg\.exe'\}|\{'Description':\ 'GnuPGs\ OpenPGP\ tool'\})
- name: '[Sigma] Portable Gpg.EXE Execution'
  tag: attack.impact,attack.t1486
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Program\ Files\ \(x86\)\\GNU\\GnuPG\\bin\\|:\\Program\ Files\ \(x86\)\\GnuPG\
    VS\-Desktop\\|:\\Program\ Files\ \(x86\)\\GnuPG\\bin\\|:\\Program\ Files\ \(x86\)\\Gpg4win\\bin\\)
- name: '[Sigma] File Encryption/Decryption Via Gpg4win From Suspicious Locations'
  tag: attack.execution
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\gpg\.exe',\ '\\\\gpg2\.exe'\]\}|\{'Product':\
    'GNU\ Privacy\ Guard\ \(GnuPG\)'\}|\{'Description':\ 'GnuPGs\ OpenPGP\ tool'\})
- name: '[Sigma] File Encryption/Decryption Via Gpg4win From Suspicious Locations'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\-passphrase
- name: '[Sigma] File Encryption/Decryption Via Gpg4win From Suspicious Locations'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\PerfLogs\\|:\\Temp\\|:\\Users\\Public\\|:\\Windows\\Temp\\|\\AppData\\Local\\Temp\\|\\AppData\\Roaming\\)
- name: '[Sigma] Gpresult Display Group Policy Information'
  tag: attack.discovery,attack.t1615
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\gpresult\.exe$
- name: '[Sigma] Gpresult Display Group Policy Information'
  tag: attack.discovery,attack.t1615
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/z|/v)
- name: '[Sigma] Arbitrary Binary Execution Using GUP Utility'
  tag: attack.execution
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\gup\.exe$
- name: '[Sigma] Arbitrary Binary Execution Using GUP Utility'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\explorer\.exe$
- name: '[Sigma] Arbitrary Binary Execution Using GUP Utility'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\explorer\.exe$
- name: '[Sigma] Arbitrary Binary Execution Using GUP Utility'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\Notepad\+\+\\notepad\+\+\.exe
- name: '[Sigma] Arbitrary Binary Execution Using GUP Utility'
  tag: attack.execution
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\Notepad\+\+\\updater\\
- name: '[Sigma] Arbitrary Binary Execution Using GUP Utility'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: None
- name: '[Sigma] File Download Using Notepad++ GUP Utility'
  tag: attack.command-and-control,attack.t1105
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\GUP\.exe'\}|\{'OriginalFileName':\ 'gup\.exe'\})
- name: '[Sigma] File Download Using Notepad++ GUP Utility'
  tag: attack.command-and-control,attack.t1105
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-unzipTo\ |http)
- name: '[Sigma] File Download Using Notepad++ GUP Utility'
  tag: attack.command-and-control,attack.t1105
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\notepad\+\+\.exe$
- name: '[Sigma] Suspicious GUP Usage'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\GUP\.exe$
- name: '[Sigma] Suspicious GUP Usage'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\Program\ Files\\Notepad\+\+\\updater\\GUP\.exe|\\Program\ Files\
    \(x86\)\\Notepad\+\+\\updater\\GUP\.exe)$
- name: '[Sigma] Suspicious GUP Usage'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\Users\\
- name: '[Sigma] Suspicious GUP Usage'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\AppData\\Local\\Notepad\+\+\\updater\\GUP\.exe|\\AppData\\Roaming\\Notepad\+\+\\updater\\GUP\.exe)$
- name: '[Sigma] HH.EXE Execution'
  tag: attack.defense-evasion,attack.t1218.001
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'HH\.exe'\}|\{'Image\|endswith':\ '\\\\hh\.exe'\})
- name: '[Sigma] HH.EXE Execution'
  tag: attack.defense-evasion,attack.t1218.001
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)\.chm
- name: '[Sigma] Remote CHM File Download/Execution Via HH.EXE'
  tag: attack.defense-evasion,attack.t1218.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'HH\.exe'\}|\{'Image\|endswith':\ '\\\\hh\.exe'\})
- name: '[Sigma] Remote CHM File Download/Execution Via HH.EXE'
  tag: attack.defense-evasion,attack.t1218.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(http://|https://|\\\\\\\\)
- name: '[Sigma] HTML Help HH.EXE Suspicious Child Process'
  tag: attack.defense-evasion,attack.execution,attack.initial-access,attack.t1047,attack.t1059.001,attack.t1059.003,attack.t1059.005,attack.t1059.007,attack.t1218,attack.t1218.001,attack.t1218.010,attack.t1218.011,attack.t1566,attack.t1566.001
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\hh\.exe$
- name: '[Sigma] HTML Help HH.EXE Suspicious Child Process'
  tag: attack.defense-evasion,attack.execution,attack.initial-access,attack.t1047,attack.t1059.001,attack.t1059.003,attack.t1059.005,attack.t1059.007,attack.t1218,attack.t1218.001,attack.t1218.010,attack.t1218.011,attack.t1566,attack.t1566.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\CertReq\.exe|\\CertUtil\.exe|\\cmd\.exe|\\cscript\.exe|\\installutil\.exe|\\MSbuild\.exe|\\MSHTA\.EXE|\\msiexec\.exe|\\powershell\.exe|\\pwsh\.exe|\\regsvr32\.exe|\\rundll32\.exe|\\schtasks\.exe|\\wmic\.exe|\\wscript\.exe)$
- name: '[Sigma] Suspicious HH.EXE Execution'
  tag: attack.defense-evasion,attack.execution,attack.initial-access,attack.t1047,attack.t1059.001,attack.t1059.003,attack.t1059.005,attack.t1059.007,attack.t1218,attack.t1218.001,attack.t1218.010,attack.t1218.011,attack.t1566,attack.t1566.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'HH\.exe'\}|\{'Image\|endswith':\ '\\\\hh\.exe'\})
- name: '[Sigma] Suspicious HH.EXE Execution'
  tag: attack.defense-evasion,attack.execution,attack.initial-access,attack.t1047,attack.t1059.001,attack.t1059.003,attack.t1059.005,attack.t1059.007,attack.t1218,attack.t1218.001,attack.t1218.010,attack.t1218.011,attack.t1566,attack.t1566.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.application|\\AppData\\Local\\Temp\\|\\Content\.Outlook\\|\\Downloads\\|\\Users\\Public\\|\\Windows\\Temp\\)
- name: '[Sigma] HackTool - ADCSPwn Execution'
  tag: attack.collection,attack.credential-access,attack.t1557.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-\-adcs\ |\ \-\-port\ )
- name: '[Sigma] HackTool - Bloodhound/Sharphound Execution'
  tag: attack.discovery,attack.t1087.001,attack.t1087.002,attack.t1482,attack.t1069.001,attack.t1069.002,attack.execution,attack.t1059.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Product\|contains':\ 'SharpHound'\}|\{'Description\|contains':\
    'SharpHound'\}|\{'Company\|contains':\ \['SpecterOps',\ 'evil\ corp'\]\}|\{'Image\|contains':\
    \['\\\\Bloodhound\.exe',\ '\\\\SharpHound\.exe'\]\})
- name: '[Sigma] HackTool - Bloodhound/Sharphound Execution'
  tag: attack.discovery,attack.t1087.001,attack.t1087.002,attack.t1482,attack.t1069.001,attack.t1069.002,attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-CollectionMethod\ All\ |\ \-\-CollectionMethods\ Session\ |\ \-\-Loop\
    \-\-Loopduration\ |\ \-\-PortScanTimeout\ |\.exe\ \-c\ All\ \-d\ |Invoke\-Bloodhound|Get\-BloodHoundData)
- name: '[Sigma] HackTool - Bloodhound/Sharphound Execution'
  tag: attack.discovery,attack.t1087.001,attack.t1087.002,attack.t1482,attack.t1069.001,attack.t1069.002,attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-JsonFolder\ |\ \-ZipFileName\ )
- name: '[Sigma] HackTool - Bloodhound/Sharphound Execution'
  tag: attack.discovery,attack.t1087.001,attack.t1087.002,attack.t1482,attack.t1069.001,attack.t1069.002,attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ DCOnly\ |\ \-\-NoSaveCache\ )
- name: '[Sigma] HackTool - F-Secure C3 Load by Rundll32'
  tag: attack.defense-evasion,attack.t1218.011
  score: 100
  target: Target_Path
  condition: regex
  pattern: (?i)(rundll32\.exe|\.dll|StartNodeRelay)
- name: '[Sigma] HackTool - Certify Execution'
  tag: attack.discovery,attack.credential-access,attack.t1649
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\Certify\.exe'\}|\{'OriginalFileName':\
    'Certify\.exe'\}|\{'Description\|contains':\ 'Certify'\})
- name: '[Sigma] HackTool - Certify Execution'
  tag: attack.discovery,attack.credential-access,attack.t1649
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.exe\ cas\ |\.exe\ find\ |\.exe\ pkiobjects\ |\.exe\ request\ |\.exe\
    download\ )
- name: '[Sigma] HackTool - Certify Execution'
  tag: attack.discovery,attack.credential-access,attack.t1649
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /vulnerable|\ /template:|\ /altname:|\ /domain:|\ /path:|\ /ca:)
- name: '[Sigma] HackTool - Certipy Execution'
  tag: attack.discovery,attack.credential-access,attack.t1649
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\Certipy\.exe'\}|\{'OriginalFileName':\
    'Certipy\.exe'\}|\{'Description\|contains':\ 'Certipy'\})
- name: '[Sigma] HackTool - Certipy Execution'
  tag: attack.discovery,attack.credential-access,attack.t1649
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ account\ |\ auth\ |\ cert\ |\ find\ |\ forge\ |\ ptt\ |\ relay\
    |\ req\ |\ shadow\ |\ template\ )
- name: '[Sigma] HackTool - Certipy Execution'
  tag: attack.discovery,attack.credential-access,attack.t1649
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-bloodhound|\ \-ca\-pfx\ |\ \-dc\-ip\ |\ \-kirbi|\ \-old\-bloodhound|\
    \-pfx\ |\ \-target|\ \-template|\ \-username\ |\ \-vulnerable|auth\ \-pfx|shadow\
    auto|shadow\ list)
- name: '[Sigma] Operator Bloopers Cobalt Strike Commands'
  tag: attack.execution,attack.t1059.003,stp.1u
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'Cmd\.Exe'\}|\{'Image\|endswith':\ '\\\\cmd\.exe'\})
- name: '[Sigma] Operator Bloopers Cobalt Strike Commands'
  tag: attack.execution,attack.t1059.003,stp.1u
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^(cmd\ |cmd\.exe|c:\\windows\\system32\\cmd\.exe)
- name: '[Sigma] Operator Bloopers Cobalt Strike Commands'
  tag: attack.execution,attack.t1059.003,stp.1u
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(psinject|spawnas|make_token|remote\-exec|rev2self|dcsync|logonpasswords|execute\-assembly|getsystem)
- name: '[Sigma] Operator Bloopers Cobalt Strike Modules'
  tag: attack.execution,attack.t1059.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'Cmd\.Exe'\}|\{'Image\|endswith':\ '\\\\cmd\.exe'\})
- name: '[Sigma] Operator Bloopers Cobalt Strike Modules'
  tag: attack.execution,attack.t1059.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Invoke\-UserHunter|Invoke\-ShareFinder|Invoke\-Kerberoast|Invoke\-SMBAutoBrute|Invoke\-Nightmare|zerologon|av_query)
- name: '[Sigma] CobaltStrike Load by Rundll32'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\rundll32\.exe'\}|\{'OriginalFileName':\
    'RUNDLL32\.EXE'\}|\{'CommandLine\|contains':\ \['rundll32\.exe',\ 'rundll32\ '\]\})
- name: '[Sigma] CobaltStrike Load by Rundll32'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\.dll
- name: '[Sigma] CobaltStrike Load by Rundll32'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ StartW|,StartW)$
- name: '[Sigma] Potential CobaltStrike Process Patterns'
  tag: attack.execution,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)cmd\.exe\ /C\ whoami$
- name: '[Sigma] Potential CobaltStrike Process Patterns'
  tag: attack.execution,attack.t1059
  score: 80
  target: ParentPath
  condition: regex
  pattern: ^C:\\Temp\\
- name: '[Sigma] Potential CobaltStrike Process Patterns'
  tag: attack.execution,attack.t1059
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\runonce\.exe|\\dllhost\.exe)$
- name: '[Sigma] Potential CobaltStrike Process Patterns'
  tag: attack.execution,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(cmd\.exe\ /c\ echo|>\ \\\\\\\\\.\\\\pipe)
- name: '[Sigma] Potential CobaltStrike Process Patterns'
  tag: attack.execution,attack.t1059
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(cmd\.exe\ /C\ echo|\ >\ \\\\\\\\\.\\\\pipe)
- name: '[Sigma] Potential CobaltStrike Process Patterns'
  tag: attack.execution,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)conhost\.exe\ 0xffffffff\ \-ForceV1$
- name: '[Sigma] Potential CobaltStrike Process Patterns'
  tag: attack.execution,attack.t1059
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)/C\ whoami$
- name: '[Sigma] Potential CobaltStrike Process Patterns'
  tag: attack.execution,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)conhost\.exe\ 0xffffffff\ \-ForceV1$
- name: '[Sigma] HackTool - CoercedPotato Execution'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1055
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\CoercedPotato\.exe$
- name: '[Sigma] HackTool - CoercedPotato Execution'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1055
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-\-exploitId\ '
- name: '[Sigma] HackTool - CoercedPotato Execution'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1055
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(IMPHASH=A75D7669DB6B2E107A44C4057FF7F7D6|IMPHASH=F91624350E2C678C5DCBE5E1F24E22C9|IMPHASH=14C81850A079A87E83D50CA41C709A15)
- name: '[Sigma] HackTool - Covenant PowerShell Launcher'
  tag: attack.execution,attack.defense-evasion,attack.t1059.001,attack.t1564.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-Sta|\-Nop|\-Window|Hidden)
- name: '[Sigma] HackTool - Covenant PowerShell Launcher'
  tag: attack.execution,attack.defense-evasion,attack.t1059.001,attack.t1564.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-Command|\-EncodedCommand)
- name: '[Sigma] HackTool - Covenant PowerShell Launcher'
  tag: attack.execution,attack.defense-evasion,attack.t1059.001,attack.t1564.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(sv\ o\ \(New\-Object\ IO\.MemorySteam\);sv\ d\ |mshta\ file\.hta|GruntHTTP|\-EncodedCommand\
    cwB2ACAAbwAgA)
- name: '[Sigma] HackTool - CrackMapExec Execution'
  tag: attack.execution,attack.persistence,attack.privilege-escalation,attack.credential-access,attack.discovery,attack.t1047,attack.t1053,attack.t1059.003,attack.t1059.001,attack.t1110,attack.t1201
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\crackmapexec\.exe$
- name: '[Sigma] HackTool - CrackMapExec Execution'
  tag: attack.execution,attack.persistence,attack.privilege-escalation,attack.credential-access,attack.discovery,attack.t1047,attack.t1053,attack.t1059.003,attack.t1059.001,attack.t1110,attack.t1201
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-M\ pe_inject\ '
- name: '[Sigma] HackTool - CrackMapExec Execution'
  tag: attack.execution,attack.persistence,attack.privilege-escalation,attack.credential-access,attack.discovery,attack.t1047,attack.t1053,attack.t1059.003,attack.t1059.001,attack.t1110,attack.t1201
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-\-local\-auth|\ \-u\ |\ \-x\ )
- name: '[Sigma] HackTool - CrackMapExec Execution'
  tag: attack.execution,attack.persistence,attack.privilege-escalation,attack.credential-access,attack.discovery,attack.t1047,attack.t1053,attack.t1059.003,attack.t1059.001,attack.t1110,attack.t1201
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-\-local\-auth|\ \-u\ |\ \-p\ |\ \-H\ 'NTHASH')
- name: '[Sigma] HackTool - CrackMapExec Execution'
  tag: attack.execution,attack.persistence,attack.privilege-escalation,attack.credential-access,attack.discovery,attack.t1047,attack.t1053,attack.t1059.003,attack.t1059.001,attack.t1110,attack.t1201
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ mssql\ |\ \-u\ |\ \-p\ |\ \-M\ |\ \-d\ )
- name: '[Sigma] HackTool - CrackMapExec Execution'
  tag: attack.execution,attack.persistence,attack.privilege-escalation,attack.credential-access,attack.discovery,attack.t1047,attack.t1053,attack.t1059.003,attack.t1059.001,attack.t1110,attack.t1201
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ smb\ |\ \-u\ |\ \-H\ |\ \-M\ |\ \-o\ )
- name: '[Sigma] HackTool - CrackMapExec Execution'
  tag: attack.execution,attack.persistence,attack.privilege-escalation,attack.credential-access,attack.discovery,attack.t1047,attack.t1053,attack.t1059.003,attack.t1059.001,attack.t1110,attack.t1201
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ smb\ |\ \-u\ |\ \-p\ |\ \-\-local\-auth)
- name: '[Sigma] HackTool - CrackMapExec Execution'
  tag: attack.execution,attack.persistence,attack.privilege-escalation,attack.credential-access,attack.discovery,attack.t1047,attack.t1053,attack.t1059.003,attack.t1059.001,attack.t1110,attack.t1201
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-\-local\-auth|\ \-u\ |\ \-p\ )
- name: '[Sigma] HackTool - CrackMapExec Execution'
  tag: attack.execution,attack.persistence,attack.privilege-escalation,attack.credential-access,attack.discovery,attack.t1047,attack.t1053,attack.t1059.003,attack.t1059.001,attack.t1110,attack.t1201
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ 10\.|\ 192\.168\.|/24\ )
- name: '[Sigma] HackTool - CrackMapExec Execution Patterns'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1047,attack.t1053,attack.t1059.003,attack.t1059.001,attack.s0106
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(cmd\.exe\ /Q\ /c\ .*\ 1>\ \\\\\\\\.*\\\\.*\\\\.*\ 2>\&1|cmd\.exe\
    /C\ .*\ >\ \\\\\\\\.*\\\\.*\\\\.*\ 2>\&1|cmd\.exe\ /C\ .*\ >\ .*\\\\Temp\\\\.*\
    2>\&1|powershell\.exe\ \-exec\ bypass\ \-noni\ \-nop\ \-w\ 1\ \-C\ "|powershell\.exe\
    \-noni\ \-nop\ \-w\ 1\ \-enc\ )
- name: '[Sigma] HackTool - CrackMapExec Process Patterns'
  tag: attack.credential-access,attack.t1003.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(tasklist\ /fi\ |Imagename\ eq\ lsass\.exe)
- name: '[Sigma] HackTool - CrackMapExec Process Patterns'
  tag: attack.credential-access,attack.t1003.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(cmd\.exe\ /c\ |cmd\.exe\ /r\ |cmd\.exe\ /k\ |cmd\ /c\ |cmd\ /r\ |cmd\
    /k\ )
- name: '[Sigma] HackTool - CrackMapExec Process Patterns'
  tag: attack.credential-access,attack.t1003.001
  score: 80
  target: User
  condition: regex
  pattern: (?i)(AUTHORI|AUTORI)
- name: '[Sigma] HackTool - CrackMapExec Process Patterns'
  tag: attack.credential-access,attack.t1003.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(do\ rundll32\.exe\ C:\\windows\\System32\\comsvcs\.dll,\ MiniDump|\\Windows\\Temp\\|\
    full|%%B)
- name: '[Sigma] HackTool - CrackMapExec Process Patterns'
  tag: attack.credential-access,attack.t1003.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(tasklist\ /v\ /fo\ csv|findstr\ /i\ "lsass")
- name: '[Sigma] HackTool - CrackMapExec PowerShell Obfuscation'
  tag: attack.execution,attack.t1059.001,attack.defense-evasion,attack.t1027.005
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\
    \['PowerShell\.EXE',\ 'pwsh\.dll'\]\})
- name: '[Sigma] HackTool - CrackMapExec PowerShell Obfuscation'
  tag: attack.execution,attack.t1059.001,attack.defense-evasion,attack.t1027.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(join.*split|\(\ \$ShellId\[1\]\+\$ShellId\[13\]\+'x'\)|\(\ \$PSHome\[.*\]\+\$PSHOME\[.*\]\+|\(\
    \$env:Public\[13\]\+\$env:Public\[5\]\+'x'\)|\(\ \$env:ComSpec\[4,.*,25\]\-Join''\)|\[1,3\]\+'x'\-Join''\))
- name: '[Sigma] HackTool - CreateMiniDump Execution'
  tag: attack.credential-access,attack.t1003.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\CreateMiniDump\.exe'\}|\{'Hashes\|contains':\
    'IMPHASH=4a07f944a83e8a7c2525efa35dd30e2f'\})
- name: '[Sigma] HackTool - DInjector PowerShell Cradle Execution'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1055
  score: 100
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /am51|\ /password)
- name: '[Sigma] HackTool - Dumpert Process Dumper Execution'
  tag: attack.credential-access,attack.t1003.001
  score: 100
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Hashes\|contains':\ 'MD5=09D278F9DE118EF09163C6140255C690'\}|\{'CommandLine\|contains':\
    'Dumpert\.dll'\})
- name: '[Sigma] HackTool - EDRSilencer Execution'
  tag: attack.defense-evasion,attack.t1562
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\EDRSilencer\.exe'\}|\{'OriginalFileName':\
    'EDRSilencer\.exe'\}|\{'Description\|contains':\ 'EDRSilencer'\})
- name: '[Sigma] HackTool - Empire PowerShell Launch Parameters'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-NoP\ \-sta\ \-NonI\ \-W\ Hidden\ \-Enc\ |\ \-noP\ \-sta\ \-w\
    1\ \-enc\ |\ \-NoP\ \-NonI\ \-W\ Hidden\ \-enc\ |\ \-noP\ \-sta\ \-w\ 1\ \-enc|\
    \-enc\ \ SQB|\ \-nop\ \-exec\ bypass\ \-EncodedCommand\ )
- name: '[Sigma] HackTool - Empire PowerShell UAC Bypass'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002,car.2019-04-001
  score: 100
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-NoP\ \-NonI\ \-w\ Hidden\ \-c\ \$x=\$\(\(gp\ HKCU:Software\\Microsoft\\Windows\
    Update\)\.Update\)|\ \-NoP\ \-NonI\ \-c\ \$x=\$\(\(gp\ HKCU:Software\\Microsoft\\Windows\
    Update\)\.Update\);)
- name: '[Sigma] HackTool - WinRM Access Via Evil-WinRM'
  tag: attack.lateral-movement,attack.t1021.006
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\ruby\.exe$
- name: '[Sigma] HackTool - WinRM Access Via Evil-WinRM'
  tag: attack.lateral-movement,attack.t1021.006
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-i\ |\-u\ |\-p\ )
- name: '[Sigma] Hacktool Execution - Imphash'
  tag: attack.credential-access,attack.resource-development,attack.t1588.002,attack.t1003
  score: 100
  target: Full_Path
  condition: regex
  pattern: (?i)(IMPHASH=BCCA3C247B619DCD13C8CDFF5F123932|IMPHASH=3A19059BD7688CB88E70005F18EFC439|IMPHASH=bf6223a49e45d99094406777eb6004ba|IMPHASH=23867A89C2B8FC733BE6CF5EF902F2D1|IMPHASH=A37FF327F8D48E8A4D2F757E1B6E70BC|IMPHASH=F9A28C458284584A93B14216308D31BD|IMPHASH=6118619783FC175BC7EBECFF0769B46E|IMPHASH=959A83047E80AB68B368FDB3F4C6E4EA|IMPHASH=563233BFA169ACC7892451F71AD5850A|IMPHASH=87575CB7A0E0700EB37F2E3668671A08|IMPHASH=13F08707F759AF6003837A150A371BA1|IMPHASH=1781F06048A7E58B323F0B9259BE798B|IMPHASH=233F85F2D4BC9D6521A6CAAE11A1E7F5|IMPHASH=24AF2584CBF4D60BBE5C6D1B31B3BE6D|IMPHASH=632969DDF6DBF4E0F53424B75E4B91F2|IMPHASH=713C29B396B907ED71A72482759ED757|IMPHASH=749A7BB1F0B4C4455949C0B2BF7F9E9F|IMPHASH=8628B2608957A6B0C6330AC3DE28CE2E|IMPHASH=8B114550386E31895DFAB371E741123D|IMPHASH=94CB940A1A6B65BED4D5A8F849CE9793|IMPHASH=9D68781980370E00E0BD939EE5E6C141|IMPHASH=B18A1401FF8F444056D29450FBC0A6CE|IMPHASH=CB567F9498452721D77A451374955F5F|IMPHASH=730073214094CD328547BF1F72289752|IMPHASH=17B461A082950FC6332228572138B80C|IMPHASH=DC25EE78E2EF4D36FAA0BADF1E7461C9|IMPHASH=819B19D53CA6736448F9325A85736792|IMPHASH=829DA329CE140D873B4A8BDE2CBFAA7E|IMPHASH=C547F2E66061A8DFFB6F5A3FF63C0A74|IMPHASH=0588081AB0E63BA785938467E1B10CCA|IMPHASH=0D9EC08BAC6C07D9987DFD0F1506587C|IMPHASH=BC129092B71C89B4D4C8CDF8EA590B29|IMPHASH=4DA924CF622D039D58BCE71CDF05D242|IMPHASH=E7A3A5C377E2D29324093377D7DB1C66|IMPHASH=9A9DBEC5C62F0380B4FA5FD31DEFFEDF|IMPHASH=AF8A3976AD71E5D5FDFB67DDB8DADFCE|IMPHASH=0C477898BBF137BBD6F2A54E3B805FF4|IMPHASH=0CA9F02B537BCEA20D4EA5EB1A9FE338|IMPHASH=3AB3655E5A14D4EEFC547F4781BF7F9E|IMPHASH=E6F9D5152DA699934B30DAAB206471F6|IMPHASH=3AD59991CCF1D67339B319B15A41B35D|IMPHASH=FFDD59E0318B85A3E480874D9796D872|IMPHASH=0CF479628D7CC1EA25EC7998A92F5051|IMPHASH=07A2D4DCBD6CB2C6A45E6B101F0B6D51|IMPHASH=D6D0F80386E1380D05CB78E871BC72B1|IMPHASH=38D9E015591BBFD4929E0D0F47FA0055|IMPHASH=0E2216679CA6E1094D63322E3412D650|IMPHASH=ADA161BF41B8E5E9132858CB54CAB5FB|IMPHASH=2A1BC4913CD5ECB0434DF07CB675B798|IMPHASH=11083E75553BAAE21DC89CE8F9A195E4|IMPHASH=A23D29C9E566F2FA8FFBB79267F5DF80|IMPHASH=4A07F944A83E8A7C2525EFA35DD30E2F|IMPHASH=767637C23BB42CD5D7397CF58B0BE688|IMPHASH=14C4E4C72BA075E9069EE67F39188AD8|IMPHASH=3C782813D4AFCE07BBFC5A9772ACDBDC|IMPHASH=7D010C6BB6A3726F327F7E239166D127|IMPHASH=89159BA4DD04E4CE5559F132A9964EB3|IMPHASH=6F33F4A5FC42B8CEC7314947BD13F30F|IMPHASH=5834ED4291BDEB928270428EBBAF7604|IMPHASH=5A8A8A43F25485E7EE1B201EDCBC7A38|IMPHASH=DC7D30B90B2D8ABF664FBED2B1B59894|IMPHASH=41923EA1F824FE63EA5BEB84DB7A3E74|IMPHASH=3DE09703C8E79ED2CA3F01074719906B|IMPHASH=A53A02B997935FD8EEDCB5F7ABAB9B9F|IMPHASH=E96A73C7BF33A464C510EDE582318BF2|IMPHASH=32089B8851BBF8BC2D014E9F37288C83|IMPHASH=09D278F9DE118EF09163C6140255C690|IMPHASH=03866661686829d806989e2fc5a72606|IMPHASH=e57401fbdadcd4571ff385ab82bd5d6d|IMPHASH=84B763C45C0E4A3E7CA5548C710DB4EE|IMPHASH=19584675D94829987952432E018D5056|IMPHASH=330768A4F172E10ACB6287B87289D83B|IMPHASH=885C99CCFBE77D1CBFCB9C4E7C1A3313|IMPHASH=22A22BC9E4E0D2F189F1EA01748816AC|IMPHASH=7FA30E6BB7E8E8A69155636E50BF1B28|IMPHASH=96DF3A3731912449521F6F8D183279B1|IMPHASH=7E6CF3FF4576581271AC8A313B2AAB46|IMPHASH=51791678F351C03A0EB4E2A7B05C6E17|IMPHASH=25CE42B079282632708FC846129E98A5|IMPHASH=021BCCA20BA3381B11BDDE26B4E62F20|IMPHASH=59223B5F52D8799D38E0754855CBDF42|IMPHASH=81E75D8F1D276C156653D3D8813E4A43|IMPHASH=17244E8B6B8227E57FE709CCAD421420|IMPHASH=5B76DA3ACDEDC8A5CDF23A798B5936B4|IMPHASH=CB2B65BB77D995CC1C0E5DF1C860133C|IMPHASH=40445337761D80CF465136FAFB1F63E6|IMPHASH=8A790F401B29FA87BC1E56F7272B3AA6|IMPHASH=B50199E952C875241B9CE06C971CE3C1)
- name: '[Sigma] Hacktool Execution - PE Metadata'
  tag: attack.credential-access,attack.resource-development,attack.t1588.002,attack.t1003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)Cube0x0
- name: '[Sigma] HackTool - GMER Rootkit Detector and Remover Execution'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\gmer\.exe$
- name: '[Sigma] HackTool - GMER Rootkit Detector and Remover Execution'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(MD5=E9DC058440D321AA17D0600B3CA0AB04|SHA1=539C228B6B332F5AA523E5CE358C16647D8BBE57|SHA256=E8A3E804A96C716A3E9B69195DB6FFB0D33E2433AF871E4D4E1EAB3097237173)
- name: '[Sigma] HackTool - HandleKatz LSASS Dumper Execution'
  tag: attack.credential-access,attack.t1003.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\loader\.exe$
- name: '[Sigma] HackTool - HandleKatz LSASS Dumper Execution'
  tag: attack.credential-access,attack.t1003.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\-\-pid:'
- name: '[Sigma] HackTool - HandleKatz LSASS Dumper Execution'
  tag: attack.credential-access,attack.t1003.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(IMPHASH=38D9E015591BBFD4929E0D0F47FA0055|IMPHASH=0E2216679CA6E1094D63322E3412D650)
- name: '[Sigma] HackTool - HandleKatz LSASS Dumper Execution'
  tag: attack.credential-access,attack.t1003.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-\-pid:|\-\-outfile:)
- name: '[Sigma] HackTool - HandleKatz LSASS Dumper Execution'
  tag: attack.credential-access,attack.t1003.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.dmp|lsass|\.obf|dump)
- name: '[Sigma] HackTool - Hashcat Password Cracker Execution'
  tag: attack.credential-access,attack.t1110.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\hashcat\.exe$
- name: '[Sigma] HackTool - Hashcat Password Cracker Execution'
  tag: attack.credential-access,attack.t1110.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-a\ |\-m\ 1000\ |\-r\ )
- name: '[Sigma] HackTool - Htran/NATBypass Execution'
  tag: attack.command-and-control,attack.t1090,attack.s0040
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\htran\.exe|\\lcx\.exe)$
- name: '[Sigma] HackTool - Htran/NATBypass Execution'
  tag: attack.command-and-control,attack.t1090,attack.s0040
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.exe\ \-tran\ |\.exe\ \-slave\ )
- name: '[Sigma] HackTool - Hydra Password Bruteforce Execution'
  tag: attack.credential-access,attack.t1110,attack.t1110.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-u\ |\-p\ )
- name: '[Sigma] HackTool - Hydra Password Bruteforce Execution'
  tag: attack.credential-access,attack.t1110,attack.t1110.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\^USER\^|\^PASS\^)
- name: '[Sigma] HackTool - Potential Impacket Lateral Movement Activity'
  tag: attack.execution,attack.t1047,attack.lateral-movement,attack.t1021.003
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\wmiprvse\.exe|\\mmc\.exe|\\explorer\.exe|\\services\.exe)$
- name: '[Sigma] HackTool - Potential Impacket Lateral Movement Activity'
  tag: attack.execution,attack.t1047,attack.lateral-movement,attack.t1021.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(cmd\.exe|/Q|/c|\\\\\\\\127\.0\.0\.1\\\\|\&1)
- name: '[Sigma] HackTool - Potential Impacket Lateral Movement Activity'
  tag: attack.execution,attack.t1047,attack.lateral-movement,attack.t1021.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(svchost\.exe\ \-k\ netsvcs|taskeng\.exe)
- name: '[Sigma] HackTool - Potential Impacket Lateral Movement Activity'
  tag: attack.execution,attack.t1047,attack.lateral-movement,attack.t1021.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(cmd\.exe|/C|Windows\\Temp\\|\&1)
- name: '[Sigma] HackTool - Impacket Tools Execution'
  tag: attack.collection,attack.execution,attack.credential-access,attack.t1557.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|contains':\ \['\\\\goldenPac',\ '\\\\karmaSMB',\ '\\\\kintercept',\
    '\\\\ntlmrelayx',\ '\\\\rpcdump',\ '\\\\samrdump',\ '\\\\secretsdump',\ '\\\\smbexec',\
    '\\\\smbrelayx',\ '\\\\wmiexec',\ '\\\\wmipersist'\]\}|\{'Image\|endswith':\ \['\\\\atexec_windows\.exe',\
    '\\\\dcomexec_windows\.exe',\ '\\\\dpapi_windows\.exe',\ '\\\\findDelegation_windows\.exe',\
    '\\\\GetADUsers_windows\.exe',\ '\\\\GetNPUsers_windows\.exe',\ '\\\\getPac_windows\.exe',\
    '\\\\getST_windows\.exe',\ '\\\\getTGT_windows\.exe',\ '\\\\GetUserSPNs_windows\.exe',\
    '\\\\ifmap_windows\.exe',\ '\\\\mimikatz_windows\.exe',\ '\\\\netview_windows\.exe',\
    '\\\\nmapAnswerMachine_windows\.exe',\ '\\\\opdump_windows\.exe',\ '\\\\psexec_windows\.exe',\
    '\\\\rdp_check_windows\.exe',\ '\\\\sambaPipe_windows\.exe',\ '\\\\smbclient_windows\.exe',\
    '\\\\smbserver_windows\.exe',\ '\\\\sniff_windows\.exe',\ '\\\\sniffer_windows\.exe',\
    '\\\\split_windows\.exe',\ '\\\\ticketer_windows\.exe'\]\})
- name: '[Sigma] HackTool - Impersonate Execution'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1134.001,attack.t1134.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)impersonate\.exe
- name: '[Sigma] HackTool - Impersonate Execution'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1134.001,attack.t1134.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ list\ |\ exec\ |\ adduser\ )
- name: '[Sigma] HackTool - Impersonate Execution'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1134.001,attack.t1134.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(MD5=9520714AB576B0ED01D1513691377D01|SHA256=E81CC96E2118DC4FBFE5BAD1604E0AC7681960143E2101E1A024D52264BB0A8A|IMPHASH=0A358FFC1697B7A07D0E817AC740DF62)
- name: '[Sigma] HackTool - Inveigh Execution'
  tag: attack.credential-access,attack.t1003.001
  score: 100
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\Inveigh\.exe'\}|\{'OriginalFileName':\
    \['\\\\Inveigh\.exe',\ '\\\\Inveigh\.dll'\]\}|\{'Description':\ 'Inveigh'\}|\{'CommandLine\|contains':\
    \['\ \-SpooferIP',\ '\ \-ReplyToIPs\ ',\ '\ \-ReplyToDomains\ ',\ '\ \-ReplyToMACs\
    ',\ '\ \-SnifferIP'\]\})
- name: '[Sigma] Invoke-Obfuscation CLIP+ Launcher'
  tag: attack.defense-evasion,attack.t1027,attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(cmd|\&\&|clipboard\]::|\-f)
- name: '[Sigma] Invoke-Obfuscation CLIP+ Launcher'
  tag: attack.defense-evasion,attack.t1027,attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(/c|/r)
- name: '[Sigma] Invoke-Obfuscation Obfuscated IEX Invocation'
  tag: attack.defense-evasion,attack.t1027,attack.execution,attack.t1059.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|re':\ '\\\\\$PSHome\\\\\[\\\\s.*\\\\d\{1,3\}\\\\s.*\\\\\]\\\\s.*\\\\\+\\\\s.*\\\\\$PSHome\\\\\['\}|\{'CommandLine\|re':\
    '\\\\\$ShellId\\\\\[\\\\s.*\\\\d\{1,3\}\\\\s.*\\\\\]\\\\s.*\\\\\+\\\\s.*\\\\\$ShellId\\\\\['\}|\{'CommandLine\|re':\
    '\\\\\$env:Public\\\\\[\\\\s.*\\\\d\{1,3\}\\\\s.*\\\\\]\\\\s.*\\\\\+\\\\s.*\\\\\$env:Public\\\\\['\}|\{'CommandLine\|re':\
    '\\\\\$env:ComSpec\\\\\[\(\\\\s.*\\\\d\{1,3\}\\\\s.*,\)\{2\}'\}|\{'CommandLine\|re':\
    '\\\\.*mdr\\\\.*\\\\W\\\\s.*\\\\\)\\\\\.Name'\}|\{'CommandLine\|re':\ '\\\\\$VerbosePreference\\\\\.ToString\\\\\('\}|\{'CommandLine\|re':\
    '\\\\\[String\\\\\]\\\\s.*\\\\\$VerbosePreference'\})
- name: '[Sigma] Invoke-Obfuscation STDIN+ Launcher'
  tag: attack.defense-evasion,attack.t1027,attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)cmd\.\{0,5\}\(.:/c\|/r\)\.\+powershell\.\+\(.:\\\$\\\{.input\\\}.\|noexit\)\.\+\\"
- name: '[Sigma] Invoke-Obfuscation VAR+ Launcher'
  tag: attack.defense-evasion,attack.t1027,attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)cmd\.\{0,5\}\(.:/c\|/r\)\(.:\\s\|\)\\"set\\s\[a\-zA\-Z\]\{3,6\}\..*\(.:\\\{\\d\\\}\)\{1,\}\\\\\\"\\s\+.\\\-f\(.:\..*\\\)\)\{1,\}\..*\\"
- name: '[Sigma] Invoke-Obfuscation COMPRESS OBFUSCATION'
  tag: attack.defense-evasion,attack.t1027,attack.execution,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(new\-object|text\.encoding\]::ascii)
- name: '[Sigma] Invoke-Obfuscation COMPRESS OBFUSCATION'
  tag: attack.defense-evasion,attack.t1027,attack.execution,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(system\.io\.compression\.deflatestream|system\.io\.streamreader|readtoend\()
- name: '[Sigma] Invoke-Obfuscation Via Stdin'
  tag: attack.defense-evasion,attack.t1027,attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\(.i\)\(set\)\..*\&\&\\s.set\..*\(environment\|invoke\|\\\$\\\{.input\)\..*\&\&\..*"
- name: '[Sigma] Invoke-Obfuscation Via Use Clip'
  tag: attack.defense-evasion,attack.t1027,attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\(.i\)echo\..*clip\..*\&\&\..*\(Clipboard\|i`.n`.v`.o`.k`.e`.\)
- name: '[Sigma] Invoke-Obfuscation Via Use MSHTA'
  tag: attack.defense-evasion,attack.t1027,attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(set|\&\&|mshta|vbscript:createobject|\.run|\(window\.close\))
- name: '[Sigma] Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION'
  tag: attack.defense-evasion,attack.t1027,attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\&\&set|cmd|/c|\-f)
- name: '[Sigma] Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION'
  tag: attack.defense-evasion,attack.t1027,attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\{0\}|\{1\}|\{2\}|\{3\}|\{4\}|\{5\})
- name: '[Sigma] HackTool - Jlaive In-Memory Assembly Execution'
  tag: attack.execution,attack.t1059.003
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\cmd\.exe$
- name: '[Sigma] HackTool - Jlaive In-Memory Assembly Execution'
  tag: attack.execution,attack.t1059.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\.bat$
- name: '[Sigma] HackTool - Jlaive In-Memory Assembly Execution'
  tag: attack.execution,attack.t1059.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\xcopy\.exe$
- name: '[Sigma] HackTool - Jlaive In-Memory Assembly Execution'
  tag: attack.execution,attack.t1059.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(powershell\.exe|\.bat\.exe)
- name: '[Sigma] HackTool - Jlaive In-Memory Assembly Execution'
  tag: attack.execution,attack.t1059.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\xcopy\.exe$
- name: '[Sigma] HackTool - Jlaive In-Memory Assembly Execution'
  tag: attack.execution,attack.t1059.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(pwsh\.exe|\.bat\.exe)
- name: '[Sigma] HackTool - Jlaive In-Memory Assembly Execution'
  tag: attack.execution,attack.t1059.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\attrib\.exe$
- name: '[Sigma] HackTool - Jlaive In-Memory Assembly Execution'
  tag: attack.execution,attack.t1059.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\+s|\+h|\.bat\.exe)
- name: '[Sigma] HackTool - Koadic Execution'
  tag: attack.execution,attack.t1059.003,attack.t1059.005,attack.t1059.007
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\cmd\.exe'\}|\{'OriginalFileName':\ 'Cmd\.Exe'\})
- name: '[Sigma] HackTool - Koadic Execution'
  tag: attack.execution,attack.t1059.003,attack.t1059.005,attack.t1059.007
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(/q|/c|chcp)
- name: '[Sigma] HackTool - KrbRelay Execution'
  tag: attack.credential-access,attack.t1558.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\KrbRelay\.exe'\}|\{'OriginalFileName':\
    'KrbRelay\.exe'\})
- name: '[Sigma] HackTool - KrbRelay Execution'
  tag: attack.credential-access,attack.t1558.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-spn\ |\ \-clsid\ |\ \-rbcd\ )
- name: '[Sigma] HackTool - KrbRelay Execution'
  tag: attack.credential-access,attack.t1558.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(shadowcred|clsid|spn)
- name: '[Sigma] HackTool - KrbRelay Execution'
  tag: attack.credential-access,attack.t1558.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(spn\ |session\ |clsid\ )
- name: '[Sigma] HackTool - KrbRelayUp Execution'
  tag: attack.defense-evasion,attack.credential-access,attack.t1558.003,attack.lateral-movement,attack.t1550.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\KrbRelayUp\.exe'\}|\{'OriginalFileName':\
    'KrbRelayUp\.exe'\})
- name: '[Sigma] HackTool - KrbRelayUp Execution'
  tag: attack.defense-evasion,attack.credential-access,attack.t1558.003,attack.lateral-movement,attack.t1550.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ relay\ |\ \-Domain\ |\ \-ComputerName\ )
- name: '[Sigma] HackTool - KrbRelayUp Execution'
  tag: attack.defense-evasion,attack.credential-access,attack.t1558.003,attack.lateral-movement,attack.t1550.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ krbscm\ |\ \-sc\ )
- name: '[Sigma] HackTool - KrbRelayUp Execution'
  tag: attack.defense-evasion,attack.credential-access,attack.t1558.003,attack.lateral-movement,attack.t1550.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ spawn\ |\ \-d\ |\ \-cn\ |\ \-cp\ )
- name: '[Sigma] HackTool - RemoteKrbRelay Execution'
  tag: attack.credential-access,attack.t1558.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\RemoteKrbRelay\.exe'\}|\{'OriginalFileName':\
    'RemoteKrbRelay\.exe'\})
- name: '[Sigma] HackTool - RemoteKrbRelay Execution'
  tag: attack.credential-access,attack.t1558.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-clsid\ |\ \-target\ |\ \-victim\ )
- name: '[Sigma] HackTool - RemoteKrbRelay Execution'
  tag: attack.credential-access,attack.t1558.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-smb\ |\-\-smbkeyword\ )
- name: '[Sigma] HackTool - RemoteKrbRelay Execution'
  tag: attack.credential-access,attack.t1558.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(interactive|secrets|service\-add)
- name: '[Sigma] HackTool - RemoteKrbRelay Execution'
  tag: attack.credential-access,attack.t1558.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\-rbcd\ '
- name: '[Sigma] HackTool - RemoteKrbRelay Execution'
  tag: attack.credential-access,attack.t1558.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-cn\ |\-\-computername\ )
- name: '[Sigma] HackTool - RemoteKrbRelay Execution'
  tag: attack.credential-access,attack.t1558.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\-chp\ '
- name: '[Sigma] HackTool - RemoteKrbRelay Execution'
  tag: attack.credential-access,attack.t1558.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-chpPass\ |\-chpUser\ )
- name: '[Sigma] HackTool - RemoteKrbRelay Execution'
  tag: attack.credential-access,attack.t1558.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-addgroupmember\ |\-group\ |\-groupuser\ )
- name: '[Sigma] HackTool - LocalPotato Execution'
  tag: attack.defense-evasion,attack.privilege-escalation,cve.2023-21746
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\LocalPotato\.exe$
- name: '[Sigma] HackTool - LocalPotato Execution'
  tag: attack.defense-evasion,attack.privilege-escalation,cve.2023-21746
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.exe\ \-i\ C:\\|\-o\ Windows\\)
- name: '[Sigma] HackTool - LocalPotato Execution'
  tag: attack.defense-evasion,attack.privilege-escalation,cve.2023-21746
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(IMPHASH=E1742EE971D6549E8D4D81115F88F1FC|IMPHASH=DD82066EFBA94D7556EF582F247C8BB5)
- name: '[Sigma] Potential Meterpreter/CobaltStrike Activity'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1134.001,attack.t1134.002
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\services\.exe$
- name: '[Sigma] Potential Meterpreter/CobaltStrike Activity'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1134.001,attack.t1134.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(/c|echo|\\pipe\\)
- name: '[Sigma] Potential Meterpreter/CobaltStrike Activity'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1134.001,attack.t1134.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(cmd|%COMSPEC%)
- name: '[Sigma] Potential Meterpreter/CobaltStrike Activity'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1134.001,attack.t1134.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(rundll32|\.dll,a|/p:)
- name: '[Sigma] Potential Meterpreter/CobaltStrike Activity'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1134.001,attack.t1134.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)MpCmdRun
- name: '[Sigma] HackTool - Mimikatz Execution'
  tag: attack.credential-access,attack.t1003.001,attack.t1003.002,attack.t1003.004,attack.t1003.005,attack.t1003.006
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(DumpCreds|mimikatz)
- name: '[Sigma] HackTool - Mimikatz Execution'
  tag: attack.credential-access,attack.t1003.001,attack.t1003.002,attack.t1003.004,attack.t1003.005,attack.t1003.006
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(::aadcookie|::detours|::memssp|::mflt|::ncroutemon|::ngcsign|::printnightmare|::skeleton|::preshutdown|::mstsc|::multirdp)
- name: '[Sigma] HackTool - Mimikatz Execution'
  tag: attack.credential-access,attack.t1003.001,attack.t1003.002,attack.t1003.004,attack.t1003.005,attack.t1003.006
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(rpc::|token::|crypto::|dpapi::|sekurlsa::|kerberos::|lsadump::|privilege::|process::|vault::)
- name: '[Sigma] HackTool - PCHunter Execution'
  tag: attack.execution,attack.discovery,attack.t1082,attack.t1057,attack.t1012,attack.t1083,attack.t1007
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\PCHunter64\.exe|\\PCHunter32\.exe)$
- name: '[Sigma] HackTool - PCHunter Execution'
  tag: attack.execution,attack.discovery,attack.t1082,attack.t1057,attack.t1012,attack.t1083,attack.t1007
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'PCHunter\.exe'\}|\{'Description':\ 'Epoolsoft\
    Windows\ Information\ View\ Tools'\})
- name: '[Sigma] HackTool - PCHunter Execution'
  tag: attack.execution,attack.discovery,attack.t1082,attack.t1057,attack.t1012,attack.t1083,attack.t1007
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(SHA1=5F1CBC3D99558307BC1250D084FA968521482025|MD5=987B65CD9B9F4E9A1AFD8F8B48CF64A7|SHA256=2B214BDDAAB130C274DE6204AF6DBA5AEEC7433DA99AA950022FA306421A6D32|IMPHASH=444D210CEA1FF8112F256A4997EED7FF|SHA1=3FB89787CB97D902780DA080545584D97FB1C2EB|MD5=228DD0C2E6287547E26FFBD973A40F14|SHA256=55F041BF4E78E9BFA6D4EE68BE40E496CE3A1353E1CA4306598589E19802522C|IMPHASH=0479F44DF47CFA2EF1CCC4416A538663)
- name: '[Sigma] HackTool - Default PowerSploit/Empire Scheduled Task Creation'
  tag: attack.execution,attack.persistence,attack.privilege-escalation,attack.s0111,attack.g0022,attack.g0060,car.2013-08-001,attack.t1053.005,attack.t1059.001
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\pwsh\.exe)$
- name: '[Sigma] HackTool - Default PowerSploit/Empire Scheduled Task Creation'
  tag: attack.execution,attack.persistence,attack.privilege-escalation,attack.s0111,attack.g0022,attack.g0060,car.2013-08-001,attack.t1053.005,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\schtasks\.exe$
- name: '[Sigma] HackTool - Default PowerSploit/Empire Scheduled Task Creation'
  tag: attack.execution,attack.persistence,attack.privilege-escalation,attack.s0111,attack.g0022,attack.g0060,car.2013-08-001,attack.t1053.005,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(/Create|powershell\.exe\ \-NonI|/TN\ Updater\ /TR)
- name: '[Sigma] HackTool - Default PowerSploit/Empire Scheduled Task Creation'
  tag: attack.execution,attack.persistence,attack.privilege-escalation,attack.s0111,attack.g0022,attack.g0060,car.2013-08-001,attack.t1053.005,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(/SC\ ONLOGON|/SC\ DAILY\ /ST|/SC\ ONIDLE|/SC\ HOURLY)
- name: '[Sigma] HackTool - PowerTool Execution'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\PowerTool\.exe',\ '\\\\PowerTool64\.exe'\]\}|\{'OriginalFileName':\
    'PowerTool\.exe'\})
- name: '[Sigma] HackTool - PurpleSharp Execution'
  tag: attack.t1587,attack.resource-development
  score: 100
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|contains':\ '\\\\purplesharp'\}|\{'OriginalFileName':\ 'PurpleSharp\.exe'\})
- name: '[Sigma] HackTool - PurpleSharp Execution'
  tag: attack.t1587,attack.resource-development
  score: 100
  target: Target_Path
  condition: regex
  pattern: (?i)(xyz123456\.exe|PurpleSharp)
- name: '[Sigma] HackTool - Pypykatz Credentials Dumping Activity'
  tag: attack.credential-access,attack.t1003.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\pypykatz\.exe|\\python\.exe)$
- name: '[Sigma] HackTool - Pypykatz Credentials Dumping Activity'
  tag: attack.credential-access,attack.t1003.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(live|registry)
- name: '[Sigma] HackTool - Quarks PwDump Execution'
  tag: attack.credential-access,attack.t1003.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\QuarksPwDump\.exe$
- name: '[Sigma] HackTool - Quarks PwDump Execution'
  tag: attack.credential-access,attack.t1003.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-dhl|\ \-\-dump\-hash\-local|\ \-dhdc|\ \-\-dump\-hash\-domain\-cached|\
    \-\-dump\-bitlocker|\ \-dhd\ |\ \-\-dump\-hash\-domain\ |\-\-ntds\-file)
- name: '[Sigma] HackTool - RedMimicry Winnti Playbook Execution'
  tag: attack.execution,attack.defense-evasion,attack.t1106,attack.t1059.003,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\rundll32\.exe|\\cmd\.exe)$
- name: '[Sigma] HackTool - RedMimicry Winnti Playbook Execution'
  tag: attack.execution,attack.defense-evasion,attack.t1106,attack.t1059.003,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(gthread\-3\.6\.dll|\\Windows\\Temp\\tmp\.bat|sigcmm\-2\.4\.dll)
- name: '[Sigma] Potential SMB Relay Attack Tool Execution'
  tag: attack.collection,attack.execution,attack.credential-access,attack.t1557.001
  score: 100
  target: Target_Path
  condition: regex
  pattern: (?i)(PetitPotam|RottenPotato|HotPotato|JuicyPotato|\\just_dce_|Juicy\ Potato|\\temp\\rot\.exe|\\Potato\.exe|\\SpoolSample\.exe|\\Responder\.exe|\\smbrelayx|\\ntlmrelayx|\\LocalPotato)
- name: '[Sigma] Potential SMB Relay Attack Tool Execution'
  tag: attack.collection,attack.execution,attack.credential-access,attack.t1557.001
  score: 100
  target: Target_Path
  condition: regex
  pattern: (?i)(Invoke\-Tater|\ smbrelay|\ ntlmrelay|cme\ smb\ |\ /ntlm:NTLMhash\
    |Invoke\-PetitPotam|\.exe\ \-t\ .*\ \-p\ )
- name: '[Sigma] Potential SMB Relay Attack Tool Execution'
  tag: attack.collection,attack.execution,attack.credential-access,attack.t1557.001
  score: 100
  target: Target_Path
  condition: regex
  pattern: (?i)\.exe\ \-c\ "\{
- name: '[Sigma] Potential SMB Relay Attack Tool Execution'
  tag: attack.collection,attack.execution,attack.credential-access,attack.t1557.001
  score: 100
  target: Target_Path
  condition: regex
  pattern: (?i)\}"\ \-z$
- name: '[Sigma] Potential SMB Relay Attack Tool Execution'
  tag: attack.collection,attack.execution,attack.credential-access,attack.t1557.001
  score: 100
  target: Target_Path
  condition: regex
  pattern: (?i)(HotPotatoes6|HotPotatoes7|HotPotatoes\ )
- name: '[Sigma] HackTool - Rubeus Execution'
  tag: attack.defense-evasion,attack.credential-access,attack.t1003,attack.t1558.003,attack.lateral-movement,attack.t1550.003
  score: 100
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\Rubeus\.exe'\}|\{'OriginalFileName':\ 'Rubeus\.exe'\}|\{'Description':\
    'Rubeus'\}|\{'CommandLine\|contains':\ \['asreproast\ ',\ 'dump\ /service:krbtgt\
    ',\ 'dump\ /luid:0x',\ 'kerberoast\ ',\ 'createnetonly\ /program:',\ 'ptt\ /ticket:',\
    '/impersonateuser:',\ 'renew\ /ticket:',\ 'asktgt\ /user:',\ 'harvest\ /interval:',\
    's4u\ /user:',\ 's4u\ /ticket:',\ 'hash\ /password:',\ 'golden\ /aes256:',\ 'silver\
    /user:'\]\})
- name: '[Sigma] HackTool - SafetyKatz Execution'
  tag: attack.credential-access,attack.t1003.001
  score: 100
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\SafetyKatz\.exe'\}|\{'OriginalFileName':\
    'SafetyKatz\.exe'\}|\{'Description':\ 'SafetyKatz'\})
- name: '[Sigma] HackTool - SecurityXploded Execution'
  tag: attack.credential-access,attack.t1555
  score: 100
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Company':\ 'SecurityXploded'\}|\{'Image\|endswith':\ 'PasswordDump\.exe'\}|\{'OriginalFileName\|endswith':\
    'PasswordDump\.exe'\})
- name: '[Sigma] HackTool - PPID Spoofing SelectMyParent Tool Execution'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1134.004
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\SelectMyParent\.exe'\}|\{'CommandLine\|contains':\
    \['PPID\-spoof',\ 'ppid_spoof',\ 'spoof\-ppid',\ 'spoof_ppid',\ 'ppidspoof',\
    'spoofppid',\ 'spoofedppid',\ '\ \-spawnto\ '\]\}|\{'OriginalFileName\|contains':\
    \['PPID\-spoof',\ 'ppid_spoof',\ 'spoof\-ppid',\ 'spoof_ppid',\ 'ppidspoof',\
    'spoofppid',\ 'spoofedppid'\]\}|\{'Description':\ 'SelectMyParent'\}|\{'Hashes\|contains':\
    \['IMPHASH=04D974875BD225F00902B4CAD9AF3FBC',\ 'IMPHASH=A782AF154C9E743DDF3F3EB2B8F3D16E',\
    'IMPHASH=89059503D7FBF470E68F7E63313DA3AD',\ 'IMPHASH=CA28337632625C8281AB8A130B3D6BAD'\]\})
- name: '[Sigma] HackTool - SharPersist Execution'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\SharPersist\.exe'\}|\{'Product':\ 'SharPersist'\})
- name: '[Sigma] HackTool - SharPersist Execution'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-t\ schtask\ \-c\ |\ \-t\ startupfolder\ \-c\ )
- name: '[Sigma] HackTool - SharPersist Execution'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-t\ reg\ \-c\ |\ \-m\ add)
- name: '[Sigma] HackTool - SharPersist Execution'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-t\ service\ \-c\ |\ \-m\ add)
- name: '[Sigma] HackTool - SharPersist Execution'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-t\ schtask\ \-c\ |\ \-m\ add)
- name: '[Sigma] HackTool - SharpEvtMute Execution'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\SharpEvtMute\.exe'\}|\{'Description':\
    'SharpEvtMute'\}|\{'CommandLine\|contains':\ \['\-\-Filter\ "rule\ ',\ '\-\-Encoded\
    \-\-Filter\ \\\\"'\]\})
- name: '[Sigma] HackTool - SharpLdapWhoami Execution'
  tag: attack.discovery,attack.t1033,car.2016-03-001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\SharpLdapWhoami\.exe$
- name: '[Sigma] HackTool - SharpLdapWhoami Execution'
  tag: attack.discovery,attack.t1033,car.2016-03-001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName\|contains':\ 'SharpLdapWhoami'\}|\{'Product':\
    'SharpLdapWhoami'\})
- name: '[Sigma] HackTool - SharpLdapWhoami Execution'
  tag: attack.discovery,attack.t1033,car.2016-03-001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /method:ntlm|\ /method:kerb|\ /method:nego|\ /m:nego|\ /m:ntlm|\
    /m:kerb)$
- name: '[Sigma] HackTool - SharpMove Tool Execution'
  tag: attack.lateral-movement,attack.t1021.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\SharpMove\.exe'\}|\{'OriginalFileName':\
    'SharpMove\.exe'\})
- name: '[Sigma] HackTool - SharpMove Tool Execution'
  tag: attack.lateral-movement,attack.t1021.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)computername=
- name: '[Sigma] HackTool - SharpMove Tool Execution'
  tag: attack.lateral-movement,attack.t1021.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(action=create|action=dcom|action=executevbs|action=hijackdcom|action=modschtask|action=modsvc|action=query|action=scm|action=startservice|action=taskscheduler)
- name: '[Sigma] HackTool - SharpUp PrivEsc Tool Execution'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.discovery,attack.execution,attack.t1615,attack.t1569.002,attack.t1574.005
  score: 100
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\SharpUp\.exe'\}|\{'Description':\ 'SharpUp'\}|\{'CommandLine\|contains':\
    \['HijackablePaths',\ 'UnquotedServicePath',\ 'ProcessDLLHijack',\ 'ModifiableServiceBinaries',\
    'ModifiableScheduledTask',\ 'DomainGPPPassword',\ 'CachedGPPPassword'\]\})
- name: '[Sigma] HackTool - SharpView Execution'
  tag: attack.discovery,attack.t1049,attack.t1069.002,attack.t1482,attack.t1135,attack.t1033
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'SharpView\.exe'\}|\{'Image\|endswith':\ '\\\\SharpView\.exe'\}|\{'CommandLine\|contains':\
    \['Add\-RemoteConnection',\ 'Convert\-ADName',\ 'ConvertFrom\-SID',\ 'ConvertFrom\-UACValue',\
    'Convert\-SidToName',\ 'Export\-PowerViewCSV',\ 'Find\-DomainObjectPropertyOutlier',\
    'Find\-DomainProcess',\ 'Find\-DomainShare',\ 'Find\-DomainUserEvent',\ 'Find\-DomainUserLocation',\
    'Find\-ForeignGroup',\ 'Find\-ForeignUser',\ 'Find\-GPOComputerAdmin',\ 'Find\-GPOLocation',\
    'Find\-Interesting',\ 'Find\-LocalAdminAccess',\ 'Find\-ManagedSecurityGroups',\
    'Get\-CachedRDPConnection',\ 'Get\-DFSshare',\ 'Get\-DomainComputer',\ 'Get\-DomainController',\
    'Get\-DomainDFSShare',\ 'Get\-DomainDNSRecord',\ 'Get\-DomainFileServer',\ 'Get\-DomainForeign',\
    'Get\-DomainGPO',\ 'Get\-DomainGroup',\ 'Get\-DomainGUIDMap',\ 'Get\-DomainManagedSecurityGroup',\
    'Get\-DomainObject',\ 'Get\-DomainOU',\ 'Get\-DomainPolicy',\ 'Get\-DomainSID',\
    'Get\-DomainSite',\ 'Get\-DomainSPNTicket',\ 'Get\-DomainSubnet',\ 'Get\-DomainTrust',\
    'Get\-DomainUserEvent',\ 'Get\-ForestDomain',\ 'Get\-ForestGlobalCatalog',\ 'Get\-ForestTrust',\
    'Get\-GptTmpl',\ 'Get\-GroupsXML',\ 'Get\-LastLoggedOn',\ 'Get\-LoggedOnLocal',\
    'Get\-NetComputer',\ 'Get\-NetDomain',\ 'Get\-NetFileServer',\ 'Get\-NetForest',\
    'Get\-NetGPO',\ 'Get\-NetGroupMember',\ 'Get\-NetLocalGroup',\ 'Get\-NetLoggedon',\
    'Get\-NetOU',\ 'Get\-NetProcess',\ 'Get\-NetRDPSession',\ 'Get\-NetSession',\
    'Get\-NetShare',\ 'Get\-NetSite',\ 'Get\-NetSubnet',\ 'Get\-NetUser',\ 'Get\-PathAcl',\
    'Get\-PrincipalContext',\ 'Get\-RegistryMountedDrive',\ 'Get\-RegLoggedOn',\ 'Get\-WMIRegCachedRDPConnection',\
    'Get\-WMIRegLastLoggedOn',\ 'Get\-WMIRegMountedDrive',\ 'Get\-WMIRegProxy',\ 'Invoke\-ACLScanner',\
    'Invoke\-CheckLocalAdminAccess',\ 'Invoke\-Kerberoast',\ 'Invoke\-MapDomainTrust',\
    'Invoke\-RevertToSelf',\ 'Invoke\-Sharefinder',\ 'Invoke\-UserImpersonation',\
    'Remove\-DomainObjectAcl',\ 'Remove\-RemoteConnection',\ 'Request\-SPNTicket',\
    'Set\-DomainObject',\ 'Test\-AdminAccess'\]\})
- name: '[Sigma] HackTool - SharpWSUS/WSUSpendu Execution'
  tag: attack.execution,attack.lateral-movement,attack.t1210
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-Inject\ '
- name: '[Sigma] HackTool - SharpWSUS/WSUSpendu Execution'
  tag: attack.execution,attack.lateral-movement,attack.t1210
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-PayloadArgs\ |\ \-PayloadFile\ )
- name: '[Sigma] HackTool - SharpWSUS/WSUSpendu Execution'
  tag: attack.execution,attack.lateral-movement,attack.t1210
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ approve\ |\ create\ |\ check\ |\ delete\ )
- name: '[Sigma] HackTool - SharpWSUS/WSUSpendu Execution'
  tag: attack.execution,attack.lateral-movement,attack.t1210
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /payload:|\ /payload=|\ /updateid:|\ /updateid=)
- name: '[Sigma] HackTool - SharpChisel Execution'
  tag: attack.command-and-control,attack.t1090.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\SharpChisel\.exe'\}|\{'Product':\ 'SharpChisel'\})
- name: '[Sigma] HackTool - SharpDPAPI Execution'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1134.001,attack.t1134.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\SharpDPAPI\.exe'\}|\{'OriginalFileName':\
    'SharpDPAPI\.exe'\})
- name: '[Sigma] HackTool - SharpDPAPI Execution'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1134.001,attack.t1134.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ backupkey\ |\ blob\ |\ certificates\ |\ credentials\ |\ keepass\
    |\ masterkeys\ |\ rdg\ |\ vaults\ )
- name: '[Sigma] HackTool - SharpDPAPI Execution'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1134.001,attack.t1134.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \{|\}:)
- name: '[Sigma] HackTool - SharpDPAPI Execution'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1134.001,attack.t1134.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /file:|\ /machine|\ /mkfile:|\ /password:|\ /pvk:|\ /server:|\ /target:|\
    /unprotect)
- name: '[Sigma] HackTool - SharpImpersonation Execution'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1134.001,attack.t1134.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\SharpImpersonation\.exe'\}|\{'OriginalFileName':\
    'SharpImpersonation\.exe'\})
- name: '[Sigma] HackTool - SharpImpersonation Execution'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1134.001,attack.t1134.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains\|all':\ \['\ user:',\ '\ binary:'\]\}|\{'CommandLine\|contains\|all':\
    \['\ user:',\ '\ shellcode:'\]\}|\{'CommandLine\|contains':\ \['\ technique:CreateProcessAsUserW',\
    '\ technique:ImpersonateLoggedOnuser'\]\})
- name: '[Sigma] HackTool - SharpLDAPmonitor Execution'
  tag: attack.discovery
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\SharpLDAPmonitor\.exe'\}|\{'OriginalFileName':\
    'SharpLDAPmonitor\.exe'\})
- name: '[Sigma] HackTool - SharpLDAPmonitor Execution'
  tag: attack.discovery
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/user:|/pass:|/dcip:)
- name: '[Sigma] HackTool - SILENTTRINITY Stager Execution'
  tag: attack.command-and-control,attack.t1071
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)st2stager
- name: '[Sigma] HackTool - Sliver C2 Implant Activity Pattern'
  tag: attack.execution,attack.t1059
  score: 100
  target: Target_Path
  condition: regex
  pattern: (?i)\-NoExit\ \-Command\ \[Console\]::OutputEncoding=\[Text\.UTF8Encoding\]::UTF8
- name: '[Sigma] HackTool - SOAPHound Execution'
  tag: attack.discovery,attack.t1087
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-\-buildcache\ |\ \-\-bhdump\ |\ \-\-certdump\ |\ \-\-dnsdump\
    )
- name: '[Sigma] HackTool - SOAPHound Execution'
  tag: attack.discovery,attack.t1087
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-c\ |\ \-\-cachefilename\ |\ \-o\ |\ \-\-outputdirectory)
- name: '[Sigma] HackTool - Stracciatella Execution'
  tag: attack.execution,attack.defense-evasion,attack.t1059,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\Stracciatella\.exe'\}|\{'OriginalFileName':\
    'Stracciatella\.exe'\}|\{'Description':\ 'Stracciatella'\}|\{'Hashes\|contains':\
    \['SHA256=9d25e61ec1527e2a69d7c2a4e3fe2fe15890710c198a66a9f25d99fdf6c7b956',\
    'SHA256=fd16609bd9830c63b9413671678bb159b89c357d21942ddbb6b93add808d121a'\]\})
- name: '[Sigma] HackTool - SysmonEOP Execution'
  tag: cve.2022-41120,attack.t1068,attack.privilege-escalation
  score: 100
  target: Target_Path
  condition: regex
  pattern: (?i)\\SysmonEOP\.exe$
- name: '[Sigma] HackTool - SysmonEOP Execution'
  tag: cve.2022-41120,attack.t1068,attack.privilege-escalation
  score: 100
  target: Full_Path
  condition: regex
  pattern: (?i)(IMPHASH=22F4089EB8ABA31E1BB162C6D9BF72E5|IMPHASH=5123FA4C4384D431CD0D893EEB49BBEC)
- name: '[Sigma] HackTool - TruffleSnout Execution'
  tag: attack.discovery,attack.t1482
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'TruffleSnout\.exe'\}|\{'Image\|endswith':\
    '\\\\TruffleSnout\.exe'\})
- name: '[Sigma] HackTool - UACMe Akagi Execution'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Product':\ 'UACMe'\}|\{'Company':\ \['REvol\ Corp',\ 'APT\ 92',\
    'UG\ North',\ 'Hazardous\ Environments',\ 'CD\ Project\ Rekt'\]\}|\{'Description':\
    \['UACMe\ main\ module',\ 'Pentesting\ utility'\]\}|\{'OriginalFileName':\ \['Akagi\.exe',\
    'Akagi64\.exe'\]\})
- name: '[Sigma] HackTool - UACMe Akagi Execution'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\Akagi64\.exe|\\Akagi\.exe)$
- name: '[Sigma] HackTool - UACMe Akagi Execution'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(IMPHASH=767637C23BB42CD5D7397CF58B0BE688|IMPHASH=14C4E4C72BA075E9069EE67F39188AD8|IMPHASH=3C782813D4AFCE07BBFC5A9772ACDBDC|IMPHASH=7D010C6BB6A3726F327F7E239166D127|IMPHASH=89159BA4DD04E4CE5559F132A9964EB3|IMPHASH=6F33F4A5FC42B8CEC7314947BD13F30F|IMPHASH=5834ED4291BDEB928270428EBBAF7604|IMPHASH=5A8A8A43F25485E7EE1B201EDCBC7A38|IMPHASH=DC7D30B90B2D8ABF664FBED2B1B59894|IMPHASH=41923EA1F824FE63EA5BEB84DB7A3E74|IMPHASH=3DE09703C8E79ED2CA3F01074719906B)
- name: '[Sigma] HackTool - Windows Credential Editor (WCE) Execution'
  tag: attack.credential-access,attack.t1003.001,attack.s0005
  score: 100
  target: Target_Path
  condition: regex
  pattern: (?i)(\\WCE\.exe|\\WCE64\.exe)$
- name: '[Sigma] HackTool - Windows Credential Editor (WCE) Execution'
  tag: attack.credential-access,attack.t1003.001,attack.s0005
  score: 100
  target: Full_Path
  condition: regex
  pattern: (?i)(IMPHASH=136F0A8572C058A96436C82E541E4C41|IMPHASH=589657C64DDE88533186C39F82FA1F50|IMPHASH=6BFE09EFCB4FFDE061EBDBAFC4DB84CF|IMPHASH=7D490037BF450877E6D0287BDCFF8D2E|IMPHASH=8AB93B061287C79F3088C5BC7E7D97ED|IMPHASH=A53A02B997935FD8EEDCB5F7ABAB9B9F|IMPHASH=BA434A7A729EEC20E136CA4C32D6C740|IMPHASH=BD1D1547DA13C0FCB6C15E86217D5EB8|IMPHASH=E96A73C7BF33A464C510EDE582318BF2)
- name: '[Sigma] HackTool - winPEAS Execution'
  tag: attack.privilege-escalation,attack.discovery,attack.t1082,attack.t1087,attack.t1046
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'winPEAS\.exe'\}|\{'Image\|endswith':\ \['\\\\winPEASany_ofs\.exe',\
    '\\\\winPEASany\.exe',\ '\\\\winPEASx64_ofs\.exe',\ '\\\\winPEASx64\.exe',\ '\\\\winPEASx86_ofs\.exe',\
    '\\\\winPEASx86\.exe'\]\})
- name: '[Sigma] HackTool - winPEAS Execution'
  tag: attack.privilege-escalation,attack.discovery,attack.t1082,attack.t1087,attack.t1046
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ applicationsinfo|\ browserinfo|\ eventsinfo|\ fileanalysis|\ filesinfo|\
    processinfo|\ servicesinfo|\ windowscreds)
- name: '[Sigma] HackTool - winPEAS Execution'
  tag: attack.privilege-escalation,attack.discovery,attack.t1082,attack.t1087,attack.t1046
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)https://github\.com/carlospolop/PEASS\-ng/releases/latest/download/
- name: '[Sigma] HackTool - winPEAS Execution'
  tag: attack.privilege-escalation,attack.discovery,attack.t1082,attack.t1087,attack.t1046
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'ParentCommandLine\|endswith':\ '\ \-linpeas'\}|\{'CommandLine\|endswith':\
    '\ \-linpeas'\})
- name: '[Sigma] HackTool - WinPwn Execution'
  tag: attack.credential-access,attack.defense-evasion,attack.discovery,attack.execution,attack.privilege-escalation,attack.t1046,attack.t1082,attack.t1106,attack.t1518,attack.t1548.002,attack.t1552.001,attack.t1555,attack.t1555.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Offline_Winpwn|WinPwn\ |WinPwn\.exe|WinPwn\.ps1)
- name: '[Sigma] HackTool - Wmiexec Default Powershell Command'
  tag: attack.defense-evasion,attack.lateral-movement
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\-NoP\ \-NoL\ \-sta\ \-NonI\ \-W\ Hidden\ \-Exec\ Bypass\ \-Enc
- name: '[Sigma] HackTool - XORDump Execution'
  tag: attack.defense-evasion,attack.t1036,attack.t1003.001,attack.credential-access
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\xordump\.exe'\}|\{'CommandLine\|contains':\
    \['\ \-process\ lsass\.exe\ ',\ '\ \-m\ comsvcs\ ',\ '\ \-m\ dbghelp\ ',\ '\ \-m\
    dbgcore\ '\]\})
- name: '[Sigma] Suspicious ZipExec Execution'
  tag: attack.execution,attack.defense-evasion,attack.t1218,attack.t1202
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/generic:Microsoft_Windows_Shell_ZipFolder:filename=|\.zip|/pass:|/user:)
- name: '[Sigma] Suspicious ZipExec Execution'
  tag: attack.execution,attack.defense-evasion,attack.t1218,attack.t1202
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/delete|Microsoft_Windows_Shell_ZipFolder:filename=|\.zip)
- name: '[Sigma] Suspicious Execution of Hostname'
  tag: attack.discovery,attack.t1082
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)\\HOSTNAME\.EXE$
- name: '[Sigma] Suspicious HWP Sub Processes'
  tag: attack.initial-access,attack.t1566.001,attack.execution,attack.t1203,attack.t1059.003,attack.g0032
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\Hwp\.exe$
- name: '[Sigma] Suspicious HWP Sub Processes'
  tag: attack.initial-access,attack.t1566.001,attack.execution,attack.t1203,attack.t1059.003,attack.g0032
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\gbb\.exe$
- name: '[Sigma] Potential Fake Instance Of Hxtsr.EXE Executed'
  tag: attack.defense-evasion,attack.t1036
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\hxtsr\.exe$
- name: '[Sigma] Potential Fake Instance Of Hxtsr.EXE Executed'
  tag: attack.defense-evasion,attack.t1036
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i):\\program\ files\\windowsapps\\microsoft\.windowscommunicationsapps_
- name: '[Sigma] Potential Fake Instance Of Hxtsr.EXE Executed'
  tag: attack.defense-evasion,attack.t1036
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\hxtsr\.exe$
- name: '[Sigma] Use Icacls to Hide File to Everyone'
  tag: attack.defense-evasion,attack.t1564.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'iCACLS\.EXE'\}|\{'Image\|endswith':\ '\\\\icacls\.exe'\})
- name: '[Sigma] Use Icacls to Hide File to Everyone'
  tag: attack.defense-evasion,attack.t1564.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/deny|.*S\-1\-1\-0:)
- name: '[Sigma] File Download And Execution Via IEExec.EXE'
  tag: attack.command-and-control,attack.t1105
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\IEExec\.exe'\}|\{'OriginalFileName':\ 'IEExec\.exe'\})
- name: '[Sigma] File Download And Execution Via IEExec.EXE'
  tag: attack.command-and-control,attack.t1105
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(http://|https://)
- name: '[Sigma] Self Extracting Package Creation Via Iexpress.EXE From Potentially
    Suspicious Location'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\iexpress\.exe'\}|\{'OriginalFileName':\
    'IEXPRESS\.exe'\})
- name: '[Sigma] Self Extracting Package Creation Via Iexpress.EXE From Potentially
    Suspicious Location'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ /n\ '
- name: '[Sigma] Self Extracting Package Creation Via Iexpress.EXE From Potentially
    Suspicious Location'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\ProgramData\\|:\\Temp\\|:\\Windows\\System32\\Tasks\\|:\\Windows\\Tasks\\|:\\Windows\\Temp\\|\\AppData\\Local\\Temp\\)
- name: '[Sigma] Disable Windows IIS HTTP Logging'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\appcmd\.exe'\}|\{'OriginalFileName':\ 'appcmd\.exe'\})
- name: '[Sigma] Disable Windows IIS HTTP Logging'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(set|config|section:httplogging|dontLog:true)
- name: '[Sigma] Microsoft IIS Service Account Password Dumped'
  tag: attack.credential-access,attack.t1003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\appcmd\.exe'\}|\{'OriginalFileName':\ 'appcmd\.exe'\})
- name: '[Sigma] Microsoft IIS Service Account Password Dumped'
  tag: attack.credential-access,attack.t1003
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)list\ '
- name: '[Sigma] Microsoft IIS Service Account Password Dumped'
  tag: attack.credential-access,attack.t1003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /config|\ /xml|\ \-config|\ \-xml)
- name: '[Sigma] Microsoft IIS Service Account Password Dumped'
  tag: attack.credential-access,attack.t1003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /@t|\ /text|\ /show|\ \-@t|\ \-text|\ \-show)
- name: '[Sigma] Microsoft IIS Service Account Password Dumped'
  tag: attack.credential-access,attack.t1003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\.*|password)
- name: '[Sigma] IIS Native-Code Module Command Line Installation'
  tag: attack.persistence,attack.t1505.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\appcmd\.exe'\}|\{'OriginalFileName':\ 'appcmd\.exe'\})
- name: '[Sigma] IIS Native-Code Module Command Line Installation'
  tag: attack.persistence,attack.t1505.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(install|module)
- name: '[Sigma] IIS Native-Code Module Command Line Installation'
  tag: attack.persistence,attack.t1505.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\-name:'
- name: '[Sigma] IIS Native-Code Module Command Line Installation'
  tag: attack.persistence,attack.t1505.003
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\inetsrv\\iissetup\.exe
- name: '[Sigma] Suspicious IIS URL GlobalRules Rewrite Via AppCmd'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\appcmd\.exe'\}|\{'OriginalFileName':\ 'appcmd\.exe'\})
- name: '[Sigma] Suspicious IIS URL GlobalRules Rewrite Via AppCmd'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(set|config|section:system\.webServer/rewrite/globalRules|commit:)
- name: '[Sigma] Microsoft IIS Connection Strings Decryption'
  tag: attack.credential-access,attack.t1003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\aspnet_regiis\.exe'\}|\{'OriginalFileName':\
    'aspnet_regiis\.exe'\})
- name: '[Sigma] Microsoft IIS Connection Strings Decryption'
  tag: attack.credential-access,attack.t1003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(connectionStrings|\ \-pdf)
- name: '[Sigma] Suspicious IIS Module Registration'
  tag: attack.persistence,attack.t1505.004
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\w3wp\.exe$
- name: '[Sigma] Suspicious IIS Module Registration'
  tag: attack.persistence,attack.t1505.004
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)appcmd\.exe\ add\ module
- name: '[Sigma] Suspicious IIS Module Registration'
  tag: attack.persistence,attack.t1505.004
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\ system\.enterpriseservices\.internal\.publish
- name: '[Sigma] Suspicious IIS Module Registration'
  tag: attack.persistence,attack.t1505.004
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\powershell\.exe$
- name: '[Sigma] Suspicious IIS Module Registration'
  tag: attack.persistence,attack.t1505.004
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(gacutil|\ /I)
- name: '[Sigma] C# IL Code Compilation Via Ilasm.EXE'
  tag: attack.defense-evasion,attack.t1127
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\ilasm\.exe'\}|\{'OriginalFileName':\ 'ilasm\.exe'\})
- name: '[Sigma] C# IL Code Compilation Via Ilasm.EXE'
  tag: attack.defense-evasion,attack.t1127
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /dll|\ /exe)
- name: '[Sigma] ImagingDevices Unusual Parent/Child Processes'
  tag: attack.defense-evasion,attack.execution
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\WmiPrvSE\.exe|\\svchost\.exe|\\dllhost\.exe)$
- name: '[Sigma] ImagingDevices Unusual Parent/Child Processes'
  tag: attack.defense-evasion,attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\ImagingDevices\.exe$
- name: '[Sigma] ImagingDevices Unusual Parent/Child Processes'
  tag: attack.defense-evasion,attack.execution
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\ImagingDevices\.exe$
- name: '[Sigma] Arbitrary File Download Via IMEWDBLD.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\IMEWDBLD\.exe'\}|\{'OriginalFileName':\
    'imewdbld\.exe'\})
- name: '[Sigma] Arbitrary File Download Via IMEWDBLD.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(http://|https://)
- name: '[Sigma] InfDefaultInstall.exe .inf Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(InfDefaultInstall\.exe\ |\.inf)
- name: '[Sigma] File Download Via InstallUtil.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\InstallUtil\.exe'\}|\{'OriginalFileName':\
    'InstallUtil\.exe'\})
- name: '[Sigma] File Download Via InstallUtil.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(ftp://|http://|https://)
- name: '[Sigma] Suspicious Execution of InstallUtil Without Log'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\InstallUtil\.exe$
- name: '[Sigma] Suspicious Execution of InstallUtil Without Log'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)Microsoft\.NET\\Framework
- name: '[Sigma] Suspicious Execution of InstallUtil Without Log'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/logfile=\ |/LogToConsole=false)
- name: '[Sigma] Suspicious Shells Spawn by Java Utility Keytool'
  tag: attack.initial-access,attack.persistence,attack.privilege-escalation
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\keytool\.exe$
- name: '[Sigma] Suspicious Shells Spawn by Java Utility Keytool'
  tag: attack.initial-access,attack.persistence,attack.privilege-escalation
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\cmd\.exe|\\sh\.exe|\\bash\.exe|\\powershell\.exe|\\pwsh\.exe|\\schtasks\.exe|\\certutil\.exe|\\whoami\.exe|\\bitsadmin\.exe|\\wscript\.exe|\\cscript\.exe|\\scrcons\.exe|\\regsvr32\.exe|\\hh\.exe|\\wmic\.exe|\\mshta\.exe|\\rundll32\.exe|\\forfiles\.exe|\\scriptrunner\.exe|\\mftrace\.exe|\\AppVLP\.exe|\\systeminfo\.exe|\\reg\.exe|\\query\.exe)$
- name: '[Sigma] Suspicious Child Process Of Manage Engine ServiceDesk'
  tag: attack.command-and-control,attack.t1102
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\ManageEngine\\ServiceDesk\\|\\java\.exe)
- name: '[Sigma] Suspicious Child Process Of Manage Engine ServiceDesk'
  tag: attack.command-and-control,attack.t1102
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\AppVLP\.exe|\\bash\.exe|\\bitsadmin\.exe|\\calc\.exe|\\certutil\.exe|\\cscript\.exe|\\curl\.exe|\\forfiles\.exe|\\mftrace\.exe|\\mshta\.exe|\\net\.exe|\\net1\.exe|\\notepad\.exe|\\powershell\.exe|\\pwsh\.exe|\\query\.exe|\\reg\.exe|\\schtasks\.exe|\\scrcons\.exe|\\sh\.exe|\\systeminfo\.exe|\\whoami\.exe|\\wmic\.exe|\\wscript\.exe)$
- name: '[Sigma] Suspicious Child Process Of Manage Engine ServiceDesk'
  tag: attack.command-and-control,attack.t1102
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\net\.exe|\\net1\.exe)$
- name: '[Sigma] Suspicious Child Process Of Manage Engine ServiceDesk'
  tag: attack.command-and-control,attack.t1102
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\ stop
- name: '[Sigma] Java Running with Remote Debugging'
  tag: attack.t1203,attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)transport=dt_socket,address=
- name: '[Sigma] Java Running with Remote Debugging'
  tag: attack.t1203,attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(jre1\.|jdk1\.)
- name: '[Sigma] Java Running with Remote Debugging'
  tag: attack.t1203,attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(address=127\.0\.0\.1|address=localhost)
- name: '[Sigma] Suspicious Processes Spawned by Java.EXE'
  tag: attack.initial-access,attack.persistence,attack.privilege-escalation
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\java\.exe$
- name: '[Sigma] Suspicious Processes Spawned by Java.EXE'
  tag: attack.initial-access,attack.persistence,attack.privilege-escalation
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\AppVLP\.exe|\\bitsadmin\.exe|\\certutil\.exe|\\cscript\.exe|\\curl\.exe|\\forfiles\.exe|\\hh\.exe|\\mftrace\.exe|\\mshta\.exe|\\net\.exe|\\net1\.exe|\\query\.exe|\\reg\.exe|\\regsvr32\.exe|\\rundll32\.exe|\\schtasks\.exe|\\scrcons\.exe|\\scriptrunner\.exe|\\sh\.exe|\\systeminfo\.exe|\\whoami\.exe|\\wmic\.exe|\\wscript\.exe)$
- name: '[Sigma] Shell Process Spawned by Java.EXE'
  tag: attack.initial-access,attack.persistence,attack.privilege-escalation
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\java\.exe$
- name: '[Sigma] Shell Process Spawned by Java.EXE'
  tag: attack.initial-access,attack.persistence,attack.privilege-escalation
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\bash\.exe|\\cmd\.exe|\\powershell\.exe|\\pwsh\.exe)$
- name: '[Sigma] Shell Process Spawned by Java.EXE'
  tag: attack.initial-access,attack.persistence,attack.privilege-escalation
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)build
- name: '[Sigma] Shell Process Spawned by Java.EXE'
  tag: attack.initial-access,attack.persistence,attack.privilege-escalation
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)build
- name: '[Sigma] Suspicious SysAidServer Child'
  tag: attack.lateral-movement,attack.t1210
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(\\java\.exe|\\javaw\.exe)$
- name: '[Sigma] Suspicious SysAidServer Child'
  tag: attack.lateral-movement,attack.t1210
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)SysAidServer
- name: '[Sigma] JScript Compiler Execution'
  tag: attack.defense-evasion,attack.t1127
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\jsc\.exe'\}|\{'OriginalFileName':\ 'jsc\.exe'\})
- name: '[Sigma] Kavremover Dropped Binary LOLBIN Usage'
  tag: attack.defense-evasion,attack.t1127
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ run\ run\-cmd\ '
- name: '[Sigma] Kavremover Dropped Binary LOLBIN Usage'
  tag: attack.defense-evasion,attack.t1127
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\cleanapi\.exe|\\kavremover\.exe)$
- name: '[Sigma] Windows Kernel Debugger Execution'
  tag: attack.defense-evasion,attack.privilege-escalation
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\kd\.exe'\}|\{'OriginalFileName':\ 'kd\.exe'\})
- name: '[Sigma] Potentially Suspicious Child Process of KeyScrambler.exe'
  tag: attack.persistence,attack.execution,attack.defense-evasion,attack.privilege-escalation,attack.t1203,attack.t1574.001
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\KeyScrambler\.exe$
- name: '[Sigma] Potentially Suspicious Child Process of KeyScrambler.exe'
  tag: attack.persistence,attack.execution,attack.defense-evasion,attack.privilege-escalation,attack.t1203,attack.t1574.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\cmd\.exe',\ '\\\\cscript\.exe',\ '\\\\mshta\.exe',\
    '\\\\powershell\.exe',\ '\\\\pwsh\.exe',\ '\\\\regsvr32\.exe',\ '\\\\rundll32\.exe',\
    '\\\\wscript\.exe'\]\}|\{'OriginalFileName':\ \['Cmd\.Exe',\ 'cscript\.exe',\
    'mshta\.exe',\ 'PowerShell\.EXE',\ 'pwsh\.dll',\ 'regsvr32\.exe',\ 'RUNDLL32\.EXE',\
    'wscript\.exe'\]\})
- name: '[Sigma] Computer Password Change Via Ksetup.EXE'
  tag: attack.execution
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\ksetup\.exe'\}|\{'OriginalFileName':\ 'ksetup\.exe'\})
- name: '[Sigma] Computer Password Change Via Ksetup.EXE'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ /setcomputerpassword\ '
- name: '[Sigma] Logged-On User Password Change Via Ksetup.EXE'
  tag: attack.execution
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\ksetup\.exe'\}|\{'OriginalFileName':\ 'ksetup\.exe'\})
- name: '[Sigma] Logged-On User Password Change Via Ksetup.EXE'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ /ChangePassword\ '
- name: '[Sigma] Active Directory Structure Export Via Ldifde.EXE'
  tag: attack.exfiltration
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\ldifde\.exe'\}|\{'OriginalFileName':\ 'ldifde\.exe'\})
- name: '[Sigma] Active Directory Structure Export Via Ldifde.EXE'
  tag: attack.exfiltration
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\-f
- name: '[Sigma] Active Directory Structure Export Via Ldifde.EXE'
  tag: attack.exfiltration
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-i
- name: '[Sigma] Import LDAP Data Interchange Format File Via Ldifde.EXE'
  tag: attack.command-and-control,attack.defense-evasion,attack.t1218,attack.t1105
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\ldifde\.exe'\}|\{'OriginalFileName':\ 'ldifde\.exe'\})
- name: '[Sigma] Import LDAP Data Interchange Format File Via Ldifde.EXE'
  tag: attack.command-and-control,attack.defense-evasion,attack.t1218,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-i|\-f)
- name: '[Sigma] Uncommon Link.EXE Parent Process'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\link\.exe$
- name: '[Sigma] Uncommon Link.EXE Parent Process'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)LINK\ /
- name: '[Sigma] Uncommon Link.EXE Parent Process'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: ParentPath
  condition: regex
  pattern: ^(C:\\Program\ Files\\Microsoft\ Visual\ Studio\\|C:\\Program\ Files\ \(x86\)\\Microsoft\
    Visual\ Studio\\)
- name: '[Sigma] Uncommon Link.EXE Parent Process'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(\\VC\\bin\\|\\VC\\Tools\\)
- name: '[Sigma] Rebuild Performance Counter Values Via Lodctr.EXE'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\lodctr\.exe$
- name: '[Sigma] Rebuild Performance Counter Values Via Lodctr.EXE'
  tag: attack.execution
  score: 50
  target: FileName
  condition: regex
  pattern: (?i)LODCTR\.EXE
- name: '[Sigma] Rebuild Performance Counter Values Via Lodctr.EXE'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-r
- name: '[Sigma] Suspicious Windows Trace ETW Session Tamper Via Logman.EXE'
  tag: attack.defense-evasion,attack.t1562.001,attack.t1070.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\logman\.exe'\}|\{'OriginalFileName':\ 'Logman\.exe'\})
- name: '[Sigma] Suspicious Windows Trace ETW Session Tamper Via Logman.EXE'
  tag: attack.defense-evasion,attack.t1562.001,attack.t1070.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(stop\ |delete\ )
- name: '[Sigma] Suspicious Windows Trace ETW Session Tamper Via Logman.EXE'
  tag: attack.defense-evasion,attack.t1562.001,attack.t1070.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Circular\ Kernel\ Context\ Logger|EventLog\-|SYSMON\ TRACE|SysmonDnsEtwSession)
- name: '[Sigma] LOLBAS Data Exfiltration by DataSvcUtil.exe'
  tag: attack.exfiltration,attack.t1567
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/in:|/out:|/uri:)
- name: '[Sigma] LOLBAS Data Exfiltration by DataSvcUtil.exe'
  tag: attack.exfiltration,attack.t1567
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\DataSvcUtil\.exe'\}|\{'OriginalFileName':\
    'DataSvcUtil\.exe'\})
- name: '[Sigma] Devtoolslauncher.exe Executes Specified Binary'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\devtoolslauncher\.exe$
- name: '[Sigma] Devtoolslauncher.exe Executes Specified Binary'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)LaunchForDeploy
- name: '[Sigma] Suspicious Diantz Alternate Data Stream Execution'
  tag: attack.defense-evasion,attack.t1564.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(diantz\.exe|\.cab)
- name: '[Sigma] Suspicious Diantz Alternate Data Stream Execution'
  tag: attack.defense-evasion,attack.t1564.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i):\[\^\\\\\]
- name: '[Sigma] Suspicious Diantz Download and Compress Into a CAB File'
  tag: attack.command-and-control,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(diantz\.exe|\ \\\\\\\\|\.cab)
- name: '[Sigma] Suspicious Extrac32 Execution'
  tag: attack.command-and-control,attack.t1105
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains':\ 'extrac32\.exe'\}|\{'Image\|endswith':\
    '\\\\extrac32\.exe'\}|\{'OriginalFileName':\ 'extrac32\.exe'\})
- name: '[Sigma] Suspicious Extrac32 Execution'
  tag: attack.command-and-control,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\.cab
- name: '[Sigma] Suspicious Extrac32 Execution'
  tag: attack.command-and-control,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/C|/Y|\ \\\\\\\\)
- name: '[Sigma] Suspicious Extrac32 Alternate Data Stream Execution'
  tag: attack.defense-evasion,attack.t1564.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(extrac32\.exe|\.cab)
- name: '[Sigma] Suspicious Extrac32 Alternate Data Stream Execution'
  tag: attack.defense-evasion,attack.t1564.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i):\[\^\\\\\]
- name: '[Sigma] Potential Reconnaissance Activity Via GatherNetworkInfo.VBS'
  tag: attack.discovery,attack.execution,attack.t1615,attack.t1059.005
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\cscript\.exe',\ '\\\\wscript\.exe'\]\}|\{'OriginalFileName':\
    \['cscript\.exe',\ 'wscript\.exe'\]\})
- name: '[Sigma] Potential Reconnaissance Activity Via GatherNetworkInfo.VBS'
  tag: attack.discovery,attack.execution,attack.t1615,attack.t1059.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)gatherNetworkInfo\.vbs
- name: '[Sigma] Gpscript Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\gpscript\.exe'\}|\{'OriginalFileName':\
    'GPSCRIPT\.EXE'\})
- name: '[Sigma] Gpscript Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /logon|\ /startup)
- name: '[Sigma] Gpscript Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)C:\\windows\\system32\\svchost\.exe\ \-k\ netsvcs\ \-p\ \-s\ gpsvc
- name: '[Sigma] Ie4uinit Lolbin Use From Invalid Path'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\ie4uinit\.exe'\}|\{'OriginalFileName':\
    'IE4UINIT\.EXE'\})
- name: '[Sigma] Ie4uinit Lolbin Use From Invalid Path'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(c:\\windows\\system32\\|c:\\windows\\sysWOW64\\)
- name: '[Sigma] Ie4uinit Lolbin Use From Invalid Path'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: None
- name: '[Sigma] Launch-VsDevShell.PS1 Proxy Execution'
  tag: attack.defense-evasion,attack.t1216.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)Launch\-VsDevShell\.ps1
- name: '[Sigma] Launch-VsDevShell.PS1 Proxy Execution'
  tag: attack.defense-evasion,attack.t1216.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(VsWherePath\ |VsInstallationPath\ )
- name: '[Sigma] Potential Manage-bde.wsf Abuse To Proxy Execution'
  tag: attack.defense-evasion,attack.t1216
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\wscript\.exe'\}|\{'OriginalFileName':\
    'wscript\.exe'\})
- name: '[Sigma] Potential Manage-bde.wsf Abuse To Proxy Execution'
  tag: attack.defense-evasion,attack.t1216
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)manage\-bde\.wsf
- name: '[Sigma] Potential Manage-bde.wsf Abuse To Proxy Execution'
  tag: attack.defense-evasion,attack.t1216
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\cscript\.exe|\\wscript\.exe)$
- name: '[Sigma] Potential Manage-bde.wsf Abuse To Proxy Execution'
  tag: attack.defense-evasion,attack.t1216
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)manage\-bde\.wsf
- name: '[Sigma] Potential Manage-bde.wsf Abuse To Proxy Execution'
  tag: attack.defense-evasion,attack.t1216
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\cmd\.exe$
- name: '[Sigma] Mavinject Inject DLL Into Running Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1055.001,attack.t1218.013
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ /INJECTRUNNING\ '
- name: '[Sigma] Mavinject Inject DLL Into Running Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1055.001,attack.t1218.013
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\AppVClient\.exe
- name: '[Sigma] MpiExec Lolbin'
  tag: attack.execution,attack.defense-evasion,attack.t1218
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\mpiexec\.exe'\}|\{'Hashes\|contains':\
    'IMPHASH=d8b52ef6aaa3a81501bdfff9dbb96217'\})
- name: '[Sigma] MpiExec Lolbin'
  tag: attack.execution,attack.defense-evasion,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /n\ 1\ |\ \-n\ 1\ )
- name: '[Sigma] Execute Files with Msdeploy.exe'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(verb:sync|\-source:RunCommand|\-dest:runCommand)
- name: '[Sigma] Execute Files with Msdeploy.exe'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\msdeploy\.exe$
- name: '[Sigma] Use of OpenConsole'
  tag: attack.execution,attack.t1059
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'OpenConsole\.exe'\}|\{'Image\|endswith':\
    '\\\\OpenConsole\.exe'\})
- name: '[Sigma] Use of OpenConsole'
  tag: attack.execution,attack.t1059
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^C:\\Program\ Files\\WindowsApps\\Microsoft\.WindowsTerminal
- name: '[Sigma] OpenWith.exe Executes Specified Binary'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\OpenWith\.exe$
- name: '[Sigma] OpenWith.exe Executes Specified Binary'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)/c
- name: '[Sigma] Use of Pcalua For Execution'
  tag: attack.execution,attack.t1059
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\pcalua\.exe$
- name: '[Sigma] Use of Pcalua For Execution'
  tag: attack.execution,attack.t1059
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-a
- name: '[Sigma] Indirect Command Execution By Program Compatibility Wizard'
  tag: attack.defense-evasion,attack.t1218,attack.execution
  score: 20
  target: ParentPath
  condition: regex
  pattern: (?i)\\pcwrun\.exe$
- name: '[Sigma] Execute Pcwrun.EXE To Leverage Follina'
  tag: attack.defense-evasion,attack.t1218,attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\pcwrun\.exe$
- name: '[Sigma] Execute Pcwrun.EXE To Leverage Follina'
  tag: attack.defense-evasion,attack.t1218,attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\.\./
- name: '[Sigma] Code Execution via Pcwutl.dll'
  tag: attack.defense-evasion,attack.t1218.011
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\rundll32\.exe'\}|\{'OriginalFileName':\
    'RUNDLL32\.EXE'\})
- name: '[Sigma] Code Execution via Pcwutl.dll'
  tag: attack.defense-evasion,attack.t1218.011
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(pcwutl|LaunchApplication)
- name: '[Sigma] Execute Code with Pester.bat as Parent'
  tag: attack.execution,attack.t1059.001,attack.defense-evasion,attack.t1216
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\pwsh\.exe)$
- name: '[Sigma] Execute Code with Pester.bat as Parent'
  tag: attack.execution,attack.t1059.001,attack.defense-evasion,attack.t1216
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\WindowsPowerShell\\Modules\\Pester\\
- name: '[Sigma] Execute Code with Pester.bat as Parent'
  tag: attack.execution,attack.t1059.001,attack.defense-evasion,attack.t1216
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{\ Invoke\-Pester\ \-EnableExit\ ;|\{\ Get\-Help\ ")
- name: '[Sigma] Execute Code with Pester.bat'
  tag: attack.execution,attack.t1059.001,attack.defense-evasion,attack.t1216
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\pwsh\.exe)$
- name: '[Sigma] Execute Code with Pester.bat'
  tag: attack.execution,attack.t1059.001,attack.defense-evasion,attack.t1216
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Pester|Get\-Help)
- name: '[Sigma] Execute Code with Pester.bat'
  tag: attack.execution,attack.t1059.001,attack.defense-evasion,attack.t1216
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\cmd\.exe$
- name: '[Sigma] Execute Code with Pester.bat'
  tag: attack.execution,attack.t1059.001,attack.defense-evasion,attack.t1216
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(pester|;)
- name: '[Sigma] Execute Code with Pester.bat'
  tag: attack.execution,attack.t1059.001,attack.defense-evasion,attack.t1216
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(help|\\.)
- name: '[Sigma] PrintBrm ZIP Creation of Extraction'
  tag: attack.command-and-control,attack.t1105,attack.defense-evasion,attack.t1564.004
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\PrintBrm\.exe$
- name: '[Sigma] PrintBrm ZIP Creation of Extraction'
  tag: attack.command-and-control,attack.t1105,attack.defense-evasion,attack.t1564.004
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-f|\.zip)
- name: '[Sigma] Pubprn.vbs Proxy Execution'
  tag: attack.defense-evasion,attack.t1216.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\pubprn\.vbs|script:)
- name: '[Sigma] DLL Execution via Rasautou.exe'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\rasautou\.exe'\}|\{'OriginalFileName':\
    'rasdlui\.exe'\})
- name: '[Sigma] DLL Execution via Rasautou.exe'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-d\ |\ \-p\ )
- name: '[Sigma] REGISTER_APP.VBS Proxy Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\register_app\.vbs|\-register)
- name: '[Sigma] Use of Remote.exe'
  tag: attack.defense-evasion,attack.t1127
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\remote\.exe'\}|\{'OriginalFileName':\ 'remote\.exe'\})
- name: '[Sigma] Replace.exe Usage'
  tag: attack.command-and-control,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\replace\.exe$
- name: '[Sigma] Replace.exe Usage'
  tag: attack.command-and-control,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\-a
- name: '[Sigma] Lolbin Runexehelper Use As Proxy'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\runexehelper\.exe$
- name: '[Sigma] Suspicious Runscripthelper.exe'
  tag: attack.execution,attack.t1059,attack.defense-evasion,attack.t1202
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\Runscripthelper\.exe$
- name: '[Sigma] Suspicious Runscripthelper.exe'
  tag: attack.execution,attack.t1059,attack.defense-evasion,attack.t1202
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)surfacecheck
- name: '[Sigma] Use of Scriptrunner.exe'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\ScriptRunner\.exe'\}|\{'OriginalFileName':\
    'ScriptRunner\.exe'\})
- name: '[Sigma] Use of Scriptrunner.exe'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-appvscript\ '
- name: '[Sigma] Using SettingSyncHost.exe as LOLBin'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.defense-evasion,attack.t1574.008
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^(C:\\Windows\\System32\\|C:\\Windows\\SysWOW64\\)
- name: '[Sigma] Using SettingSyncHost.exe as LOLBin'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.defense-evasion,attack.t1574.008
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(cmd\.exe\ /c|RoamDiag\.cmd|\-outputpath)
- name: '[Sigma] Use Of The SFTP.EXE Binary As A LOLBIN'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\sftp\.exe$
- name: '[Sigma] Use Of The SFTP.EXE Binary As A LOLBIN'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-D\ \.\.|\ \-D\ C:\\)
- name: '[Sigma] Suspicious Driver Install by pnputil.exe'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-i|/install|\-a|/add\-driver|\.inf)
- name: '[Sigma] Suspicious Driver Install by pnputil.exe'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\pnputil\.exe$
- name: '[Sigma] Suspicious GrpConv Execution'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(grpconv\.exe\ \-o|grpconv\ \-o)
- name: '[Sigma] Dumping Process via Sqldumper.exe'
  tag: attack.credential-access,attack.t1003.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\sqldumper\.exe$
- name: '[Sigma] Dumping Process via Sqldumper.exe'
  tag: attack.credential-access,attack.t1003.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(0x0110|0x01100:40)
- name: '[Sigma] SyncAppvPublishingServer Execute Arbitrary PowerShell Code'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\SyncAppvPublishingServer\.exe'\}|\{'OriginalFileName':\
    'syncappvpublishingserver\.exe'\})
- name: '[Sigma] SyncAppvPublishingServer Execute Arbitrary PowerShell Code'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)"n;\ '
- name: '[Sigma] SyncAppvPublishingServer VBS Execute Arbitrary PowerShell Code'
  tag: attack.defense-evasion,attack.t1218,attack.t1216
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\SyncAppvPublishingServer\.vbs|;)
- name: '[Sigma] Potential DLL Injection Or Execution Using Tracker.exe'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1055.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\tracker\.exe'\}|\{'Description':\ 'Tracker'\})
- name: '[Sigma] Potential DLL Injection Or Execution Using Tracker.exe'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1055.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /d\ |\ /c\ )
- name: '[Sigma] Potential DLL Injection Or Execution Using Tracker.exe'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1055.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ /ERRORREPORT:PROMPT\ '
- name: '[Sigma] Potential DLL Injection Or Execution Using Tracker.exe'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1055.001
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(\\Msbuild\\Current\\Bin\\MSBuild\.exe|\\Msbuild\\Current\\Bin\\amd64\\MSBuild\.exe)$
- name: '[Sigma] Use of TTDInject.exe'
  tag: attack.defense-evasion,attack.t1127
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ 'ttdinject\.exe'\}|\{'OriginalFileName':\ 'TTDInject\.EXE'\})
- name: '[Sigma] Time Travel Debugging Utility Usage'
  tag: attack.defense-evasion,attack.credential-access,attack.t1218,attack.t1003.001
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\tttracer\.exe$
- name: '[Sigma] Lolbin Unregmp2.exe Use As Proxy'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\unregmp2\.exe'\}|\{'OriginalFileName':\
    'unregmp2\.exe'\})
- name: '[Sigma] Lolbin Unregmp2.exe Use As Proxy'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ /HideWMP
- name: '[Sigma] UtilityFunctions.ps1 Proxy Dll'
  tag: attack.defense-evasion,attack.t1216
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(UtilityFunctions\.ps1|RegSnapin\ )
- name: '[Sigma] Use of VisualUiaVerifyNative.exe'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\VisualUiaVerifyNative\.exe'\}|\{'OriginalFileName':\
    'VisualUiaVerifyNative\.exe'\})
- name: '[Sigma] Visual Basic Command Line Compiler Usage'
  tag: attack.defense-evasion,attack.t1027.004
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\vbc\.exe$
- name: '[Sigma] Visual Basic Command Line Compiler Usage'
  tag: attack.defense-evasion,attack.t1027.004
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\cvtres\.exe$
- name: '[Sigma] Use of VSIISExeLauncher.exe'
  tag: attack.defense-evasion,attack.t1127
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\VSIISExeLauncher\.exe'\}|\{'OriginalFileName':\
    'VSIISExeLauncher\.exe'\})
- name: '[Sigma] Use of VSIISExeLauncher.exe'
  tag: attack.defense-evasion,attack.t1127
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-p\ |\ \-a\ )
- name: '[Sigma] Use of Wfc.exe'
  tag: attack.defense-evasion,attack.t1127
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\wfc\.exe'\}|\{'OriginalFileName':\ 'wfc\.exe'\})
- name: '[Sigma] Potential Register_App.Vbs LOLScript Abuse'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\cscript\.exe',\ '\\\\wscript\.exe'\]\}|\{'OriginalFileName':\
    \['cscript\.exe',\ 'wscript\.exe'\]\})
- name: '[Sigma] Potential Register_App.Vbs LOLScript Abuse'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\.vbs\ \-register\ '
- name: '[Sigma] Potential Credential Dumping Via LSASS Process Clone'
  tag: attack.credential-access,attack.t1003,attack.t1003.001
  score: 100
  target: ParentPath
  condition: regex
  pattern: (?i)\\Windows\\System32\\lsass\.exe$
- name: '[Sigma] Potential Credential Dumping Via LSASS Process Clone'
  tag: attack.credential-access,attack.t1003,attack.t1003.001
  score: 100
  target: Target_Path
  condition: regex
  pattern: (?i)\\Windows\\System32\\lsass\.exe$
- name: '[Sigma] Potential Mftrace.EXE Abuse'
  tag: attack.defense-evasion,attack.t1127
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\mftrace\.exe$
- name: '[Sigma] MMC20 Lateral Movement'
  tag: attack.execution,attack.lateral-movement,attack.t1021.003
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\svchost\.exe$
- name: '[Sigma] MMC20 Lateral Movement'
  tag: attack.execution,attack.lateral-movement,attack.t1021.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\mmc\.exe$
- name: '[Sigma] MMC20 Lateral Movement'
  tag: attack.execution,attack.lateral-movement,attack.t1021.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\-Embedding
- name: '[Sigma] MMC Spawning Windows Shell'
  tag: attack.lateral-movement,attack.t1021.003
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\mmc\.exe$
- name: '[Sigma] MMC Spawning Windows Shell'
  tag: attack.lateral-movement,attack.t1021.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\cmd\.exe',\ '\\\\powershell\.exe',\ '\\\\pwsh\.exe',\
    '\\\\wscript\.exe',\ '\\\\cscript\.exe',\ '\\\\sh\.exe',\ '\\\\bash\.exe',\ '\\\\reg\.exe',\
    '\\\\regsvr32\.exe'\]\}|\{'Image\|contains':\ '\\\\BITSADMIN'\})
- name: '[Sigma] CodePage Modification Via MODE.COM To Russian Language'
  tag: attack.defense-evasion,attack.t1036
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\mode\.com'\}|\{'OriginalFileName':\ 'MODE\.COM'\})
- name: '[Sigma] CodePage Modification Via MODE.COM To Russian Language'
  tag: attack.defense-evasion,attack.t1036
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ con\ |\ cp\ |\ select=)
- name: '[Sigma] CodePage Modification Via MODE.COM To Russian Language'
  tag: attack.defense-evasion,attack.t1036
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(=1251|=866)$
- name: '[Sigma] Potential Suspicious Mofcomp Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\mofcomp\.exe'\}|\{'OriginalFileName':\
    'mofcomp\.exe'\})
- name: '[Sigma] Potential Suspicious Mofcomp Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'ParentImage\|endswith':\ \['\\\\cmd\.exe',\ '\\\\powershell\.exe',\
    '\\\\pwsh\.exe',\ '\\\\wsl\.exe',\ '\\\\wscript\.exe',\ '\\\\cscript\.exe'\]\}|\{'CommandLine\|contains':\
    \['\\\\AppData\\\\Local\\\\Temp',\ '\\\\Users\\\\Public\\\\',\ '\\\\WINDOWS\\\\Temp\\\\',\
    '%temp%',\ '%tmp%',\ '%appdata%'\]\})
- name: '[Sigma] Potential Suspicious Mofcomp Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\wbem\\WmiPrvSE\.exe
- name: '[Sigma] Potential Suspicious Mofcomp Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\TEMP\\
- name: '[Sigma] Potential Suspicious Mofcomp Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\.mof$
- name: '[Sigma] Potential Suspicious Mofcomp Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\TEMP\\
- name: '[Sigma] Potential Suspicious Mofcomp Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\.mof$
- name: '[Sigma] Potential Mpclient.DLL Sideloading Via Defender Binaries'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\MpCmdRun\.exe|\\NisSrv\.exe)$
- name: '[Sigma] Potential Mpclient.DLL Sideloading Via Defender Binaries'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^(C:\\Program\ Files\ \(x86\)\\Windows\ Defender\\|C:\\Program\ Files\\Microsoft\
    Security\ Client\\|C:\\Program\ Files\\Windows\ Defender\\|C:\\ProgramData\\Microsoft\\Windows\
    Defender\\Platform\\|C:\\Windows\\WinSxS\\)
- name: '[Sigma] File Download Via Windows Defender MpCmpRun.EXE'
  tag: attack.defense-evasion,attack.t1218,attack.command-and-control,attack.t1105
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'MpCmdRun\.exe'\}|\{'Image\|endswith':\ '\\\\MpCmdRun\.exe'\}|\{'CommandLine\|contains':\
    'MpCmdRun\.exe'\}|\{'Description':\ 'Microsoft\ Malware\ Protection\ Command\
    Line\ Utility'\})
- name: '[Sigma] File Download Via Windows Defender MpCmpRun.EXE'
  tag: attack.defense-evasion,attack.t1218,attack.command-and-control,attack.t1105
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(DownloadFile|url)
- name: '[Sigma] Windows Defender Definition Files Removed'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\MpCmdRun\.exe'\}|\{'OriginalFileName':\
    'MpCmdRun\.exe'\})
- name: '[Sigma] Windows Defender Definition Files Removed'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-RemoveDefinitions|\ \-All)
- name: '[Sigma] Suspicious Msbuild Execution By Uncommon Parent Process'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\MSBuild\.exe'\}|\{'OriginalFileName':\
    'MSBuild\.exe'\})
- name: '[Sigma] Suspicious Msbuild Execution By Uncommon Parent Process'
  tag: attack.defense-evasion
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(\\devenv\.exe|\\cmd\.exe|\\msbuild\.exe|\\python\.exe|\\explorer\.exe|\\nuget\.exe)$
- name: '[Sigma] MSDT Execution Via Answer File'
  tag: attack.defense-evasion,attack.t1218,attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\msdt\.exe$
- name: '[Sigma] MSDT Execution Via Answer File'
  tag: attack.defense-evasion,attack.t1218,attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\WINDOWS\\diagnostics\\index\\PCWDiagnostic\.xml
- name: '[Sigma] MSDT Execution Via Answer File'
  tag: attack.defense-evasion,attack.t1218,attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-af\ '
- name: '[Sigma] MSDT Execution Via Answer File'
  tag: attack.defense-evasion,attack.t1218,attack.execution
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\pcwrun\.exe$
- name: '[Sigma] Potential Arbitrary Command Execution Using Msdt.EXE'
  tag: attack.defense-evasion,attack.t1202
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\msdt\.exe'\}|\{'OriginalFileName':\ 'msdt\.exe'\})
- name: '[Sigma] Potential Arbitrary Command Execution Using Msdt.EXE'
  tag: attack.defense-evasion,attack.t1202
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)IT_BrowseForFile=
- name: '[Sigma] Potential Arbitrary Command Execution Using Msdt.EXE'
  tag: attack.defense-evasion,attack.t1202
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\ PCWDiagnostic
- name: '[Sigma] Potential Arbitrary Command Execution Using Msdt.EXE'
  tag: attack.defense-evasion,attack.t1202
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-af\ '
- name: '[Sigma] Suspicious Cabinet File Execution Via Msdt.EXE'
  tag: attack.defense-evasion,attack.t1202
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\msdt\.exe'\}|\{'OriginalFileName':\ 'msdt\.exe'\})
- name: '[Sigma] Suspicious Cabinet File Execution Via Msdt.EXE'
  tag: attack.defense-evasion,attack.t1202
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-cab\ '
- name: '[Sigma] Suspicious MSDT Parent Process'
  tag: attack.defense-evasion,attack.t1036,attack.t1218
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\cmd\.exe|\\cscript\.exe|\\mshta\.exe|\\powershell\.exe|\\pwsh\.exe|\\regsvr32\.exe|\\rundll32\.exe|\\schtasks\.exe|\\wmic\.exe|\\wscript\.exe|\\wsl\.exe)$
- name: '[Sigma] Suspicious MSDT Parent Process'
  tag: attack.defense-evasion,attack.t1036,attack.t1218
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\msdt\.exe'\}|\{'OriginalFileName':\ 'msdt\.exe'\})
- name: '[Sigma] Arbitrary File Download Via MSEDGE_PROXY.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\msedge_proxy\.exe'\}|\{'OriginalFileName':\
    'msedge_proxy\.exe'\})
- name: '[Sigma] Arbitrary File Download Via MSEDGE_PROXY.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(http://|https://)
- name: '[Sigma] Remotely Hosted HTA File Executed Via Mshta.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218.005
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\mshta\.exe'\}|\{'OriginalFileName':\ 'MSHTA\.EXE'\})
- name: '[Sigma] Remotely Hosted HTA File Executed Via Mshta.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(http://|https://|ftp://)
- name: '[Sigma] Wscript Shell Run In CommandLine'
  tag: attack.execution,attack.t1059
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Wscript\.|\.Shell|\.Run)
- name: '[Sigma] Suspicious JavaScript Execution Via Mshta.EXE'
  tag: attack.defense-evasion,attack.t1218.005
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\mshta\.exe'\}|\{'OriginalFileName':\ 'MSHTA\.EXE'\})
- name: '[Sigma] Suspicious JavaScript Execution Via Mshta.EXE'
  tag: attack.defense-evasion,attack.t1218.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)javascript
- name: '[Sigma] Potential LethalHTA Technique Execution'
  tag: attack.defense-evasion,attack.t1218.005
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\svchost\.exe$
- name: '[Sigma] Potential LethalHTA Technique Execution'
  tag: attack.defense-evasion,attack.t1218.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\mshta\.exe$
- name: '[Sigma] Suspicious MSHTA Child Process'
  tag: attack.defense-evasion,attack.t1218.005,car.2013-02-003,car.2013-03-001,car.2014-04-003
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\mshta\.exe$
- name: '[Sigma] Suspicious MSHTA Child Process'
  tag: attack.defense-evasion,attack.t1218.005,car.2013-02-003,car.2013-03-001,car.2014-04-003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\cmd\.exe',\ '\\\\powershell\.exe',\ '\\\\pwsh\.exe',\
    '\\\\wscript\.exe',\ '\\\\cscript\.exe',\ '\\\\sh\.exe',\ '\\\\bash\.exe',\ '\\\\reg\.exe',\
    '\\\\regsvr32\.exe',\ '\\\\bitsadmin\.exe'\]\}|\{'OriginalFileName':\ \['Cmd\.Exe',\
    'PowerShell\.EXE',\ 'pwsh\.dll',\ 'wscript\.exe',\ 'cscript\.exe',\ 'Bash\.exe',\
    'reg\.exe',\ 'REGSVR32\.EXE',\ 'bitsadmin\.exe'\]\})
- name: '[Sigma] MSHTA Execution with Suspicious File Extensions'
  tag: attack.defense-evasion,attack.t1140,attack.t1218.005,attack.execution,attack.t1059.007,cve.2020-1599
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\mshta\.exe'\}|\{'OriginalFileName':\ 'mshta\.exe'\})
- name: '[Sigma] MSHTA Execution with Suspicious File Extensions'
  tag: attack.defense-evasion,attack.t1140,attack.t1218.005,attack.execution,attack.t1059.007,cve.2020-1599
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.7z|\.avi|\.bat|\.bmp|\.conf|\.csv|\.dll|\.doc|\.gif|\.gz|\.ini|\.jpe|\.jpg|\.json|\.lnk|\.log|\.mkv|\.mp3|\.mp4|\.pdf|\.png|\.ppt|\.rar|\.rtf|\.svg|\.tar|\.tmp|\.txt|\.xls|\.xml|\.yaml|\.yml|\.zip|vbscript)
- name: '[Sigma] Suspicious Mshta.EXE Execution Patterns'
  tag: attack.execution,attack.t1106
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\mshta\.exe'\}|\{'OriginalFileName':\ 'MSHTA\.EXE'\})
- name: '[Sigma] Suspicious Mshta.EXE Execution Patterns'
  tag: attack.execution,attack.t1106
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\cmd\.exe|\\cscript\.exe|\\powershell\.exe|\\pwsh\.exe|\\regsvr32\.exe|\\rundll32\.exe|\\wscript\.exe)$
- name: '[Sigma] Suspicious Mshta.EXE Execution Patterns'
  tag: attack.execution,attack.t1106
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\AppData\\Local\\|C:\\ProgramData\\|C:\\Users\\Public\\|C:\\Windows\\Temp\\)
- name: '[Sigma] Suspicious Mshta.EXE Execution Patterns'
  tag: attack.execution,attack.t1106
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|startswith':\ \['C:\\\\Windows\\\\System32\\\\',\ 'C:\\\\Windows\\\\SysWOW64\\\\'\]\}|\{'CommandLine\|contains':\
    \['\.htm',\ '\.hta'\]\}|\{'CommandLine\|endswith':\ \['mshta\.exe',\ 'mshta'\]\})
- name: '[Sigma] DllUnregisterServer Function Call Via Msiexec.EXE'
  tag: attack.defense-evasion,attack.t1218.007
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\msiexec\.exe'\}|\{'OriginalFileName':\
    '\\\\msiexec\.exe'\})
- name: '[Sigma] DllUnregisterServer Function Call Via Msiexec.EXE'
  tag: attack.defense-evasion,attack.t1218.007
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-z\ '
- name: '[Sigma] DllUnregisterServer Function Call Via Msiexec.EXE'
  tag: attack.defense-evasion,attack.t1218.007
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\.dll
- name: '[Sigma] Suspicious MsiExec Embedding Parent'
  tag: attack.t1218.007,attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\pwsh\.exe|\\cmd\.exe)$
- name: '[Sigma] Suspicious MsiExec Embedding Parent'
  tag: attack.t1218.007,attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(MsiExec\.exe|\-Embedding\ )
- name: '[Sigma] Suspicious MsiExec Embedding Parent'
  tag: attack.t1218.007,attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i):\\Windows\\System32\\cmd\.exe$
- name: '[Sigma] Suspicious MsiExec Embedding Parent'
  tag: attack.t1218.007,attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Program\ Files\\SplunkUniversalForwarder\\bin\\
- name: '[Sigma] Suspicious MsiExec Embedding Parent'
  tag: attack.t1218.007,attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains':\ '\\\\DismFoDInstall\.cmd'\}|\{'ParentCommandLine\|contains\|all':\
    \['\\\\MsiExec\.exe\ \-Embedding\ ',\ 'Global\\\\MSI0000'\]\})
- name: '[Sigma] Suspicious Msiexec Execute Arbitrary DLL'
  tag: attack.defense-evasion,attack.t1218.007
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\msiexec\.exe$
- name: '[Sigma] Suspicious Msiexec Execute Arbitrary DLL'
  tag: attack.defense-evasion,attack.t1218.007
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-y
- name: '[Sigma] Suspicious Msiexec Execute Arbitrary DLL'
  tag: attack.defense-evasion,attack.t1218.007
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\MsiExec\.exe"\ /Y\ "C:\\Program\ Files\\Bonjour\\mdnsNSP\.dll|\\MsiExec\.exe"\
    /Y\ "C:\\Program\ Files\ \(x86\)\\Bonjour\\mdnsNSP\.dll|\\MsiExec\.exe"\ /Y\ "C:\\Program\
    Files\ \(x86\)\\Apple\ Software\ Update\\ScriptingObjectModel\.dll|\\MsiExec\.exe"\
    /Y\ "C:\\Program\ Files\ \(x86\)\\Apple\ Software\ Update\\SoftwareUpdateAdmin\.dll|\\MsiExec\.exe"\
    /Y\ "C:\\Windows\\CCM\\|\\MsiExec\.exe"\ /Y\ C:\\Windows\\CCM\\|\\MsiExec\.exe"\
    \-Y\ "C:\\Program\ Files\\Bonjour\\mdnsNSP\.dll|\\MsiExec\.exe"\ \-Y\ "C:\\Program\
    Files\ \(x86\)\\Bonjour\\mdnsNSP\.dll|\\MsiExec\.exe"\ \-Y\ "C:\\Program\ Files\
    \(x86\)\\Apple\ Software\ Update\\ScriptingObjectModel\.dll|\\MsiExec\.exe"\ \-Y\
    "C:\\Program\ Files\ \(x86\)\\Apple\ Software\ Update\\SoftwareUpdateAdmin\.dll|\\MsiExec\.exe"\
    \-Y\ "C:\\Windows\\CCM\\|\\MsiExec\.exe"\ \-Y\ C:\\Windows\\CCM\\)
- name: '[Sigma] Msiexec Quiet Installation'
  tag: attack.defense-evasion,attack.t1218.007
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\msiexec\.exe'\}|\{'OriginalFileName':\
    'msiexec\.exe'\})
- name: '[Sigma] Msiexec Quiet Installation'
  tag: attack.defense-evasion,attack.t1218.007
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-i|\-package|\-a|\-j)
- name: '[Sigma] Msiexec Quiet Installation'
  tag: attack.defense-evasion,attack.t1218.007
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\-q
- name: '[Sigma] Msiexec Quiet Installation'
  tag: attack.defense-evasion,attack.t1218.007
  score: 50
  target: ParentPath
  condition: regex
  pattern: ^C:\\Users\\
- name: '[Sigma] Msiexec Quiet Installation'
  tag: attack.defense-evasion,attack.t1218.007
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\AppData\\Local\\Temp\\
- name: '[Sigma] Msiexec Quiet Installation'
  tag: attack.defense-evasion,attack.t1218.007
  score: 50
  target: ParentPath
  condition: regex
  pattern: ^C:\\Windows\\Temp\\
- name: '[Sigma] Msiexec Quiet Installation'
  tag: attack.defense-evasion,attack.t1218.007
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Windows\\CCM\\Ccm32BitLauncher\.exe
- name: '[Sigma] Msiexec Quiet Installation'
  tag: attack.defense-evasion,attack.t1218.007
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(System|S\-1\-16\-16384)
- name: '[Sigma] Suspicious Msiexec Quiet Install From Remote Location'
  tag: attack.defense-evasion,attack.t1218.007
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\msiexec\.exe'\}|\{'OriginalFileName':\
    'msiexec\.exe'\})
- name: '[Sigma] Suspicious Msiexec Quiet Install From Remote Location'
  tag: attack.defense-evasion,attack.t1218.007
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-i|\-package|\-a|\-j)
- name: '[Sigma] Suspicious Msiexec Quiet Install From Remote Location'
  tag: attack.defense-evasion,attack.t1218.007
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\-q
- name: '[Sigma] Suspicious Msiexec Quiet Install From Remote Location'
  tag: attack.defense-evasion,attack.t1218.007
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(http|\\\\\\\\)
- name: '[Sigma] Suspicious Msiexec Quiet Install From Remote Location'
  tag: attack.defense-evasion,attack.t1218.007
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\AppData\\Local\\Temp\\OpenOffice|Installation\ Files\\openoffice)
- name: '[Sigma] Potential MsiExec Masquerading'
  tag: attack.defense-evasion,attack.t1036.005
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\msiexec\.exe'\}|\{'OriginalFileName':\
    '\\\\msiexec\.exe'\})
- name: '[Sigma] Potential MsiExec Masquerading'
  tag: attack.defense-evasion,attack.t1036.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^(C:\\Windows\\System32\\|C:\\Windows\\SysWOW64\\|C:\\Windows\\WinSxS\\)
- name: '[Sigma] MsiExec Web Install'
  tag: attack.defense-evasion,attack.t1218.007,attack.command-and-control,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ msiexec|://)
- name: '[Sigma] Arbitrary File Download Via MSOHTMED.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\MSOHTMED\.exe'\}|\{'OriginalFileName':\
    'MsoHtmEd\.exe'\})
- name: '[Sigma] Arbitrary File Download Via MSOHTMED.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(ftp://|http://|https://)
- name: '[Sigma] Arbitrary File Download Via MSPUB.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\MSPUB\.exe'\}|\{'OriginalFileName':\ 'MSPUB\.exe'\})
- name: '[Sigma] Arbitrary File Download Via MSPUB.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(ftp://|http://|https://)
- name: '[Sigma] Potential Process Injection Via Msra.EXE'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1055
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\msra\.exe$
- name: '[Sigma] Potential Process Injection Via Msra.EXE'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1055
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)msra\.exe$
- name: '[Sigma] Potential Process Injection Via Msra.EXE'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1055
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\arp\.exe|\\cmd\.exe|\\net\.exe|\\netstat\.exe|\\nslookup\.exe|\\route\.exe|\\schtasks\.exe|\\whoami\.exe)$
- name: '[Sigma] Detection of PowerShell Execution via Sqlps.exe'
  tag: attack.execution,attack.t1059.001,attack.defense-evasion,attack.t1127
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\sqlps\.exe$
- name: '[Sigma] Detection of PowerShell Execution via Sqlps.exe'
  tag: attack.execution,attack.t1059.001,attack.defense-evasion,attack.t1127
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\sqlps\.exe'\}|\{'OriginalFileName':\ 'sqlps\.exe'\})
- name: '[Sigma] Detection of PowerShell Execution via Sqlps.exe'
  tag: attack.execution,attack.t1059.001,attack.defense-evasion,attack.t1127
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\sqlagent\.exe$
- name: '[Sigma] SQL Client Tools PowerShell Session Detection'
  tag: attack.execution,attack.t1059.001,attack.defense-evasion,attack.t1127
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\sqltoolsps\.exe'\}|\{'ParentImage\|endswith':\
    '\\\\sqltoolsps\.exe'\}|\{'OriginalFileName':\ '\\\\sqltoolsps\.exe'\})
- name: '[Sigma] SQL Client Tools PowerShell Session Detection'
  tag: attack.execution,attack.t1059.001,attack.defense-evasion,attack.t1127
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\smss\.exe$
- name: '[Sigma] Suspicious Child Process Of SQL Server'
  tag: attack.t1505.003,attack.t1190,attack.initial-access,attack.persistence,attack.privilege-escalation
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\sqlservr\.exe$
- name: '[Sigma] Suspicious Child Process Of SQL Server'
  tag: attack.t1505.003,attack.t1190,attack.initial-access,attack.persistence,attack.privilege-escalation
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\bash\.exe|\\bitsadmin\.exe|\\cmd\.exe|\\netstat\.exe|\\nltest\.exe|\\ping\.exe|\\powershell\.exe|\\pwsh\.exe|\\regsvr32\.exe|\\rundll32\.exe|\\sh\.exe|\\systeminfo\.exe|\\tasklist\.exe|\\wsl\.exe)$
- name: '[Sigma] Suspicious Child Process Of SQL Server'
  tag: attack.t1505.003,attack.t1190,attack.initial-access,attack.persistence,attack.privilege-escalation
  score: 80
  target: ParentPath
  condition: regex
  pattern: ^C:\\Program\ Files\\Microsoft\ SQL\ Server\\
- name: '[Sigma] Suspicious Child Process Of SQL Server'
  tag: attack.t1505.003,attack.t1190,attack.initial-access,attack.persistence,attack.privilege-escalation
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)DATEV_DBENGINE\\MSSQL\\Binn\\sqlservr\.exe$
- name: '[Sigma] Suspicious Child Process Of SQL Server'
  tag: attack.t1505.003,attack.t1190,attack.initial-access,attack.persistence,attack.privilege-escalation
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\cmd\.exe
- name: '[Sigma] Suspicious Child Process Of SQL Server'
  tag: attack.t1505.003,attack.t1190,attack.initial-access,attack.persistence,attack.privilege-escalation
  score: 80
  target: Target_Path
  condition: regex
  pattern: '^"C:\\Windows\\system32\\cmd\.exe"\ '
- name: '[Sigma] Suspicious Child Process Of Veeam Dabatase'
  tag: attack.initial-access,attack.persistence,attack.privilege-escalation
  score: 100
  target: ParentPath
  condition: regex
  pattern: (?i)\\sqlservr\.exe$
- name: '[Sigma] Suspicious Child Process Of Veeam Dabatase'
  tag: attack.initial-access,attack.persistence,attack.privilege-escalation
  score: 100
  target: Full_Path
  condition: regex
  pattern: (?i)VEEAMSQL
- name: '[Sigma] Suspicious Child Process Of Veeam Dabatase'
  tag: attack.initial-access,attack.persistence,attack.privilege-escalation
  score: 100
  target: Target_Path
  condition: regex
  pattern: (?i)(\\cmd\.exe|\\powershell\.exe|\\pwsh\.exe|\\wsl\.exe|\\wt\.exe)$
- name: '[Sigma] Suspicious Child Process Of Veeam Dabatase'
  tag: attack.initial-access,attack.persistence,attack.privilege-escalation
  score: 100
  target: Target_Path
  condition: regex
  pattern: (?i)(\-ex\ |bypass|cscript|DownloadString|http://|https://|mshta|regsvr32|rundll32|wscript|copy\
    )
- name: '[Sigma] Suspicious Child Process Of Veeam Dabatase'
  tag: attack.initial-access,attack.persistence,attack.privilege-escalation
  score: 100
  target: Target_Path
  condition: regex
  pattern: (?i)(\\net\.exe|\\net1\.exe|\\netstat\.exe|\\nltest\.exe|\\ping\.exe|\\tasklist\.exe|\\whoami\.exe)$
- name: '[Sigma] Potential MSTSC Shadowing Activity'
  tag: attack.lateral-movement,attack.t1563.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(noconsentprompt|shadow:)
- name: '[Sigma] New Remote Desktop Connection Initiated Via Mstsc.EXE'
  tag: attack.lateral-movement,attack.t1021.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\mstsc\.exe'\}|\{'OriginalFileName':\ 'mstsc\.exe'\})
- name: '[Sigma] New Remote Desktop Connection Initiated Via Mstsc.EXE'
  tag: attack.lateral-movement,attack.t1021.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ /v:'
- name: '[Sigma] New Remote Desktop Connection Initiated Via Mstsc.EXE'
  tag: attack.lateral-movement,attack.t1021.001
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\lxss\\wslhost\.exe
- name: '[Sigma] New Remote Desktop Connection Initiated Via Mstsc.EXE'
  tag: attack.lateral-movement,attack.t1021.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\ProgramData\\Microsoft\\WSL\\wslg\.rdp
- name: '[Sigma] Mstsc.EXE Execution With Local RDP File'
  tag: attack.command-and-control,attack.t1219.002
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\mstsc\.exe'\}|\{'OriginalFileName':\ 'mstsc\.exe'\})
- name: '[Sigma] Mstsc.EXE Execution With Local RDP File'
  tag: attack.command-and-control,attack.t1219.002
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(\.rdp|\.rdp")$
- name: '[Sigma] Mstsc.EXE Execution With Local RDP File'
  tag: attack.command-and-control,attack.t1219.002
  score: 20
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\lxss\\wslhost\.exe
- name: '[Sigma] Mstsc.EXE Execution With Local RDP File'
  tag: attack.command-and-control,attack.t1219.002
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\ProgramData\\Microsoft\\WSL\\wslg\.rdp
- name: '[Sigma] Suspicious Mstsc.EXE Execution With Local RDP File'
  tag: attack.command-and-control,attack.t1219.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\mstsc\.exe'\}|\{'OriginalFileName':\ 'mstsc\.exe'\})
- name: '[Sigma] Suspicious Mstsc.EXE Execution With Local RDP File'
  tag: attack.command-and-control,attack.t1219.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.rdp|\.rdp")$
- name: '[Sigma] Suspicious Mstsc.EXE Execution With Local RDP File'
  tag: attack.command-and-control,attack.t1219.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Users\\Public\\|:\\Windows\\System32\\spool\\drivers\\color|:\\Windows\\System32\\Tasks_Migrated\
    |:\\Windows\\Tasks\\|:\\Windows\\Temp\\|:\\Windows\\Tracing\\|\\AppData\\Local\\Temp\\|\\Downloads\\)
- name: '[Sigma] Mstsc.EXE Execution From Uncommon Parent'
  tag: attack.lateral-movement
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\brave\.exe|\\CCleanerBrowser\.exe|\\chrome\.exe|\\chromium\.exe|\\firefox\.exe|\\iexplore\.exe|\\microsoftedge\.exe|\\msedge\.exe|\\opera\.exe|\\vivaldi\.exe|\\whale\.exe|\\outlook\.exe)$
- name: '[Sigma] Mstsc.EXE Execution From Uncommon Parent'
  tag: attack.lateral-movement
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\mstsc\.exe'\}|\{'OriginalFileName':\ 'mstsc\.exe'\})
- name: '[Sigma] Msxsl.EXE Execution'
  tag: attack.defense-evasion,attack.t1220
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\msxsl\.exe$
- name: '[Sigma] Remote XSL Execution Via Msxsl.EXE'
  tag: attack.defense-evasion,attack.t1220
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\msxsl\.exe$
- name: '[Sigma] Remote XSL Execution Via Msxsl.EXE'
  tag: attack.defense-evasion,attack.t1220
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)http
- name: '[Sigma] New Firewall Rule Added Via Netsh.EXE'
  tag: attack.defense-evasion,attack.t1562.004,attack.s0246
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\netsh\.exe'\}|\{'OriginalFileName':\ 'netsh\.exe'\})
- name: '[Sigma] New Firewall Rule Added Via Netsh.EXE'
  tag: attack.defense-evasion,attack.t1562.004,attack.s0246
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ firewall\ |\ add\ )
- name: '[Sigma] New Firewall Rule Added Via Netsh.EXE'
  tag: attack.defense-evasion,attack.t1562.004,attack.s0246
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(advfirewall\ firewall\ add\ rule\ name=Dropbox\ dir=in\ action=allow\
    "program=.:\\Program\ Files\ \(x86\)\\Dropbox\\Client\\Dropbox\.exe"\ enable=yes\
    profile=Any|advfirewall\ firewall\ add\ rule\ name=Dropbox\ dir=in\ action=allow\
    "program=.:\\Program\ Files\\Dropbox\\Client\\Dropbox\.exe"\ enable=yes\ profile=Any)
- name: '[Sigma] Suspicious Program Location Whitelisted In Firewall Via Netsh.EXE'
  tag: attack.defense-evasion,attack.t1562.004
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\netsh\.exe'\}|\{'OriginalFileName':\ 'netsh\.exe'\})
- name: '[Sigma] Suspicious Program Location Whitelisted In Firewall Via Netsh.EXE'
  tag: attack.defense-evasion,attack.t1562.004
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains\|all':\ \['firewall',\ 'add',\ 'allowedprogram'\]\}|\{'CommandLine\|contains\|all':\
    \['advfirewall',\ 'firewall',\ 'add',\ 'rule',\ 'action=allow',\ 'program='\]\})
- name: '[Sigma] Suspicious Program Location Whitelisted In Firewall Via Netsh.EXE'
  tag: attack.defense-evasion,attack.t1562.004
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\\$Recycle\.bin\\|:\\RECYCLER\.BIN\\|:\\RECYCLERS\.BIN\\|:\\SystemVolumeInformation\\|:\\Temp\\|:\\Users\\Default\\|:\\Users\\Desktop\\|:\\Users\\Public\\|:\\Windows\\addins\\|:\\Windows\\cursors\\|:\\Windows\\debug\\|:\\Windows\\drivers\\|:\\Windows\\fonts\\|:\\Windows\\help\\|:\\Windows\\system32\\tasks\\|:\\Windows\\Tasks\\|:\\Windows\\Temp\\|\\Downloads\\|\\Local\
    Settings\\Temporary\ Internet\ Files\\|\\Temporary\ Internet\ Files\\Content\.Outlook\\|%Public%\\|%TEMP%|%TMP%)
- name: '[Sigma] RDP Connection Allowed Via Netsh.EXE'
  tag: attack.defense-evasion,attack.t1562.004
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\netsh\.exe'\}|\{'OriginalFileName':\ 'netsh\.exe'\})
- name: '[Sigma] RDP Connection Allowed Via Netsh.EXE'
  tag: attack.defense-evasion,attack.t1562.004
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(firewall\ |add\ |tcp\ |3389)
- name: '[Sigma] RDP Connection Allowed Via Netsh.EXE'
  tag: attack.defense-evasion,attack.t1562.004
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(portopening|allow)
- name: '[Sigma] Firewall Rule Deleted Via Netsh.EXE'
  tag: attack.defense-evasion,attack.t1562.004
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\netsh\.exe'\}|\{'OriginalFileName':\ 'netsh\.exe'\})
- name: '[Sigma] Firewall Rule Deleted Via Netsh.EXE'
  tag: attack.defense-evasion,attack.t1562.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(firewall|delete\ )
- name: '[Sigma] Firewall Rule Deleted Via Netsh.EXE'
  tag: attack.defense-evasion,attack.t1562.004
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\Dropbox\.exe$
- name: '[Sigma] Firewall Rule Deleted Via Netsh.EXE'
  tag: attack.defense-evasion,attack.t1562.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)name=Dropbox
- name: '[Sigma] Firewall Rule Deleted Via Netsh.EXE'
  tag: attack.defense-evasion,attack.t1562.004
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\instup\.exe$
- name: '[Sigma] Firewall Rule Deleted Via Netsh.EXE'
  tag: attack.defense-evasion,attack.t1562.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)advfirewall\ firewall\ delete\ rule\ name="Avast\ Antivirus\ Admin\
    Client"
- name: '[Sigma] Firewall Disabled via Netsh.EXE'
  tag: attack.defense-evasion,attack.t1562.004,attack.s0108
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\netsh\.exe'\}|\{'OriginalFileName':\ 'netsh\.exe'\})
- name: '[Sigma] Firewall Disabled via Netsh.EXE'
  tag: attack.defense-evasion,attack.t1562.004,attack.s0108
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(firewall|set|opmode|disable)
- name: '[Sigma] Firewall Disabled via Netsh.EXE'
  tag: attack.defense-evasion,attack.t1562.004,attack.s0108
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(advfirewall|set|state|off)
- name: '[Sigma] Netsh Allow Group Policy on Microsoft Defender Firewall'
  tag: attack.defense-evasion,attack.t1562.004
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\netsh\.exe'\}|\{'OriginalFileName':\ 'netsh\.exe'\})
- name: '[Sigma] Netsh Allow Group Policy on Microsoft Defender Firewall'
  tag: attack.defense-evasion,attack.t1562.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(advfirewall|firewall|set|rule|group=|new|enable=Yes)
- name: '[Sigma] Firewall Configuration Discovery Via Netsh.EXE'
  tag: attack.discovery,attack.t1016
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\netsh\.exe'\}|\{'OriginalFileName':\ 'netsh\.exe'\})
- name: '[Sigma] Firewall Configuration Discovery Via Netsh.EXE'
  tag: attack.discovery,attack.t1016
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(netsh|show\ |firewall\ )
- name: '[Sigma] Firewall Configuration Discovery Via Netsh.EXE'
  tag: attack.discovery,attack.t1016
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(config\ |state\ |rule\ |name=all)
- name: '[Sigma] Firewall Rule Update Via Netsh.EXE'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\netsh\.exe'\}|\{'OriginalFileName':\ 'netsh\.exe'\})
- name: '[Sigma] Firewall Rule Update Via Netsh.EXE'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ firewall\ |\ set\ )
- name: '[Sigma] Potential Persistence Via Netsh Helper DLL'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.007,attack.s0108
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'netsh\.exe'\}|\{'Image\|endswith':\ '\\\\netsh\.exe'\})
- name: '[Sigma] Potential Persistence Via Netsh Helper DLL'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.007,attack.s0108
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(add|helper)
- name: '[Sigma] New Network Trace Capture Started Via Netsh.EXE'
  tag: attack.discovery,attack.credential-access,attack.t1040
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\netsh\.exe'\}|\{'OriginalFileName':\ 'netsh\.exe'\})
- name: '[Sigma] New Network Trace Capture Started Via Netsh.EXE'
  tag: attack.discovery,attack.credential-access,attack.t1040
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(trace|start)
- name: '[Sigma] New Port Forwarding Rule Added Via Netsh.EXE'
  tag: attack.lateral-movement,attack.defense-evasion,attack.command-and-control,attack.t1090
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\netsh\.exe'\}|\{'OriginalFileName':\ 'netsh\.exe'\})
- name: '[Sigma] New Port Forwarding Rule Added Via Netsh.EXE'
  tag: attack.lateral-movement,attack.defense-evasion,attack.command-and-control,attack.t1090
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(interface|portproxy|add|v4tov4)
- name: '[Sigma] New Port Forwarding Rule Added Via Netsh.EXE'
  tag: attack.lateral-movement,attack.defense-evasion,attack.command-and-control,attack.t1090
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(i\ |p\ |a\ |v\ )
- name: '[Sigma] New Port Forwarding Rule Added Via Netsh.EXE'
  tag: attack.lateral-movement,attack.defense-evasion,attack.command-and-control,attack.t1090
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(connectp|listena|c=)
- name: '[Sigma] RDP Port Forwarding Rule Added Via Netsh.EXE'
  tag: attack.lateral-movement,attack.defense-evasion,attack.command-and-control,attack.t1090
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\netsh\.exe'\}|\{'OriginalFileName':\ 'netsh\.exe'\})
- name: '[Sigma] RDP Port Forwarding Rule Added Via Netsh.EXE'
  tag: attack.lateral-movement,attack.defense-evasion,attack.command-and-control,attack.t1090
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ i|\ p|=3389|\ c)
- name: '[Sigma] Harvesting Of Wifi Credentials Via Netsh.EXE'
  tag: attack.discovery,attack.credential-access,attack.t1040
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\netsh\.exe'\}|\{'OriginalFileName':\ 'netsh\.exe'\})
- name: '[Sigma] Harvesting Of Wifi Credentials Via Netsh.EXE'
  tag: attack.discovery,attack.credential-access,attack.t1040
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(wlan|\ s|\ p|\ k|=clear)
- name: '[Sigma] Suspicious Group And Account Reconnaissance Activity Using Net.EXE'
  tag: attack.discovery,attack.t1087.001,attack.t1087.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\net\.exe',\ '\\\\net1\.exe'\]\}|\{'OriginalFileName':\
    \['net\.exe',\ 'net1\.exe'\]\})
- name: '[Sigma] Suspicious Group And Account Reconnaissance Activity Using Net.EXE'
  tag: attack.discovery,attack.t1087.001,attack.t1087.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ group\ |\ localgroup\ )
- name: '[Sigma] Suspicious Group And Account Reconnaissance Activity Using Net.EXE'
  tag: attack.discovery,attack.t1087.001,attack.t1087.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(domain\ admins|\ administrator|\ administrateur|enterprise\ admins|Exchange\
    Trusted\ Subsystem|Remote\ Desktop\ Users|Utilisateurs\ du\ Bureau\ \ distance|Usuarios\
    de\ escritorio\ remoto|\ /do)
- name: '[Sigma] Suspicious Group And Account Reconnaissance Activity Using Net.EXE'
  tag: attack.discovery,attack.t1087.001,attack.t1087.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ /add
- name: '[Sigma] Suspicious Group And Account Reconnaissance Activity Using Net.EXE'
  tag: attack.discovery,attack.t1087.001,attack.t1087.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ accounts\ '
- name: '[Sigma] Suspicious Group And Account Reconnaissance Activity Using Net.EXE'
  tag: attack.discovery,attack.t1087.001,attack.t1087.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ /do
- name: '[Sigma] Unmount Share Via Net.EXE'
  tag: attack.defense-evasion,attack.t1070.005
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\net\.exe',\ '\\\\net1\.exe'\]\}|\{'OriginalFileName':\
    \['net\.exe',\ 'net1\.exe'\]\})
- name: '[Sigma] Unmount Share Via Net.EXE'
  tag: attack.defense-evasion,attack.t1070.005
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(share|/delete)
- name: '[Sigma] Start Windows Service Via Net.EXE'
  tag: attack.execution,attack.t1569.002
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\net\.exe',\ '\\\\net1\.exe'\]\}|\{'OriginalFileName':\
    \['net\.exe',\ 'net1\.exe'\]\})
- name: '[Sigma] Start Windows Service Via Net.EXE'
  tag: attack.execution,attack.t1569.002
  score: 20
  target: Target_Path
  condition: regex
  pattern: '(?i)\ start\ '
- name: '[Sigma] Stop Windows Service Via Net.EXE'
  tag: attack.impact,attack.t1489
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ \['net\.exe',\ 'net1\.exe'\]\}|\{'Image\|endswith':\
    \['\\\\net\.exe',\ '\\\\net1\.exe'\]\})
- name: '[Sigma] Stop Windows Service Via Net.EXE'
  tag: attack.impact,attack.t1489
  score: 20
  target: Target_Path
  condition: regex
  pattern: '(?i)\ stop\ '
- name: '[Sigma] New User Created Via Net.EXE'
  tag: attack.persistence,attack.t1136.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\net\.exe',\ '\\\\net1\.exe'\]\}|\{'OriginalFileName':\
    \['net\.exe',\ 'net1\.exe'\]\})
- name: '[Sigma] New User Created Via Net.EXE'
  tag: attack.persistence,attack.t1136.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(user|add)
- name: '[Sigma] New User Created Via Net.EXE With Never Expire Option'
  tag: attack.persistence,attack.t1136.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\net\.exe',\ '\\\\net1\.exe'\]\}|\{'OriginalFileName':\
    \['net\.exe',\ 'net1\.exe'\]\})
- name: '[Sigma] New User Created Via Net.EXE With Never Expire Option'
  tag: attack.persistence,attack.t1136.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(user|add|expires:never)
- name: '[Sigma] Suspicious Manipulation Of Default Accounts Via Net.EXE'
  tag: attack.collection,attack.t1560.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\net\.exe',\ '\\\\net1\.exe'\]\}|\{'OriginalFileName':\
    \['net\.exe',\ 'net1\.exe'\]\})
- name: '[Sigma] Suspicious Manipulation Of Default Accounts Via Net.EXE'
  tag: attack.collection,attack.t1560.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ user\ '
- name: '[Sigma] Suspicious Manipulation Of Default Accounts Via Net.EXE'
  tag: attack.collection,attack.t1560.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ Jrjestelmnvalvoja\ |\ Rendszergazda\ |\ \ |\ Administrateur\
    |\ Administrador\ |\ Administratr\ |\ Administrator\ |\ guest\ |\ DefaultAccount\
    |\ "Jrjestelmnvalvoja"\ |\ "Rendszergazda"\ |\ ""\ |\ "Administrateur"\
    |\ "Administrador"\ |\ "Administratr"\ |\ "Administrator"\ |\ "guest"\ |\ "DefaultAccount"\
    |\ 'Jrjestelmnvalvoja'\ |\ 'Rendszergazda'\ |\ ''\ |\ 'Administrateur'\
    |\ 'Administrador'\ |\ 'Administratr'\ |\ 'Administrator'\ |\ 'guest'\ |\ 'DefaultAccount'\
    )
- name: '[Sigma] Suspicious Manipulation Of Default Accounts Via Net.EXE'
  tag: attack.collection,attack.t1560.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(guest|/active\ no)
- name: '[Sigma] Windows Admin Share Mount Via Net.EXE'
  tag: attack.lateral-movement,attack.t1021.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\net\.exe',\ '\\\\net1\.exe'\]\}|\{'OriginalFileName':\
    \['net\.exe',\ 'net1\.exe'\]\})
- name: '[Sigma] Windows Admin Share Mount Via Net.EXE'
  tag: attack.lateral-movement,attack.t1021.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ use\ |\ \\\\\\\\.*\\\\.*\$)
- name: '[Sigma] Windows Internet Hosted WebDav Share Mount Via Net.EXE'
  tag: attack.lateral-movement,attack.t1021.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\net\.exe',\ '\\\\net1\.exe'\]\}|\{'OriginalFileName':\
    \['net\.exe',\ 'net1\.exe'\]\})
- name: '[Sigma] Windows Internet Hosted WebDav Share Mount Via Net.EXE'
  tag: attack.lateral-movement,attack.t1021.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ use\ |\ http)
- name: '[Sigma] Windows Share Mount Via Net.EXE'
  tag: attack.lateral-movement,attack.t1021.002
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\net\.exe',\ '\\\\net1\.exe'\]\}|\{'OriginalFileName':\
    \['net\.exe',\ 'net1\.exe'\]\})
- name: '[Sigma] Windows Share Mount Via Net.EXE'
  tag: attack.lateral-movement,attack.t1021.002
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(\ use\ |\ \\\\\\\\)
- name: '[Sigma] System Network Connections Discovery Via Net.EXE'
  tag: attack.discovery,attack.t1049
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\net\.exe',\ '\\\\net1\.exe'\]\}|\{'OriginalFileName':\
    \['net\.exe',\ 'net1\.exe'\]\})
- name: '[Sigma] System Network Connections Discovery Via Net.EXE'
  tag: attack.discovery,attack.t1049
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|endswith':\ \['\ use',\ '\ sessions'\]\}|\{'CommandLine\|contains':\
    \['\ use\ ',\ '\ sessions\ '\]\})
- name: '[Sigma] Password Provided In Command Line Of Net.EXE'
  tag: attack.defense-evasion,attack.initial-access,attack.persistence,attack.privilege-escalation,attack.lateral-movement,attack.t1021.002,attack.t1078
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\net\.exe',\ '\\\\net1\.exe'\]\}|\{'OriginalFileName':\
    \['net\.exe',\ 'net1\.exe'\]\})
- name: '[Sigma] Password Provided In Command Line Of Net.EXE'
  tag: attack.defense-evasion,attack.initial-access,attack.persistence,attack.privilege-escalation,attack.lateral-movement,attack.t1021.002,attack.t1078
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ use\ |:.*\\\\|/USER:.*\ .*)
- name: '[Sigma] Password Provided In Command Line Of Net.EXE'
  tag: attack.defense-evasion,attack.initial-access,attack.persistence,attack.privilege-escalation,attack.lateral-movement,attack.t1021.002,attack.t1078
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ $
- name: '[Sigma] Share And Session Enumeration Using Net.EXE'
  tag: attack.discovery,attack.t1018
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\net\.exe',\ '\\\\net1\.exe'\]\}|\{'OriginalFileName':\
    \['net\.exe',\ 'net1\.exe'\]\})
- name: '[Sigma] Share And Session Enumeration Using Net.EXE'
  tag: attack.discovery,attack.t1018
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)view
- name: '[Sigma] Share And Session Enumeration Using Net.EXE'
  tag: attack.discovery,attack.t1018
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)\\\\\\\\
- name: '[Sigma] Nltest.EXE Execution'
  tag: attack.discovery,attack.t1016,attack.t1018,attack.t1482
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\nltest\.exe'\}|\{'OriginalFileName':\ 'nltestrk\.exe'\})
- name: '[Sigma] Potential Recon Activity Via Nltest.EXE'
  tag: attack.discovery,attack.t1016,attack.t1482
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\nltest\.exe'\}|\{'OriginalFileName':\ 'nltestrk\.exe'\})
- name: '[Sigma] Potential Recon Activity Via Nltest.EXE'
  tag: attack.discovery,attack.t1016,attack.t1482
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains\|all':\ \['server',\ 'query'\]\}|\{'CommandLine\|contains':\
    \['/user',\ 'all_trusts',\ 'dclist:',\ 'dnsgetdc:',\ 'domain_trusts',\ 'dsgetdc:',\
    'parentdomain',\ 'trusted_domains'\]\})
- name: '[Sigma] Potential Arbitrary Code Execution Via Node.EXE'
  tag: attack.defense-evasion,attack.t1127
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\node\.exe$
- name: '[Sigma] Potential Arbitrary Code Execution Via Node.EXE'
  tag: attack.defense-evasion,attack.t1127
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-e\ |\ \-\-eval\ )
- name: '[Sigma] Potential Arbitrary Code Execution Via Node.EXE'
  tag: attack.defense-evasion,attack.t1127
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.exec\(|net\.socket|\.connect|child_process)
- name: '[Sigma] Node Process Executions'
  tag: attack.defense-evasion,attack.execution,attack.t1127,attack.t1059.007
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\Adobe\ Creative\ Cloud\ Experience\\libs\\node\.exe$
- name: '[Sigma] Node Process Executions'
  tag: attack.defense-evasion,attack.execution,attack.t1127,attack.t1059.007
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)Adobe\ Creative\ Cloud\ Experience\\js
- name: '[Sigma] Network Reconnaissance Activity'
  tag: attack.discovery,attack.t1087,attack.t1082,car.2016-03-001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(nslookup|_ldap\._tcp\.dc\._msdcs\.)
- name: '[Sigma] Nslookup PowerShell Download Cradle - ProcessCreation'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|contains':\ '\\\\nslookup\.exe'\}|\{'OriginalFileName':\
    '\\\\nslookup\.exe'\})
- name: '[Sigma] Nslookup PowerShell Download Cradle - ProcessCreation'
  tag: attack.defense-evasion
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\pwsh\.exe)$
- name: '[Sigma] Nslookup PowerShell Download Cradle - ProcessCreation'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-q=txt\ |\ \-querytype=txt\ )
- name: '[Sigma] Suspicious Usage Of Active Directory Diagnostic Tool (ntdsutil.exe)'
  tag: attack.credential-access,attack.t1003.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\ntdsutil\.exe'\}|\{'OriginalFileName':\
    'ntdsutil\.exe'\})
- name: '[Sigma] Suspicious Usage Of Active Directory Diagnostic Tool (ntdsutil.exe)'
  tag: attack.credential-access,attack.t1003.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains\|all':\ \['snapshot',\ 'mount\ '\]\}|\{'CommandLine\|contains\|all':\
    \['ac',\ '\ i',\ '\ ntds'\]\})
- name: '[Sigma] Invocation of Active Directory Diagnostic Tool (ntdsutil.exe)'
  tag: attack.credential-access,attack.t1003.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\ntdsutil\.exe$
- name: '[Sigma] Driver/DLL Installation Via Odbcconf.EXE'
  tag: attack.defense-evasion,attack.t1218.008
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\odbcconf\.exe'\}|\{'OriginalFileName':\
    'odbcconf\.exe'\})
- name: '[Sigma] Driver/DLL Installation Via Odbcconf.EXE'
  tag: attack.defense-evasion,attack.t1218.008
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(INSTALLDRIVER\ |\.dll)
- name: '[Sigma] Suspicious Driver/DLL Installation Via Odbcconf.EXE'
  tag: attack.defense-evasion,attack.t1218.008
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\odbcconf\.exe'\}|\{'OriginalFileName':\
    'odbcconf\.exe'\})
- name: '[Sigma] Suspicious Driver/DLL Installation Via Odbcconf.EXE'
  tag: attack.defense-evasion,attack.t1218.008
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)INSTALLDRIVER\ '
- name: '[Sigma] Suspicious Driver/DLL Installation Via Odbcconf.EXE'
  tag: attack.defense-evasion,attack.t1218.008
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\.dll
- name: '[Sigma] Odbcconf.EXE Suspicious DLL Location'
  tag: attack.defense-evasion,attack.t1218.008
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\odbcconf\.exe'\}|\{'OriginalFileName':\
    'odbcconf\.exe'\})
- name: '[Sigma] Odbcconf.EXE Suspicious DLL Location'
  tag: attack.defense-evasion,attack.t1218.008
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\PerfLogs\\|:\\ProgramData\\|:\\Temp\\|:\\Users\\Public\\|:\\Windows\\Registration\\CRMLog|:\\Windows\\System32\\com\\dmp\\|:\\Windows\\System32\\FxsTmp\\|:\\Windows\\System32\\Microsoft\\Crypto\\RSA\\MachineKeys\\|:\\Windows\\System32\\spool\\drivers\\color\\|:\\Windows\\System32\\spool\\PRINTERS\\|:\\Windows\\System32\\spool\\SERVERS\\|:\\Windows\\System32\\Tasks_Migrated\\|:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\SyncCenter\\|:\\Windows\\SysWOW64\\com\\dmp\\|:\\Windows\\SysWOW64\\FxsTmp\\|:\\Windows\\SysWOW64\\Tasks\\Microsoft\\Windows\\PLA\\System\\|:\\Windows\\SysWOW64\\Tasks\\Microsoft\\Windows\\SyncCenter\\|:\\Windows\\Tasks\\|:\\Windows\\Temp\\|:\\Windows\\Tracing\\|\\AppData\\Local\\Temp\\|\\AppData\\Roaming\\)
- name: '[Sigma] New DLL Registered Via Odbcconf.EXE'
  tag: attack.defense-evasion,attack.t1218.008
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\odbcconf\.exe'\}|\{'OriginalFileName':\
    'odbcconf\.exe'\})
- name: '[Sigma] New DLL Registered Via Odbcconf.EXE'
  tag: attack.defense-evasion,attack.t1218.008
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(REGSVR\ |\.dll)
- name: '[Sigma] Potentially Suspicious DLL Registered Via Odbcconf.EXE'
  tag: attack.defense-evasion,attack.t1218.008
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\odbcconf\.exe'\}|\{'OriginalFileName':\
    'odbcconf\.exe'\})
- name: '[Sigma] Potentially Suspicious DLL Registered Via Odbcconf.EXE'
  tag: attack.defense-evasion,attack.t1218.008
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)REGSVR\ '
- name: '[Sigma] Potentially Suspicious DLL Registered Via Odbcconf.EXE'
  tag: attack.defense-evasion,attack.t1218.008
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\.dll
- name: '[Sigma] Response File Execution Via Odbcconf.EXE'
  tag: attack.defense-evasion,attack.t1218.008
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\odbcconf\.exe'\}|\{'OriginalFileName':\
    'odbcconf\.exe'\})
- name: '[Sigma] Response File Execution Via Odbcconf.EXE'
  tag: attack.defense-evasion,attack.t1218.008
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-f\ '
- name: '[Sigma] Response File Execution Via Odbcconf.EXE'
  tag: attack.defense-evasion,attack.t1218.008
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\.rsp
- name: '[Sigma] Suspicious Response File Execution Via Odbcconf.EXE'
  tag: attack.defense-evasion,attack.t1218.008
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\odbcconf\.exe'\}|\{'OriginalFileName':\
    'odbcconf\.exe'\})
- name: '[Sigma] Suspicious Response File Execution Via Odbcconf.EXE'
  tag: attack.defense-evasion,attack.t1218.008
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-f\ '
- name: '[Sigma] Suspicious Response File Execution Via Odbcconf.EXE'
  tag: attack.defense-evasion,attack.t1218.008
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\.rsp
- name: '[Sigma] Suspicious Response File Execution Via Odbcconf.EXE'
  tag: attack.defense-evasion,attack.t1218.008
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\runonce\.exe
- name: '[Sigma] Suspicious Response File Execution Via Odbcconf.EXE'
  tag: attack.defense-evasion,attack.t1218.008
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\odbcconf\.exe
- name: '[Sigma] Suspicious Response File Execution Via Odbcconf.EXE'
  tag: attack.defense-evasion,attack.t1218.008
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\.exe\ /E\ /F\ "C:\\WINDOWS\\system32\\odbcconf\.tmp"
- name: '[Sigma] Uncommon Child Process Spawned By Odbcconf.EXE'
  tag: attack.defense-evasion,attack.t1218.008
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\odbcconf\.exe$
- name: '[Sigma] Potential Arbitrary File Download Using Office Application'
  tag: attack.defense-evasion,attack.t1202
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\EXCEL\.EXE',\ '\\\\POWERPNT\.EXE',\ '\\\\WINWORD\.exe'\]\}|\{'OriginalFileName':\
    \['Excel\.exe',\ 'POWERPNT\.EXE',\ 'WinWord\.exe'\]\})
- name: '[Sigma] Potential Arbitrary File Download Using Office Application'
  tag: attack.defense-evasion,attack.t1202
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(http://|https://)
- name: '[Sigma] Potential Excel.EXE DCOM Lateral Movement Via ActivateMicrosoftApp'
  tag: attack.t1021.003,attack.lateral-movement
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\excel\.exe$
- name: '[Sigma] Potential Excel.EXE DCOM Lateral Movement Via ActivateMicrosoftApp'
  tag: attack.t1021.003,attack.lateral-movement
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ \['foxprow\.exe',\ 'schdplus\.exe',\ 'winproj\.exe'\]\}|\{'Image\|endswith':\
    \['\\\\foxprow\.exe',\ '\\\\schdplus\.exe',\ '\\\\winproj\.exe'\]\})
- name: '[Sigma] Potentially Suspicious Office Document Executed From Trusted Location'
  tag: attack.defense-evasion,attack.t1202
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\explorer\.exe|\\dopus\.exe)$
- name: '[Sigma] Potentially Suspicious Office Document Executed From Trusted Location'
  tag: attack.defense-evasion,attack.t1202
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\EXCEL\.EXE',\ '\\\\POWERPNT\.EXE',\ '\\\\WINWORD\.exe'\]\}|\{'OriginalFileName':\
    \['Excel\.exe',\ 'POWERPNT\.EXE',\ 'WinWord\.exe'\]\})
- name: '[Sigma] Potentially Suspicious Office Document Executed From Trusted Location'
  tag: attack.defense-evasion,attack.t1202
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\AppData\\Roaming\\Microsoft\\Templates|\\AppData\\Roaming\\Microsoft\\Word\\Startup\\|\\Microsoft\
    Office\\root\\Templates\\|\\Microsoft\ Office\\Templates\\)
- name: '[Sigma] Potentially Suspicious Office Document Executed From Trusted Location'
  tag: attack.defense-evasion,attack.t1202
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.dotx|\.xltx|\.potx)$
- name: '[Sigma] OneNote.EXE Execution of Malicious Embedded Scripts'
  tag: attack.defense-evasion,attack.t1218.001
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\onenote\.exe$
- name: '[Sigma] OneNote.EXE Execution of Malicious Embedded Scripts'
  tag: attack.defense-evasion,attack.t1218.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\cmd\.exe|\\cscript\.exe|\\mshta\.exe|\\powershell\.exe|\\pwsh\.exe|\\wscript\.exe)$
- name: '[Sigma] OneNote.EXE Execution of Malicious Embedded Scripts'
  tag: attack.defense-evasion,attack.t1218.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\exported\\|\\onenoteofflinecache_files\\)
- name: '[Sigma] Suspicious Microsoft OneNote Child Process'
  tag: attack.t1566,attack.t1566.001,attack.initial-access
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\onenote\.exe$
- name: '[Sigma] Suspicious Microsoft OneNote Child Process'
  tag: attack.t1566,attack.t1566.001,attack.initial-access
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ \['bitsadmin\.exe',\ 'CertOC\.exe',\ 'CertUtil\.exe',\
    'Cmd\.Exe',\ 'CMSTP\.EXE',\ 'cscript\.exe',\ 'curl\.exe',\ 'HH\.exe',\ 'IEExec\.exe',\
    'InstallUtil\.exe',\ 'javaw\.exe',\ 'Microsoft\.Workflow\.Compiler\.exe',\ 'msdt\.exe',\
    'MSHTA\.EXE',\ 'msiexec\.exe',\ 'Msxsl\.exe',\ 'odbcconf\.exe',\ 'pcalua\.exe',\
    'PowerShell\.EXE',\ 'RegAsm\.exe',\ 'RegSvcs\.exe',\ 'REGSVR32\.exe',\ 'RUNDLL32\.exe',\
    'schtasks\.exe',\ 'ScriptRunner\.exe',\ 'wmic\.exe',\ 'WorkFolders\.exe',\ 'wscript\.exe'\]\}|\{'Image\|endswith':\
    \['\\\\AppVLP\.exe',\ '\\\\bash\.exe',\ '\\\\bitsadmin\.exe',\ '\\\\certoc\.exe',\
    '\\\\certutil\.exe',\ '\\\\cmd\.exe',\ '\\\\cmstp\.exe',\ '\\\\control\.exe',\
    '\\\\cscript\.exe',\ '\\\\curl\.exe',\ '\\\\forfiles\.exe',\ '\\\\hh\.exe',\ '\\\\ieexec\.exe',\
    '\\\\installutil\.exe',\ '\\\\javaw\.exe',\ '\\\\mftrace\.exe',\ '\\\\Microsoft\.Workflow\.Compiler\.exe',\
    '\\\\msbuild\.exe',\ '\\\\msdt\.exe',\ '\\\\mshta\.exe',\ '\\\\msidb\.exe',\ '\\\\msiexec\.exe',\
    '\\\\msxsl\.exe',\ '\\\\odbcconf\.exe',\ '\\\\pcalua\.exe',\ '\\\\powershell\.exe',\
    '\\\\pwsh\.exe',\ '\\\\regasm\.exe',\ '\\\\regsvcs\.exe',\ '\\\\regsvr32\.exe',\
    '\\\\rundll32\.exe',\ '\\\\schtasks\.exe',\ '\\\\scrcons\.exe',\ '\\\\scriptrunner\.exe',\
    '\\\\sh\.exe',\ '\\\\svchost\.exe',\ '\\\\verclsid\.exe',\ '\\\\wmic\.exe',\ '\\\\workfolders\.exe',\
    '\\\\wscript\.exe'\]\})
- name: '[Sigma] Suspicious Microsoft OneNote Child Process'
  tag: attack.t1566,attack.t1566.001,attack.initial-access
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\explorer\.exe$
- name: '[Sigma] Suspicious Microsoft OneNote Child Process'
  tag: attack.t1566,attack.t1566.001,attack.initial-access
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.hta|\.vb|\.wsh|\.js|\.ps|\.scr|\.pif|\.bat|\.cmd)
- name: '[Sigma] Suspicious Microsoft OneNote Child Process'
  tag: attack.t1566,attack.t1566.001,attack.initial-access
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\AppData\\|\\Users\\Public\\|\\ProgramData\\|\\Windows\\Tasks\\|\\Windows\\Temp\\|\\Windows\\System32\\Tasks\\)
- name: '[Sigma] Suspicious Microsoft OneNote Child Process'
  tag: attack.t1566,attack.t1566.001,attack.initial-access
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\AppData\\Local\\Microsoft\\Teams\\current\\Teams\.exe$
- name: '[Sigma] Suspicious Microsoft OneNote Child Process'
  tag: attack.t1566,attack.t1566.001,attack.initial-access
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\-Embedding$
- name: '[Sigma] Suspicious Microsoft OneNote Child Process'
  tag: attack.t1566,attack.t1566.001,attack.initial-access
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\AppData\\Local\\Microsoft\\OneDrive\\
- name: '[Sigma] Suspicious Microsoft OneNote Child Process'
  tag: attack.t1566,attack.t1566.001,attack.initial-access
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\FileCoAuth\.exe$
- name: '[Sigma] Suspicious Microsoft OneNote Child Process'
  tag: attack.t1566,attack.t1566.001,attack.initial-access
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\-Embedding$
- name: '[Sigma] Outlook EnableUnsafeClientMailRules Setting Enabled'
  tag: attack.execution,attack.defense-evasion,attack.t1059,attack.t1202
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\Outlook\\Security\\EnableUnsafeClientMailRules
- name: '[Sigma] Suspicious Execution From Outlook Temporary Folder'
  tag: attack.initial-access,attack.t1566.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\Temporary\ Internet\ Files\\Content\.Outlook\\
- name: '[Sigma] Suspicious Outlook Child Process'
  tag: attack.execution,attack.t1204.002
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\OUTLOOK\.EXE$
- name: '[Sigma] Suspicious Outlook Child Process'
  tag: attack.execution,attack.t1204.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\AppVLP\.exe|\\bash\.exe|\\cmd\.exe|\\cscript\.exe|\\forfiles\.exe|\\hh\.exe|\\mftrace\.exe|\\msbuild\.exe|\\msdt\.exe|\\mshta\.exe|\\msiexec\.exe|\\powershell\.exe|\\pwsh\.exe|\\regsvr32\.exe|\\schtasks\.exe|\\scrcons\.exe|\\scriptrunner\.exe|\\sh\.exe|\\svchost\.exe|\\wmic\.exe|\\wscript\.exe)$
- name: '[Sigma] Suspicious Remote Child Process From Outlook'
  tag: attack.execution,attack.defense-evasion,attack.t1059,attack.t1202
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\outlook\.exe$
- name: '[Sigma] Suspicious Remote Child Process From Outlook'
  tag: attack.execution,attack.defense-evasion,attack.t1059,attack.t1202
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^\\\\\\\\
- name: '[Sigma] Suspicious Binary In User Directory Spawned From Office Application'
  tag: attack.execution,attack.t1204.002,attack.g0046,car.2013-05-002
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\WINWORD\.EXE|\\EXCEL\.EXE|\\POWERPNT\.exe|\\MSPUB\.exe|\\VISIO\.exe|\\MSACCESS\.exe|\\EQNEDT32\.exe)$
- name: '[Sigma] Suspicious Binary In User Directory Spawned From Office Application'
  tag: attack.execution,attack.t1204.002,attack.g0046,car.2013-05-002
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^C:\\users\\
- name: '[Sigma] Suspicious Binary In User Directory Spawned From Office Application'
  tag: attack.execution,attack.t1204.002,attack.g0046,car.2013-05-002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\.exe$
- name: '[Sigma] Suspicious Binary In User Directory Spawned From Office Application'
  tag: attack.execution,attack.t1204.002,attack.g0046,car.2013-05-002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\Teams\.exe$
- name: '[Sigma] Suspicious Microsoft Office Child Process'
  tag: attack.defense-evasion,attack.execution,attack.t1047,attack.t1204.002,attack.t1218.010
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\EQNEDT32\.EXE|\\EXCEL\.EXE|\\MSACCESS\.EXE|\\MSPUB\.exe|\\ONENOTE\.EXE|\\POWERPNT\.exe|\\VISIO\.exe|\\WINWORD\.EXE|\\wordpad\.exe|\\wordview\.exe)$
- name: '[Sigma] Suspicious Microsoft Office Child Process'
  tag: attack.defense-evasion,attack.execution,attack.t1047,attack.t1204.002,attack.t1218.010
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ \['bitsadmin\.exe',\ 'CertOC\.exe',\ 'CertUtil\.exe',\
    'Cmd\.Exe',\ 'CMSTP\.EXE',\ 'cscript\.exe',\ 'curl\.exe',\ 'HH\.exe',\ 'IEExec\.exe',\
    'InstallUtil\.exe',\ 'javaw\.exe',\ 'Microsoft\.Workflow\.Compiler\.exe',\ 'msdt\.exe',\
    'MSHTA\.EXE',\ 'msiexec\.exe',\ 'Msxsl\.exe',\ 'odbcconf\.exe',\ 'pcalua\.exe',\
    'PowerShell\.EXE',\ 'RegAsm\.exe',\ 'RegSvcs\.exe',\ 'REGSVR32\.exe',\ 'RUNDLL32\.exe',\
    'schtasks\.exe',\ 'ScriptRunner\.exe',\ 'wmic\.exe',\ 'WorkFolders\.exe',\ 'wscript\.exe'\]\}|\{'Image\|endswith':\
    \['\\\\AppVLP\.exe',\ '\\\\bash\.exe',\ '\\\\bitsadmin\.exe',\ '\\\\certoc\.exe',\
    '\\\\certutil\.exe',\ '\\\\cmd\.exe',\ '\\\\cmstp\.exe',\ '\\\\control\.exe',\
    '\\\\cscript\.exe',\ '\\\\curl\.exe',\ '\\\\forfiles\.exe',\ '\\\\hh\.exe',\ '\\\\ieexec\.exe',\
    '\\\\installutil\.exe',\ '\\\\javaw\.exe',\ '\\\\mftrace\.exe',\ '\\\\Microsoft\.Workflow\.Compiler\.exe',\
    '\\\\msbuild\.exe',\ '\\\\msdt\.exe',\ '\\\\mshta\.exe',\ '\\\\msidb\.exe',\ '\\\\msiexec\.exe',\
    '\\\\msxsl\.exe',\ '\\\\odbcconf\.exe',\ '\\\\pcalua\.exe',\ '\\\\powershell\.exe',\
    '\\\\pwsh\.exe',\ '\\\\regasm\.exe',\ '\\\\regsvcs\.exe',\ '\\\\regsvr32\.exe',\
    '\\\\rundll32\.exe',\ '\\\\schtasks\.exe',\ '\\\\scrcons\.exe',\ '\\\\scriptrunner\.exe',\
    '\\\\sh\.exe',\ '\\\\svchost\.exe',\ '\\\\verclsid\.exe',\ '\\\\wmic\.exe',\ '\\\\workfolders\.exe',\
    '\\\\wscript\.exe'\]\})
- name: '[Sigma] Suspicious Microsoft Office Child Process'
  tag: attack.defense-evasion,attack.execution,attack.t1047,attack.t1204.002,attack.t1218.010
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\AppData\\|\\Users\\Public\\|\\ProgramData\\|\\Windows\\Tasks\\|\\Windows\\Temp\\|\\Windows\\System32\\Tasks\\)
- name: '[Sigma] Potential Arbitrary DLL Load Using Winword'
  tag: attack.defense-evasion,attack.t1202
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\WINWORD\.exe'\}|\{'OriginalFileName':\
    'WinWord\.exe'\})
- name: '[Sigma] Potential Arbitrary DLL Load Using Winword'
  tag: attack.defense-evasion,attack.t1202
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/l\ |\.dll)
- name: '[Sigma] Potential Mpclient.DLL Sideloading Via OfflineScannerShell.EXE Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\OfflineScannerShell\.exe'\}|\{'OriginalFileName':\
    'OfflineScannerShell\.exe'\})
- name: '[Sigma] Potential Mpclient.DLL Sideloading Via OfflineScannerShell.EXE Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)C:\\Program\ Files\\Windows\ Defender\\Offline\\
- name: '[Sigma] Potential Mpclient.DLL Sideloading Via OfflineScannerShell.EXE Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)
- name: '[Sigma] Potential Mpclient.DLL Sideloading Via OfflineScannerShell.EXE Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: None
- name: '[Sigma] PDQ Deploy Remote Adminstartion Tool Execution'
  tag: attack.execution,attack.lateral-movement,attack.t1072
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Description':\ 'PDQ\ Deploy\ Console'\}|\{'Product':\ 'PDQ\ Deploy'\}|\{'Company':\
    'PDQ\.com'\}|\{'OriginalFileName':\ 'PDQDeployConsole\.exe'\})
- name: '[Sigma] Potentially Suspicious Execution Of PDQDeployRunner'
  tag: attack.execution
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\PDQDeployRunner\-
- name: '[Sigma] Potentially Suspicious Execution Of PDQDeployRunner'
  tag: attack.execution
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\bash\.exe',\ '\\\\certutil\.exe',\ '\\\\cmd\.exe',\
    '\\\\csc\.exe',\ '\\\\cscript\.exe',\ '\\\\dllhost\.exe',\ '\\\\mshta\.exe',\
    '\\\\msiexec\.exe',\ '\\\\regsvr32\.exe',\ '\\\\rundll32\.exe',\ '\\\\scriptrunner\.exe',\
    '\\\\wmic\.exe',\ '\\\\wscript\.exe',\ '\\\\wsl\.exe'\]\}|\{'Image\|contains':\
    \[':\\\\ProgramData\\\\',\ ':\\\\Users\\\\Public\\\\',\ ':\\\\Windows\\\\TEMP\\\\',\
    '\\\\AppData\\\\Local\\\\Temp'\]\}|\{'CommandLine\|contains':\ \['\ \-decode\
    ',\ '\ \-enc\ ',\ '\ \-encodedcommand\ ',\ '\ \-w\ hidden',\ 'DownloadString',\
    'FromBase64String',\ 'http',\ 'iex\ ',\ 'Invoke\-'\]\})
- name: '[Sigma] Perl Inline Command Execution'
  tag: attack.execution,attack.t1059
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\perl\.exe'\}|\{'OriginalFileName':\ 'perl\.exe'\})
- name: '[Sigma] Perl Inline Command Execution'
  tag: attack.execution,attack.t1059
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-e
- name: '[Sigma] Php Inline Command Execution'
  tag: attack.execution,attack.t1059
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\php\.exe'\}|\{'OriginalFileName':\ 'php\.exe'\})
- name: '[Sigma] Php Inline Command Execution'
  tag: attack.execution,attack.t1059
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-r
- name: '[Sigma] Ping Hex IP'
  tag: attack.defense-evasion,attack.t1140,attack.t1027
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\ping\.exe$
- name: '[Sigma] Ping Hex IP'
  tag: attack.defense-evasion,attack.t1140,attack.t1027
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)0x\[a\-fA\-F0\-9\]\{8\}
- name: '[Sigma] PktMon.EXE Execution'
  tag: attack.discovery,attack.credential-access,attack.t1040
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\pktmon\.exe'\}|\{'OriginalFileName':\ 'PktMon\.exe'\})
- name: '[Sigma] Suspicious Plink Port Forwarding'
  tag: attack.command-and-control,attack.t1572,attack.lateral-movement,attack.t1021.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)Command\-line\ SSH,\ Telnet,\ and\ Rlogin\ client
- name: '[Sigma] Suspicious Plink Port Forwarding'
  tag: attack.command-and-control,attack.t1572,attack.lateral-movement,attack.t1021.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-R\ '
- name: '[Sigma] Potential RDP Tunneling Via Plink'
  tag: attack.command-and-control,attack.t1572
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\plink\.exe$
- name: '[Sigma] Potential RDP Tunneling Via Plink'
  tag: attack.command-and-control,attack.t1572
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i):127\.0\.0\.1:3389
- name: '[Sigma] Potential RDP Tunneling Via Plink'
  tag: attack.command-and-control,attack.t1572
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\plink\.exe$
- name: '[Sigma] Potential RDP Tunneling Via Plink'
  tag: attack.command-and-control,attack.t1572
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i):3389
- name: '[Sigma] Potential RDP Tunneling Via Plink'
  tag: attack.command-and-control,attack.t1572
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-P\ 443|\ \-P\ 22)
- name: '[Sigma] Suspicious Powercfg Execution To Change Lock Screen Timeout'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\powercfg\.exe'\}|\{'OriginalFileName':\
    'PowerCfg\.exe'\})
- name: '[Sigma] Suspicious Powercfg Execution To Change Lock Screen Timeout'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains\|all':\ \['/setacvalueindex\ ',\ 'SCHEME_CURRENT',\
    'SUB_VIDEO',\ 'VIDEOCONLOCK'\]\}|\{'CommandLine\|contains\|all':\ \['\-change\
    ',\ '\-standby\-timeout\-'\]\})
- name: '[Sigma] AADInternals PowerShell Cmdlets Execution - ProccessCreation'
  tag: attack.execution,attack.reconnaissance,attack.discovery,attack.credential-access,attack.impact
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\powershell_ise\.exe',\
    '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\ \['PowerShell\.Exe',\ 'pwsh\.dll'\]\})
- name: '[Sigma] AADInternals PowerShell Cmdlets Execution - ProccessCreation'
  tag: attack.execution,attack.reconnaissance,attack.discovery,attack.credential-access,attack.impact
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Add\-AADInt|ConvertTo\-AADInt|Disable\-AADInt|Enable\-AADInt|Export\-AADInt|Find\-AADInt|Get\-AADInt|Grant\-AADInt|Initialize\-AADInt|Install\-AADInt|Invoke\-AADInt|Join\-AADInt|New\-AADInt|Open\-AADInt|Read\-AADInt|Register\-AADInt|Remove\-AADInt|Reset\-AADInt|Resolve\-AADInt|Restore\-AADInt|Save\-AADInt|Search\-AADInt|Send\-AADInt|Set\-AADInt|Start\-AADInt|Unprotect\-AADInt|Update\-AADInt)
- name: '[Sigma] Potential Active Directory Enumeration Using AD Module - ProcCreation'
  tag: attack.reconnaissance,attack.discovery,attack.impact
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\
    \['PowerShell\.EXE',\ 'pwsh\.dll'\]\})
- name: '[Sigma] Potential Active Directory Enumeration Using AD Module - ProcCreation'
  tag: attack.reconnaissance,attack.discovery,attack.impact
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Import\-Module\ |ipmo\ )
- name: '[Sigma] Potential Active Directory Enumeration Using AD Module - ProcCreation'
  tag: attack.reconnaissance,attack.discovery,attack.impact
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)Microsoft\.ActiveDirectory\.Management\.dll
- name: '[Sigma] Add Windows Capability Via PowerShell Cmdlet'
  tag: attack.execution
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\
    \['PowerShell\.EXE',\ 'pwsh\.dll'\]\})
- name: '[Sigma] Add Windows Capability Via PowerShell Cmdlet'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)Add\-WindowsCapability
- name: '[Sigma] Add Windows Capability Via PowerShell Cmdlet'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)OpenSSH\.
- name: '[Sigma] Potential AMSI Bypass Via .NET Reflection'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains\|all':\ \['System\.Management\.Automation\.AmsiUtils',\
    'amsiInitFailed'\]\}|\{'CommandLine\|contains\|all':\ \['\[Ref\]\.Assembly\.GetType',\
    'SetValue\(\$null,\$true\)',\ 'NonPublic,Static'\]\})
- name: '[Sigma] Potential AMSI Bypass Using NULL Bits'
  tag: attack.defense-evasion,attack.t1562.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(if\(0\)\{\{\{0\}\}\}'\ \-f\ \$\(0\ \-as\ \[char\]\)\ \+|\#<NULL>)
- name: '[Sigma] Audio Capture via PowerShell'
  tag: attack.collection,attack.t1123
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(WindowsAudioDevice\-Powershell\-Cmdlet|Toggle\-AudioDevice|Get\-AudioDevice\
    |Set\-AudioDevice\ |Write\-AudioDevice\ )
- name: '[Sigma] Suspicious Encoded PowerShell Command Line'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\
    \['PowerShell\.EXE',\ 'pwsh\.dll'\]\})
- name: '[Sigma] Suspicious Encoded PowerShell Command Line'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-e
- name: '[Sigma] Suspicious Encoded PowerShell Command Line'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ JAB|\ SUVYI|\ SQBFAFgA|\ aQBlAHgA|\ aWV4I|\ IAA|\ IAB|\ UwB|\ cwB)
- name: '[Sigma] Suspicious Encoded PowerShell Command Line'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.exe\ \-ENCOD\ |\ BA\^J\ e\-)
- name: '[Sigma] Suspicious Encoded PowerShell Command Line'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-ExecutionPolicy\ remotesigned\ '
- name: '[Sigma] Suspicious PowerShell Encoded Command Patterns'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\
    \['PowerShell\.Exe',\ 'pwsh\.dll'\]\})
- name: '[Sigma] Suspicious PowerShell Encoded Command Patterns'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-e\ |\ \-en\ |\ \-enc\ |\ \-enco)
- name: '[Sigma] Suspicious PowerShell Encoded Command Patterns'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ JAB|\ SUVYI|\ SQBFAFgA|\ aWV4I|\ IAB|\ PAA|\ aQBlAHgA)
- name: '[Sigma] Suspicious PowerShell Encoded Command Patterns'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(C:\\Packages\\Plugins\\Microsoft\.GuestConfiguration\.ConfigurationforWindows\\|\\gc_worker\.exe)
- name: '[Sigma] Suspicious Obfuscated PowerShell Code'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(IAAtAGIAeABvAHIAIAAwAHgA|AALQBiAHgAbwByACAAMAB4A|gAC0AYgB4AG8AcgAgADAAeA|AC4ASQBuAHYAbwBrAGUAKAApACAAfAAg|AuAEkAbgB2AG8AawBlACgAKQAgAHwAI|ALgBJAG4AdgBvAGsAZQAoACkAIAB8AC|AHsAMQB9AHsAMAB9ACIAIAAtAGYAI|B7ADEAfQB7ADAAfQAiACAALQBmAC|AewAxAH0AewAwAH0AIgAgAC0AZgAg|AHsAMAB9AHsAMwB9ACIAIAAtAGYAI|B7ADAAfQB7ADMAfQAiACAALQBmAC|AewAwAH0AewAzAH0AIgAgAC0AZgAg|AHsAMgB9AHsAMAB9ACIAIAAtAGYAI|B7ADIAfQB7ADAAfQAiACAALQBmAC|AewAyAH0AewAwAH0AIgAgAC0AZgAg|AHsAMQB9AHsAMAB9ACcAIAAtAGYAI|B7ADEAfQB7ADAAfQAnACAALQBmAC|AewAxAH0AewAwAH0AJwAgAC0AZgAg|AHsAMAB9AHsAMwB9ACcAIAAtAGYAI|B7ADAAfQB7ADMAfQAnACAALQBmAC|AewAwAH0AewAzAH0AJwAgAC0AZgAg|AHsAMgB9AHsAMAB9ACcAIAAtAGYAI|B7ADIAfQB7ADAAfQAnACAALQBmAC|AewAyAH0AewAwAH0AJwAgAC0AZgAg)
- name: '[Sigma] PowerShell Base64 Encoded FromBase64String Cmdlet'
  tag: attack.defense-evasion,attack.t1140,attack.execution,attack.t1059.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|base64offset\|contains':\ '::FromBase64String'\}|\{'CommandLine\|contains':\
    \['OgA6AEYAcgBvAG0AQgBhAHMAZQA2ADQAUwB0AHIAaQBuAGcA',\ 'oAOgBGAHIAbwBtAEIAYQBzAGUANgA0AFMAdAByAGkAbgBnA',\
    '6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZw'\]\})
- name: '[Sigma] Malicious Base64 Encoded PowerShell Keywords in Command Lines'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\
    \['PowerShell\.EXE',\ 'pwsh\.dll'\]\})
- name: '[Sigma] Malicious Base64 Encoded PowerShell Keywords in Command Lines'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ hidden\ '
- name: '[Sigma] Malicious Base64 Encoded PowerShell Keywords in Command Lines'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(AGkAdABzAGEAZABtAGkAbgAgAC8AdAByAGEAbgBzAGYAZQByA|aXRzYWRtaW4gL3RyYW5zZmVy|IAaQB0AHMAYQBkAG0AaQBuACAALwB0AHIAYQBuAHMAZgBlAHIA|JpdHNhZG1pbiAvdHJhbnNmZX|YgBpAHQAcwBhAGQAbQBpAG4AIAAvAHQAcgBhAG4AcwBmAGUAcg|Yml0c2FkbWluIC90cmFuc2Zlc|AGMAaAB1AG4AawBfAHMAaQB6AGUA|JABjAGgAdQBuAGsAXwBzAGkAegBlA|JGNodW5rX3Npem|QAYwBoAHUAbgBrAF8AcwBpAHoAZQ|RjaHVua19zaXpl|Y2h1bmtfc2l6Z|AE8ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4A|kATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8Abg|lPLkNvbXByZXNzaW9u|SQBPAC4AQwBvAG0AcAByAGUAcwBzAGkAbwBuA|SU8uQ29tcHJlc3Npb2|Ty5Db21wcmVzc2lvb|AE8ALgBNAGUAbQBvAHIAeQBTAHQAcgBlAGEAbQ|kATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtA|lPLk1lbW9yeVN0cmVhb|SQBPAC4ATQBlAG0AbwByAHkAUwB0AHIAZQBhAG0A|SU8uTWVtb3J5U3RyZWFt|Ty5NZW1vcnlTdHJlYW|4ARwBlAHQAQwBoAHUAbgBrA|5HZXRDaHVua|AEcAZQB0AEMAaAB1AG4Aaw|LgBHAGUAdABDAGgAdQBuAGsA|LkdldENodW5r|R2V0Q2h1bm|AEgAUgBFAEEARABfAEkATgBGAE8ANgA0A|QASABSAEUAQQBEAF8ASQBOAEYATwA2ADQA|RIUkVBRF9JTkZPNj|SFJFQURfSU5GTzY0|VABIAFIARQBBAEQAXwBJAE4ARgBPADYANA|VEhSRUFEX0lORk82N|AHIAZQBhAHQAZQBSAGUAbQBvAHQAZQBUAGgAcgBlAGEAZA|cmVhdGVSZW1vdGVUaHJlYW|MAcgBlAGEAdABlAFIAZQBtAG8AdABlAFQAaAByAGUAYQBkA|NyZWF0ZVJlbW90ZVRocmVhZ|Q3JlYXRlUmVtb3RlVGhyZWFk|QwByAGUAYQB0AGUAUgBlAG0AbwB0AGUAVABoAHIAZQBhAGQA|0AZQBtAG0AbwB2AGUA|1lbW1vdm|AGUAbQBtAG8AdgBlA|bQBlAG0AbQBvAHYAZQ|bWVtbW92Z|ZW1tb3Zl)
- name: '[Sigma] PowerShell Base64 Encoded IEX Cmdlet'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|base64offset\|contains':\ \['IEX\ \(\[',\ 'iex\ \(\[',\
    'iex\ \(New',\ 'IEX\ \(New',\ 'IEX\(\[',\ 'iex\(\[',\ 'iex\(New',\ 'IEX\(New',\
    "IEX\(\('",\ "iex\(\('"\]\}|\{'CommandLine\|contains':\ \['SQBFAFgAIAAoAFsA',\
    'kARQBYACAAKABbA',\ 'JAEUAWAAgACgAWw',\ 'aQBlAHgAIAAoAFsA',\ 'kAZQB4ACAAKABbA',\
    'pAGUAeAAgACgAWw',\ 'aQBlAHgAIAAoAE4AZQB3A',\ 'kAZQB4ACAAKABOAGUAdw',\ 'pAGUAeAAgACgATgBlAHcA',\
    'SQBFAFgAIAAoAE4AZQB3A',\ 'kARQBYACAAKABOAGUAdw',\ 'JAEUAWAAgACgATgBlAHcA'\]\})
- name: '[Sigma] PowerShell Base64 Encoded Invoke Keyword'
  tag: attack.execution,attack.t1059.001,attack.defense-evasion,attack.t1027
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\
    \['PowerShell\.EXE',\ 'pwsh\.dll'\]\})
- name: '[Sigma] PowerShell Base64 Encoded Invoke Keyword'
  tag: attack.execution,attack.t1059.001,attack.defense-evasion,attack.t1027
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-e
- name: '[Sigma] PowerShell Base64 Encoded Invoke Keyword'
  tag: attack.execution,attack.t1059.001,attack.defense-evasion,attack.t1027
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(SQBuAHYAbwBrAGUALQ|kAbgB2AG8AawBlAC0A|JAG4AdgBvAGsAZQAtA|SW52b2tlL|ludm9rZS|JbnZva2Ut)
- name: '[Sigma] Powershell Base64 Encoded MpPreference Cmdlet'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|base64offset\|contains':\ \['Add\-MpPreference\ ',\
    'Set\-MpPreference\ ',\ 'add\-mppreference\ ',\ 'set\-mppreference\ '\]\}|\{'CommandLine\|contains':\
    \['QQBkAGQALQBNAHAAUAByAGUAZgBlAHIAZQBuAGMAZQAgA',\ 'EAZABkAC0ATQBwAFAAcgBlAGYAZQByAGUAbgBjAGUAIA',\
    'BAGQAZAAtAE0AcABQAHIAZQBmAGUAcgBlAG4AYwBlACAA',\ 'UwBlAHQALQBNAHAAUAByAGUAZgBlAHIAZQBuAGMAZQAgA',\
    'MAZQB0AC0ATQBwAFAAcgBlAGYAZQByAGUAbgBjAGUAIA',\ 'TAGUAdAAtAE0AcABQAHIAZQBmAGUAcgBlAG4AYwBlACAA',\
    'YQBkAGQALQBtAHAAcAByAGUAZgBlAHIAZQBuAGMAZQAgA',\ 'EAZABkAC0AbQBwAHAAcgBlAGYAZQByAGUAbgBjAGUAIA',\
    'hAGQAZAAtAG0AcABwAHIAZQBmAGUAcgBlAG4AYwBlACAA',\ 'cwBlAHQALQBtAHAAcAByAGUAZgBlAHIAZQBuAGMAZQAgA',\
    'MAZQB0AC0AbQBwAHAAcgBlAGYAZQByAGUAbgBjAGUAIA',\ 'zAGUAdAAtAG0AcABwAHIAZQBmAGUAcgBlAG4AYwBlACAA'\]\})
- name: '[Sigma] PowerShell Base64 Encoded Reflective Assembly Load'
  tag: attack.execution,attack.t1059.001,attack.defense-evasion,attack.t1027,attack.t1620
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(WwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAKA|sAUgBlAGYAbABlAGMAdABpAG8AbgAuAEEAcwBzAGUAbQBiAGwAeQBdADoAOgBMAG8AYQBkACgA|bAFIAZQBmAGwAZQBjAHQAaQBvAG4ALgBBAHMAcwBlAG0AYgBsAHkAXQA6ADoATABvAGEAZAAoA|AFsAcgBlAGYAbABlAGMAdABpAG8AbgAuAGEAcwBzAGUAbQBiAGwAeQBdADoAOgAoACIATABvAGEAZAAiAC|BbAHIAZQBmAGwAZQBjAHQAaQBvAG4ALgBhAHMAcwBlAG0AYgBsAHkAXQA6ADoAKAAiAEwAbwBhAGQAIgAp|AWwByAGUAZgBsAGUAYwB0AGkAbwBuAC4AYQBzAHMAZQBtAGIAbAB5AF0AOgA6ACgAIgBMAG8AYQBkACIAK|WwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6ACgAIgBMAG8AYQBkACIAKQ|sAUgBlAGYAbABlAGMAdABpAG8AbgAuAEEAcwBzAGUAbQBiAGwAeQBdADoAOgAoACIATABvAGEAZAAiACkA|bAFIAZQBmAGwAZQBjAHQAaQBvAG4ALgBBAHMAcwBlAG0AYgBsAHkAXQA6ADoAKAAiAEwAbwBhAGQAIgApA|WwByAGUAZgBsAGUAYwB0AGkAbwBuAC4AYQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAKA|sAcgBlAGYAbABlAGMAdABpAG8AbgAuAGEAcwBzAGUAbQBiAGwAeQBdADoAOgBMAG8AYQBkACgA|bAHIAZQBmAGwAZQBjAHQAaQBvAG4ALgBhAHMAcwBlAG0AYgBsAHkAXQA6ADoATABvAGEAZAAoA)
- name: '[Sigma] Suspicious Encoded And Obfuscated Reflection Assembly Load Function
    Call'
  tag: attack.execution,attack.defense-evasion,attack.t1059.001,attack.t1027
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(OgA6ACgAIgBMACIAKwAiAG8AYQBkACIAKQ|oAOgAoACIATAAiACsAIgBvAGEAZAAiACkA|6ADoAKAAiAEwAIgArACIAbwBhAGQAIgApA|OgA6ACgAIgBMAG8AIgArACIAYQBkACIAKQ|oAOgAoACIATABvACIAKwAiAGEAZAAiACkA|6ADoAKAAiAEwAbwAiACsAIgBhAGQAIgApA|OgA6ACgAIgBMAG8AYQAiACsAIgBkACIAKQ|oAOgAoACIATABvAGEAIgArACIAZAAiACkA|6ADoAKAAiAEwAbwBhACIAKwAiAGQAIgApA|OgA6ACgAJwBMACcAKwAnAG8AYQBkACcAKQ|oAOgAoACcATAAnACsAJwBvAGEAZAAnACkA|6ADoAKAAnAEwAJwArACcAbwBhAGQAJwApA|OgA6ACgAJwBMAG8AJwArACcAYQBkACcAKQ|oAOgAoACcATABvACcAKwAnAGEAZAAnACkA|6ADoAKAAnAEwAbwAnACsAJwBhAGQAJwApA|OgA6ACgAJwBMAG8AYQAnACsAJwBkACcAKQ|oAOgAoACcATABvAGEAJwArACcAZAAnACkA|6ADoAKAAnAEwAbwBhACcAKwAnAGQAJwApA)
- name: '[Sigma] PowerShell Base64 Encoded WMI Classes'
  tag: attack.execution,attack.t1059.001,attack.defense-evasion,attack.t1027
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\
    \['PowerShell\.EXE',\ 'pwsh\.dll'\]\})
- name: '[Sigma] PowerShell Base64 Encoded WMI Classes'
  tag: attack.execution,attack.t1059.001,attack.defense-evasion,attack.t1027
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(VwBpAG4AMwAyAF8AUwBoAGEAZABvAHcAYwBvAHAAeQ|cAaQBuADMAMgBfAFMAaABhAGQAbwB3AGMAbwBwAHkA|XAGkAbgAzADIAXwBTAGgAYQBkAG8AdwBjAG8AcAB5A|V2luMzJfU2hhZG93Y29we|dpbjMyX1NoYWRvd2NvcH|XaW4zMl9TaGFkb3djb3B5)
- name: '[Sigma] PowerShell Base64 Encoded WMI Classes'
  tag: attack.execution,attack.t1059.001,attack.defense-evasion,attack.t1027
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(VwBpAG4AMwAyAF8AUwBjAGgAZQBkAHUAbABlAGQASgBvAGIA|cAaQBuADMAMgBfAFMAYwBoAGUAZAB1AGwAZQBkAEoAbwBiA|XAGkAbgAzADIAXwBTAGMAaABlAGQAdQBsAGUAZABKAG8AYg|V2luMzJfU2NoZWR1bGVkSm9i|dpbjMyX1NjaGVkdWxlZEpvY|XaW4zMl9TY2hlZHVsZWRKb2)
- name: '[Sigma] PowerShell Base64 Encoded WMI Classes'
  tag: attack.execution,attack.t1059.001,attack.defense-evasion,attack.t1027
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(VwBpAG4AMwAyAF8AUAByAG8AYwBlAHMAcw|cAaQBuADMAMgBfAFAAcgBvAGMAZQBzAHMA|XAGkAbgAzADIAXwBQAHIAbwBjAGUAcwBzA|V2luMzJfUHJvY2Vzc|dpbjMyX1Byb2Nlc3|XaW4zMl9Qcm9jZXNz)
- name: '[Sigma] PowerShell Base64 Encoded WMI Classes'
  tag: attack.execution,attack.t1059.001,attack.defense-evasion,attack.t1027
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(VwBpAG4AMwAyAF8AVQBzAGUAcgBBAGMAYwBvAHUAbgB0A|cAaQBuADMAMgBfAFUAcwBlAHIAQQBjAGMAbwB1AG4AdA|XAGkAbgAzADIAXwBVAHMAZQByAEEAYwBjAG8AdQBuAHQA|V2luMzJfVXNlckFjY291bn|dpbjMyX1VzZXJBY2NvdW50|XaW4zMl9Vc2VyQWNjb3Vud)
- name: '[Sigma] PowerShell Base64 Encoded WMI Classes'
  tag: attack.execution,attack.t1059.001,attack.defense-evasion,attack.t1027
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(VwBpAG4AMwAyAF8ATABvAGcAZwBlAGQATwBuAFUAcwBlAHIA|cAaQBuADMAMgBfAEwAbwBnAGcAZQBkAE8AbgBVAHMAZQByA|XAGkAbgAzADIAXwBMAG8AZwBnAGUAZABPAG4AVQBzAGUAcg|V2luMzJfTG9nZ2VkT25Vc2Vy|dpbjMyX0xvZ2dlZE9uVXNlc|XaW4zMl9Mb2dnZWRPblVzZX)
- name: '[Sigma] Potential Process Execution Proxy Via CL_Invocation.ps1'
  tag: attack.defense-evasion,attack.t1216
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)SyncInvoke\ '
- name: '[Sigma] Assembly Loading Via CL_LoadAssembly.ps1'
  tag: attack.defense-evasion,attack.t1216
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(LoadAssemblyFromPath\ |LoadAssemblyFromNS\ )
- name: '[Sigma] Potential Script Proxy Execution Via CL_Mutexverifiers.ps1'
  tag: attack.defense-evasion,attack.t1216
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\pwsh\.exe)$
- name: '[Sigma] Potential Script Proxy Execution Via CL_Mutexverifiers.ps1'
  tag: attack.defense-evasion,attack.t1216
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\powershell\.exe$
- name: '[Sigma] Potential Script Proxy Execution Via CL_Mutexverifiers.ps1'
  tag: attack.defense-evasion,attack.t1216
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-nologo\ \-windowstyle\ minimized\ \-file\ '
- name: '[Sigma] Potential Script Proxy Execution Via CL_Mutexverifiers.ps1'
  tag: attack.defense-evasion,attack.t1216
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\AppData\\Local\\Temp\\|\\Windows\\Temp\\)
- name: '[Sigma] ConvertTo-SecureString Cmdlet Usage Via CommandLine'
  tag: attack.defense-evasion,attack.t1027,attack.execution,attack.t1059.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\
    \['PowerShell\.EXE',\ 'pwsh\.dll'\]\})
- name: '[Sigma] ConvertTo-SecureString Cmdlet Usage Via CommandLine'
  tag: attack.defense-evasion,attack.t1027,attack.execution,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)ConvertTo\-SecureString
- name: '[Sigma] Potential PowerShell Obfuscation Via Reversed Commands'
  tag: attack.defense-evasion,attack.t1027,attack.execution,attack.t1059.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\
    \['PowerShell\.EXE',\ 'pwsh\.dll'\]\})
- name: '[Sigma] Potential PowerShell Obfuscation Via Reversed Commands'
  tag: attack.defense-evasion,attack.t1027,attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(hctac|kaerb|dnammoc|ekovn|eliFd|rahc|etirw|golon|tninon|eddih|tpircS|ssecorp|llehsrewop|esnopser|daolnwod|tneilCbeW|tneilc|ptth|elifotevas|46esab|htaPpmeTteG|tcejbO|maerts|hcaerof|retupmoc)
- name: '[Sigma] Potential PowerShell Obfuscation Via Reversed Commands'
  tag: attack.defense-evasion,attack.t1027,attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-EncodedCommand\ |\ \-enc\ )
- name: '[Sigma] Potential PowerShell Command Line Obfuscation'
  tag: attack.execution,attack.defense-evasion,attack.t1027,attack.t1059.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\
    \['PowerShell\.EXE',\ 'pwsh\.dll'\]\})
- name: '[Sigma] Potential PowerShell Command Line Obfuscation'
  tag: attack.execution,attack.defense-evasion,attack.t1027,attack.t1059.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|re':\ '\\\\\+\..*\\\\\+\..*\\\\\+\..*\\\\\+\..*\\\\\+\..*\\\\\+\..*\\\\\+\..*\\\\\+\..*\\\\\+\..*\\\\\+\..*\\\\\+\..*\\\\\+\..*\\\\\+\..*\\\\\+'\}|\{'CommandLine\|re':\
    '\\\\\{\..*\\\\\{\..*\\\\\{\..*\\\\\{\..*\\\\\{\..*\\\\\{\..*\\\\\{\..*\\\\\{\..*\\\\\{\..*\\\\\{'\}|\{'CommandLine\|re':\
    '\\\\\^\..*\\\\\^\..*\\\\\^\..*\\\\\^\..*\\\\\^'\}|\{'CommandLine\|re':\ '`\..*`\..*`\..*`\..*`'\})
- name: '[Sigma] Potential PowerShell Command Line Obfuscation'
  tag: attack.execution,attack.defense-evasion,attack.t1027,attack.t1059.001
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Program\ Files\\Amazon\\SSM\\ssm\-document\-worker\.exe
- name: '[Sigma] Potential PowerShell Command Line Obfuscation'
  tag: attack.execution,attack.defense-evasion,attack.t1027,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(new\ EventSource\("Microsoft\.Windows\.Sense\.Client\.Management"|public\
    static\ extern\ bool\ InstallELAMCertificateInfo\(SafeFileHandle\ handle\);)
- name: '[Sigma] Computer Discovery And Export Via Get-ADComputer Cmdlet'
  tag: attack.discovery,attack.t1033
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\
    \['PowerShell\.EXE',\ 'pwsh\.dll'\]\})
- name: '[Sigma] Computer Discovery And Export Via Get-ADComputer Cmdlet'
  tag: attack.discovery,attack.t1033
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Get\-ADComputer\ |\ \-Filter\ \\.*)
- name: '[Sigma] Computer Discovery And Export Via Get-ADComputer Cmdlet'
  tag: attack.discovery,attack.t1033
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ >\ |\ \|\ Select\ |Out\-File|Set\-Content|Add\-Content)
- name: '[Sigma] New Service Creation Using PowerShell'
  tag: attack.persistence,attack.privilege-escalation,attack.t1543.003
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(New\-Service|\-BinaryPathName)
- name: '[Sigma] Gzip Archive Decode Via PowerShell'
  tag: attack.command-and-control,attack.t1132.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(GZipStream|::Decompress)
- name: '[Sigma] PowerShell Execution With Potential Decryption Capabilities'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\pwsh\.exe)$
- name: '[Sigma] PowerShell Execution With Potential Decryption Capabilities'
  tag: attack.execution
  score: 80
  target: FileName
  condition: regex
  pattern: (?i)(PowerShell\.EXE|pwsh\.dll)
- name: '[Sigma] PowerShell Execution With Potential Decryption Capabilities'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Get\-ChildItem\ |dir\ |gci\ |ls\ )
- name: '[Sigma] PowerShell Execution With Potential Decryption Capabilities'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Get\-Content\ |gc\ |cat\ |type\ |ReadAllBytes)
- name: '[Sigma] PowerShell Execution With Potential Decryption Capabilities'
  tag: attack.execution
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains\|all':\ \['\ \^\|\ ',\ '\\\\.*\.lnk',\ '\-Recurse',\
    '\-Skip\ '\]\}|\{'CommandLine\|contains\|all':\ \['\ \-ExpandProperty\ ',\ '\\\\.*\.lnk',\
    'WriteAllBytes',\ '\ \.length\ '\]\})
- name: '[Sigma] Powershell Defender Disable Scan Feature'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Add\-MpPreference\ |Set\-MpPreference\ )
- name: '[Sigma] Powershell Defender Disable Scan Feature'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(DisableArchiveScanning\ |DisableRealtimeMonitoring\ |DisableIOAVProtection\
    |DisableBehaviorMonitoring\ |DisableBlockAtFirstSeen\ |DisableCatchupFullScan\
    |DisableCatchupQuickScan\ )
- name: '[Sigma] Powershell Defender Disable Scan Feature'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\$true|\ 1\ )
- name: '[Sigma] Powershell Defender Disable Scan Feature'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(disablearchivescanning\ |DisableArchiveScanning\ |disablebehaviormonitoring\
    |DisableBehaviorMonitoring\ |disableblockatfirstseen\ |DisableBlockAtFirstSeen\
    |disablecatchupfullscan\ |DisableCatchupFullScan\ |disablecatchupquickscan\ |DisableCatchupQuickScan\
    |disableioavprotection\ |DisableIOAVProtection\ |disablerealtimemonitoring\ |DisableRealtimeMonitoring\
    )
- name: '[Sigma] Powershell Defender Disable Scan Feature'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(RABpAHMAYQBiAGwAZQBSAGUAYQBsAHQAaQBtAGUATQBvAG4AaQB0AG8AcgBpAG4AZwAgA|QAaQBzAGEAYgBsAGUAUgBlAGEAbAB0AGkAbQBlAE0AbwBuAGkAdABvAHIAaQBuAGcAIA|EAGkAcwBhAGIAbABlAFIAZQBhAGwAdABpAG0AZQBNAG8AbgBpAHQAbwByAGkAbgBnACAA|RABpAHMAYQBiAGwAZQBJAE8AQQBWAFAAcgBvAHQAZQBjAHQAaQBvAG4AIA|QAaQBzAGEAYgBsAGUASQBPAEEAVgBQAHIAbwB0AGUAYwB0AGkAbwBuACAA|EAGkAcwBhAGIAbABlAEkATwBBAFYAUAByAG8AdABlAGMAdABpAG8AbgAgA|RABpAHMAYQBiAGwAZQBCAGUAaABhAHYAaQBvAHIATQBvAG4AaQB0AG8AcgBpAG4AZwAgA|QAaQBzAGEAYgBsAGUAQgBlAGgAYQB2AGkAbwByAE0AbwBuAGkAdABvAHIAaQBuAGcAIA|EAGkAcwBhAGIAbABlAEIAZQBoAGEAdgBpAG8AcgBNAG8AbgBpAHQAbwByAGkAbgBnACAA|RABpAHMAYQBiAGwAZQBCAGwAbwBjAGsAQQB0AEYAaQByAHMAdABTAGUAZQBuACAA|QAaQBzAGEAYgBsAGUAQgBsAG8AYwBrAEEAdABGAGkAcgBzAHQAUwBlAGUAbgAgA|EAGkAcwBhAGIAbABlAEIAbABvAGMAawBBAHQARgBpAHIAcwB0AFMAZQBlAG4AIA|ZABpAHMAYQBiAGwAZQByAGUAYQBsAHQAaQBtAGUAbQBvAG4AaQB0AG8AcgBpAG4AZwAgA|QAaQBzAGEAYgBsAGUAcgBlAGEAbAB0AGkAbQBlAG0AbwBuAGkAdABvAHIAaQBuAGcAIA|kAGkAcwBhAGIAbABlAHIAZQBhAGwAdABpAG0AZQBtAG8AbgBpAHQAbwByAGkAbgBnACAA|ZABpAHMAYQBiAGwAZQBpAG8AYQB2AHAAcgBvAHQAZQBjAHQAaQBvAG4AIA|QAaQBzAGEAYgBsAGUAaQBvAGEAdgBwAHIAbwB0AGUAYwB0AGkAbwBuACAA|kAGkAcwBhAGIAbABlAGkAbwBhAHYAcAByAG8AdABlAGMAdABpAG8AbgAgA|ZABpAHMAYQBiAGwAZQBiAGUAaABhAHYAaQBvAHIAbQBvAG4AaQB0AG8AcgBpAG4AZwAgA|QAaQBzAGEAYgBsAGUAYgBlAGgAYQB2AGkAbwByAG0AbwBuAGkAdABvAHIAaQBuAGcAIA|kAGkAcwBhAGIAbABlAGIAZQBoAGEAdgBpAG8AcgBtAG8AbgBpAHQAbwByAGkAbgBnACAA|ZABpAHMAYQBiAGwAZQBiAGwAbwBjAGsAYQB0AGYAaQByAHMAdABzAGUAZQBuACAA|QAaQBzAGEAYgBsAGUAYgBsAG8AYwBrAGEAdABmAGkAcgBzAHQAcwBlAGUAbgAgA|kAGkAcwBhAGIAbABlAGIAbABvAGMAawBhAHQAZgBpAHIAcwB0AHMAZQBlAG4AIA|RABpAHMAYQBiAGwAZQBDAGEAdABjAGgAdQBwAEYAdQBsAGwAUwBjAGEAbgA|RABpAHMAYQBiAGwAZQBDAGEAdABjAGgAdQBwAFEAdQBpAGMAawBTAGMAYQBuAA|RABpAHMAYQBiAGwAZQBBAHIAYwBoAGkAdgBlAFMAYwBhAG4AbgBpAG4AZwA)
- name: '[Sigma] Powershell Defender Exclusion'
  tag: attack.defense-evasion,attack.t1562.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Add\-MpPreference\ |Set\-MpPreference\ )
- name: '[Sigma] Powershell Defender Exclusion'
  tag: attack.defense-evasion,attack.t1562.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-ExclusionPath\ |\ \-ExclusionExtension\ |\ \-ExclusionProcess\
    |\ \-ExclusionIpAddress\ )
- name: '[Sigma] Disable Windows Defender AV Security Monitoring'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\
    \['PowerShell\.EXE',\ 'pwsh\.dll'\]\})
- name: '[Sigma] Disable Windows Defender AV Security Monitoring'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-DisableBehaviorMonitoring\ \$true|\-DisableRuntimeMonitoring\ \$true)
- name: '[Sigma] Disable Windows Defender AV Security Monitoring'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\sc\.exe'\}|\{'OriginalFileName':\ 'sc\.exe'\})
- name: '[Sigma] Disable Windows Defender AV Security Monitoring'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(stop|WinDefend)
- name: '[Sigma] Disable Windows Defender AV Security Monitoring'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(delete|WinDefend)
- name: '[Sigma] Disable Windows Defender AV Security Monitoring'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(config|WinDefend|start=disabled)
- name: '[Sigma] Windows Firewall Disabled via PowerShell'
  tag: attack.defense-evasion,attack.t1562
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe',\
    '\\\\powershell_ise\.exe'\]\}|\{'OriginalFileName':\ \['PowerShell\.EXE',\ 'pwsh\.dll'\]\})
- name: '[Sigma] Windows Firewall Disabled via PowerShell'
  tag: attack.defense-evasion,attack.t1562
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Set\-NetFirewallProfile\ |\ \-Enabled\ |\ False)
- name: '[Sigma] Windows Firewall Disabled via PowerShell'
  tag: attack.defense-evasion,attack.t1562
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-All\ |Public|Domain|Private)
- name: '[Sigma] Disabled IE Security Features'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-name\ IEHarden\ |\ \-value\ 0\ )
- name: '[Sigma] Disabled IE Security Features'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-name\ DEPOff\ |\ \-value\ 1\ )
- name: '[Sigma] Disabled IE Security Features'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-name\ DisableFirstRunCustomize\ |\ \-value\ 2\ )
- name: '[Sigma] Potential PowerShell Downgrade Attack'
  tag: attack.defense-evasion,attack.execution,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\powershell\.exe$
- name: '[Sigma] Potential PowerShell Downgrade Attack'
  tag: attack.defense-evasion,attack.execution,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-version\ 2\ |\ \-versio\ 2\ |\ \-versi\ 2\ |\ \-vers\ 2\ |\ \-ver\
    2\ |\ \-ve\ 2\ |\ \-v\ 2\ )
- name: '[Sigma] Potential COM Objects Download Cradles Usage - Process Creation'
  tag: attack.command-and-control,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\[Type\]::GetTypeFromCLSID\(
- name: '[Sigma] Potential COM Objects Download Cradles Usage - Process Creation'
  tag: attack.command-and-control,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(0002DF01\-0000\-0000\-C000\-000000000046|F6D90F16\-9C73\-11D3\-B32E\-00C04F990BB4|F5078F35\-C551\-11D3\-89B9\-0000F81FE221|88d96a0a\-f192\-11d4\-a65f\-0040963251e5|AFBA6B42\-5692\-48EA\-8141\-DC517DCF0EF1|AFB40FFD\-B609\-40A3\-9828\-F88BBE11E4E3|88d96a0b\-f192\-11d4\-a65f\-0040963251e5|2087c2f4\-2cef\-4953\-a8ab\-66779b670495|000209FF\-0000\-0000\-C000\-000000000046|00024500\-0000\-0000\-C000\-000000000046)
- name: '[Sigma] Obfuscated PowerShell OneLiner Execution'
  tag: attack.defense-evasion,attack.execution,attack.t1059.001,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\powershell\.exe$
- name: '[Sigma] Obfuscated PowerShell OneLiner Execution'
  tag: attack.defense-evasion,attack.execution,attack.t1059.001,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(http://127\.0\.0\.1|%\{\(IRM\ \$_\)\}|Invoke)
- name: '[Sigma] Potential DLL File Download Via PowerShell Invoke-WebRequest'
  tag: attack.command-and-control,attack.execution,attack.t1059.001,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Invoke\-RestMethod\ |Invoke\-WebRequest\ |IRM\ |IWR\ )
- name: '[Sigma] Potential DLL File Download Via PowerShell Invoke-WebRequest'
  tag: attack.command-and-control,attack.execution,attack.t1059.001,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(http|OutFile|\.dll)
- name: '[Sigma] PowerShell Download and Execution Cradles'
  tag: attack.execution,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.DownloadString\(|\.DownloadFile\(|Invoke\-WebRequest\ |iwr\ |Invoke\-RestMethod\
    |irm\ )
- name: '[Sigma] PowerShell Download and Execution Cradles'
  tag: attack.execution,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(;iex\ \$|\|\ IEX|\|IEX\ |I`E`X|I`EX|IE`X|iex\ |IEX\ \(|IEX\(|Invoke\-Expression)
- name: '[Sigma] PowerShell Download Pattern'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell_ise\.exe',\ '\\\\powershell\.exe',\
    '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\ \['PowerShell_ISE\.EXE',\ 'PowerShell\.EXE',\
    'pwsh\.dll'\]\})
- name: '[Sigma] PowerShell Download Pattern'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(new\-object|net\.webclient\)\.|download)
- name: '[Sigma] PowerShell Download Pattern'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(string\(|file\()
- name: '[Sigma] Potentially Suspicious File Download From File Sharing Domain Via
    PowerShell.EXE'
  tag: attack.execution
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\
    \['PowerShell\.EXE',\ 'pwsh\.dll'\]\})
- name: '[Sigma] Potentially Suspicious File Download From File Sharing Domain Via
    PowerShell.EXE'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(anonfiles\.com|cdn\.discordapp\.com|ddns\.net|dl\.dropboxusercontent\.com|ghostbin\.co|glitch\.me|gofile\.io|hastebin\.com|mediafire\.com|mega\.nz|onrender\.com|pages\.dev|paste\.ee|pastebin\.com|pastebin\.pl|pastetext\.net|pixeldrain\.com|privatlab\.com|privatlab\.net|send\.exploit\.in|sendspace\.com|storage\.googleapis\.com|storjshare\.io|supabase\.co|temp\.sh|transfer\.sh|trycloudflare\.com|ufile\.io|w3spaces\.com|workers\.dev)
- name: '[Sigma] Potentially Suspicious File Download From File Sharing Domain Via
    PowerShell.EXE'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.DownloadString\(|\.DownloadFile\(|Invoke\-WebRequest\ |iwr\ |wget\
    )
- name: '[Sigma] DSInternals Suspicious PowerShell Cmdlets'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Add\-ADDBSidHistory|Add\-ADNgcKey|Add\-ADReplNgcKey|ConvertFrom\-ADManagedPasswordBlob|ConvertFrom\-GPPrefPassword|ConvertFrom\-ManagedPasswordBlob|ConvertFrom\-UnattendXmlPassword|ConvertFrom\-UnicodePassword|ConvertTo\-AADHash|ConvertTo\-GPPrefPassword|ConvertTo\-KerberosKey|ConvertTo\-LMHash|ConvertTo\-MsoPasswordHash|ConvertTo\-NTHash|ConvertTo\-OrgIdHash|ConvertTo\-UnicodePassword|Disable\-ADDBAccount|Enable\-ADDBAccount|Get\-ADDBAccount|Get\-ADDBBackupKey|Get\-ADDBDomainController|Get\-ADDBGroupManagedServiceAccount|Get\-ADDBKdsRootKey|Get\-ADDBSchemaAttribute|Get\-ADDBServiceAccount|Get\-ADDefaultPasswordPolicy|Get\-ADKeyCredential|Get\-ADPasswordPolicy|Get\-ADReplAccount|Get\-ADReplBackupKey|Get\-ADReplicationAccount|Get\-ADSIAccount|Get\-AzureADUserEx|Get\-BootKey|Get\-KeyCredential|Get\-LsaBackupKey|Get\-LsaPolicy|Get\-SamPasswordPolicy|Get\-SysKey|Get\-SystemKey|New\-ADDBRestoreFromMediaScript|New\-ADKeyCredential|New\-ADNgcKey|New\-NTHashSet|Remove\-ADDBObject|Save\-DPAPIBlob|Set\-ADAccountPasswordHash|Set\-ADDBAccountPassword|Set\-ADDBBootKey|Set\-ADDBDomainController|Set\-ADDBPrimaryGroup|Set\-ADDBSysKey|Set\-AzureADUserEx|Set\-LsaPolicy|Set\-SamAccountPasswordHash|Set\-WinUserPasswordHash|Test\-ADDBPasswordQuality|Test\-ADPasswordQuality|Test\-ADReplPasswordQuality|Test\-PasswordQuality|Unlock\-ADDBAccount|Write\-ADNgcKey|Write\-ADReplNgcKey)
- name: '[Sigma] Email Exifiltration Via Powershell'
  tag: attack.exfiltration
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\pwsh\.exe)$
- name: '[Sigma] Email Exifiltration Via Powershell'
  tag: attack.exfiltration
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Add\-PSSnapin|Get\-Recipient|\-ExpandProperty|EmailAddresses|SmtpAddress|\-hidetableheaders)
- name: '[Sigma] Potential Suspicious Windows Feature Enabled - ProcCreation'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Enable\-WindowsOptionalFeature|\-Online|\-FeatureName)
- name: '[Sigma] Potential Suspicious Windows Feature Enabled - ProcCreation'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(TelnetServer|Internet\-Explorer\-Optional\-amd64|TFTP|SMB1Protocol|Client\-ProjFS|Microsoft\-Windows\-Subsystem\-Linux)
- name: '[Sigma] Suspicious Execution of Powershell with Base64'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\pwsh\.exe)$
- name: '[Sigma] Suspicious Execution of Powershell with Base64'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-e\ |\ \-en\ |\ \-enc\ |\ \-enco|\ \-ec\ )
- name: '[Sigma] Suspicious Execution of Powershell with Base64'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-Encoding\ '
- name: '[Sigma] Suspicious Execution of Powershell with Base64'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(C:\\Packages\\Plugins\\Microsoft\.GuestConfiguration\.ConfigurationforWindows\\|\\gc_worker\.exe)
- name: '[Sigma] Potential Encoded PowerShell Patterns In CommandLine'
  tag: attack.defense-evasion,attack.t1027,attack.execution,attack.t1059.001
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\
    \['PowerShell\.EXE',\ 'pwsh\.dll'\]\})
- name: '[Sigma] Potential Encoded PowerShell Patterns In CommandLine'
  tag: attack.defense-evasion,attack.t1027,attack.execution,attack.t1059.001
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(ToInt|ToDecimal|ToByte|ToUint|ToSingle|ToSByte)
- name: '[Sigma] Potential Encoded PowerShell Patterns In CommandLine'
  tag: attack.defense-evasion,attack.t1027,attack.execution,attack.t1059.001
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(ToChar|ToString|String)
- name: '[Sigma] Potential Encoded PowerShell Patterns In CommandLine'
  tag: attack.defense-evasion,attack.t1027,attack.execution,attack.t1059.001
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(char|join)
- name: '[Sigma] Potential Encoded PowerShell Patterns In CommandLine'
  tag: attack.defense-evasion,attack.t1027,attack.execution,attack.t1059.001
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(split|join)
- name: '[Sigma] Powershell Inline Execution From A File'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(iex\ |Invoke\-Expression\ |Invoke\-Command\ |icm\ )
- name: '[Sigma] Powershell Inline Execution From A File'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(cat\ |get\-content\ |type\ )
- name: '[Sigma] Powershell Inline Execution From A File'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-raw
- name: '[Sigma] Certificate Exported Via PowerShell'
  tag: attack.credential-access,attack.execution,attack.t1552.004,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Export\-PfxCertificate\ |Export\-Certificate\ )
- name: '[Sigma] Base64 Encoded PowerShell Command Detected'
  tag: attack.t1027,attack.defense-evasion,attack.execution,attack.t1140,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)::FromBase64String\(
- name: '[Sigma] Suspicious FromBase64String Usage On Gzip Archive - Process Creation'
  tag: attack.command-and-control,attack.t1132.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(FromBase64String|MemoryStream|H4sI)
- name: '[Sigma] PowerShell Get-Process LSASS'
  tag: attack.credential-access,attack.t1552.004
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Get\-Process\ lsas|ps\ lsas|gps\ lsas)
- name: '[Sigma] PowerShell Get-Clipboard Cmdlet Via CLI'
  tag: attack.collection,attack.t1115
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)Get\-Clipboard
- name: '[Sigma] Suspicious Reconnaissance Activity Using Get-LocalGroupMember Cmdlet'
  tag: attack.discovery,attack.t1087.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)Get\-LocalGroupMember\ '
- name: '[Sigma] Suspicious Reconnaissance Activity Using Get-LocalGroupMember Cmdlet'
  tag: attack.discovery,attack.t1087.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(domain\ admins|\ administrator|\ administrateur|enterprise\ admins|Exchange\
    Trusted\ Subsystem|Remote\ Desktop\ Users|Utilisateurs\ du\ Bureau\ \ distance|Usuarios\
    de\ escritorio\ remoto)
- name: '[Sigma] Abuse of Service Permissions to Hide Services Via Set-Service'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1574.011
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\pwsh\.exe'\}|\{'OriginalFileName':\ 'pwsh\.dll'\})
- name: '[Sigma] Abuse of Service Permissions to Hide Services Via Set-Service'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1574.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Set\-Service\ |DCLCWPDTSD)
- name: '[Sigma] Abuse of Service Permissions to Hide Services Via Set-Service'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1574.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-SecurityDescriptorSddl\ |\-sd\ )
- name: '[Sigma] Suspicious PowerShell IEX Execution Patterns'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\pwsh\.exe)$
- name: '[Sigma] Suspicious PowerShell IEX Execution Patterns'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \|\ iex;|\ \|\ iex\ |\ \|\ iex\}|\ \|\ IEX\ ;|\ \|\ IEX\ \-Error|\
    \|\ IEX\ \(new|\);IEX\ )
- name: '[Sigma] Suspicious PowerShell IEX Execution Patterns'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(::FromBase64String|\.GetString\(\[System\.Convert\]::)
- name: '[Sigma] Suspicious PowerShell IEX Execution Patterns'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\)\|iex;\$|\);iex\(\$|\);iex\ \$|\ \|\ IEX\ \|\ |\ \|\ iex\\")
- name: '[Sigma] Root Certificate Installed From Susp Locations'
  tag: attack.defense-evasion,attack.t1553.004
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Import\-Certificate|\ \-FilePath\ |Cert:\\LocalMachine\\Root)
- name: '[Sigma] Root Certificate Installed From Susp Locations'
  tag: attack.defense-evasion,attack.t1553.004
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\AppData\\Local\\Temp\\|:\\Windows\\TEMP\\|\\Desktop\\|\\Downloads\\|\\Perflogs\\|:\\Users\\Public\\)
- name: '[Sigma] Import PowerShell Modules From Suspicious Directories - ProcCreation'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Import\-Module\ "\$Env:Temp\\|Import\-Module\ '\$Env:Temp\\|Import\-Module\
    \$Env:Temp\\|Import\-Module\ "\$Env:Appdata\\|Import\-Module\ '\$Env:Appdata\\|Import\-Module\
    \$Env:Appdata\\|Import\-Module\ C:\\Users\\Public\\|ipmo\ "\$Env:Temp\\|ipmo\
    '\$Env:Temp\\|ipmo\ \$Env:Temp\\|ipmo\ "\$Env:Appdata\\|ipmo\ '\$Env:Appdata\\|ipmo\
    \$Env:Appdata\\|ipmo\ C:\\Users\\Public\\)
- name: '[Sigma] Unsigned AppX Installation Attempt Using Add-AppxPackage'
  tag: attack.persistence,attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\
    \['PowerShell\.EXE',\ 'pwsh\.dll'\]\})
- name: '[Sigma] Unsigned AppX Installation Attempt Using Add-AppxPackage'
  tag: attack.persistence,attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Add\-AppPackage\ |Add\-AppxPackage\ )
- name: '[Sigma] Unsigned AppX Installation Attempt Using Add-AppxPackage'
  tag: attack.persistence,attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-AllowUnsigned
- name: '[Sigma] Suspicious PowerShell Invocations - Specific - ProcessCreation'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-nop|\ \-w\ |hidden|\ \-c\ |\[Convert\]::FromBase64String)
- name: '[Sigma] Suspicious PowerShell Invocations - Specific - ProcessCreation'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-w\ |hidden|\-noni|\-nop|\ \-c\ |iex|New\-Object)
- name: '[Sigma] Suspicious PowerShell Invocations - Specific - ProcessCreation'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-w\ |hidden|\-ep|bypass|\-Enc)
- name: '[Sigma] Suspicious PowerShell Invocations - Specific - ProcessCreation'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(powershell|reg|add|\\software\\)
- name: '[Sigma] Suspicious PowerShell Invocations - Specific - ProcessCreation'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(bypass|\-noprofile|\-windowstyle|hidden|new\-object|system\.net\.webclient|\.download)
- name: '[Sigma] Suspicious PowerShell Invocations - Specific - ProcessCreation'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(iex|New\-Object|Net\.WebClient|\.Download)
- name: '[Sigma] Suspicious PowerShell Invocations - Specific - ProcessCreation'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\(New\-Object\ System\.Net\.WebClient\)\.DownloadString\('https://community\.chocolatey\.org/install\.ps1|Write\-ChocolateyWarning)
- name: '[Sigma] Suspicious Invoke-WebRequest Execution With DirectIP'
  tag: attack.command-and-control,attack.t1105
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell_ise\.exe',\ '\\\\powershell\.exe',\
    '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\ \['powershell_ise\.EXE',\ 'PowerShell\.EXE',\
    'pwsh\.dll'\]\})
- name: '[Sigma] Suspicious Invoke-WebRequest Execution With DirectIP'
  tag: attack.command-and-control,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(curl\ |Invoke\-RestMethod|Invoke\-WebRequest|\ irm\ |iwr\ |wget\ )
- name: '[Sigma] Suspicious Invoke-WebRequest Execution With DirectIP'
  tag: attack.command-and-control,attack.t1105
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(://1|://2|://3|://4|://5|://6|://7|://8|://9)
- name: '[Sigma] Suspicious Invoke-WebRequest Execution'
  tag: attack.command-and-control,attack.t1105
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell_ise\.exe',\ '\\\\powershell\.exe',\
    '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\ \['powershell_ise\.EXE',\ 'PowerShell\.EXE',\
    'pwsh\.dll'\]\})
- name: '[Sigma] Suspicious Invoke-WebRequest Execution'
  tag: attack.command-and-control,attack.t1105
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(curl\ |Invoke\-WebRequest|iwr\ |wget\ )
- name: '[Sigma] Suspicious Invoke-WebRequest Execution'
  tag: attack.command-and-control,attack.t1105
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-ur|\ \-o)
- name: '[Sigma] Suspicious Invoke-WebRequest Execution'
  tag: attack.command-and-control,attack.t1105
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\AppData\\|\\Desktop\\|\\Temp\\|\\Users\\Public\\|%AppData%|%Public%|%Temp%|%tmp%|:\\Windows\\)
- name: '[Sigma] Suspicious PowerShell Mailbox Export to Share'
  tag: attack.exfiltration
  score: 100
  target: Target_Path
  condition: regex
  pattern: (?i)(New\-MailboxExportRequest|\ \-Mailbox\ |\ \-FilePath\ \\\\\\\\)
- name: '[Sigma] Malicious PowerShell Commandlets - ProcessCreation'
  tag: attack.execution,attack.discovery,attack.t1482,attack.t1087,attack.t1087.001,attack.t1087.002,attack.t1069.001,attack.t1069.002,attack.t1069,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Add\-Exfiltration|Add\-Persistence|Add\-RegBackdoor|Add\-RemoteRegBackdoor|Add\-ScrnSaveBackdoor|Check\-VM|ConvertTo\-Rc4ByteStream|Decrypt\-Hash|Disable\-ADIDNSNode|Disable\-MachineAccount|Do\-Exfiltration|Enable\-ADIDNSNode|Enable\-MachineAccount|Enabled\-DuplicateToken|Exploit\-Jboss|Export\-ADR|Export\-ADRCSV|Export\-ADRExcel|Export\-ADRHTML|Export\-ADRJSON|Export\-ADRXML|Find\-Fruit|Find\-GPOLocation|Find\-TrustedDocuments|Get\-ADIDNS|Get\-ApplicationHost|Get\-ChromeDump|Get\-ClipboardContents|Get\-FoxDump|Get\-GPPPassword|Get\-IndexedItem|Get\-KerberosAESKey|Get\-Keystrokes|Get\-LSASecret|Get\-MachineAccountAttribute|Get\-MachineAccountCreator|Get\-PassHashes|Get\-RegAlwaysInstallElevated|Get\-RegAutoLogon|Get\-RemoteBootKey|Get\-RemoteCachedCredential|Get\-RemoteLocalAccountHash|Get\-RemoteLSAKey|Get\-RemoteMachineAccountHash|Get\-RemoteNLKMKey|Get\-RickAstley|Get\-Screenshot|Get\-SecurityPackages|Get\-ServiceFilePermission|Get\-ServicePermission|Get\-ServiceUnquoted|Get\-SiteListPassword|Get\-System|Get\-TimedScreenshot|Get\-UnattendedInstallFile|Get\-Unconstrained|Get\-USBKeystrokes|Get\-VaultCredential|Get\-VulnAutoRun|Get\-VulnSchTask|Grant\-ADIDNSPermission|Gupt\-Backdoor|HTTP\-Login|Install\-ServiceBinary|Install\-SSP|Invoke\-ACLScanner|Invoke\-ADRecon|Invoke\-ADSBackdoor|Invoke\-AgentSmith|Invoke\-AllChecks|Invoke\-ARPScan|Invoke\-AzureHound|Invoke\-BackdoorLNK|Invoke\-BadPotato|Invoke\-BetterSafetyKatz|Invoke\-BypassUAC|Invoke\-Carbuncle|Invoke\-Certify|Invoke\-ConPtyShell|Invoke\-CredentialInjection|Invoke\-DAFT|Invoke\-DCSync|Invoke\-DinvokeKatz|Invoke\-DllInjection|Invoke\-DNSUpdate|Invoke\-DNSExfiltrator|Invoke\-DomainPasswordSpray|Invoke\-DowngradeAccount|Invoke\-EgressCheck|Invoke\-Eyewitness|Invoke\-FakeLogonScreen|Invoke\-Farmer|Invoke\-Get\-RBCD\-Threaded|Invoke\-Gopher|Invoke\-Grouper|Invoke\-HandleKatz|Invoke\-ImpersonatedProcess|Invoke\-ImpersonateSystem|Invoke\-InteractiveSystemPowerShell|Invoke\-Internalmonologue|Invoke\-Inveigh|Invoke\-InveighRelay|Invoke\-KrbRelay|Invoke\-LdapSignCheck|Invoke\-Lockless|Invoke\-MalSCCM|Invoke\-Mimikatz|Invoke\-Mimikittenz|Invoke\-MITM6|Invoke\-NanoDump|Invoke\-NetRipper|Invoke\-Nightmare|Invoke\-NinjaCopy|Invoke\-OfficeScrape|Invoke\-OxidResolver|Invoke\-P0wnedshell|Invoke\-Paranoia|Invoke\-PortScan|Invoke\-PoshRatHttp|Invoke\-PostExfil|Invoke\-PowerDump|Invoke\-PowerDPAPI|Invoke\-PowerShellTCP|Invoke\-PowerShellWMI|Invoke\-PPLDump|Invoke\-PsExec|Invoke\-PSInject|Invoke\-PsUaCme|Invoke\-ReflectivePEInjection|Invoke\-ReverseDNSLookup|Invoke\-Rubeus|Invoke\-RunAs|Invoke\-SafetyKatz|Invoke\-SauronEye|Invoke\-SCShell|Invoke\-Seatbelt|Invoke\-ServiceAbuse|Invoke\-ShadowSpray|Invoke\-Sharp|Invoke\-Shellcode|Invoke\-SMBScanner|Invoke\-Snaffler|Invoke\-Spoolsample|Invoke\-SpraySinglePassword|Invoke\-SSHCommand|Invoke\-StandIn|Invoke\-StickyNotesExtract|Invoke\-SystemCommand|Invoke\-Tasksbackdoor|Invoke\-Tater|Invoke\-Thunderfox|Invoke\-ThunderStruck|Invoke\-TokenManipulation|Invoke\-Tokenvator|Invoke\-TotalExec|Invoke\-UrbanBishop|Invoke\-UserHunter|Invoke\-VoiceTroll|Invoke\-Whisker|Invoke\-WinEnum|Invoke\-winPEAS|Invoke\-WireTap|Invoke\-WmiCommand|Invoke\-WMIExec|Invoke\-WScriptBypassUAC|Invoke\-Zerologon|MailRaider|New\-ADIDNSNode|New\-DNSRecordArray|New\-HoneyHash|New\-InMemoryModule|New\-MachineAccount|New\-SOASerialNumberArray|Out\-Minidump|Port\-Scan|PowerBreach|powercat\
    |PowerUp|PowerView|Remove\-ADIDNSNode|Remove\-MachineAccount|Remove\-Update|Rename\-ADIDNSNode|Revoke\-ADIDNSPermission|Set\-ADIDNSNode|Set\-MacAttribute|Set\-MachineAccountAttribute|Set\-Wallpaper|Show\-TargetScreen|Start\-CaptureServer|Start\-Dnscat2|Start\-WebcamRecorder|Veeam\-Get\-Creds|VolumeShadowCopyTools)
- name: '[Sigma] MSExchange Transport Agent Installation'
  tag: attack.persistence,attack.t1505.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)Install\-TransportAgent
- name: '[Sigma] Non Interactive PowerShell Process Spawned'
  tag: attack.execution,attack.t1059.001
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\
    \['PowerShell\.EXE',\ 'pwsh\.dll'\]\})
- name: '[Sigma] Non Interactive PowerShell Process Spawned'
  tag: attack.execution,attack.t1059.001
  score: 20
  target: ParentPath
  condition: regex
  pattern: (?i)(:\\Windows\\explorer\.exe|:\\Windows\\System32\\CompatTelRunner\.exe|:\\Windows\\SysWOW64\\explorer\.exe)$
- name: '[Sigma] Non Interactive PowerShell Process Spawned'
  tag: attack.execution,attack.t1059.001
  score: 20
  target: ParentPath
  condition: regex
  pattern: (?i):\\\$WINDOWS\.\~BT\\Sources\\SetupHost\.exe
- name: '[Sigma] Non Interactive PowerShell Process Spawned'
  tag: attack.execution,attack.t1059.001
  score: 20
  target: ParentPath
  condition: regex
  pattern: (?i)\\AppData\\Local\\Programs\\Microsoft\ VS\ Code\\Code\.exe$
- name: '[Sigma] Non Interactive PowerShell Process Spawned'
  tag: attack.execution,attack.t1059.001
  score: 20
  target: Full_Path
  condition: regex
  pattern: '(?i)\ \-\-ms\-enable\-electron\-run\-as\-node\ '
- name: '[Sigma] Non Interactive PowerShell Process Spawned'
  tag: attack.execution,attack.t1059.001
  score: 20
  target: ParentPath
  condition: regex
  pattern: (?i):\\Program\ Files\\WindowsApps\\Microsoft\.WindowsTerminal_
- name: '[Sigma] Non Interactive PowerShell Process Spawned'
  tag: attack.execution,attack.t1059.001
  score: 20
  target: ParentPath
  condition: regex
  pattern: (?i)\\WindowsTerminal\.exe$
- name: '[Sigma] Potential PowerShell Obfuscation Via WCHAR/CHAR'
  tag: attack.execution,attack.t1059.001,attack.defense-evasion,attack.t1027
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\[char\]0x|\(WCHAR\)0x)
- name: '[Sigma] Execution of Powershell Script in Public Folder'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\pwsh\.exe)$
- name: '[Sigma] Execution of Powershell Script in Public Folder'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-f\ C:\\Users\\Public|\-f\ "C:\\Users\\Public|\-f\ %Public%|\-fi\
    C:\\Users\\Public|\-fi\ "C:\\Users\\Public|\-fi\ %Public%|\-fil\ C:\\Users\\Public|\-fil\
    "C:\\Users\\Public|\-fil\ %Public%|\-file\ C:\\Users\\Public|\-file\ "C:\\Users\\Public|\-file\
    %Public%)
- name: '[Sigma] RemoteFXvGPUDisablement Abuse Via AtomicTestHarnesses'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Invoke\-ATHRemoteFXvGPUDisablementCommand|Invoke\-ATHRemoteFXvGPUDisableme)
- name: '[Sigma] Tamper Windows Defender Remove-MpPreference'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)Remove\-MpPreference
- name: '[Sigma] Tamper Windows Defender Remove-MpPreference'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-ControlledFolderAccessProtectedFolders\ |\-AttackSurfaceReductionRules_Ids\
    |\-AttackSurfaceReductionRules_Actions\ |\-CheckForSignaturesBeforeRunningScan\
    )
- name: '[Sigma] Potential Powershell ReverseShell Connection'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ \['PowerShell\.EXE',\ 'pwsh\.dll'\]\}|\{'Image\|endswith':\
    \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\})
- name: '[Sigma] Potential Powershell ReverseShell Connection'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ Net\.Sockets\.TCPClient|\.GetStream\(|\.Write\()
- name: '[Sigma] Run PowerShell Script from ADS'
  tag: attack.defense-evasion,attack.t1564.004
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\pwsh\.exe)$
- name: '[Sigma] Run PowerShell Script from ADS'
  tag: attack.defense-evasion,attack.t1564.004
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\pwsh\.exe)$
- name: '[Sigma] Run PowerShell Script from ADS'
  tag: attack.defense-evasion,attack.t1564.004
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Get\-Content|\-Stream)
- name: '[Sigma] Run PowerShell Script from Redirected Input Stream'
  tag: attack.defense-evasion,attack.execution,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\pwsh\.exe)$
- name: '[Sigma] Run PowerShell Script from Redirected Input Stream'
  tag: attack.defense-evasion,attack.execution,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\s\-\\s.*<
- name: '[Sigma] PowerShell SAM Copy'
  tag: attack.credential-access,attack.t1003.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\HarddiskVolumeShadowCopy|System32\\config\\sam)
- name: '[Sigma] PowerShell SAM Copy'
  tag: attack.credential-access,attack.t1003.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Copy\-Item|cp\ \$_\.|cpi\ \$_\.|copy\ \$_\.|\.File\]::Copy\()
- name: '[Sigma] Suspicious PowerShell Invocation From Script Engines'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(\\wscript\.exe|\\cscript\.exe)$
- name: '[Sigma] Suspicious PowerShell Invocation From Script Engines'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\pwsh\.exe)$
- name: '[Sigma] Suspicious PowerShell Invocation From Script Engines'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Health\ Service\ State\\
- name: '[Sigma] Suspicious Service DACL Modification Via Set-Service Cmdlet'
  tag: attack.privilege-escalation,attack.persistence,attack.t1543.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\pwsh\.exe'\}|\{'OriginalFileName':\ 'pwsh\.dll'\})
- name: '[Sigma] Suspicious Service DACL Modification Via Set-Service Cmdlet'
  tag: attack.privilege-escalation,attack.persistence,attack.t1543.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-SecurityDescriptorSddl\ |\-sd\ )
- name: '[Sigma] Suspicious Service DACL Modification Via Set-Service Cmdlet'
  tag: attack.privilege-escalation,attack.persistence,attack.t1543.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Set\-Service\ |D;;)
- name: '[Sigma] Suspicious Service DACL Modification Via Set-Service Cmdlet'
  tag: attack.privilege-escalation,attack.persistence,attack.t1543.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(;;;IU|;;;SU|;;;BA|;;;SY|;;;WD)
- name: '[Sigma] PowerShell Script Change Permission Via Set-Acl'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ \['PowerShell\.EXE',\ 'pwsh\.dll'\]\}|\{'Image\|endswith':\
    \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\})
- name: '[Sigma] PowerShell Script Change Permission Via Set-Acl'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Set\-Acl\ |\-AclObject\ |\-Path\ )
- name: '[Sigma] PowerShell Set-Acl On Windows Folder'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ \['PowerShell\.EXE',\ 'pwsh\.dll'\]\}|\{'Image\|endswith':\
    \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\})
- name: '[Sigma] PowerShell Set-Acl On Windows Folder'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Set\-Acl\ |\-AclObject\ )
- name: '[Sigma] PowerShell Set-Acl On Windows Folder'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-Path\ "C:\\Windows|\-Path\ 'C:\\Windows|\-Path\ %windir%|\-Path\
    \$env:windir)
- name: '[Sigma] PowerShell Set-Acl On Windows Folder'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(FullControl|Allow)
- name: '[Sigma] Change PowerShell Policies to an Insecure Level'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ \['powershell_ise\.exe',\ 'PowerShell\.EXE',\
    'pwsh\.dll'\]\}|\{'Image\|endswith':\ \['\\\\powershell_ise\.exe',\ '\\\\powershell\.exe',\
    '\\\\pwsh\.exe'\]\})
- name: '[Sigma] Change PowerShell Policies to an Insecure Level'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-executionpolicy\ |\ \-ep\ |\ \-exec\ )
- name: '[Sigma] Change PowerShell Policies to an Insecure Level'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Bypass|Unrestricted)
- name: '[Sigma] Change PowerShell Policies to an Insecure Level'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(C:\\Windows\\SysWOW64\\msiexec\.exe|C:\\Windows\\System32\\msiexec\.exe)
- name: '[Sigma] Change PowerShell Policies to an Insecure Level'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-NoProfile\ \-ExecutionPolicy\ Bypass\ \-File\ "C:\\Program\ Files\\PowerShell\\7\\|\-NoProfile\
    \-ExecutionPolicy\ Bypass\ \-File\ "C:\\Program\ Files\ \(x86\)\\PowerShell\\7\\)
- name: '[Sigma] Change PowerShell Policies to an Insecure Level'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(C:\\Program\ Files\\Avast\ Software\\Avast\\|C:\\Program\ Files\ \(x86\)\\Avast\
    Software\\Avast\\|\\instup\.exe)
- name: '[Sigma] Change PowerShell Policies to an Insecure Level'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-ExecutionPolicy\ ByPass\ \-File\ "C:\\Program\ Files\\Avast\ Software\\Avast|\-ExecutionPolicy\
    ByPass\ \-File\ "C:\\Program\ Files\ \(x86\)\\Avast\ Software\\Avast\\)
- name: '[Sigma] Service StartupType Change Via PowerShell Set-Service'
  tag: attack.execution,attack.defense-evasion,attack.t1562.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\powershell\.exe'\}|\{'OriginalFileName':\
    'PowerShell\.EXE'\})
- name: '[Sigma] Service StartupType Change Via PowerShell Set-Service'
  tag: attack.execution,attack.defense-evasion,attack.t1562.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Set\-Service|\-StartupType)
- name: '[Sigma] Service StartupType Change Via PowerShell Set-Service'
  tag: attack.execution,attack.defense-evasion,attack.t1562.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Disabled|Manual)
- name: '[Sigma] Deletion of Volume Shadow Copies via WMI with PowerShell'
  tag: attack.impact,attack.t1490
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Get\-WmiObject|gwmi|Get\-CimInstance|gcim)
- name: '[Sigma] Deletion of Volume Shadow Copies via WMI with PowerShell'
  tag: attack.impact,attack.t1490
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)Win32_ShadowCopy
- name: '[Sigma] Deletion of Volume Shadow Copies via WMI with PowerShell'
  tag: attack.impact,attack.t1490
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.Delete\(\)|Remove\-WmiObject|rwmi|Remove\-CimInstance|rcim)
- name: '[Sigma] Exchange PowerShell Snap-Ins Usage'
  tag: attack.execution,attack.t1059.001,attack.collection,attack.t1114
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\
    \['PowerShell\.EXE',\ 'pwsh\.dll'\]\})
- name: '[Sigma] Exchange PowerShell Snap-Ins Usage'
  tag: attack.execution,attack.t1059.001,attack.collection,attack.t1114
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)Add\-PSSnapin
- name: '[Sigma] Exchange PowerShell Snap-Ins Usage'
  tag: attack.execution,attack.t1059.001,attack.collection,attack.t1114
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Microsoft\.Exchange\.Powershell\.Snapin|Microsoft\.Exchange\.Management\.PowerShell\.SnapIn)
- name: '[Sigma] Exchange PowerShell Snap-Ins Usage'
  tag: attack.execution,attack.t1059.001,attack.collection,attack.t1114
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\msiexec\.exe
- name: '[Sigma] Exchange PowerShell Snap-Ins Usage'
  tag: attack.execution,attack.t1059.001,attack.collection,attack.t1114
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\$exserver=Get\-ExchangeServer\ \(\[Environment\]::MachineName\)\ \-ErrorVariable\
    exerr\ 2>\ \$null
- name: '[Sigma] Stop Windows Service Via PowerShell Stop-Service'
  tag: attack.impact,attack.t1489
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ \['PowerShell\.EXE',\ 'pwsh\.dll'\]\}|\{'Image\|endswith':\
    \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\})
- name: '[Sigma] Stop Windows Service Via PowerShell Stop-Service'
  tag: attack.impact,attack.t1489
  score: 20
  target: Target_Path
  condition: regex
  pattern: '(?i)Stop\-Service\ '
- name: '[Sigma] Suspicious PowerShell Download and Execute Pattern'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(IEX\ \(\(New\-Object\ Net\.WebClient\)\.DownloadString|IEX\ \(New\-Object\
    Net\.WebClient\)\.DownloadString|IEX\(\(New\-Object\ Net\.WebClient\)\.DownloadString|IEX\(New\-Object\
    Net\.WebClient\)\.DownloadString|\ \-command\ \(New\-Object\ System\.Net\.WebClient\)\.DownloadFile\(|\
    \-c\ \(New\-Object\ System\.Net\.WebClient\)\.DownloadFile\()
- name: '[Sigma] Suspicious PowerShell Parameter Substring'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\pwsh\.exe)$
- name: '[Sigma] Suspicious PowerShell Parameter Substring'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-windowstyle\ h\ |\ \-windowstyl\ h|\ \-windowsty\ h|\ \-windowst\
    h|\ \-windows\ h|\ \-windo\ h|\ \-wind\ h|\ \-win\ h|\ \-wi\ h|\ \-win\ h\ |\
    \-win\ hi\ |\ \-win\ hid\ |\ \-win\ hidd\ |\ \-win\ hidde\ |\ \-NoPr\ |\ \-NoPro\
    |\ \-NoProf\ |\ \-NoProfi\ |\ \-NoProfil\ |\ \-nonin\ |\ \-nonint\ |\ \-noninte\
    |\ \-noninter\ |\ \-nonintera\ |\ \-noninterac\ |\ \-noninteract\ |\ \-noninteracti\
    |\ \-noninteractiv\ |\ \-ec\ |\ \-encodedComman\ |\ \-encodedComma\ |\ \-encodedComm\
    |\ \-encodedCom\ |\ \-encodedCo\ |\ \-encodedC\ |\ \-encoded\ |\ \-encode\ |\
    \-encod\ |\ \-enco\ |\ \-en\ |\ \-executionpolic\ |\ \-executionpoli\ |\ \-executionpol\
    |\ \-executionpo\ |\ \-executionp\ |\ \-execution\ bypass|\ \-executio\ bypass|\
    \-executi\ bypass|\ \-execut\ bypass|\ \-execu\ bypass|\ \-exec\ bypass|\ \-exe\
    bypass|\ \-ex\ bypass|\ \-ep\ bypass|\ /windowstyle\ h\ |\ /windowstyl\ h|\ /windowsty\
    h|\ /windowst\ h|\ /windows\ h|\ /windo\ h|\ /wind\ h|\ /win\ h|\ /wi\ h|\ /win\
    h\ |\ /win\ hi\ |\ /win\ hid\ |\ /win\ hidd\ |\ /win\ hidde\ |\ /NoPr\ |\ /NoPro\
    |\ /NoProf\ |\ /NoProfi\ |\ /NoProfil\ |\ /nonin\ |\ /nonint\ |\ /noninte\ |\
    /noninter\ |\ /nonintera\ |\ /noninterac\ |\ /noninteract\ |\ /noninteracti\ |\
    /noninteractiv\ |\ /ec\ |\ /encodedComman\ |\ /encodedComma\ |\ /encodedComm\
    |\ /encodedCom\ |\ /encodedCo\ |\ /encodedC\ |\ /encoded\ |\ /encode\ |\ /encod\
    |\ /enco\ |\ /en\ |\ /executionpolic\ |\ /executionpoli\ |\ /executionpol\ |\
    /executionpo\ |\ /executionp\ |\ /execution\ bypass|\ /executio\ bypass|\ /executi\
    bypass|\ /execut\ bypass|\ /execu\ bypass|\ /exec\ bypass|\ /exe\ bypass|\ /ex\
    bypass|\ /ep\ bypass)
- name: '[Sigma] Suspicious PowerShell Parent Process'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'ParentImage\|contains':\ 'tomcat'\}|\{'ParentImage\|endswith':\
    \['\\\\amigo\.exe',\ '\\\\browser\.exe',\ '\\\\chrome\.exe',\ '\\\\firefox\.exe',\
    '\\\\httpd\.exe',\ '\\\\iexplore\.exe',\ '\\\\jbosssvc\.exe',\ '\\\\microsoftedge\.exe',\
    '\\\\microsoftedgecp\.exe',\ '\\\\MicrosoftEdgeSH\.exe',\ '\\\\mshta\.exe',\ '\\\\nginx\.exe',\
    '\\\\outlook\.exe',\ '\\\\php\-cgi\.exe',\ '\\\\regsvr32\.exe',\ '\\\\rundll32\.exe',\
    '\\\\safari\.exe',\ '\\\\services\.exe',\ '\\\\sqlagent\.exe',\ '\\\\sqlserver\.exe',\
    '\\\\sqlservr\.exe',\ '\\\\vivaldi\.exe',\ '\\\\w3wp\.exe'\]\})
- name: '[Sigma] Suspicious PowerShell Parent Process'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\}|\{'CommandLine\|contains':\
    \['/c\ powershell',\ '/c\ pwsh'\]\}|\{'Description':\ 'Windows\ PowerShell'\}|\{'Product':\
    'PowerShell\ Core\ 6'\}|\{'OriginalFileName':\ \['PowerShell\.EXE',\ 'pwsh\.dll'\]\})
- name: '[Sigma] PowerShell Script Run in AppData'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(powershell\.exe|\\powershell|\\pwsh|pwsh\.exe)
- name: '[Sigma] PowerShell Script Run in AppData'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/c\ |\\AppData\\)
- name: '[Sigma] PowerShell Script Run in AppData'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Local\\|Roaming\\)
- name: '[Sigma] Powershell Token Obfuscation - Process Creation'
  tag: attack.defense-evasion,attack.t1027.009
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|re':\ '\\\\w\+`\(\\\\w\+\|\-\|\.\)`\[\\\\w\+\|\\\\s\]'\}|\{'CommandLine\|re':\
    '"\(\\\\\{\\\\d\\\\\}\)\+"\\\\s.*\-f'\}|\{'CommandLine\|re':\ '\(.i\)\\\\\$\\\\\{`.e`.n`.v`.:`.p`.a`.t`.h`.\\\\\}'\})
- name: '[Sigma] Powershell Token Obfuscation - Process Creation'
  tag: attack.defense-evasion,attack.t1027.009
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\$\{env:path\}
- name: '[Sigma] User Discovery And Export Via Get-ADUser Cmdlet'
  tag: attack.discovery,attack.t1033
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\
    \['PowerShell\.EXE',\ 'pwsh\.dll'\]\})
- name: '[Sigma] User Discovery And Export Via Get-ADUser Cmdlet'
  tag: attack.discovery,attack.t1033
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Get\-ADUser\ |\ \-Filter\ \\.*)
- name: '[Sigma] User Discovery And Export Via Get-ADUser Cmdlet'
  tag: attack.discovery,attack.t1033
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ >\ |\ \|\ Select\ |Out\-File|Set\-Content|Add\-Content)
- name: '[Sigma] Net WebClient Casing Anomalies'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\
    \['PowerShell\.EXE',\ 'pwsh\.dll'\]\})
- name: '[Sigma] Net WebClient Casing Anomalies'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(TgBlAFQALgB3AEUAQg|4AZQBUAC4AdwBFAEIA|OAGUAVAAuAHcARQBCA|bgBFAHQALgB3AGUAYg|4ARQB0AC4AdwBlAGIA|uAEUAdAAuAHcAZQBiA|TgBFAHQALgB3AGUAYg|OAEUAdAAuAHcAZQBiA|bgBlAFQALgB3AGUAYg|4AZQBUAC4AdwBlAGIA|uAGUAVAAuAHcAZQBiA|TgBlAFQALgB3AGUAYg|OAGUAVAAuAHcAZQBiA|bgBFAFQALgB3AGUAYg|4ARQBUAC4AdwBlAGIA|uAEUAVAAuAHcAZQBiA|bgBlAHQALgBXAGUAYg|4AZQB0AC4AVwBlAGIA|uAGUAdAAuAFcAZQBiA|bgBFAHQALgBXAGUAYg|4ARQB0AC4AVwBlAGIA|uAEUAdAAuAFcAZQBiA|TgBFAHQALgBXAGUAYg|OAEUAdAAuAFcAZQBiA|bgBlAFQALgBXAGUAYg|4AZQBUAC4AVwBlAGIA|uAGUAVAAuAFcAZQBiA|TgBlAFQALgBXAGUAYg|OAGUAVAAuAFcAZQBiA|bgBFAFQALgBXAGUAYg|4ARQBUAC4AVwBlAGIA|uAEUAVAAuAFcAZQBiA|bgBlAHQALgB3AEUAYg|4AZQB0AC4AdwBFAGIA|uAGUAdAAuAHcARQBiA|TgBlAHQALgB3AEUAYg|OAGUAdAAuAHcARQBiA|bgBFAHQALgB3AEUAYg|4ARQB0AC4AdwBFAGIA|uAEUAdAAuAHcARQBiA|TgBFAHQALgB3AEUAYg|OAEUAdAAuAHcARQBiA|bgBlAFQALgB3AEUAYg|4AZQBUAC4AdwBFAGIA|uAGUAVAAuAHcARQBiA|TgBlAFQALgB3AEUAYg|OAGUAVAAuAHcARQBiA|bgBFAFQALgB3AEUAYg|4ARQBUAC4AdwBFAGIA|uAEUAVAAuAHcARQBiA|TgBFAFQALgB3AEUAYg|OAEUAVAAuAHcARQBiA|bgBlAHQALgBXAEUAYg|4AZQB0AC4AVwBFAGIA|uAGUAdAAuAFcARQBiA|TgBlAHQALgBXAEUAYg|OAGUAdAAuAFcARQBiA|bgBFAHQALgBXAEUAYg|4ARQB0AC4AVwBFAGIA|uAEUAdAAuAFcARQBiA|TgBFAHQALgBXAEUAYg|OAEUAdAAuAFcARQBiA|bgBlAFQALgBXAEUAYg|4AZQBUAC4AVwBFAGIA|uAGUAVAAuAFcARQBiA|TgBlAFQALgBXAEUAYg|OAGUAVAAuAFcARQBiA|bgBFAFQALgBXAEUAYg|4ARQBUAC4AVwBFAGIA|uAEUAVAAuAFcARQBiA|TgBFAFQALgBXAEUAYg|OAEUAVAAuAFcARQBiA|bgBlAHQALgB3AGUAQg|4AZQB0AC4AdwBlAEIA|uAGUAdAAuAHcAZQBCA|TgBlAHQALgB3AGUAQg|OAGUAdAAuAHcAZQBCA|bgBFAHQALgB3AGUAQg|4ARQB0AC4AdwBlAEIA|uAEUAdAAuAHcAZQBCA|TgBFAHQALgB3AGUAQg|OAEUAdAAuAHcAZQBCA|bgBlAFQALgB3AGUAQg|4AZQBUAC4AdwBlAEIA|uAGUAVAAuAHcAZQBCA|TgBlAFQALgB3AGUAQg|OAGUAVAAuAHcAZQBCA|bgBFAFQALgB3AGUAQg|4ARQBUAC4AdwBlAEIA|uAEUAVAAuAHcAZQBCA|TgBFAFQALgB3AGUAQg|OAEUAVAAuAHcAZQBCA|bgBlAHQALgBXAGUAQg|4AZQB0AC4AVwBlAEIA|uAGUAdAAuAFcAZQBCA|TgBlAHQALgBXAGUAQg|OAGUAdAAuAFcAZQBCA|bgBFAHQALgBXAGUAQg|4ARQB0AC4AVwBlAEIA|uAEUAdAAuAFcAZQBCA|TgBFAHQALgBXAGUAQg|OAEUAdAAuAFcAZQBCA|bgBlAFQALgBXAGUAQg|4AZQBUAC4AVwBlAEIA|uAGUAVAAuAFcAZQBCA|TgBlAFQALgBXAGUAQg|OAGUAVAAuAFcAZQBCA|bgBFAFQALgBXAGUAQg|4ARQBUAC4AVwBlAEIA|uAEUAVAAuAFcAZQBCA|TgBFAFQALgBXAGUAQg|OAEUAVAAuAFcAZQBCA|bgBlAHQALgB3AEUAQg|4AZQB0AC4AdwBFAEIA|uAGUAdAAuAHcARQBCA|TgBlAHQALgB3AEUAQg|OAGUAdAAuAHcARQBCA|bgBFAHQALgB3AEUAQg|4ARQB0AC4AdwBFAEIA|uAEUAdAAuAHcARQBCA|TgBFAHQALgB3AEUAQg|OAEUAdAAuAHcARQBCA|bgBlAFQALgB3AEUAQg|uAGUAVAAuAHcARQBCA|bgBFAFQALgB3AEUAQg|4ARQBUAC4AdwBFAEIA|uAEUAVAAuAHcARQBCA|TgBFAFQALgB3AEUAQg|OAEUAVAAuAHcARQBCA|TgBlAHQALgBXAEUAQg|4AZQB0AC4AVwBFAEIA|OAGUAdAAuAFcARQBCA|bgBFAHQALgBXAEUAQg|4ARQB0AC4AVwBFAEIA|uAEUAdAAuAFcARQBCA|TgBFAHQALgBXAEUAQg|OAEUAdAAuAFcARQBCA|bgBlAFQALgBXAEUAQg|4AZQBUAC4AVwBFAEIA|uAGUAVAAuAFcARQBCA|TgBlAFQALgBXAEUAQg|OAGUAVAAuAFcARQBCA|bgBFAFQALgBXAEUAQg|4ARQBUAC4AVwBFAEIA|uAEUAVAAuAFcARQBCA)
- name: '[Sigma] Suspicious X509Enrollment - Process Creation'
  tag: attack.defense-evasion,attack.t1553.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(X509Enrollment\.CBinaryConverter|884e2002\-217d\-11da\-b2a4\-000e7bbb2b09)
- name: '[Sigma] Suspicious XOR Encoded PowerShell Command'
  tag: attack.defense-evasion,attack.execution,attack.t1059.001,attack.t1140,attack.t1027
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\
    \['PowerShell\.EXE',\ 'pwsh\.dll'\]\}|\{'Description':\ 'Windows\ PowerShell'\}|\{'Product':\
    'PowerShell\ Core\ 6'\})
- name: '[Sigma] Suspicious XOR Encoded PowerShell Command'
  tag: attack.defense-evasion,attack.execution,attack.t1059.001,attack.t1140,attack.t1027
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)bxor
- name: '[Sigma] Suspicious XOR Encoded PowerShell Command'
  tag: attack.defense-evasion,attack.execution,attack.t1059.001,attack.t1140,attack.t1027
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(ForEach|for\(|for\ |\-join\ |\-join'|\-join"|\-join`|::Join|\[char\])
- name: '[Sigma] Folder Compress To Potentially Suspicious Output Via Compress-Archive
    Cmdlet'
  tag: attack.collection,attack.t1074.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Compress\-Archive\ \-Path.*\-DestinationPath\ \$env:TEMP|Compress\-Archive\
    \-Path.*\-DestinationPath.*\\AppData\\Local\\Temp\\|Compress\-Archive\ \-Path.*\-DestinationPath.*:\\Windows\\Temp\\)
- name: '[Sigma] Arbitrary File Download Via PresentationHost.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\presentationhost\.exe'\}|\{'OriginalFileName':\
    'PresentationHost\.exe'\})
- name: '[Sigma] Arbitrary File Download Via PresentationHost.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(http://|https://|ftp://)
- name: '[Sigma] XBAP Execution From Uncommon Locations Via PresentationHost.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\presentationhost\.exe'\}|\{'OriginalFileName':\
    'PresentationHost\.exe'\})
- name: '[Sigma] XBAP Execution From Uncommon Locations Via PresentationHost.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\.xbap
- name: '[Sigma] XBAP Execution From Uncommon Locations Via PresentationHost.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ C:\\Windows\\|\ C:\\Program\ Files)
- name: '[Sigma] Visual Studio NodejsTools PressAnyKey Arbitrary Binary Execution'
  tag: attack.execution,attack.defense-evasion,attack.t1218
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\Microsoft\.NodejsTools\.PressAnyKey\.exe$
- name: '[Sigma] Abusing Print Executable'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\print\.exe$
- name: '[Sigma] Abusing Print Executable'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^print
- name: '[Sigma] Abusing Print Executable'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/D|\.exe)
- name: '[Sigma] Abusing Print Executable'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)print\.exe
- name: '[Sigma] File Download Using ProtocolHandler.exe'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\protocolhandler\.exe'\}|\{'OriginalFileName':\
    'ProtocolHandler\.exe'\})
- name: '[Sigma] File Download Using ProtocolHandler.exe'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(ftp://|http://|https://)
- name: '[Sigma] Potential Provlaunch.EXE Binary Proxy Execution Abuse'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\provlaunch\.exe$
- name: '[Sigma] Potential Provlaunch.EXE Binary Proxy Execution Abuse'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\calc\.exe',\ '\\\\cmd\.exe',\ '\\\\cscript\.exe',\
    '\\\\mshta\.exe',\ '\\\\notepad\.exe',\ '\\\\powershell\.exe',\ '\\\\pwsh\.exe',\
    '\\\\regsvr32\.exe',\ '\\\\rundll32\.exe',\ '\\\\wscript\.exe'\]\}|\{'Image\|contains':\
    \[':\\\\PerfLogs\\\\',\ ':\\\\Temp\\\\',\ ':\\\\Users\\\\Public\\\\',\ '\\\\AppData\\\\Temp\\\\',\
    '\\\\Windows\\\\System32\\\\Tasks\\\\',\ '\\\\Windows\\\\Tasks\\\\',\ '\\\\Windows\\\\Temp\\\\'\]\})
- name: '[Sigma] Suspicious Provlaunch.EXE Child Process'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\provlaunch\.exe$
- name: '[Sigma] Suspicious Provlaunch.EXE Child Process'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\calc\.exe',\ '\\\\cmd\.exe',\ '\\\\cscript\.exe',\
    '\\\\mshta\.exe',\ '\\\\notepad\.exe',\ '\\\\powershell\.exe',\ '\\\\pwsh\.exe',\
    '\\\\regsvr32\.exe',\ '\\\\rundll32\.exe',\ '\\\\wscript\.exe'\]\}|\{'Image\|contains':\
    \[':\\\\PerfLogs\\\\',\ ':\\\\Temp\\\\',\ ':\\\\Users\\\\Public\\\\',\ '\\\\AppData\\\\Temp\\\\',\
    '\\\\Windows\\\\System32\\\\Tasks\\\\',\ '\\\\Windows\\\\Tasks\\\\',\ '\\\\Windows\\\\Temp\\\\'\]\})
- name: '[Sigma] Screen Capture Activity Via Psr.EXE'
  tag: attack.collection,attack.t1113
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\Psr\.exe$
- name: '[Sigma] Screen Capture Activity Via Psr.EXE'
  tag: attack.collection,attack.t1113
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/start|\-start)
- name: '[Sigma] PUA - 3Proxy Execution'
  tag: attack.command-and-control,attack.t1572
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\3proxy\.exe$
- name: '[Sigma] PUA - 3Proxy Execution'
  tag: attack.command-and-control,attack.t1572
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)3proxy\ \-\ tiny\ proxy\ server
- name: '[Sigma] PUA - 3Proxy Execution'
  tag: attack.command-and-control,attack.t1572
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\.exe\ \-i127\.0\.0\.1\ \-p
- name: '[Sigma] PUA - Suspicious ActiveDirectory Enumeration Via AdFind.EXE'
  tag: attack.discovery,attack.t1087.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(lockoutduration|lockoutthreshold|lockoutobservationwindow|maxpwdage|minpwdage|minpwdlength|pwdhistorylength|pwdproperties)
- name: '[Sigma] PUA - Suspicious ActiveDirectory Enumeration Via AdFind.EXE'
  tag: attack.discovery,attack.t1087.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\-sc\ admincountdmp
- name: '[Sigma] PUA - Suspicious ActiveDirectory Enumeration Via AdFind.EXE'
  tag: attack.discovery,attack.t1087.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\-sc\ exchaddresses
- name: '[Sigma] PUA - AdFind Suspicious Execution'
  tag: attack.discovery,attack.t1018,attack.t1087.002,attack.t1482,attack.t1069.002,stp.1u
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(domainlist|trustdmp|dcmodes|adinfo|\-sc\ dclist|computer_pwdnotreqd|objectcategory=|\-subnets\
    \-f|name="Domain\ Admins"|\-sc\ u:|domainncs|dompol|\ oudmp\ |subnetdmp|gpodmp|fspdmp|users_noexpire|computers_active|computers_pwdnotreqd)
- name: '[Sigma] PUA - AdvancedRun Execution'
  tag: attack.execution,attack.defense-evasion,attack.privilege-escalation,attack.t1564.003,attack.t1134.002,attack.t1059.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'AdvancedRun\.exe'\}|\{'CommandLine\|contains\|all':\
    \['\ /EXEFilename\ ',\ '\ /Run'\]\}|\{'CommandLine\|contains\|all':\ \['\ /WindowState\
    0',\ '\ /RunAs\ ',\ '\ /CommandLine\ '\]\})
- name: '[Sigma] PUA - AdvancedRun Suspicious Execution'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1134.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(/EXEFilename|/CommandLine)
- name: '[Sigma] PUA - AdvancedRun Suspicious Execution'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1134.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains':\ \['\ /RunAs\ 8\ ',\ '\ /RunAs\ 4\ ',\
    '\ /RunAs\ 10\ ',\ '\ /RunAs\ 11\ '\]\}|\{'CommandLine\|endswith':\ \['/RunAs\
    8',\ '/RunAs\ 4',\ '/RunAs\ 10',\ '/RunAs\ 11'\]\})
- name: '[Sigma] PUA - Advanced IP Scanner Execution'
  tag: attack.discovery,attack.t1046,attack.t1135
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|contains':\ '\\\\advanced_ip_scanner'\}|\{'OriginalFileName\|contains':\
    'advanced_ip_scanner'\}|\{'Description\|contains':\ 'Advanced\ IP\ Scanner'\})
- name: '[Sigma] PUA - Advanced IP Scanner Execution'
  tag: attack.discovery,attack.t1046,attack.t1135
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/portable|/lng)
- name: '[Sigma] PUA - Advanced Port Scanner Execution'
  tag: attack.discovery,attack.t1046,attack.t1135
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|contains':\ '\\\\advanced_port_scanner'\}|\{'OriginalFileName\|contains':\
    'advanced_port_scanner'\}|\{'Description\|contains':\ 'Advanced\ Port\ Scanner'\})
- name: '[Sigma] PUA - Advanced Port Scanner Execution'
  tag: attack.discovery,attack.t1046,attack.t1135
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/portable|/lng)
- name: '[Sigma] PUA - Chisel Tunneling Tool Execution'
  tag: attack.command-and-control,attack.t1090.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\chisel\.exe$
- name: '[Sigma] PUA - Chisel Tunneling Tool Execution'
  tag: attack.command-and-control,attack.t1090.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(exe\ client\ |exe\ server\ )
- name: '[Sigma] PUA - Chisel Tunneling Tool Execution'
  tag: attack.command-and-control,attack.t1090.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-socks5|\-reverse|\ r:|:127\.0\.0\.1:|\-tls\-skip\-verify\ |:socks)
- name: '[Sigma] PUA - CleanWipe Execution'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\SepRemovalToolNative_x64\.exe$
- name: '[Sigma] PUA - CleanWipe Execution'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\CATClean\.exe$
- name: '[Sigma] PUA - CleanWipe Execution'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\-\-uninstall
- name: '[Sigma] PUA - CleanWipe Execution'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\NetInstaller\.exe$
- name: '[Sigma] PUA - CleanWipe Execution'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\-r
- name: '[Sigma] PUA - CleanWipe Execution'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\WFPUnins\.exe$
- name: '[Sigma] PUA - CleanWipe Execution'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(/uninstall|/enterprise)
- name: '[Sigma] PUA - Crassus Execution'
  tag: attack.discovery,attack.reconnaissance,attack.t1590.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\Crassus\.exe'\}|\{'OriginalFileName':\
    'Crassus\.exe'\}|\{'Description\|contains':\ 'Crassus'\})
- name: '[Sigma] PUA - CsExec Execution'
  tag: attack.resource-development,attack.t1587.001,attack.execution,attack.t1569.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\csexec\.exe$
- name: '[Sigma] PUA - CsExec Execution'
  tag: attack.resource-development,attack.t1587.001,attack.execution,attack.t1569.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)csexec
- name: '[Sigma] PUA - DefenderCheck Execution'
  tag: attack.defense-evasion,attack.t1027.005
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\DefenderCheck\.exe'\}|\{'Description':\
    'DefenderCheck'\})
- name: '[Sigma] PUA - DIT Snapshot Viewer'
  tag: attack.credential-access,attack.t1003.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\ditsnap\.exe'\}|\{'CommandLine\|contains':\
    'ditsnap\.exe'\})
- name: '[Sigma] PUA - Fast Reverse Proxy (FRP) Execution'
  tag: attack.command-and-control,attack.t1090
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\frpc\.exe|\\frps\.exe)$
- name: '[Sigma] PUA - Fast Reverse Proxy (FRP) Execution'
  tag: attack.command-and-control,attack.t1090
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\frpc\.ini
- name: '[Sigma] PUA - Fast Reverse Proxy (FRP) Execution'
  tag: attack.command-and-control,attack.t1090
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(MD5=7D9C233B8C9E3F0EA290D2B84593C842|SHA1=06DDC9280E1F1810677935A2477012960905942F|SHA256=57B0936B8D336D8E981C169466A15A5FD21A7D5A2C7DAF62D5E142EE860E387C)
- name: '[Sigma] PUA- IOX Tunneling Tool Execution'
  tag: attack.command-and-control,attack.t1090
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\iox\.exe$
- name: '[Sigma] PUA- IOX Tunneling Tool Execution'
  tag: attack.command-and-control,attack.t1090
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.exe\ fwd\ \-l\ |\.exe\ fwd\ \-r\ |\.exe\ proxy\ \-l\ |\.exe\ proxy\
    \-r\ )
- name: '[Sigma] PUA- IOX Tunneling Tool Execution'
  tag: attack.command-and-control,attack.t1090
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(MD5=9DB2D314DD3F704A02051EF5EA210993|SHA1=039130337E28A6623ECF9A0A3DA7D92C5964D8DD|SHA256=C6CF82919B809967D9D90EA73772A8AA1C1EB3BC59252D977500F64F1A0D6731)
- name: '[Sigma] PUA - Mouse Lock Execution'
  tag: attack.credential-access,attack.collection,attack.t1056.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Product\|contains':\ 'Mouse\ Lock'\}|\{'Company\|contains':\ 'Misc314'\}|\{'CommandLine\|contains':\
    'Mouse\ Lock_'\})
- name: '[Sigma] PUA - Netcat Suspicious Execution'
  tag: attack.command-and-control,attack.t1095
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\nc\.exe|\\ncat\.exe|\\netcat\.exe)$
- name: '[Sigma] PUA - Netcat Suspicious Execution'
  tag: attack.command-and-control,attack.t1095
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-lvp\ |\ \-lvnp|\ \-l\ \-v\ \-p\ |\ \-lv\ \-p\ |\ \-l\ \-\-proxy\-type\
    http\ |\ \-vnl\ \-\-exec\ |\ \-vnl\ \-e\ |\ \-\-lua\-exec\ |\ \-\-sh\-exec\ )
- name: '[Sigma] PUA - SoftPerfect Netscan Execution'
  tag: attack.discovery,attack.t1046
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\netscan\.exe'\}|\{'Product':\ 'Network\
    Scanner'\}|\{'Description':\ 'Application\ for\ scanning\ networks'\})
- name: '[Sigma] PUA - Ngrok Execution'
  tag: attack.command-and-control,attack.t1572
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ tcp\ 139|\ tcp\ 445|\ tcp\ 3389|\ tcp\ 5985|\ tcp\ 5986)
- name: '[Sigma] PUA - Ngrok Execution'
  tag: attack.command-and-control,attack.t1572
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ start\ |\-\-all|\-\-config|\.yml)
- name: '[Sigma] PUA - Ngrok Execution'
  tag: attack.command-and-control,attack.t1572
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)ngrok\.exe$
- name: '[Sigma] PUA - Ngrok Execution'
  tag: attack.command-and-control,attack.t1572
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ tcp\ |\ http\ |\ authtoken\ )
- name: '[Sigma] PUA - Ngrok Execution'
  tag: attack.command-and-control,attack.t1572
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.exe\ authtoken\ |\.exe\ start\ \-\-all)
- name: '[Sigma] PUA - Nimgrab Execution'
  tag: attack.command-and-control,attack.t1105
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\nimgrab\.exe$
- name: '[Sigma] PUA - Nimgrab Execution'
  tag: attack.command-and-control,attack.t1105
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(MD5=2DD44C3C29D667F5C0EF5F9D7C7FFB8B|SHA256=F266609E91985F0FE3E31C5E8FAEEEC4FFA5E0322D8B6F15FE69F4C5165B9559|IMPHASH=C07FDDD21D123EA9B3A08EEF44AAAC45)
- name: '[Sigma] PUA - NimScan Execution'
  tag: attack.discovery,attack.t1046
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\NimScan\.exe'\}|\{'Hashes\|contains':\
    \['IMPHASH=41BB1C7571B3A724EB83A1D2B96DBB8C',\ 'IMPHASH=B1B6ADACB172795480179EFD18A29549',\
    'IMPHASH=0D1F896DC7642AD8384F9042F30279C2'\]\})
- name: '[Sigma] PUA - NirCmd Execution'
  tag: attack.execution,attack.t1569.002,attack.s0029
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\NirCmd\.exe'\}|\{'OriginalFileName':\ 'NirCmd\.exe'\})
- name: '[Sigma] PUA - NirCmd Execution'
  tag: attack.execution,attack.t1569.002,attack.s0029
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ execmd\ |\.exe\ script\ |\.exe\ shexec\ |\ runinteractive\ )
- name: '[Sigma] PUA - NirCmd Execution'
  tag: attack.execution,attack.t1569.002,attack.s0029
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ exec\ |\ exec2\ )
- name: '[Sigma] PUA - NirCmd Execution'
  tag: attack.execution,attack.t1569.002,attack.s0029
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ show\ |\ hide\ )
- name: '[Sigma] PUA - NirCmd Execution As LOCAL SYSTEM'
  tag: attack.execution,attack.t1569.002,attack.s0029
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ runassystem\ '
- name: '[Sigma] PUA - Nmap/Zenmap Execution'
  tag: attack.discovery,attack.t1046
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\nmap\.exe',\ '\\\\zennmap\.exe'\]\}|\{'OriginalFileName':\
    \['nmap\.exe',\ 'zennmap\.exe'\]\})
- name: '[Sigma] PUA - NPS Tunneling Tool Execution'
  tag: attack.command-and-control,attack.t1090
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\npc\.exe$
- name: '[Sigma] PUA - NPS Tunneling Tool Execution'
  tag: attack.command-and-control,attack.t1090
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-server=|\ \-vkey=|\ \-password=)
- name: '[Sigma] PUA - NPS Tunneling Tool Execution'
  tag: attack.command-and-control,attack.t1090
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-config=npc
- name: '[Sigma] PUA - NPS Tunneling Tool Execution'
  tag: attack.command-and-control,attack.t1090
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(MD5=AE8ACF66BFE3A44148964048B826D005|SHA1=CEA49E9B9B67F3A13AD0BE1C2655293EA3C18181|SHA256=5A456283392FFCEEEACA3D3426C306EB470304637520D72FED1CC1FEBBBD6856)
- name: '[Sigma] PUA - NSudo Execution'
  tag: attack.execution,attack.t1569.002,attack.s0029
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\NSudo\.exe',\ '\\\\NSudoLC\.exe',\ '\\\\NSudoLG\.exe'\]\}|\{'OriginalFileName':\
    \['NSudo\.exe',\ 'NSudoLC\.exe',\ 'NSudoLG\.exe'\]\})
- name: '[Sigma] PUA - NSudo Execution'
  tag: attack.execution,attack.t1569.002,attack.s0029
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-U:S\ |\-U:T\ |\-U:E\ |\-P:E\ |\-M:S\ |\-M:H\ |\-U=S\ |\-U=T\ |\-U=E\
    |\-P=E\ |\-M=S\ |\-M=H\ |\-ShowWindowMode:Hide)
- name: '[Sigma] PUA - PingCastle Execution'
  tag: attack.reconnaissance,attack.t1595
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Hashes\|contains':\ \['MD5=f741f25ac909ee434e50812d436c73ff',\
    'MD5=d40acbfc29ee24388262e3d8be16f622',\ 'MD5=01bb2c16fadb992fa66228cd02d45c60',\
    'MD5=9e1b18e62e42b5444fc55b51e640355b',\ 'MD5=b7f8fe33ac471b074ca9e630ba0c7e79',\
    'MD5=324579d717c9b9b8e71d0269d13f811f',\ 'MD5=63257a1ddaf83cfa43fe24a3bc06c207',\
    'MD5=049e85963826b059c9bac273bb9c82ab',\ 'MD5=ecb98b7b4d4427eb8221381154ff4cb2',\
    'MD5=faf87749ac790ec3a10dd069d10f9d63',\ 'MD5=f296dba5d21ad18e6990b1992aea8f83',\
    'MD5=93ba94355e794b6c6f98204cf39f7a11',\ 'MD5=a258ef593ac63155523a461ecc73bdba',\
    'MD5=97000eb5d1653f1140ee3f47186463c4',\ 'MD5=95eb317fbbe14a82bd9fdf31c48b8d93',\
    'MD5=32fe9f0d2630ac40ea29023920f20f49',\ 'MD5=a05930dde939cfd02677fc18bb2b7df5',\
    'MD5=124283924e86933ff9054a549d3a268b',\ 'MD5=ceda6909b8573fdeb0351c6920225686',\
    'MD5=60ce120040f2cd311c810ae6f6bbc182',\ 'MD5=2f10cdc5b09100a260703a28eadd0ceb',\
    'MD5=011d967028e797a4c16d547f7ba1463f',\ 'MD5=2da9152c0970500c697c1c9b4a9e0360',\
    'MD5=b5ba72034b8f44d431f55275bace9f8b',\ 'MD5=d6ed9101df0f24e27ff92ddab42dacca',\
    'MD5=3ed3cdb6d12aa1ac562ad185cdbf2d1d',\ 'MD5=5e083cd0143ae95a6cb79b68c07ca573',\
    'MD5=28caff93748cb84be70486e79f04c2df',\ 'MD5=9d4f12c30f9b500f896efd1800e4dd11',\
    'MD5=4586f7dd14271ad65a5fb696b393f4c0',\ 'MD5=86ba9dddbdf49215145b5bcd081d4011',\
    'MD5=9dce0a481343874ef9a36c9a825ef991',\ 'MD5=85890f62e231ad964b1fda7a674747ec',\
    'MD5=599be548da6441d7fe3e9a1bb8cb0833',\ 'MD5=9b0c7fd5763f66e9b8c7b457fce53f96',\
    'MD5=32d45718164205aec3e98e0223717d1d',\ 'MD5=6ff5f373ee7f794cd17db50704d00ddb',\
    'MD5=88efbdf41f0650f8f58a3053b0ca0459',\ 'MD5=ef915f61f861d1fb7cbde9afd2e7bd93',\
    'MD5=781fa16511a595757154b4304d2dd350',\ 'MD5=5018ec39be0e296f4fc8c8575bfa8486',\
    'MD5=f4a84d6f1caf0875b50135423d04139f',\ 'SHA1=9c1431801fa6342ed68f047842b9a11778fc669b',\
    'SHA1=c36c862f40dad78cb065197aad15fef690c262f2',\ 'SHA1=bc8e23faea8b3c537f268b3e81d05b937012272d',\
    'SHA1=12e0357658614ff60d480d1a6709be68a2e40c5f',\ 'SHA1=18b33ab5719966393d424a3edbfa8dec225d98fa',\
    'SHA1=f14c9633040897d375e3069fddc71e859f283778',\ 'SHA1=08041b426c9f112ad2061bf3c8c718e34739d4fc',\
    'SHA1=7be77c885d0c9a4af4cecc64d512987cf93ba937',\ 'SHA1=72dbb719b05f89d9d2dbdf186714caf7639daa36',\
    'SHA1=5b1498beb2cfb4d971e377801e7abce62c0e315b',\ 'SHA1=292629c6ab33bddf123d26328025e2d157d9e8fc',\
    'SHA1=be59e621e83a2d4c87b0e6c69a2d22f175408b11',\ 'SHA1=0250ce9a716ab8cca1c70a9de4cbc49a51934995',\
    'SHA1=607e1fa810c799735221a609af3bfc405728c02d',\ 'SHA1=ab1c547f6d1c07a9e0a01e46adea3aae1cac12e3',\
    'SHA1=044cf5698a8e6b0aeba5acb56567f06366a9a70a',\ 'SHA1=ef2dea8c736d49607832986c6c2d6fdd68ba6491',\
    'SHA1=efffc2bfb8af2e3242233db9a7109b903fc3f178',\ 'SHA1=5a05d4320de9afbc84de8469dd02b3a109efb2d4',\
    'SHA1=a785d88cf8b862a420b9be793ee6a9616aa94c84',\ 'SHA1=5688d56cbaf0d934c4e37b112ba257e8fb63f4ea',\
    'SHA1=5cd2ada1c26815fbfd6a0cd746d5d429c0d83a17',\ 'SHA1=81d67b3d70c4e855cb11a453cc32997517708362',\
    'SHA1=9cffce9de95e0109f4dfecce0ab2cb0a59cc58ad',\ 'SHA1=09c6930d057f49c1c1e11cf9241fffc8c12df3a2',\
    'SHA1=e27bf7db8d96db9d4c8a06ee5e9b8e9fcb86ac92',\ 'SHA1=9e3c992415e390f9ada4d15c693b687f38a492d1',\
    'SHA1=3f34a5ee303d37916584c888c4928e1c1164f92a',\ 'SHA1=ea4c8c56a8f5c90a4c08366933e5fb2de611d0db',\
    'SHA1=3150f14508ee4cae19cf09083499d1cda8426540',\ 'SHA1=036ad9876fa552b1298c040e233d620ea44689c6',\
    'SHA1=3a3c1dcb146bb4616904157344ce1a82cd173bf5',\ 'SHA1=6230d6fca973fa26188dfbadede57afb4c15f75c',\
    'SHA1=8f7b2a9b8842f339b1e33602b7f926ab65de1a4d',\ 'SHA1=a586bb06b59a4736a47abff8423a54fe8e2c05c4',\
    'SHA1=c82152cddf9e5df49094686531872ecd545976db',\ 'SHA1=04c39ffc18533100aaa4f9c06baf2c719ac94a61',\
    'SHA1=e082affa5cdb2d46452c6601a9e85acb8446b836',\ 'SHA1=a075bfb6cf5c6451ce682197a87277c8bc188719',\
    'SHA1=34c0c5839af1c92bce7562b91418443a2044c90d',\ 'SHA1=74e10a9989e0ec8fe075537ac802bd3031ae7e08',\
    'SHA1=3a515551814775df0ccbe09f219bc972eae45a10',\ 'SHA256=90fd5b855b5107e7abaaefb6e658f50d5d6e08ac28e35f31d8b03dcabf77872b',\
    'SHA256=5836c24f233f77342fee825f3cad73caab7ab4fb65ec2aec309fd12bc1317e85',\ 'SHA256=e850e54b12331249c357a20604281b9abf8a91e6f3d957463fc625e6b126ef03',\
    'SHA256=9e752f29edcd0db9931c20b173eee8d4d8196f87382c68a6e7eb4c8a44d58795',\ 'SHA256=7a8c127d6c41f80d178d2315ed2f751ac91b1cd54d008af13680e04f068f426f',\
    'SHA256=9f65e1c142c4f814e056a197a2241fd09e09acf245c62897109871137321a72a',\ 'SHA256=c9b52d03c66d54d6391c643b3559184b1425c84a372081ec2bfed07ebf6af275',\
    'SHA256=1b96f6218498aa6baf6f6c15b8f99e542077e33feb1ab5472bbbf7d4de43eb6b',\ 'SHA256=768021fc242054decc280675750dec0a9e74e764b8646864c58756fa2386d2a2',\
    'SHA256=1e1b32bef31be040f0f038fcb5a2d68fb192daaef23c6167f91793d21e06ebae',\ 'SHA256=606bd75ed9d2d6107ea7ee67063d1761a99f2fb5e932c8344d11395d24587dd6',\
    'SHA256=b489d3cdd158f040322ae5c8d0139ad28eff743c738a10f2d0255c7e149bd92a',\ 'SHA256=ca7ecf04a8ad63aff330492c15270d56760cb223a607cdb1431fb00e1b9985d1',\
    'SHA256=9dc4fca72463078b70f6516559a179c78400b06534e63ee12fb38adbe2632559',\ 'SHA256=c00d2aee59bac087d769e09b5b7f832176f7714fefdc6af2502e6031e3eb37c2',\
    'SHA256=a8e96d564687064190eaf865774f773def05fdbf651aa5bbf66216c077b863ef',\ 'SHA256=84ed328cee2a0505e87662faf6fc57915e3a831c97ee88ad691f5c63522e139d',\
    'SHA256=c143de99c57965d3a44c1fce6a97c2773b050609c1ea7f45688a4ca2422a5524',\ 'SHA256=01d1efd5e552c59baa70c0778902233c05fde7de6e5cc156c62607df0804d36b',\
    'SHA256=9a8dfeb7e3174f3510691e2b32d0f9088e0ed67d9ed1b2afbe450d70dec2016b',\ 'SHA256=63b92a114075d855f706979d50ed3460fe39f8a2f5498b7657f0d14865117629',\
    'SHA256=2eb014130ff837b6481c26f0d0152f84de22ca7370b15a4f51921e0054a2a358',\ 'SHA256=7d5bb4271bf8ca2b63a59e731f3ec831dbda53adb8e28665e956afb4941f32ca',\
    'SHA256=e57098a75bf32e127c214b61bfba492d6b209e211f065fcc84ff10637a2143ea',\ 'SHA256=dd14dbcdbcfcf4bc108a926b9667af4944a3b6faf808cf1bb9a3a2554722e172',\
    'SHA256=dca2b1b824cb28bd15577eace45bde7ff8f8f44705b17085524659de31761de4',\ 'SHA256=8b95f339a07d59a8c8d8580283dffb9e8dfabdeb9171e42c948ab68c71afe7f2',\
    'SHA256=5428a840fab6ac4a0ecb2fc20dbc5f928432b00b9297dd1cb6e69336f44eba66',\ 'SHA256=e2517ae0fccaa4aefe039026a4fc855964f0c2a5f84177140200b0e58ddbfd27',\
    'SHA256=75d05880de2593480254181215dd9a0075373876f2f4a2a4a9a654b2e0729a41',\ 'SHA256=56490e14ce3817c3a1ddc0d97b96e90d6351bcd29914e7c9282f6a998cca84b1',\
    'SHA256=f25d0a5e77e4ed9e7c4204a33cfc8e46281b43adbee550b15701dd00f41bdbe0',\ 'SHA256=845a5fdcbb08e7efa7e0eabfcd881c9eebc0eec0a3a2f8689194e6b91b6eeaf8',\
    'SHA256=9a89e6652e563d26a3f328ba23d91f464c9549da734557c5a02559df24b2700d',\ 'SHA256=5614f2bc9b2ed414aab2c5c7997bdcbe8236e67ced8f91a63d1b6cfbe6e08726',\
    'SHA256=37bf92dcedb47a90d8d38ebda8d8dd168ef5803dcb01161f8cf6d68b70d49d90',\ 'SHA256=ec8590f91f5cc21e931c57345425f0625a6e37dfba026b222260450de40459f5',\
    'SHA256=3994eb72b1c227c593e14b8cad7001de11d1c247d4fbf84d0714bb8a17853140',\ 'SHA256=d654f870436d63c9d8e4390d9d4d898abdf0456736c7654d71cdf81a299c3f87',\
    'SHA256=63fbfabd4d8afb497dee47d112eb9d683671b75a8bf6407c4bd5027fd211b892',\ 'SHA256=47028053f05188e6a366fff19bedbcad2bc4daba8ff9e4df724b77d0181b7054',\
    'SHA256=7c1b1e8c880a30c43b3a52ee245f963a977e1f40284f4b83f4b9afe3821753dd'\]\}|\{'Image\|endswith':\
    '\\\\PingCastle\.exe'\}|\{'OriginalFileName':\ 'PingCastle\.exe'\}|\{'Product':\
    'Ping\ Castle'\}|\{'CommandLine\|contains':\ \['\-\-scanner\ aclcheck',\ '\-\-scanner\
    antivirus',\ '\-\-scanner\ computerversion',\ '\-\-scanner\ foreignusers',\ '\-\-scanner\
    laps_bitlocker',\ '\-\-scanner\ localadmin',\ '\-\-scanner\ nullsession',\ '\-\-scanner\
    nullsession\-trust',\ '\-\-scanner\ oxidbindings',\ '\-\-scanner\ remote',\ '\-\-scanner\
    share',\ '\-\-scanner\ smb',\ '\-\-scanner\ smb3querynetwork',\ '\-\-scanner\
    spooler',\ '\-\-scanner\ startup',\ '\-\-scanner\ zerologon'\]\}|\{'CommandLine\|contains':\
    '\-\-no\-enum\-limit'\}|\{'CommandLine\|contains\|all':\ \['\-\-healthcheck',\
    '\-\-level\ Full'\]\}|\{'CommandLine\|contains\|all':\ \['\-\-healthcheck',\ '\-\-server\
    '\]\})
- name: '[Sigma] PUA - PingCastle Execution From Potentially Suspicious Parent'
  tag: attack.reconnaissance,attack.t1595
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\.bat|\.chm|\.cmd|\.hta|\.htm|\.html|\.js|\.lnk|\.ps1|\.vbe|\.vbs|\.wsf)
- name: '[Sigma] PUA - PingCastle Execution From Potentially Suspicious Parent'
  tag: attack.reconnaissance,attack.t1595
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(:\\Perflogs\\|:\\Temp\\|:\\Users\\Public\\|:\\Windows\\Temp\\|\\AppData\\Local\\Temp|\\AppData\\Roaming\\|\\Temporary\
    Internet)
- name: '[Sigma] PUA - PingCastle Execution From Potentially Suspicious Parent'
  tag: attack.reconnaissance,attack.t1595
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'ParentCommandLine\|contains\|all':\ \[':\\\\Users\\\\',\ '\\\\Favorites\\\\'\]\}|\{'ParentCommandLine\|contains\|all':\
    \[':\\\\Users\\\\',\ '\\\\Favourites\\\\'\]\}|\{'ParentCommandLine\|contains\|all':\
    \[':\\\\Users\\\\',\ '\\\\Contacts\\\\'\]\})
- name: '[Sigma] PUA - PingCastle Execution From Potentially Suspicious Parent'
  tag: attack.reconnaissance,attack.t1595
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\PingCastle\.exe'\}|\{'OriginalFileName':\
    'PingCastle\.exe'\}|\{'Product':\ 'Ping\ Castle'\}|\{'CommandLine\|contains':\
    \['\-\-scanner\ aclcheck',\ '\-\-scanner\ antivirus',\ '\-\-scanner\ computerversion',\
    '\-\-scanner\ foreignusers',\ '\-\-scanner\ laps_bitlocker',\ '\-\-scanner\ localadmin',\
    '\-\-scanner\ nullsession',\ '\-\-scanner\ nullsession\-trust',\ '\-\-scanner\
    oxidbindings',\ '\-\-scanner\ remote',\ '\-\-scanner\ share',\ '\-\-scanner\ smb',\
    '\-\-scanner\ smb3querynetwork',\ '\-\-scanner\ spooler',\ '\-\-scanner\ startup',\
    '\-\-scanner\ zerologon'\]\}|\{'CommandLine\|contains':\ '\-\-no\-enum\-limit'\}|\{'CommandLine\|contains\|all':\
    \['\-\-healthcheck',\ '\-\-level\ Full'\]\}|\{'CommandLine\|contains\|all':\ \['\-\-healthcheck',\
    '\-\-server\ '\]\})
- name: '[Sigma] PUA - Process Hacker Execution'
  tag: attack.defense-evasion,attack.discovery,attack.persistence,attack.privilege-escalation,attack.t1622,attack.t1564,attack.t1543
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|contains':\ '\\\\ProcessHacker_'\}|\{'Image\|endswith':\
    '\\\\ProcessHacker\.exe'\}|\{'OriginalFileName':\ \['ProcessHacker\.exe',\ 'Process\
    Hacker'\]\}|\{'Description':\ 'Process\ Hacker'\}|\{'Product':\ 'Process\ Hacker'\}|\{'Hashes\|contains':\
    \['MD5=68F9B52895F4D34E74112F3129B3B00D',\ 'MD5=B365AF317AE730A67C936F21432B9C71',\
    'SHA1=A0BDFAC3CE1880B32FF9B696458327CE352E3B1D',\ 'SHA1=C5E2018BF7C0F314FED4FD7FE7E69FA2E648359E',\
    'SHA256=D4A0FE56316A2C45B9BA9AC1005363309A3EDC7ACF9E4DF64D326A0FF273E80F',\ 'SHA256=BD2C2CF0631D881ED382817AFCCE2B093F4E412FFB170A719E2762F250ABFEA4',\
    'IMPHASH=3695333C60DEDECDCAFF1590409AA462',\ 'IMPHASH=04DE0AD9C37EB7BD52043D2ECAC958DF'\]\})
- name: '[Sigma] PUA - Radmin Viewer Utility Execution'
  tag: attack.execution,attack.lateral-movement,attack.t1072
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Description':\ 'Radmin\ Viewer'\}|\{'Product':\ 'Radmin\ Viewer'\}|\{'OriginalFileName':\
    'Radmin\.exe'\})
- name: '[Sigma] PUA - Potential PE Metadata Tamper Using Rcedit'
  tag: attack.defense-evasion,attack.t1036.003,attack.t1036,attack.t1027.005,attack.t1027
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\rcedit\-x64\.exe',\ '\\\\rcedit\-x86\.exe'\]\}|\{'Description':\
    'Edit\ resources\ of\ exe'\}|\{'Product':\ 'rcedit'\})
- name: '[Sigma] PUA - Potential PE Metadata Tamper Using Rcedit'
  tag: attack.defense-evasion,attack.t1036.003,attack.t1036,attack.t1027.005,attack.t1027
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\-\-set\-
- name: '[Sigma] PUA - Potential PE Metadata Tamper Using Rcedit'
  tag: attack.defense-evasion,attack.t1036.003,attack.t1036,attack.t1027.005,attack.t1027
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(OriginalFileName|CompanyName|FileDescription|ProductName|ProductVersion|LegalCopyright)
- name: '[Sigma] PUA - Rclone Execution'
  tag: attack.exfiltration,attack.t1567.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-\-config\ |\-\-no\-check\-certificate\ |\ copy\ )
- name: '[Sigma] PUA - Rclone Execution'
  tag: attack.exfiltration,attack.t1567.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\rclone\.exe'\}|\{'Description':\ 'Rsync\
    for\ cloud\ storage'\})
- name: '[Sigma] PUA - Rclone Execution'
  tag: attack.exfiltration,attack.t1567.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(pass|user|copy|sync|config|lsd|remote|ls|mega|pcloud|ftp|ignore\-existing|auto\-confirm|transfers|multi\-thread\-streams|no\-check\-certificate\
    )
- name: '[Sigma] PUA - RunXCmd Execution'
  tag: attack.execution,attack.t1569.002,attack.s0029
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /account=system\ |\ /account=ti\ )
- name: '[Sigma] PUA - RunXCmd Execution'
  tag: attack.execution,attack.t1569.002,attack.s0029
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)/exec=
- name: '[Sigma] PUA - Seatbelt Execution'
  tag: attack.discovery,attack.t1526,attack.t1087,attack.t1083
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\Seatbelt\.exe'\}|\{'OriginalFileName':\
    'Seatbelt\.exe'\}|\{'Description':\ 'Seatbelt'\}|\{'CommandLine\|contains':\ \['\
    DpapiMasterKeys',\ '\ InterestingProcesses',\ '\ InterestingFiles',\ '\ CertificateThumbprints',\
    '\ ChromiumBookmarks',\ '\ ChromiumHistory',\ '\ ChromiumPresence',\ '\ CloudCredentials',\
    '\ CredEnum',\ '\ CredGuard',\ '\ FirefoxHistory',\ '\ ProcessCreationEvents'\]\})
- name: '[Sigma] PUA - Seatbelt Execution'
  tag: attack.discovery,attack.t1526,attack.t1087,attack.t1083
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-group=misc|\ \-group=remote|\ \-group=chromium|\ \-group=slack|\
    \-group=system|\ \-group=user|\ \-group=all)
- name: '[Sigma] PUA - Seatbelt Execution'
  tag: attack.discovery,attack.t1526,attack.t1087,attack.t1083
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-outputfile=
- name: '[Sigma] PUA - System Informer Execution'
  tag: attack.persistence,attack.privilege-escalation,attack.discovery,attack.defense-evasion,attack.t1082,attack.t1564,attack.t1543
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\SystemInformer\.exe'\}|\{'OriginalFileName':\
    'SystemInformer\.exe'\}|\{'Description':\ 'System\ Informer'\}|\{'Product':\ 'System\
    Informer'\}|\{'Hashes\|contains':\ \['MD5=19426363A37C03C3ED6FEDF57B6696EC',\
    'SHA1=8B12C6DA8FAC0D5E8AB999C31E5EA04AF32D53DC',\ 'SHA256=8EE9D84DE50803545937A63C686822388A3338497CDDB660D5D69CF68B68F287',\
    'IMPHASH=B68908ADAEB5D662F87F2528AF318F12'\]\})
- name: '[Sigma] PUA - WebBrowserPassView Execution'
  tag: attack.credential-access,attack.t1555.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Description':\ 'Web\ Browser\ Password\ Viewer'\}|\{'Image\|endswith':\
    '\\\\WebBrowserPassView\.exe'\})
- name: '[Sigma] PUA - Wsudo Suspicious Execution'
  tag: attack.execution,attack.privilege-escalation,attack.t1059
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\wsudo\.exe'\}|\{'OriginalFileName':\ 'wsudo\.exe'\}|\{'Description':\
    'Windows\ sudo\ utility'\}|\{'ParentImage\|endswith':\ '\\\\wsudo\-bridge\.exe'\})
- name: '[Sigma] PUA - Wsudo Suspicious Execution'
  tag: attack.execution,attack.privilege-escalation,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-u\ System|\-uSystem|\-u\ TrustedInstaller|\-uTrustedInstaller|\
    \-\-ti\ )
- name: '[Sigma] PUA - Adidnsdump Execution'
  tag: attack.discovery,attack.t1018
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)\\python\.exe$
- name: '[Sigma] PUA - Adidnsdump Execution'
  tag: attack.discovery,attack.t1018
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)adidnsdump
- name: '[Sigma] Python Inline Command Execution'
  tag: attack.execution,attack.t1059
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'python\.exe'\}|\{'Image\|endswith':\ \['python\.exe',\
    'python3\.exe',\ 'python2\.exe'\]\})
- name: '[Sigma] Python Inline Command Execution'
  tag: attack.execution,attack.t1059
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-c
- name: '[Sigma] Python Inline Command Execution'
  tag: attack.execution,attack.t1059
  score: 50
  target: ParentPath
  condition: regex
  pattern: ^(C:\\Program\ Files\\Python|C:\\Program\ Files\ \(x86\)\\Python)
- name: '[Sigma] Python Inline Command Execution'
  tag: attack.execution,attack.t1059
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\python\.exe$
- name: '[Sigma] Python Inline Command Execution'
  tag: attack.execution,attack.t1059
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\-E\ \-s\ \-m\ ensurepip\ \-U\ \-\-default\-pip
- name: '[Sigma] Python Inline Command Execution'
  tag: attack.execution,attack.t1059
  score: 50
  target: ParentPath
  condition: regex
  pattern: ^(C:\\Program\ Files\\Python|C:\\Program\ Files\ \(x86\)\\Python)
- name: '[Sigma] Python Inline Command Execution'
  tag: attack.execution,attack.t1059
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-W\ ignore::DeprecationWarning|\['install',\ '\-\-no\-cache\-dir',\
    '\-\-no\-index',\ '\-\-find\-links',|'\-\-upgrade',\ 'pip')
- name: '[Sigma] Python Inline Command Execution'
  tag: attack.execution,attack.t1059
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'ParentImage\|endswith':\ '\\\\AppData\\\\Local\\\\Programs\\\\Microsoft\
    VS\ Code\\\\Code\.exe'\}|\{'ParentImage':\ \['C:\\\\Program\ Files\\\\Microsoft\
    VS\ Code\\\\Code\.exe',\ 'C:\\\\Program\ Files\ \(x86\)\\\\Microsoft\ VS\ Code\\\\Code\.exe'\]\})
- name: '[Sigma] Python Inline Command Execution'
  tag: attack.execution,attack.t1059
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(<pip\-setuptools\-caller>|exec\(compile\()
- name: '[Sigma] Python Spawning Pretty TTY on Windows'
  tag: attack.execution,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(python\.exe|python3\.exe|python2\.exe)$
- name: '[Sigma] Python Spawning Pretty TTY on Windows'
  tag: attack.execution,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(import\ pty|\.spawn\()
- name: '[Sigma] Python Spawning Pretty TTY on Windows'
  tag: attack.execution,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)from\ pty\ import\ spawn
- name: '[Sigma] Potentially Suspicious Usage Of Qemu'
  tag: attack.command-and-control,attack.t1090,attack.t1572
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-m\ 1M|\-m\ 2M|\-m\ 3M)
- name: '[Sigma] Potentially Suspicious Usage Of Qemu'
  tag: attack.command-and-control,attack.t1090,attack.t1572
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(restrict=off|\-netdev\ |connect=|\-nographic)
- name: '[Sigma] Potentially Suspicious Usage Of Qemu'
  tag: attack.command-and-control,attack.t1090,attack.t1572
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-cdrom\ |\ type=virt\ |\ \-blockdev\ )
- name: '[Sigma] Query Usage To Exfil Data'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i):\\Windows\\System32\\query\.exe$
- name: '[Sigma] Query Usage To Exfil Data'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(session\ >|process\ >)
- name: '[Sigma] Rar Usage with Password and Compression Level'
  tag: attack.collection,attack.t1560.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-hp
- name: '[Sigma] Rar Usage with Password and Compression Level'
  tag: attack.collection,attack.t1560.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-m|\ a\ )
- name: '[Sigma] Files Added To An Archive Using Rar.EXE'
  tag: attack.collection,attack.t1560.001
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)\\rar\.exe$
- name: '[Sigma] Files Added To An Archive Using Rar.EXE'
  tag: attack.collection,attack.t1560.001
  score: 20
  target: Target_Path
  condition: regex
  pattern: '(?i)\ a\ '
- name: '[Sigma] Suspicious Greedy Compression Using Rar.EXE'
  tag: attack.execution,attack.t1059
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\rar\.exe'\}|\{'Description':\ 'Command\
    line\ RAR'\})
- name: '[Sigma] Suspicious Greedy Compression Using Rar.EXE'
  tag: attack.execution,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.exe\ a\ |\ a\ \-m)
- name: '[Sigma] Suspicious Greedy Compression Using Rar.EXE'
  tag: attack.execution,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-hp|\ \-r\ )
- name: '[Sigma] Suspicious Greedy Compression Using Rar.EXE'
  tag: attack.execution,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ .:\\\\\\.*\.|\ .:\\\\\\\\\\.*\.|\ .:\\\$Recycle\.bin\\|\ .:\\PerfLogs\\|\
    .:\\Temp|\ .:\\Users\\Public\\|\ .:\\Windows\\|\ %public%)
- name: '[Sigma] Suspicious RASdial Activity'
  tag: attack.defense-evasion,attack.execution,attack.t1059
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)rasdial\.exe$
- name: '[Sigma] Process Memory Dump via RdrLeakDiag.EXE'
  tag: attack.credential-access,attack.t1003.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\rdrleakdiag\.exe'\}|\{'OriginalFileName':\
    'RdrLeakDiag\.exe'\})
- name: '[Sigma] Process Memory Dump via RdrLeakDiag.EXE'
  tag: attack.credential-access,attack.t1003.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(/memdmp|fullmemdmp)
- name: '[Sigma] Process Memory Dump via RdrLeakDiag.EXE'
  tag: attack.credential-access,attack.t1003.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /o\ |\ /p\ )
- name: '[Sigma] Potentially Suspicious Execution Of Regasm/Regsvcs With Uncommon
    Extension'
  tag: attack.defense-evasion,attack.t1218.009
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\Regsvcs\.exe',\ '\\\\Regasm\.exe'\]\}|\{'OriginalFileName':\
    \['RegSvcs\.exe',\ 'RegAsm\.exe'\]\})
- name: '[Sigma] Potentially Suspicious Execution Of Regasm/Regsvcs With Uncommon
    Extension'
  tag: attack.defense-evasion,attack.t1218.009
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\.dat|\.gif|\.jpeg|\.jpg|\.png|\.txt)
- name: '[Sigma] Potentially Suspicious Execution Of Regasm/Regsvcs From Uncommon
    Location'
  tag: attack.defense-evasion,attack.t1218.009
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\Regsvcs\.exe',\ '\\\\Regasm\.exe'\]\}|\{'OriginalFileName':\
    \['RegSvcs\.exe',\ 'RegAsm\.exe'\]\})
- name: '[Sigma] Potentially Suspicious Execution Of Regasm/Regsvcs From Uncommon
    Location'
  tag: attack.defense-evasion,attack.t1218.009
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\AppData\\Local\\Temp\\|\\Microsoft\\Windows\\Start\ Menu\\Programs\\Startup\\|\\PerfLogs\\|\\Users\\Public\\|\\Windows\\Temp\\)
- name: '[Sigma] Exports Critical Registry Keys To a File'
  tag: attack.exfiltration,attack.discovery,attack.t1012
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\regedit\.exe'\}|\{'OriginalFileName':\
    'REGEDIT\.EXE'\})
- name: '[Sigma] Exports Critical Registry Keys To a File'
  tag: attack.exfiltration,attack.discovery,attack.t1012
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-E\ '
- name: '[Sigma] Exports Critical Registry Keys To a File'
  tag: attack.exfiltration,attack.discovery,attack.t1012
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(hklm|hkey_local_machine)
- name: '[Sigma] Exports Critical Registry Keys To a File'
  tag: attack.exfiltration,attack.discovery,attack.t1012
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\system|\\sam|\\security)$
- name: '[Sigma] Exports Registry Key To a File'
  tag: attack.exfiltration,attack.discovery,attack.t1012
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\regedit\.exe'\}|\{'OriginalFileName':\
    'REGEDIT\.EXE'\})
- name: '[Sigma] Exports Registry Key To a File'
  tag: attack.exfiltration,attack.discovery,attack.t1012
  score: 20
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-E\ '
- name: '[Sigma] Exports Registry Key To a File'
  tag: attack.exfiltration,attack.discovery,attack.t1012
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(hklm|hkey_local_machine)
- name: '[Sigma] Exports Registry Key To a File'
  tag: attack.exfiltration,attack.discovery,attack.t1012
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(\\system|\\sam|\\security)$
- name: '[Sigma] Imports Registry Key From a File'
  tag: attack.persistence,attack.t1112,attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\regedit\.exe'\}|\{'OriginalFileName':\
    'REGEDIT\.EXE'\})
- name: '[Sigma] Imports Registry Key From a File'
  tag: attack.persistence,attack.t1112,attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /i\ |\ /s\ |\.reg)
- name: '[Sigma] Imports Registry Key From a File'
  tag: attack.persistence,attack.t1112,attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-e\ |\ \-a\ |\ \-c\ )
- name: '[Sigma] Imports Registry Key From a File'
  tag: attack.persistence,attack.t1112,attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i):\[\^\ \\\\\]
- name: '[Sigma] Imports Registry Key From an ADS'
  tag: attack.persistence,attack.t1112,attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\regedit\.exe'\}|\{'OriginalFileName':\
    'REGEDIT\.EXE'\})
- name: '[Sigma] Imports Registry Key From an ADS'
  tag: attack.persistence,attack.t1112,attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /i\ |\.reg)
- name: '[Sigma] Imports Registry Key From an ADS'
  tag: attack.persistence,attack.t1112,attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i):\[\^\ \\\\\]
- name: '[Sigma] Imports Registry Key From an ADS'
  tag: attack.persistence,attack.t1112,attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-e\ |\ \-a\ |\ \-c\ )
- name: '[Sigma] Regedit as Trusted Installer'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\regedit\.exe$
- name: '[Sigma] Regedit as Trusted Installer'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\TrustedInstaller\.exe|\\ProcessHacker\.exe)$
- name: '[Sigma] Suspicious Registry Modification From ADS Via Regini.EXE'
  tag: attack.persistence,attack.t1112,attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\regini\.exe'\}|\{'OriginalFileName':\ 'REGINI\.EXE'\})
- name: '[Sigma] Suspicious Registry Modification From ADS Via Regini.EXE'
  tag: attack.persistence,attack.t1112,attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i):\[\^\ \\\\\]
- name: '[Sigma] Registry Modification Via Regini.EXE'
  tag: attack.persistence,attack.t1112,attack.defense-evasion
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\regini\.exe'\}|\{'OriginalFileName':\ 'REGINI\.EXE'\})
- name: '[Sigma] Registry Modification Via Regini.EXE'
  tag: attack.persistence,attack.t1112,attack.defense-evasion
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i):\[\^\ \\\\\]
- name: '[Sigma] DLL Execution Via Register-cimprovider.exe'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\register\-cimprovider\.exe$
- name: '[Sigma] DLL Execution Via Register-cimprovider.exe'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-path|dll)
- name: '[Sigma] Enumeration for 3rd Party Creds From CLI'
  tag: attack.credential-access,attack.t1552.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\Software\\Aerofox\\Foxmail\\V3\.1|\\Software\\Aerofox\\FoxmailPreview|\\Software\\DownloadManager\\Passwords|\\Software\\FTPWare\\COREFTP\\Sites|\\Software\\IncrediMail\\Identities|\\Software\\Martin\
    Prikryl\\WinSCP\ 2\\Sessions|\\Software\\Mobatek\\MobaXterm\\|\\Software\\OpenSSH\\Agent\\Keys|\\Software\\OpenVPN\-GUI\\configs|\\Software\\ORL\\WinVNC3\\Password|\\Software\\Qualcomm\\Eudora\\CommandLine|\\Software\\RealVNC\\WinVNC4|\\Software\\RimArts\\B2\\Settings|\\Software\\SimonTatham\\PuTTY\\Sessions|\\Software\\SimonTatham\\PuTTY\\SshHostKeys\\|\\Software\\Sota\\FFFTP|\\Software\\TightVNC\\Server|\\Software\\WOW6432Node\\Radmin\\v3\.0\\Server\\Parameters\\Radmin)
- name: '[Sigma] Enumeration for 3rd Party Creds From CLI'
  tag: attack.credential-access,attack.t1552.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)reg\.exe$
- name: '[Sigma] Enumeration for 3rd Party Creds From CLI'
  tag: attack.credential-access,attack.t1552.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(export|save)
- name: '[Sigma] IE ZoneMap Setting Downgraded To MyComputer Zone For HTTP Protocols
    Via CLI'
  tag: attack.execution,attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\Microsoft\\Windows\\CurrentVersion\\Internet\ Settings\\ZoneMap\\ProtocolDefaults|http|\
    0)
- name: '[Sigma] Suspicious Debugger Registration Cmdline'
  tag: attack.persistence,attack.privilege-escalation,attack.t1546.008
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\CurrentVersion\\Image\ File\ Execution\ Options\\
- name: '[Sigma] Suspicious Debugger Registration Cmdline'
  tag: attack.persistence,attack.privilege-escalation,attack.t1546.008
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(sethc\.exe|utilman\.exe|osk\.exe|magnify\.exe|narrator\.exe|displayswitch\.exe|atbroker\.exe|HelpPane\.exe)
- name: '[Sigma] Potential Persistence Via Logon Scripts - CommandLine'
  tag: attack.privilege-escalation,attack.persistence,attack.t1037.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)UserInitMprLogonScript
- name: '[Sigma] Potential Credential Dumping Attempt Using New NetworkProvider -
    CLI'
  tag: attack.credential-access,attack.t1003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\System\\CurrentControlSet\\Services\\|\\NetworkProvider)
- name: '[Sigma] Python Function Execution Security Warning Disabled In Excel'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\Microsoft\\Office\\|\\Excel\\Security|PythonFunctionWarnings)
- name: '[Sigma] Python Function Execution Security Warning Disabled In Excel'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\ 0
- name: '[Sigma] Potential Privilege Escalation via Service Permissions Weakness'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1574.011
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(Medium|S\-1\-16\-8192)
- name: '[Sigma] Potential Privilege Escalation via Service Permissions Weakness'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1574.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(ControlSet|services)
- name: '[Sigma] Potential Privilege Escalation via Service Permissions Weakness'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1574.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\ImagePath|\\FailureCommand|\\ServiceDll)
- name: '[Sigma] Potential Provisioning Registry Key Abuse For Binary Proxy Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)SOFTWARE\\Microsoft\\Provisioning\\Commands\\
- name: '[Sigma] Potential PowerShell Execution Policy Tampering - ProcCreation'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\ShellIds\\Microsoft\.PowerShell\\ExecutionPolicy|\\Policies\\Microsoft\\Windows\\PowerShell\\ExecutionPolicy)
- name: '[Sigma] Potential PowerShell Execution Policy Tampering - ProcCreation'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Bypass|RemoteSigned|Unrestricted)
- name: '[Sigma] Hiding User Account Via SpecialAccounts Registry Key - CommandLine'
  tag: attack.defense-evasion,attack.t1564.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\reg\.exe$
- name: '[Sigma] Hiding User Account Via SpecialAccounts Registry Key - CommandLine'
  tag: attack.defense-evasion,attack.t1564.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\SOFTWARE\\Microsoft\\Windows\ NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\UserList|add|/v|/d\
    0)
- name: '[Sigma] Persistence Via TypedPaths - CommandLine'
  tag: attack.persistence
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TypedPaths
- name: '[Sigma] Potential Regsvr32 Commandline Flag Anomaly'
  tag: attack.defense-evasion,attack.t1218.010
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\regsvr32\.exe$
- name: '[Sigma] Potential Regsvr32 Commandline Flag Anomaly'
  tag: attack.defense-evasion,attack.t1218.010
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-i:'
- name: '[Sigma] Potential Regsvr32 Commandline Flag Anomaly'
  tag: attack.defense-evasion,attack.t1218.010
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-n\ '
- name: '[Sigma] Potentially Suspicious Regsvr32 HTTP IP Pattern'
  tag: attack.defense-evasion,attack.t1218.010
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\regsvr32\.exe'\}|\{'OriginalFileName':\
    'REGSVR32\.EXE'\})
- name: '[Sigma] Potentially Suspicious Regsvr32 HTTP IP Pattern'
  tag: attack.defense-evasion,attack.t1218.010
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /i:http://1|\ /i:http://2|\ /i:http://3|\ /i:http://4|\ /i:http://5|\
    /i:http://6|\ /i:http://7|\ /i:http://8|\ /i:http://9|\ /i:https://1|\ /i:https://2|\
    /i:https://3|\ /i:https://4|\ /i:https://5|\ /i:https://6|\ /i:https://7|\ /i:https://8|\
    /i:https://9|\ \-i:http://1|\ \-i:http://2|\ \-i:http://3|\ \-i:http://4|\ \-i:http://5|\
    \-i:http://6|\ \-i:http://7|\ \-i:http://8|\ \-i:http://9|\ \-i:https://1|\ \-i:https://2|\
    \-i:https://3|\ \-i:https://4|\ \-i:https://5|\ \-i:https://6|\ \-i:https://7|\
    \-i:https://8|\ \-i:https://9)
- name: '[Sigma] Potentially Suspicious Regsvr32 HTTP/FTP Pattern'
  tag: attack.defense-evasion,attack.t1218.010
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\regsvr32\.exe'\}|\{'OriginalFileName':\
    'REGSVR32\.EXE'\})
- name: '[Sigma] Potentially Suspicious Regsvr32 HTTP/FTP Pattern'
  tag: attack.defense-evasion,attack.t1218.010
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /i|\ \-i)
- name: '[Sigma] Potentially Suspicious Regsvr32 HTTP/FTP Pattern'
  tag: attack.defense-evasion,attack.t1218.010
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(ftp|http)
- name: '[Sigma] Suspicious Regsvr32 Execution From Remote Share'
  tag: attack.defense-evasion,attack.t1218.010
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\regsvr32\.exe'\}|\{'OriginalFileName':\
    '\\\\REGSVR32\.EXE'\})
- name: '[Sigma] Suspicious Regsvr32 Execution From Remote Share'
  tag: attack.defense-evasion,attack.t1218.010
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\ \\\\\\\\
- name: '[Sigma] Potentially Suspicious Child Process Of Regsvr32'
  tag: attack.defense-evasion,attack.t1218.010
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\regsvr32\.exe$
- name: '[Sigma] Potentially Suspicious Child Process Of Regsvr32'
  tag: attack.defense-evasion,attack.t1218.010
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\calc\.exe|\\cscript\.exe|\\explorer\.exe|\\mshta\.exe|\\net\.exe|\\net1\.exe|\\nltest\.exe|\\notepad\.exe|\\powershell\.exe|\\pwsh\.exe|\\reg\.exe|\\schtasks\.exe|\\werfault\.exe|\\wscript\.exe)$
- name: '[Sigma] Potentially Suspicious Child Process Of Regsvr32'
  tag: attack.defense-evasion,attack.t1218.010
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\werfault\.exe$
- name: '[Sigma] Potentially Suspicious Child Process Of Regsvr32'
  tag: attack.defense-evasion,attack.t1218.010
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-u\ \-p\ '
- name: '[Sigma] Regsvr32 Execution From Potential Suspicious Location'
  tag: attack.defense-evasion,attack.t1218.010
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\regsvr32\.exe'\}|\{'OriginalFileName':\
    'REGSVR32\.EXE'\})
- name: '[Sigma] Regsvr32 Execution From Potential Suspicious Location'
  tag: attack.defense-evasion,attack.t1218.010
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\ProgramData\\|:\\Temp\\|:\\Users\\Public\\|:\\Windows\\Temp\\|\\AppData\\Local\\Temp\\|\\AppData\\Roaming\\)
- name: '[Sigma] Regsvr32 Execution From Highly Suspicious Location'
  tag: attack.defense-evasion,attack.t1218.010
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\regsvr32\.exe'\}|\{'OriginalFileName':\
    'REGSVR32\.EXE'\})
- name: '[Sigma] Regsvr32 Execution From Highly Suspicious Location'
  tag: attack.defense-evasion,attack.t1218.010
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\PerfLogs\\|:\\Temp\\|\\Windows\\Registration\\CRMLog|\\Windows\\System32\\com\\dmp\\|\\Windows\\System32\\FxsTmp\\|\\Windows\\System32\\Microsoft\\Crypto\\RSA\\MachineKeys\\|\\Windows\\System32\\spool\\drivers\\color\\|\\Windows\\System32\\spool\\PRINTERS\\|\\Windows\\System32\\spool\\SERVERS\\|\\Windows\\System32\\Tasks_Migrated\\|\\Windows\\System32\\Tasks\\Microsoft\\Windows\\SyncCenter\\|\\Windows\\SysWOW64\\com\\dmp\\|\\Windows\\SysWOW64\\FxsTmp\\|\\Windows\\SysWOW64\\Tasks\\Microsoft\\Windows\\PLA\\System\\|\\Windows\\SysWOW64\\Tasks\\Microsoft\\Windows\\SyncCenter\\|\\Windows\\Tasks\\|\\Windows\\Tracing\\)
- name: '[Sigma] Regsvr32 Execution From Highly Suspicious Location'
  tag: attack.defense-evasion,attack.t1218.010
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ "C:\\|\ C:\\|\ 'C:\\|D:\\)
- name: '[Sigma] Regsvr32 Execution From Highly Suspicious Location'
  tag: attack.defense-evasion,attack.t1218.010
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\ \(x86\)\\|C:\\Program\ Files\\|C:\\ProgramData\\|C:\\Users\\|\
    C:\\Windows\\|\ "C:\\Windows\\|\ 'C:\\Windows\\)
- name: '[Sigma] Regsvr32 Execution From Highly Suspicious Location'
  tag: attack.defense-evasion,attack.t1218.010
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)
- name: '[Sigma] Regsvr32 Execution From Highly Suspicious Location'
  tag: attack.defense-evasion,attack.t1218.010
  score: 80
  target: Target_Path
  condition: regex
  pattern: None
- name: '[Sigma] Regsvr32 DLL Execution With Suspicious File Extension'
  tag: attack.defense-evasion,attack.t1218.010
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\regsvr32\.exe'\}|\{'OriginalFileName':\
    'REGSVR32\.EXE'\})
- name: '[Sigma] Regsvr32 DLL Execution With Suspicious File Extension'
  tag: attack.defense-evasion,attack.t1218.010
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.bin|\.bmp|\.cr2|\.dat|\.eps|\.gif|\.ico|\.jpeg|\.jpg|\.log|\.nef|\.orf|\.png|\.raw|\.rtf|\.sr2|\.temp|\.tif|\.tiff|\.tmp|\.txt)$
- name: '[Sigma] Scripting/CommandLine Process Spawned Regsvr32'
  tag: attack.defense-evasion,attack.t1218.010
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(\\cmd\.exe|\\cscript\.exe|\\mshta\.exe|\\powershell_ise\.exe|\\powershell\.exe|\\pwsh\.exe|\\wscript\.exe)$
- name: '[Sigma] Scripting/CommandLine Process Spawned Regsvr32'
  tag: attack.defense-evasion,attack.t1218.010
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\regsvr32\.exe$
- name: '[Sigma] Scripting/CommandLine Process Spawned Regsvr32'
  tag: attack.defense-evasion,attack.t1218.010
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\cmd\.exe
- name: '[Sigma] Scripting/CommandLine Process Spawned Regsvr32'
  tag: attack.defense-evasion,attack.t1218.010
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ /s\ C:\\Windows\\System32\\RpcProxy\\RpcProxy\.dll$
- name: '[Sigma] Regsvr32 DLL Execution With Uncommon Extension'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574,attack.execution
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\regsvr32\.exe'\}|\{'OriginalFileName':\
    'REGSVR32\.EXE'\})
- name: '[Sigma] Regsvr32 DLL Execution With Uncommon Extension'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574,attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\.ax|\.cpl|\.dll|\.ocx)
- name: '[Sigma] Regsvr32 DLL Execution With Uncommon Extension'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574,attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\.ppl
- name: '[Sigma] Regsvr32 DLL Execution With Uncommon Extension'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574,attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\.bav
- name: '[Sigma] Regsvr32 DLL Execution With Uncommon Extension'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574,attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: None
- name: '[Sigma] Regsvr32 DLL Execution With Uncommon Extension'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574,attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)
- name: '[Sigma] Potential Persistence Attempt Via Run Keys Using Reg.EXE'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\reg\.exe$
- name: '[Sigma] Potential Persistence Attempt Via Run Keys Using Reg.EXE'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(reg|\ add\ )
- name: '[Sigma] Potential Persistence Attempt Via Run Keys Using Reg.EXE'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Software\\Microsoft\\Windows\\CurrentVersion\\Run|\\Software\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Run|\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run)
- name: '[Sigma] Add SafeBoot Keys Via Reg Utility'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\reg\.exe'\}|\{'OriginalFileName':\ 'reg\.exe'\})
- name: '[Sigma] Add SafeBoot Keys Via Reg Utility'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot
- name: '[Sigma] Add SafeBoot Keys Via Reg Utility'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ copy\ |\ add\ )
- name: '[Sigma] Suspicious Reg Add BitLocker'
  tag: attack.impact,attack.t1486
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(REG|ADD|\\SOFTWARE\\Policies\\Microsoft\\FVE|/v|/f)
- name: '[Sigma] Suspicious Reg Add BitLocker'
  tag: attack.impact,attack.t1486
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(EnableBDEWithNoTPM|UseAdvancedStartup|UseTPM|UseTPMKey|UseTPMKeyPIN|RecoveryKeyMessageSource|UseTPMPIN|RecoveryKeyMessage)
- name: '[Sigma] Dropping Of Password Filter DLL'
  tag: attack.persistence,attack.defense-evasion,attack.credential-access,attack.t1556.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa|scecli\\0.*|reg\ add)
- name: '[Sigma] Suspicious Windows Defender Folder Exclusion Added Via Reg.EXE'
  tag: attack.defense-evasion,attack.t1562.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\reg\.exe$
- name: '[Sigma] Suspicious Windows Defender Folder Exclusion Added Via Reg.EXE'
  tag: attack.defense-evasion,attack.t1562.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(SOFTWARE\\Microsoft\\Windows\ Defender\\Exclusions\\Paths|SOFTWARE\\Microsoft\\Microsoft\
    Antimalware\\Exclusions\\Paths)
- name: '[Sigma] Suspicious Windows Defender Folder Exclusion Added Via Reg.EXE'
  tag: attack.defense-evasion,attack.t1562.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(ADD\ |/t\ |REG_DWORD\ |/v\ |/d\ |0)
- name: '[Sigma] SafeBoot Registry Key Deleted Via Reg.EXE'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ 'reg\.exe'\}|\{'OriginalFileName':\ 'reg\.exe'\})
- name: '[Sigma] SafeBoot Registry Key Deleted Via Reg.EXE'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ delete\ |\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot)
- name: '[Sigma] Service Registry Key Deleted Via Reg.EXE'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ 'reg\.exe'\}|\{'OriginalFileName':\ 'reg\.exe'\})
- name: '[Sigma] Service Registry Key Deleted Via Reg.EXE'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ delete\ '
- name: '[Sigma] Service Registry Key Deleted Via Reg.EXE'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\SYSTEM\\CurrentControlSet\\services\\
- name: '[Sigma] Potentially Suspicious Desktop Background Change Using Reg.EXE'
  tag: attack.persistence,attack.defense-evasion,attack.impact,attack.t1112,attack.t1491.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\reg\.exe'\}|\{'OriginalFileName':\ 'reg\.exe'\})
- name: '[Sigma] Potentially Suspicious Desktop Background Change Using Reg.EXE'
  tag: attack.persistence,attack.defense-evasion,attack.impact,attack.t1112,attack.t1491.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)add
- name: '[Sigma] Potentially Suspicious Desktop Background Change Using Reg.EXE'
  tag: attack.persistence,attack.defense-evasion,attack.impact,attack.t1112,attack.t1491.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Control\ Panel\\Desktop|CurrentVersion\\Policies\\ActiveDesktop|CurrentVersion\\Policies\\System)
- name: '[Sigma] Potentially Suspicious Desktop Background Change Using Reg.EXE'
  tag: attack.persistence,attack.defense-evasion,attack.impact,attack.t1112,attack.t1491.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/v\ NoChangingWallpaper|/d\ 1)
- name: '[Sigma] Potentially Suspicious Desktop Background Change Using Reg.EXE'
  tag: attack.persistence,attack.defense-evasion,attack.impact,attack.t1112,attack.t1491.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/v\ Wallpaper|/t\ REG_SZ)
- name: '[Sigma] Potentially Suspicious Desktop Background Change Using Reg.EXE'
  tag: attack.persistence,attack.defense-evasion,attack.impact,attack.t1112,attack.t1491.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/v\ WallpaperStyle|/d\ 2)
- name: '[Sigma] Direct Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\reg\.exe'\}|\{'OriginalFileName':\ 'reg\.exe'\})
- name: '[Sigma] Direct Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)add
- name: '[Sigma] Direct Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\software\\Microsoft\\Windows\\CurrentVersion\\Run|\\software\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Run|\\software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run|\\software\\Microsoft\\Windows\
    NT\\CurrentVersion\\Winlogon\\Userinit|\\software\\Microsoft\\Windows\ NT\\CurrentVersion\\Winlogon\\Shell|\\software\\Microsoft\\Windows\
    NT\\CurrentVersion\\Windows|\\software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User\
    Shell\ Folders|\\system\\CurrentControlSet\\Control\\SafeBoot\\AlternateShell)
- name: '[Sigma] Security Service Disabled Via Reg.EXE'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(reg|add)
- name: '[Sigma] Security Service Disabled Via Reg.EXE'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(d\ 4|v\ Start)
- name: '[Sigma] Security Service Disabled Via Reg.EXE'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\AppIDSvc|\\MsMpSvc|\\NisSrv|\\SecurityHealthService|\\Sense|\\UsoSvc|\\WdBoot|\\WdFilter|\\WdNisDrv|\\WdNisSvc|\\WinDefend|\\wscsvc|\\wuauserv)
- name: '[Sigma] Dumping of Sensitive Hives Via Reg.EXE'
  tag: attack.credential-access,attack.t1003.002,attack.t1003.004,attack.t1003.005,car.2013-07-001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\reg\.exe'\}|\{'OriginalFileName':\ 'reg\.exe'\})
- name: '[Sigma] Dumping of Sensitive Hives Via Reg.EXE'
  tag: attack.credential-access,attack.t1003.002,attack.t1003.004,attack.t1003.005,car.2013-07-001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ save\ |\ export\ |\ ave\ |\ eport\ )
- name: '[Sigma] Dumping of Sensitive Hives Via Reg.EXE'
  tag: attack.credential-access,attack.t1003.002,attack.t1003.004,attack.t1003.005,car.2013-07-001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(hklm|hkm|hkey_local_machine|hkey_ocal_machine|hkey_loca_machine|hkey_oca_machine)
- name: '[Sigma] Dumping of Sensitive Hives Via Reg.EXE'
  tag: attack.credential-access,attack.t1003.002,attack.t1003.004,attack.t1003.005,car.2013-07-001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\system|\\sam|\\security|\\ystem|\\sytem|\\ytem|\\am|\\ecurity)
- name: '[Sigma] Windows Recall Feature Enabled Via Reg.EXE'
  tag: attack.collection,attack.t1113
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\reg\.exe'\}|\{'OriginalFileName':\ 'reg\.exe'\})
- name: '[Sigma] Windows Recall Feature Enabled Via Reg.EXE'
  tag: attack.collection,attack.t1113
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Microsoft\\Windows\\WindowsAI|DisableAIDataAnalysis)
- name: '[Sigma] Windows Recall Feature Enabled Via Reg.EXE'
  tag: attack.collection,attack.t1113
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(add|0)
- name: '[Sigma] Windows Recall Feature Enabled Via Reg.EXE'
  tag: attack.collection,attack.t1113
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)delete
- name: '[Sigma] Enumeration for Credentials in Registry'
  tag: attack.credential-access,attack.t1552.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\reg\.exe$
- name: '[Sigma] Enumeration for Credentials in Registry'
  tag: attack.credential-access,attack.t1552.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ query\ |/t\ |REG_SZ|/s)
- name: '[Sigma] Enumeration for Credentials in Registry'
  tag: attack.credential-access,attack.t1552.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains\|all':\ \['/f\ ',\ 'HKLM'\]\}|\{'CommandLine\|contains\|all':\
    \['/f\ ',\ 'HKCU'\]\}|\{'CommandLine\|contains':\ 'HKCU\\\\Software\\\\SimonTatham\\\\PuTTY\\\\Sessions'\})
- name: '[Sigma] Potential Suspicious Registry File Imported Via Reg.EXE'
  tag: attack.persistence,attack.t1112,attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\reg\.exe'\}|\{'OriginalFileName':\ 'reg\.exe'\})
- name: '[Sigma] Potential Suspicious Registry File Imported Via Reg.EXE'
  tag: attack.persistence,attack.t1112,attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ import\ '
- name: '[Sigma] Potential Suspicious Registry File Imported Via Reg.EXE'
  tag: attack.persistence,attack.t1112,attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Users\\|%temp%|%tmp%|%appdata%|\\AppData\\Local\\Temp\\|C:\\Windows\\Temp\\|C:\\ProgramData\\)
- name: '[Sigma] RestrictedAdminMode Registry Value Tampering - ProcCreation'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\System\\CurrentControlSet\\Control\\Lsa|DisableRestrictedAdmin)
- name: '[Sigma] LSA PPL Protection Disabled Via Reg.EXE'
  tag: attack.defense-evasion,attack.t1562.010
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\reg\.exe'\}|\{'OriginalFileName':\ 'reg\.exe'\})
- name: '[Sigma] LSA PPL Protection Disabled Via Reg.EXE'
  tag: attack.defense-evasion,attack.t1562.010
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)SYSTEM\\CurrentControlSet\\Control\\Lsa
- name: '[Sigma] LSA PPL Protection Disabled Via Reg.EXE'
  tag: attack.defense-evasion,attack.t1562.010
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ add\ |\ /d\ 0|\ /v\ RunAsPPL\ )
- name: '[Sigma] Suspicious Query of MachineGUID'
  tag: attack.discovery,attack.t1082
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)\\reg\.exe$
- name: '[Sigma] Suspicious Query of MachineGUID'
  tag: attack.discovery,attack.t1082
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(SOFTWARE\\Microsoft\\Cryptography|/v\ |MachineGuid)
- name: '[Sigma] Modify Group Policy Settings'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1484.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\reg\.exe'\}|\{'OriginalFileName':\ 'reg\.exe'\})
- name: '[Sigma] Modify Group Policy Settings'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1484.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Policies\\Microsoft\\Windows\\System
- name: '[Sigma] Modify Group Policy Settings'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1484.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(GroupPolicyRefreshTimeDC|GroupPolicyRefreshTimeOffsetDC|GroupPolicyRefreshTime|GroupPolicyRefreshTimeOffset|EnableSmartScreen|ShellSmartScreenLevel)
- name: '[Sigma] Enable LM Hash Storage - ProcCreation'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\System\\CurrentControlSet\\Control\\Lsa|NoLMHash|\ 0)
- name: '[Sigma] Suspicious Reg Add Open Command'
  tag: attack.credential-access,attack.t1003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(reg|add|hkcu\\software\\classes\\ms\-settings\\shell\\open\\command|/ve\
    |/d)
- name: '[Sigma] Suspicious Reg Add Open Command'
  tag: attack.credential-access,attack.t1003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(reg|add|hkcu\\software\\classes\\ms\-settings\\shell\\open\\command|/v|DelegateExecute)
- name: '[Sigma] Suspicious Reg Add Open Command'
  tag: attack.credential-access,attack.t1003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(reg|delete|hkcu\\software\\classes\\ms\-settings)
- name: '[Sigma] Potential Configuration And Service Reconnaissance Via Reg.EXE'
  tag: attack.discovery,attack.t1012,attack.t1007
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\reg\.exe'\}|\{'OriginalFileName':\ 'reg\.exe'\})
- name: '[Sigma] Potential Configuration And Service Reconnaissance Via Reg.EXE'
  tag: attack.discovery,attack.t1012,attack.t1007
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)query
- name: '[Sigma] Potential Configuration And Service Reconnaissance Via Reg.EXE'
  tag: attack.discovery,attack.t1012,attack.t1007
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(currentVersion\\windows|winlogon\\|currentVersion\\shellServiceObjectDelayLoad|currentVersion\\run|currentVersion\\policies\\explorer\\run|currentcontrolset\\services)
- name: '[Sigma] Potential Tampering With RDP Related Registry Keys Via Reg.EXE'
  tag: attack.persistence,attack.defense-evasion,attack.lateral-movement,attack.t1021.001,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\reg\.exe'\}|\{'OriginalFileName':\ 'reg\.exe'\})
- name: '[Sigma] Potential Tampering With RDP Related Registry Keys Via Reg.EXE'
  tag: attack.persistence,attack.defense-evasion,attack.lateral-movement,attack.t1021.001,attack.t1112
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ add\ |\\CurrentControlSet\\Control\\Terminal\ Server|REG_DWORD|\
    /f)
- name: '[Sigma] Potential Tampering With RDP Related Registry Keys Via Reg.EXE'
  tag: attack.persistence,attack.defense-evasion,attack.lateral-movement,attack.t1021.001,attack.t1112
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Licensing\ Core|EnableConcurrentSessions)
- name: '[Sigma] Potential Tampering With RDP Related Registry Keys Via Reg.EXE'
  tag: attack.persistence,attack.defense-evasion,attack.lateral-movement,attack.t1021.001,attack.t1112
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(AllowTSConnections|fDenyTSConnections|fEnableWinStation|fSingleSessionPerUser|IdleWinStationPoolCount|MaxInstanceCount|SecurityLayer|TSAdvertise|TSAppCompat|TSEnabled|TSUserEnabled|WinStations\\RDP\-Tcp)
- name: '[Sigma] Potential Tampering With RDP Related Registry Keys Via Reg.EXE'
  tag: attack.persistence,attack.defense-evasion,attack.lateral-movement,attack.t1021.001,attack.t1112
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(SecurityLayer|02)
- name: '[Sigma] Suspicious ScreenSave Change by Reg.exe'
  tag: attack.persistence,attack.privilege-escalation,attack.t1546.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\reg\.exe$
- name: '[Sigma] Suspicious ScreenSave Change by Reg.exe'
  tag: attack.persistence,attack.privilege-escalation,attack.t1546.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(HKEY_CURRENT_USER\\Control\ Panel\\Desktop|HKCU\\Control\ Panel\\Desktop)
- name: '[Sigma] Suspicious ScreenSave Change by Reg.exe'
  tag: attack.persistence,attack.privilege-escalation,attack.t1546.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/v\ ScreenSaveActive|/t\ REG_SZ|/d\ 1|/f)
- name: '[Sigma] Suspicious ScreenSave Change by Reg.exe'
  tag: attack.persistence,attack.privilege-escalation,attack.t1546.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/v\ ScreenSaveTimeout|/t\ REG_SZ|/d\ |/f)
- name: '[Sigma] Suspicious ScreenSave Change by Reg.exe'
  tag: attack.persistence,attack.privilege-escalation,attack.t1546.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/v\ ScreenSaverIsSecure|/t\ REG_SZ|/d\ 0|/f)
- name: '[Sigma] Suspicious ScreenSave Change by Reg.exe'
  tag: attack.persistence,attack.privilege-escalation,attack.t1546.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/v\ SCRNSAVE\.EXE|/t\ REG_SZ|/d\ |\.scr|/f)
- name: '[Sigma] Changing Existing Service ImagePath Value Via Reg.EXE'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.persistence,attack.t1574.011
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\reg\.exe$
- name: '[Sigma] Changing Existing Service ImagePath Value Via Reg.EXE'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.persistence,attack.t1574.011
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(add\ |SYSTEM\\CurrentControlSet\\Services\\|\ ImagePath\ )
- name: '[Sigma] Changing Existing Service ImagePath Value Via Reg.EXE'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.persistence,attack.t1574.011
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-d\ '
- name: '[Sigma] Detected Windows Software Discovery'
  tag: attack.discovery,attack.t1518
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\reg\.exe$
- name: '[Sigma] Detected Windows Software Discovery'
  tag: attack.discovery,attack.t1518
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(query|\\software\\|/v|svcversion)
- name: '[Sigma] Reg Add Suspicious Paths'
  tag: attack.persistence,attack.defense-evasion,attack.t1112,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\reg\.exe'\}|\{'OriginalFileName':\ 'reg\.exe'\})
- name: '[Sigma] Reg Add Suspicious Paths'
  tag: attack.persistence,attack.defense-evasion,attack.t1112,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\AppDataLow\\Software\\Microsoft\\|\\Policies\\Microsoft\\Windows\\OOBE|\\Policies\\Microsoft\\Windows\
    NT\\CurrentVersion\\Winlogon|\\SOFTWARE\\Microsoft\\Windows\ NT\\Currentversion\\Winlogon|\\CurrentControlSet\\Control\\SecurityProviders\\WDigest|\\Microsoft\\Windows\
    Defender\\)
- name: '[Sigma] Disabled Volume Snapshots'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\Services\\VSS\\Diag|/d\ Disabled)
- name: '[Sigma] Suspicious Windows Defender Registry Key Tampering Via Reg.EXE'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\reg\.exe'\}|\{'OriginalFileName':\ 'reg\.exe'\})
- name: '[Sigma] Suspicious Windows Defender Registry Key Tampering Via Reg.EXE'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(SOFTWARE\\Microsoft\\Windows\ Defender\\|SOFTWARE\\Policies\\Microsoft\\Windows\
    Defender\ Security\ Center|SOFTWARE\\Policies\\Microsoft\\Windows\ Defender\\)
- name: '[Sigma] Suspicious Windows Defender Registry Key Tampering Via Reg.EXE'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ add\ |d\ 0)
- name: '[Sigma] Suspicious Windows Defender Registry Key Tampering Via Reg.EXE'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(DisallowExploitProtectionOverride|EnableControlledFolderAccess|MpEnablePus|PUAProtection|SpynetReporting|SubmitSamplesConsent|TamperProtection)
- name: '[Sigma] Suspicious Windows Defender Registry Key Tampering Via Reg.EXE'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ add\ |d\ 1)
- name: '[Sigma] Suspicious Windows Defender Registry Key Tampering Via Reg.EXE'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(DisableAccess|DisableAntiSpyware|DisableAntiSpywareRealtimeProtection|DisableAntiVirus|DisableAntiVirusSignatures|DisableArchiveScanning|DisableBehaviorMonitoring|DisableBlockAtFirstSeen|DisableCloudProtection|DisableConfig|DisableEnhancedNotifications|DisableIntrusionPreventionSystem|DisableIOAVProtection|DisableNetworkProtection|DisableOnAccessProtection|DisablePrivacyMode|DisableRealtimeMonitoring|DisableRoutinelyTakingAction|DisableScanOnRealtimeEnable|DisableScriptScanning|DisableSecurityCenter|Notification_Suppress|SignatureDisableUpdateOnStartupWithoutEngine)
- name: '[Sigma] Write Protect For Storage Disabled'
  tag: attack.defense-evasion,attack.t1562
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\System\\CurrentControlSet\\Control|Write\ Protection|0|storage)
- name: '[Sigma] Remote Access Tool - AnyDesk Execution'
  tag: attack.command-and-control,attack.t1219.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\AnyDesk\.exe',\ '\\\\AnyDeskMSI\.exe'\]\}|\{'Description':\
    'AnyDesk'\}|\{'Product':\ 'AnyDesk'\}|\{'Company':\ 'AnyDesk\ Software\ GmbH'\})
- name: '[Sigma] Remote Access Tool - AnyDesk Piped Password Via CLI'
  tag: attack.command-and-control,attack.t1219.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/c\ |echo\ |\.exe\ \-\-set\-password)
- name: '[Sigma] Remote Access Tool - AnyDesk Execution With Known Revoked Signing
    Certificate'
  tag: attack.execution,attack.initial-access
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\AnyDesk\.exe'\}|\{'Description':\ 'AnyDesk'\}|\{'Product':\
    'AnyDesk'\}|\{'Company':\ 'AnyDesk\ Software\ GmbH'\})
- name: '[Sigma] Remote Access Tool - AnyDesk Execution With Known Revoked Signing
    Certificate'
  tag: attack.execution,attack.initial-access
  score: 50
  target: Full_Path
  condition: regex
  pattern: ^(7\.0\.|7\.1\.|8\.0\.1|8\.0\.2|8\.0\.3|8\.0\.4|8\.0\.5|8\.0\.6|8\.0\.7)
- name: '[Sigma] Remote Access Tool - AnyDesk Execution With Known Revoked Signing
    Certificate'
  tag: attack.execution,attack.initial-access
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-\-remove|\ \-\-uninstall)
- name: '[Sigma] Remote Access Tool - AnyDesk Silent Installation'
  tag: attack.command-and-control,attack.t1219.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-\-install|\-\-start\-with\-win|\-\-silent)
- name: '[Sigma] Remote Access Tool - Anydesk Execution From Suspicious Folder'
  tag: attack.command-and-control,attack.t1219.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\AnyDesk\.exe',\ '\\\\AnyDeskMSI\.exe'\]\}|\{'Description':\
    'AnyDesk'\}|\{'Product':\ 'AnyDesk'\}|\{'Company':\ 'AnyDesk\ Software\ GmbH'\})
- name: '[Sigma] Remote Access Tool - Anydesk Execution From Suspicious Folder'
  tag: attack.command-and-control,attack.t1219.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\AppData\\|Program\ Files\ \(x86\)\\AnyDesk|Program\ Files\\AnyDesk)
- name: '[Sigma] Remote Access Tool - GoToAssist Execution'
  tag: attack.command-and-control,attack.t1219.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Description':\ 'GoTo\ Opener'\}|\{'Product':\ 'GoTo\ Opener'\}|\{'Company':\
    'LogMeIn,\ Inc\.'\})
- name: '[Sigma] Remote Access Tool - LogMeIn Execution'
  tag: attack.command-and-control,attack.t1219.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Description':\ 'LMIGuardianSvc'\}|\{'Product':\ 'LMIGuardianSvc'\}|\{'Company':\
    'LogMeIn,\ Inc\.'\})
- name: '[Sigma] Remote Access Tool - MeshAgent Command Execution via MeshCentral'
  tag: attack.command-and-control,attack.t1219.002
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\meshagent\.exe$
- name: '[Sigma] Remote Access Tool - MeshAgent Command Execution via MeshCentral'
  tag: attack.command-and-control,attack.t1219.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\cmd\.exe|\\powershell\.exe|\\pwsh\.exe)$
- name: '[Sigma] Remote Access Tool - NetSupport Execution'
  tag: attack.command-and-control,attack.t1219.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Description':\ 'NetSupport\ Client\ Configurator'\}|\{'Product':\
    'NetSupport\ Remote\ Control'\}|\{'Company':\ 'NetSupport\ Ltd'\}|\{'OriginalFileName':\
    'PCICFGUI\.EXE'\})
- name: '[Sigma] Remote Access Tool - NetSupport Execution From Unusual Location'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\client32\.exe'\}|\{'Product\|contains':\
    'NetSupport\ Remote\ Control'\}|\{'OriginalFileName\|contains':\ 'client32\.exe'\}|\{'Hashes\|contains':\
    'IMPHASH=a9d50692e95b79723f3e76fcf70d023e'\})
- name: '[Sigma] Remote Access Tool - NetSupport Execution From Unusual Location'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^(C:\\Program\ Files\\|C:\\Program\ Files\ \(x86\)\\)
- name: '[Sigma] Remote Access Tool - RURAT Execution From Unusual Location'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\rutserv\.exe',\ '\\\\rfusclient\.exe'\]\}|\{'Product':\
    'Remote\ Utilities'\})
- name: '[Sigma] Remote Access Tool - RURAT Execution From Unusual Location'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^(C:\\Program\ Files\\Remote\ Utilities|C:\\Program\ Files\ \(x86\)\\Remote\
    Utilities)
- name: '[Sigma] Remote Access Tool - ScreenConnect Execution'
  tag: attack.command-and-control,attack.t1219.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Description':\ 'ScreenConnect\ Service'\}|\{'Product':\ 'ScreenConnect'\}|\{'Company':\
    'ScreenConnect\ Software'\})
- name: '[Sigma] Remote Access Tool - ScreenConnect Installation Execution'
  tag: attack.persistence,attack.initial-access,attack.t1133
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(e=Access\&|y=Guest\&|\&p=|\&c=|\&k=)
- name: '[Sigma] Remote Access Tool - ScreenConnect Remote Command Execution'
  tag: attack.execution,attack.t1059.003
  score: 20
  target: ParentPath
  condition: regex
  pattern: (?i)\\ScreenConnect\.ClientService\.exe$
- name: '[Sigma] Remote Access Tool - ScreenConnect Remote Command Execution'
  tag: attack.execution,attack.t1059.003
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\cmd\.exe'\}|\{'OriginalFileName':\ 'Cmd\.Exe'\})
- name: '[Sigma] Remote Access Tool - ScreenConnect Remote Command Execution'
  tag: attack.execution,attack.t1059.003
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)\\TEMP\\ScreenConnect\\
- name: '[Sigma] Remote Access Tool - ScreenConnect Potential Suspicious Remote Command
    Execution'
  tag: attack.command-and-control,attack.t1219.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(:\\Windows\\TEMP\\ScreenConnect\\|run\.cmd)
- name: '[Sigma] Remote Access Tool - ScreenConnect Potential Suspicious Remote Command
    Execution'
  tag: attack.command-and-control,attack.t1219.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\bitsadmin\.exe|\\cmd\.exe|\\curl\.exe|\\dllhost\.exe|\\net\.exe|\\nltest\.exe|\\powershell\.exe|\\pwsh\.exe|\\rundll32\.exe|\\wevtutil\.exe)$
- name: '[Sigma] Remote Access Tool - ScreenConnect Server Web Shell Execution'
  tag: attack.initial-access,attack.t1190
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\ScreenConnect\.Service\.exe$
- name: '[Sigma] Remote Access Tool - ScreenConnect Server Web Shell Execution'
  tag: attack.initial-access,attack.t1190
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\cmd\.exe|\\csc\.exe)$
- name: '[Sigma] Remote Access Tool - Simple Help Execution'
  tag: attack.command-and-control,attack.t1219.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\JWrapper\-Remote\ Access\\|\\JWrapper\-Remote\ Support\\)
- name: '[Sigma] Remote Access Tool - Simple Help Execution'
  tag: attack.command-and-control,attack.t1219.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\SimpleService\.exe$
- name: '[Sigma] Remote Access Tool - Team Viewer Session Started On Windows Host'
  tag: attack.persistence,attack.initial-access,attack.t1133
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)TeamViewer_Desktop\.exe
- name: '[Sigma] Remote Access Tool - Team Viewer Session Started On Windows Host'
  tag: attack.persistence,attack.initial-access,attack.t1133
  score: 20
  target: ParentPath
  condition: regex
  pattern: (?i)TeamViewer_Service\.exe
- name: '[Sigma] Remote Access Tool - Team Viewer Session Started On Windows Host'
  tag: attack.persistence,attack.initial-access,attack.t1133
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)TeamViewer_Desktop\.exe\ \-\-IPCport\ 5939\ \-\-Module\ 1$
- name: '[Sigma] Remote Access Tool - UltraViewer Execution'
  tag: attack.command-and-control,attack.t1219.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Product':\ 'UltraViewer'\}|\{'Company':\ 'DucFabulous\ Co,ltd'\}|\{'OriginalFileName':\
    'UltraViewer_Desktop\.exe'\})
- name: '[Sigma] Discovery of a System Time'
  tag: attack.discovery,attack.t1124
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(\\net\.exe|\\net1\.exe)$
- name: '[Sigma] Discovery of a System Time'
  tag: attack.discovery,attack.t1124
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)time
- name: '[Sigma] Discovery of a System Time'
  tag: attack.discovery,attack.t1124
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)\\w32tm\.exe$
- name: '[Sigma] Discovery of a System Time'
  tag: attack.discovery,attack.t1124
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)tz
- name: '[Sigma] Renamed AdFind Execution'
  tag: attack.discovery,attack.t1018,attack.t1087.002,attack.t1482,attack.t1069.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(domainlist|trustdmp|dcmodes|adinfo|\ dclist\ |computer_pwdnotreqd|objectcategory=|\-subnets\
    \-f|name="Domain\ Admins"|\-sc\ u:|domainncs|dompol|\ oudmp\ |subnetdmp|gpodmp|fspdmp|users_noexpire|computers_active|computers_pwdnotreqd)
- name: '[Sigma] Renamed AdFind Execution'
  tag: attack.discovery,attack.t1018,attack.t1087.002,attack.t1482,attack.t1069.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(IMPHASH=BCA5675746D13A1F246E2DA3C2217492|IMPHASH=53E117A96057EAF19C41380D0E87F1C2|IMPHASH=d144de8117df2beceaba2201ad304764|IMPHASH=12ce1c0f3f5837ecc18a3782408fa975|IMPHASH=4fbf3f084fbbb2470b80b2013134df35|IMPHASH=49b639b4acbecc49d72a01f357aa4930|IMPHASH=680dad9e300346e05a85023965867201|IMPHASH=21aa085d54992511b9f115355e468782)
- name: '[Sigma] Renamed AdFind Execution'
  tag: attack.discovery,attack.t1018,attack.t1087.002,attack.t1482,attack.t1069.002
  score: 80
  target: FileName
  condition: regex
  pattern: (?i)AdFind\.exe
- name: '[Sigma] Renamed AdFind Execution'
  tag: attack.discovery,attack.t1018,attack.t1087.002,attack.t1482,attack.t1069.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\AdFind\.exe$
- name: '[Sigma] Renamed AutoHotkey.EXE Execution'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Product\|contains':\ 'AutoHotkey'\}|\{'Description\|contains':\
    'AutoHotkey'\}|\{'OriginalFileName':\ \['AutoHotkey\.exe',\ 'AutoHotkey\.rc'\]\})
- name: '[Sigma] Renamed AutoHotkey.EXE Execution'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\AutoHotkey\.exe',\ '\\\\AutoHotkey32\.exe',\
    '\\\\AutoHotkey32_UIA\.exe',\ '\\\\AutoHotkey64\.exe',\ '\\\\AutoHotkey64_UIA\.exe',\
    '\\\\AutoHotkeyA32\.exe',\ '\\\\AutoHotkeyA32_UIA\.exe',\ '\\\\AutoHotkeyU32\.exe',\
    '\\\\AutoHotkeyU32_UIA\.exe',\ '\\\\AutoHotkeyU64\.exe',\ '\\\\AutoHotkeyU64_UIA\.exe'\]\}|\{'Image\|contains':\
    '\\\\AutoHotkey'\})
- name: '[Sigma] Renamed AutoIt Execution'
  tag: attack.defense-evasion,attack.t1027
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /AutoIt3ExecuteScript|\ /ErrorStdOut)
- name: '[Sigma] Renamed AutoIt Execution'
  tag: attack.defense-evasion,attack.t1027
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(IMPHASH=FDC554B3A8683918D731685855683DDF|IMPHASH=CD30A61B60B3D60CECDB034C8C83C290|IMPHASH=F8A00C72F2D667D2EDBB234D0C0AE000)
- name: '[Sigma] Renamed AutoIt Execution'
  tag: attack.defense-evasion,attack.t1027
  score: 80
  target: FileName
  condition: regex
  pattern: (?i)(AutoIt3\.exe|AutoIt2\.exe|AutoIt\.exe)
- name: '[Sigma] Renamed AutoIt Execution'
  tag: attack.defense-evasion,attack.t1027
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\AutoIt\.exe|\\AutoIt2\.exe|\\AutoIt3_x64\.exe|\\AutoIt3\.exe)$
- name: '[Sigma] Potential Defense Evasion Via Binary Rename'
  tag: attack.defense-evasion,attack.t1036.003
  score: 50
  target: FileName
  condition: regex
  pattern: (?i)(Cmd\.Exe|CONHOST\.EXE|7z\.exe|7za\.exe|WinRAR\.exe|wevtutil\.exe|net\.exe|net1\.exe|netsh\.exe|InstallUtil\.exe)
- name: '[Sigma] Potential Defense Evasion Via Binary Rename'
  tag: attack.defense-evasion,attack.t1036.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\cmd\.exe|\\conhost\.exe|\\7z\.exe|\\7za\.exe|\\WinRAR\.exe|\\wevtutil\.exe|\\net\.exe|\\net1\.exe|\\netsh\.exe|\\InstallUtil\.exe)$
- name: '[Sigma] Potential Defense Evasion Via Rename Of Highly Relevant Binaries'
  tag: attack.defense-evasion,attack.t1036.003,car.2013-05-009
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Description':\ 'Execute\ processes\ remotely'\}|\{'Product':\ 'Sysinternals\
    PsExec'\}|\{'Description\|startswith':\ \['Windows\ PowerShell',\ 'pwsh'\]\}|\{'OriginalFileName':\
    \['certutil\.exe',\ 'cmstp\.exe',\ 'cscript\.exe',\ 'IE4UINIT\.EXE',\ 'mshta\.exe',\
    'msiexec\.exe',\ 'msxsl\.exe',\ 'powershell_ise\.exe',\ 'powershell\.exe',\ 'psexec\.c',\
    'psexec\.exe',\ 'psexesvc\.exe',\ 'pwsh\.dll',\ 'reg\.exe',\ 'regsvr32\.exe',\
    'rundll32\.exe',\ 'WerMgr',\ 'wmic\.exe',\ 'wscript\.exe'\]\})
- name: '[Sigma] Potential Defense Evasion Via Rename Of Highly Relevant Binaries'
  tag: attack.defense-evasion,attack.t1036.003,car.2013-05-009
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\certutil\.exe|\\cmstp\.exe|\\cscript\.exe|\\ie4uinit\.exe|\\mshta\.exe|\\msiexec\.exe|\\msxsl\.exe|\\powershell_ise\.exe|\\powershell\.exe|\\psexec\.exe|\\psexec64\.exe|\\PSEXESVC\.exe|\\pwsh\.exe|\\reg\.exe|\\regsvr32\.exe|\\rundll32\.exe|\\wermgr\.exe|\\wmic\.exe|\\wscript\.exe)$
- name: '[Sigma] Renamed BOINC Client Execution'
  tag: attack.defense-evasion,attack.t1553
  score: 50
  target: FileName
  condition: regex
  pattern: (?i)BOINC\.exe
- name: '[Sigma] Renamed BOINC Client Execution'
  tag: attack.defense-evasion,attack.t1553
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\BOINC\.exe$
- name: '[Sigma] Renamed BrowserCore.EXE Execution'
  tag: attack.credential-access,attack.defense-evasion,attack.t1528,attack.t1036.003
  score: 80
  target: FileName
  condition: regex
  pattern: (?i)BrowserCore\.exe
- name: '[Sigma] Renamed BrowserCore.EXE Execution'
  tag: attack.credential-access,attack.defense-evasion,attack.t1528,attack.t1036.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\BrowserCore\.exe$
- name: '[Sigma] Renamed Cloudflared.EXE Execution'
  tag: attack.command-and-control,attack.t1090.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ tunnel\ |cleanup\ )
- name: '[Sigma] Renamed Cloudflared.EXE Execution'
  tag: attack.command-and-control,attack.t1090.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-config\ |\-connector\-id\ )
- name: '[Sigma] Renamed Cloudflared.EXE Execution'
  tag: attack.command-and-control,attack.t1090.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ tunnel\ |\ run\ )
- name: '[Sigma] Renamed Cloudflared.EXE Execution'
  tag: attack.command-and-control,attack.t1090.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-config\ |\-credentials\-contents\ |\-credentials\-file\ |\-token\
    )
- name: '[Sigma] Renamed Cloudflared.EXE Execution'
  tag: attack.command-and-control,attack.t1090.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-url|tunnel)
- name: '[Sigma] Renamed Cloudflared.EXE Execution'
  tag: attack.command-and-control,attack.t1090.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(SHA256=2fb6c04c4f95fb8d158af94c137f90ac820716deaf88d8ebec956254e046cb29|SHA256=b3d21940a10fdef5e415ad70331ce257c24fe3bcf7722262302e0421791f87e8|SHA256=1fbd8362b2d2d2e6a5750ae3db69cd1815e6c1d31da48a98b796450971a8e039|SHA256=0409c9b12f9d0eda86e461ed9bdabeefb00172b26322079681a0bdf48e68dc28|SHA256=7cfb411d04bac42ef93d1f0c93c0a481e38c6f4612b97ae89d4702595988edc7|SHA256=5b3c2d846ab162dc6bc595cce3a49de5731afde5d6060be7066d21b013a28373|SHA256=ce95df7f69664c3df19b76028e115931919a71517b776da7b42d353e2ff4a670|SHA256=1293525a19cfe3bc8296b62fbfe19f083632ed644a1c18c10b045a1d3030d81a|SHA256=af2b9161cfcb654b16408cd6b098afe9d1fb61a037d18d7090a119d4c0c8e0f0|SHA256=39ddceb56a15798826a5fc4892fa2b474c444bb4d7a8bf2fa95e41cab10fa7a1|SHA256=ccd11f2328023a0e7929e845d5b6e7bc783fb4650d65faef3ae090239d4bbce2|SHA256=b6e5c5d2567ae8c69cc012ebcae30e6c9b5359d64a58d17ba75ec89f8bce71ac|SHA256=f813484ea441404f18caad96f28138e8aaf0cb256163c09c2ab8a3acab87f69f|SHA256=fc4a0802ab9c7409b892ca00636bec61e2acfc911bccfdeb9978b8ab5a2f828d|SHA256=083150724b49604c8765c1ba19541fa260b133be0acb0647fcd936d81f054499|SHA256=44303d6572956f28a0f2e4b188934fb9874f2584f5c81fa431a463cfbf28083b|SHA256=5d38c46032a58e28ae5f7d174d8761ec3d64d186677f3ec53af5f51afb9bfd2f|SHA256=e1e70fa42059911bc6685fafef957f9a73fc66f214d0704a9b932683a5204032|SHA256=c01356092a365b84f84f0e66870bd1a05ba3feb53cafd973fa5fea2534bee234|SHA256=b3f9c06151e30ee43d39e788a79cd918a314f24e04fe87f3de8272a2057b624f|SHA256=cd81b2792f0739f473c31c9cb7cf2313154bfa28b839975802b90e8790bb5058|SHA256=9ec7e6c8e1bfd883663d8d9d62c9e4f9ae373b731407181e32491b27a7218a2c|SHA256=c2cfd23fdc6c0e1b1ffa0e545cbe556f18d11b362b4a89ba0713f6ab01c4827f|SHA256=53f8adbd76c0eb16f5e43cadde422474d8a06f9c8f959389c1930042ad8beaa5|SHA256=648c8d2f8001c113d2986dd00b7bbd181593d462bef73522cee212c4f71f95b3|SHA256=ae047e2095e46c3f9c518b2be67ec753f4f0aad23b261a361fcb6144dcdb63b4|SHA256=3153d2baa462978dd22ab33d1c2274ecc88c200225d6a3327f98d5b752d08f5c|SHA256=f49cde976e628012c9db73e1c8d76081944ecf2297cdafeb78bb13290da274c4|SHA256=d2513e58bb03ccc83affde685c6ef987924c37ce6707d8e9857e2524b0d7e90f|SHA256=bb67c7623ba92fe64ffd9816b8d5b3b1ea3013960a30bd4cf6e295b3eb5b1bad|SHA256=b34b3c3a91e3165d1481f0b3ec23eab93a1cfba94345a6cbfe5b18ddbd48eac7|SHA256=f7848034e010d55f15e474ca998f96391e320ff29b00cfcc4c5e536529703e75|SHA256=b6fc9493778cbe3bfc062d73f5cc604bc0ff058bc5e5dc6aac87f3a4008b54b6|SHA256=f5c5e962577e2293c4ad10603816dce7cc273585969615fbf4e4bfa9eaff1688|SHA256=d14c52d9220b606f428a8fe9f7c108b0d6f14cf71e7384749e98e6a95962e68f|SHA256=d3a0e1a79158f3985cd49607ebe0cdfcc49cb9af96b8f43aefd0cdfe2f22e663|SHA256=2fbbfc8299537ff80cadf9d0e27c223fe0ccb9052bf9d8763ad717bbfa521c77|SHA256=19074674c6fbdaa573b3081745e5e26144fdf7a086d14e0e220d1814f1f13078)
- name: '[Sigma] Renamed Cloudflared.EXE Execution'
  tag: attack.command-and-control,attack.t1090.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\cloudflared\.exe|\\cloudflared\-windows\-386\.exe|\\cloudflared\-windows\-amd64\.exe)$
- name: '[Sigma] Renamed CreateDump Utility Execution'
  tag: attack.defense-evasion,attack.t1036,attack.t1003.001,attack.credential-access
  score: 80
  target: FileName
  condition: regex
  pattern: (?i)FX_VER_INTERNALNAME_STR
- name: '[Sigma] Renamed CreateDump Utility Execution'
  tag: attack.defense-evasion,attack.t1036,attack.t1003.001,attack.credential-access
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains\|all':\ \['\ \-u\ ',\ '\ \-f\ ',\ '\.dmp'\]\}|\{'CommandLine\|contains\|all':\
    \['\ \-\-full\ ',\ '\ \-\-name\ ',\ '\.dmp'\]\})
- name: '[Sigma] Renamed CreateDump Utility Execution'
  tag: attack.defense-evasion,attack.t1036,attack.t1003.001,attack.credential-access
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\createdump\.exe$
- name: '[Sigma] Renamed CURL.EXE Execution'
  tag: attack.execution,attack.t1059,attack.defense-evasion,attack.t1202
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'curl\.exe'\}|\{'Description':\ 'The\ curl\
    executable'\})
- name: '[Sigma] Renamed CURL.EXE Execution'
  tag: attack.execution,attack.t1059,attack.defense-evasion,attack.t1202
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\curl
- name: '[Sigma] Renamed ZOHO Dctask64 Execution'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1036,attack.t1055.001,attack.t1202,attack.t1218
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(IMPHASH=6834B1B94E49701D77CCB3C0895E1AFD|IMPHASH=1BB6F93B129F398C7C4A76BB97450BBA|IMPHASH=FAA2AC19875FADE461C8D89DCF2710A3|IMPHASH=F1039CED4B91572AB7847D26032E6BBF)
- name: '[Sigma] Renamed ZOHO Dctask64 Execution'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1036,attack.t1055.001,attack.t1202,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\dctask64\.exe$
- name: '[Sigma] Renamed FTP.EXE Execution'
  tag: attack.execution,attack.t1059,attack.defense-evasion,attack.t1202
  score: 50
  target: FileName
  condition: regex
  pattern: (?i)ftp\.exe
- name: '[Sigma] Renamed FTP.EXE Execution'
  tag: attack.execution,attack.t1059,attack.defense-evasion,attack.t1202
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\ftp\.exe$
- name: '[Sigma] Renamed Gpg.EXE Execution'
  tag: attack.impact,attack.t1486
  score: 80
  target: FileName
  condition: regex
  pattern: (?i)gpg\.exe
- name: '[Sigma] Renamed Gpg.EXE Execution'
  tag: attack.impact,attack.t1486
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\gpg\.exe|\\gpg2\.exe)$
- name: '[Sigma] Renamed Jusched.EXE Execution'
  tag: attack.execution,attack.defense-evasion,attack.t1036.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(Java\ Update\ Scheduler|Java\(TM\)\ Update\ Scheduler)
- name: '[Sigma] Renamed Jusched.EXE Execution'
  tag: attack.execution,attack.defense-evasion,attack.t1036.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\jusched\.exe$
- name: '[Sigma] Renamed Mavinject.EXE Execution'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1055.001,attack.t1218.013
  score: 80
  target: FileName
  condition: regex
  pattern: (?i)(mavinject32\.exe|mavinject64\.exe)
- name: '[Sigma] Renamed Mavinject.EXE Execution'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1055.001,attack.t1218.013
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\mavinject32\.exe|\\mavinject64\.exe)$
- name: '[Sigma] Renamed MegaSync Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: FileName
  condition: regex
  pattern: (?i)megasync\.exe
- name: '[Sigma] Renamed MegaSync Execution'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\megasync\.exe$
- name: '[Sigma] Renamed Msdt.EXE Execution'
  tag: attack.defense-evasion,attack.t1036.003
  score: 80
  target: FileName
  condition: regex
  pattern: (?i)msdt\.exe
- name: '[Sigma] Renamed Msdt.EXE Execution'
  tag: attack.defense-evasion,attack.t1036.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\msdt\.exe$
- name: '[Sigma] Renamed Microsoft Teams Execution'
  tag: attack.defense-evasion
  score: 50
  target: FileName
  condition: regex
  pattern: (?i)(msteams\.exe|teams\.exe)
- name: '[Sigma] Renamed Microsoft Teams Execution'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\msteams\.exe|\\teams\.exe)$
- name: '[Sigma] Renamed NetSupport RAT Execution'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Product\|contains':\ 'NetSupport\ Remote\ Control'\}|\{'OriginalFileName\|contains':\
    'client32\.exe'\}|\{'Hashes\|contains':\ 'IMPHASH=A9D50692E95B79723F3E76FCF70D023E'\})
- name: '[Sigma] Renamed NetSupport RAT Execution'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\client32\.exe$
- name: '[Sigma] Renamed NirCmd.EXE Execution'
  tag: attack.execution,attack.t1059,attack.defense-evasion,attack.t1202
  score: 80
  target: FileName
  condition: regex
  pattern: (?i)NirCmd\.exe
- name: '[Sigma] Renamed NirCmd.EXE Execution'
  tag: attack.execution,attack.t1059,attack.defense-evasion,attack.t1202
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\nircmd\.exe|\\nircmdc\.exe)$
- name: '[Sigma] Renamed Office Binary Execution'
  tag: attack.defense-evasion,attack.t1036.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ \['Excel\.exe',\ 'MSACCESS\.EXE',\ 'MSPUB\.EXE',\
    'OneNote\.exe',\ 'OneNoteM\.exe',\ 'OUTLOOK\.EXE',\ 'POWERPNT\.EXE',\ 'WinWord\.exe',\
    'Olk\.exe'\]\}|\{'Description':\ \['Microsoft\ Access',\ 'Microsoft\ Excel',\
    'Microsoft\ OneNote',\ 'Microsoft\ Outlook',\ 'Microsoft\ PowerPoint',\ 'Microsoft\
    Publisher',\ 'Microsoft\ Word',\ 'Sent\ to\ OneNote\ Tool'\]\})
- name: '[Sigma] Renamed Office Binary Execution'
  tag: attack.defense-evasion,attack.t1036.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\EXCEL\.exe|\\excelcnv\.exe|\\MSACCESS\.exe|\\MSPUB\.EXE|\\ONENOTE\.EXE|\\ONENOTEM\.EXE|\\OUTLOOK\.EXE|\\POWERPNT\.EXE|\\WINWORD\.exe|\\OLK\.EXE)$
- name: '[Sigma] Renamed PAExec Execution'
  tag: attack.defense-evasion,attack.t1202
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Description':\ 'PAExec\ Application'\}|\{'OriginalFileName':\ 'PAExec\.exe'\}|\{'Product\|contains':\
    'PAExec'\}|\{'Hashes\|contains':\ \['IMPHASH=11D40A7B7876288F919AB819CC2D9802',\
    'IMPHASH=6444f8a34e99b8f7d9647de66aabe516',\ 'IMPHASH=dfd6aa3f7b2b1035b76b718f1ddc689f',\
    'IMPHASH=1a6cca4d5460b1710a12dea39e4a592c'\]\})
- name: '[Sigma] Renamed PAExec Execution'
  tag: attack.defense-evasion,attack.t1202
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\paexec\.exe'\}|\{'Image\|startswith':\
    'C:\\\\Windows\\\\PAExec\-'\})
- name: '[Sigma] Renamed PingCastle Binary Execution'
  tag: attack.execution,attack.t1059,attack.defense-evasion,attack.t1202
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ \['PingCastleReporting\.exe',\ 'PingCastleCloud\.exe',\
    'PingCastle\.exe'\]\}|\{'CommandLine\|contains':\ \['\-\-scanner\ aclcheck',\
    '\-\-scanner\ antivirus',\ '\-\-scanner\ computerversion',\ '\-\-scanner\ foreignusers',\
    '\-\-scanner\ laps_bitlocker',\ '\-\-scanner\ localadmin',\ '\-\-scanner\ nullsession',\
    '\-\-scanner\ nullsession\-trust',\ '\-\-scanner\ oxidbindings',\ '\-\-scanner\
    remote',\ '\-\-scanner\ share',\ '\-\-scanner\ smb',\ '\-\-scanner\ smb3querynetwork',\
    '\-\-scanner\ spooler',\ '\-\-scanner\ startup',\ '\-\-scanner\ zerologon'\]\}|\{'CommandLine\|contains':\
    '\-\-no\-enum\-limit'\}|\{'CommandLine\|contains\|all':\ \['\-\-healthcheck',\
    '\-\-level\ Full'\]\}|\{'CommandLine\|contains\|all':\ \['\-\-healthcheck',\ '\-\-server\
    '\]\})
- name: '[Sigma] Renamed PingCastle Binary Execution'
  tag: attack.execution,attack.t1059,attack.defense-evasion,attack.t1202
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\PingCastleReporting\.exe|\\PingCastleCloud\.exe|\\PingCastle\.exe)$
- name: '[Sigma] Renamed Plink Execution'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'Plink'\}|\{'CommandLine\|contains\|all':\
    \['\ \-l\ forward',\ '\ \-P\ ',\ '\ \-R\ '\]\})
- name: '[Sigma] Renamed Plink Execution'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\plink\.exe$
- name: '[Sigma] Visual Studio NodejsTools PressAnyKey Renamed Execution'
  tag: attack.execution,attack.defense-evasion,attack.t1218
  score: 50
  target: FileName
  condition: regex
  pattern: (?i)Microsoft\.NodejsTools\.PressAnyKey\.exe
- name: '[Sigma] Visual Studio NodejsTools PressAnyKey Renamed Execution'
  tag: attack.execution,attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\Microsoft\.NodejsTools\.PressAnyKey\.exe$
- name: '[Sigma] Potential Renamed Rundll32 Execution'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)DllRegisterServer
- name: '[Sigma] Potential Renamed Rundll32 Execution'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\rundll32\.exe$
- name: '[Sigma] Renamed Remote Utilities RAT (RURAT) Execution'
  tag: attack.defense-evasion,attack.collection,attack.command-and-control,attack.discovery,attack.s0592
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)Remote\ Utilities
- name: '[Sigma] Renamed Remote Utilities RAT (RURAT) Execution'
  tag: attack.defense-evasion,attack.collection,attack.command-and-control,attack.discovery,attack.s0592
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\rutserv\.exe|\\rfusclient\.exe)$
- name: '[Sigma] Renamed SysInternals DebugView Execution'
  tag: attack.resource-development,attack.t1588.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)Sysinternals\ DebugView
- name: '[Sigma] Renamed SysInternals DebugView Execution'
  tag: attack.resource-development,attack.t1588.002
  score: 80
  target: FileName
  condition: regex
  pattern: (?i)Dbgview\.exe
- name: '[Sigma] Renamed SysInternals DebugView Execution'
  tag: attack.resource-development,attack.t1588.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\Dbgview\.exe$
- name: '[Sigma] Renamed ProcDump Execution'
  tag: attack.defense-evasion,attack.t1036.003
  score: 80
  target: FileName
  condition: regex
  pattern: (?i)procdump
- name: '[Sigma] Renamed ProcDump Execution'
  tag: attack.defense-evasion,attack.t1036.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-ma\ |\ \-mp\ )
- name: '[Sigma] Renamed ProcDump Execution'
  tag: attack.defense-evasion,attack.t1036.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\ /accepteula
- name: '[Sigma] Renamed ProcDump Execution'
  tag: attack.defense-evasion,attack.t1036.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\procdump\.exe|\\procdump64\.exe)$
- name: '[Sigma] Renamed PsExec Service Execution'
  tag: attack.execution
  score: 80
  target: FileName
  condition: regex
  pattern: (?i)psexesvc\.exe
- name: '[Sigma] Renamed PsExec Service Execution'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\PSEXESVC\.exe
- name: '[Sigma] Renamed Sysinternals Sdelete Execution'
  tag: attack.impact,attack.t1485
  score: 80
  target: FileName
  condition: regex
  pattern: (?i)sdelete\.exe
- name: '[Sigma] Renamed Sysinternals Sdelete Execution'
  tag: attack.impact,attack.t1485
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\sdelete\.exe|\\sdelete64\.exe)$
- name: '[Sigma] Renamed Vmnat.exe Execution'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574.001
  score: 80
  target: FileName
  condition: regex
  pattern: (?i)vmnat\.exe
- name: '[Sigma] Renamed Vmnat.exe Execution'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)vmnat\.exe$
- name: '[Sigma] Renamed Whoami Execution'
  tag: attack.discovery,attack.t1033,car.2016-03-001
  score: 100
  target: FileName
  condition: regex
  pattern: (?i)whoami\.exe
- name: '[Sigma] Renamed Whoami Execution'
  tag: attack.discovery,attack.t1033,car.2016-03-001
  score: 100
  target: Target_Path
  condition: regex
  pattern: (?i)\\whoami\.exe$
- name: '[Sigma] Capture Credentials with Rpcping.exe'
  tag: attack.credential-access,attack.t1003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\RpcPing\.exe'\}|\{'OriginalFileName':\
    '\\\\RpcPing\.exe'\})
- name: '[Sigma] Capture Credentials with Rpcping.exe'
  tag: attack.credential-access,attack.t1003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\-s
- name: '[Sigma] Capture Credentials with Rpcping.exe'
  tag: attack.credential-access,attack.t1003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\-u
- name: '[Sigma] Capture Credentials with Rpcping.exe'
  tag: attack.credential-access,attack.t1003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)NTLM
- name: '[Sigma] Capture Credentials with Rpcping.exe'
  tag: attack.credential-access,attack.t1003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\-t
- name: '[Sigma] Capture Credentials with Rpcping.exe'
  tag: attack.credential-access,attack.t1003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)ncacn_np
- name: '[Sigma] Ruby Inline Command Execution'
  tag: attack.execution,attack.t1059
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\ruby\.exe'\}|\{'OriginalFileName':\ 'ruby\.exe'\})
- name: '[Sigma] Ruby Inline Command Execution'
  tag: attack.execution,attack.t1059
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-e
- name: '[Sigma] Potential Rundll32 Execution With DLL Stored In ADS'
  tag: attack.defense-evasion,attack.t1564.004
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\rundll32\.exe'\}|\{'OriginalFileName':\
    'RUNDLL32\.EXE'\})
- name: '[Sigma] Potential Rundll32 Execution With DLL Stored In ADS'
  tag: attack.defense-evasion,attack.t1564.004
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\[Rr\]\[Uu\]\[Nn\]\[Dd\]\[Ll\]\[Ll\]32\(\\\.\[Ee\]\[Xx\]\[Ee\]\).\
    \\S\+.\\w:\\S\+.:'
- name: '[Sigma] Suspicious Advpack Call Via Rundll32.EXE'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\rundll32\.exe'\}|\{'OriginalFileName':\
    'RUNDLL32\.EXE'\}|\{'CommandLine\|contains':\ 'rundll32'\})
- name: '[Sigma] Suspicious Advpack Call Via Rundll32.EXE'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)advpack
- name: '[Sigma] Suspicious Advpack Call Via Rundll32.EXE'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains\|all':\ \['\#\+',\ '12'\]\}|\{'CommandLine\|contains':\
    '\#\-'\})
- name: '[Sigma] Suspicious Rundll32 Invoking Inline VBScript'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1055
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(rundll32\.exe|Execute|RegRead|window\.close)
- name: '[Sigma] Rundll32 InstallScreenSaver Execution'
  tag: attack.t1218.011,attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\rundll32\.exe'\}|\{'OriginalFileName':\
    'RUNDLL32\.EXE'\})
- name: '[Sigma] Rundll32 InstallScreenSaver Execution'
  tag: attack.t1218.011,attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)InstallScreenSaver
- name: '[Sigma] Suspicious Key Manager Access'
  tag: attack.credential-access,attack.t1555.004
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\rundll32\.exe'\}|\{'OriginalFileName':\
    'RUNDLL32\.EXE'\})
- name: '[Sigma] Suspicious Key Manager Access'
  tag: attack.credential-access,attack.t1555.004
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(keymgr|KRShowKeyMgr)
- name: '[Sigma] Mshtml.DLL RunHTMLApplication Suspicious Usage'
  tag: attack.defense-evasion,attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\\.\.\\|mshtml)
- name: '[Sigma] Mshtml.DLL RunHTMLApplication Suspicious Usage'
  tag: attack.defense-evasion,attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\#135|RunHTMLApplication)
- name: '[Sigma] Rundll32 Execution Without CommandLine Parameters'
  tag: attack.defense-evasion,attack.t1202
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\rundll32\.exe|\\rundll32\.exe"|\\rundll32)$
- name: '[Sigma] Rundll32 Execution Without CommandLine Parameters'
  tag: attack.defense-evasion,attack.t1202
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\AppData\\Local\\|\\Microsoft\\Edge\\)
- name: '[Sigma] Suspicious NTLM Authentication on the Printer Spooler Service'
  tag: attack.privilege-escalation,attack.credential-access,attack.t1212
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\rundll32\.exe'\}|\{'OriginalFileName':\
    'RUNDLL32\.EXE'\})
- name: '[Sigma] Suspicious NTLM Authentication on the Printer Spooler Service'
  tag: attack.privilege-escalation,attack.credential-access,attack.t1212
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\windows\\system32\\davclnt\.dll,DavSetCookie|http)
- name: '[Sigma] Suspicious NTLM Authentication on the Printer Spooler Service'
  tag: attack.privilege-escalation,attack.credential-access,attack.t1212
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(spoolss|srvsvc|/print/pipe/)
- name: '[Sigma] Potential Obfuscated Ordinal Call Via Rundll32'
  tag: attack.defense-evasion,attack.t1027.010
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\rundll32\.exe'\}|\{'OriginalFileName':\
    'RUNDLL32\.EXE'\}|\{'CommandLine\|contains':\ 'rundll32'\})
- name: '[Sigma] Potential Obfuscated Ordinal Call Via Rundll32'
  tag: attack.defense-evasion,attack.t1027.010
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\#\+|\#\-|\#0|\#655|\#656)
- name: '[Sigma] Rundll32 Spawned Via Explorer.EXE'
  tag: attack.defense-evasion
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\explorer\.exe$
- name: '[Sigma] Rundll32 Spawned Via Explorer.EXE'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\rundll32\.exe'\}|\{'OriginalFileName':\
    'RUNDLL32\.EXE'\})
- name: '[Sigma] Rundll32 Spawned Via Explorer.EXE'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains':\ '\ C:\\\\Windows\\\\System32\\\\'\}|\{'CommandLine\|endswith':\
    '\ \-localserver\ 22d8c27b\-47a1\-48d1\-ad08\-7da7abd79617'\})
- name: '[Sigma] Process Memory Dump Via Comsvcs.DLL'
  tag: attack.defense-evasion,attack.credential-access,attack.t1036,attack.t1003.001,car.2013-05-009
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\rundll32\.exe'\}|\{'OriginalFileName':\
    'RUNDLL32\.EXE'\}|\{'CommandLine\|contains':\ 'rundll32'\})
- name: '[Sigma] Process Memory Dump Via Comsvcs.DLL'
  tag: attack.defense-evasion,attack.credential-access,attack.t1036,attack.t1003.001,car.2013-05-009
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(comsvcs|full)
- name: '[Sigma] Process Memory Dump Via Comsvcs.DLL'
  tag: attack.defense-evasion,attack.credential-access,attack.t1036,attack.t1003.001,car.2013-05-009
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\#\-|\#\+|\#24|24\ |MiniDump|\#65560)
- name: '[Sigma] Process Memory Dump Via Comsvcs.DLL'
  tag: attack.defense-evasion,attack.credential-access,attack.t1036,attack.t1003.001,car.2013-05-009
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(24|comsvcs|full)
- name: '[Sigma] Process Memory Dump Via Comsvcs.DLL'
  tag: attack.defense-evasion,attack.credential-access,attack.t1036,attack.t1003.001,car.2013-05-009
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \#|,\#|,\ \#|"\#)
- name: '[Sigma] Rundll32 Registered COM Objects'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.015
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\rundll32\.exe'\}|\{'OriginalFileName':\
    'RUNDLL32\.EXE'\})
- name: '[Sigma] Rundll32 Registered COM Objects'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.015
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-sta\ |\-localserver\ )
- name: '[Sigma] Rundll32 Registered COM Objects'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.015
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\{|\})
- name: '[Sigma] Suspicious Process Start Locations'
  tag: attack.defense-evasion,attack.t1036,car.2013-05-002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|contains':\ \[':\\\\RECYCLER\\\\',\ ':\\\\SystemVolumeInformation\\\\'\]\}|\{'Image\|startswith':\
    \['C:\\\\Windows\\\\Tasks\\\\',\ 'C:\\\\Windows\\\\debug\\\\',\ 'C:\\\\Windows\\\\fonts\\\\',\
    'C:\\\\Windows\\\\help\\\\',\ 'C:\\\\Windows\\\\drivers\\\\',\ 'C:\\\\Windows\\\\addins\\\\',\
    'C:\\\\Windows\\\\cursors\\\\',\ 'C:\\\\Windows\\\\system32\\\\tasks\\\\'\]\})
- name: '[Sigma] Suspicious Rundll32 Setupapi.dll Activity'
  tag: attack.defense-evasion,attack.t1218.011
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\runonce\.exe$
- name: '[Sigma] Suspicious Rundll32 Setupapi.dll Activity'
  tag: attack.defense-evasion,attack.t1218.011
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\rundll32\.exe$
- name: '[Sigma] Suspicious Rundll32 Setupapi.dll Activity'
  tag: attack.defense-evasion,attack.t1218.011
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(setupapi\.dll|InstallHinfSection)
- name: '[Sigma] Shell32 DLL Execution in Suspicious Directory'
  tag: attack.defense-evasion,attack.execution,attack.t1218.011
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\rundll32\.exe'\}|\{'OriginalFileName':\
    'RUNDLL32\.EXE'\})
- name: '[Sigma] Shell32 DLL Execution in Suspicious Directory'
  tag: attack.defense-evasion,attack.execution,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(shell32\.dll|Control_RunDLL)
- name: '[Sigma] Shell32 DLL Execution in Suspicious Directory'
  tag: attack.defense-evasion,attack.execution,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(%AppData%|%LocalAppData%|%Temp%|%tmp%|\\AppData\\|\\Temp\\|\\Users\\Public\\)
- name: '[Sigma] Potential ShellDispatch.DLL Functionality Abuse'
  tag: attack.execution,attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\rundll32\.exe'\}|\{'OriginalFileName':\
    'RUNDLL32\.EXE'\})
- name: '[Sigma] Potential ShellDispatch.DLL Functionality Abuse'
  tag: attack.execution,attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)RunDll_ShellExecuteW
- name: '[Sigma] RunDLL32 Spawning Explorer'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\rundll32\.exe$
- name: '[Sigma] RunDLL32 Spawning Explorer'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\explorer\.exe$
- name: '[Sigma] RunDLL32 Spawning Explorer'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\shell32\.dll,Control_RunDLL
- name: '[Sigma] Potentially Suspicious Rundll32 Activity'
  tag: attack.defense-evasion,attack.t1218.011
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains\|all':\ \['javascript:',\ '\.RegisterXLL'\]\}|\{'CommandLine\|contains\|all':\
    \['url\.dll',\ 'OpenURL'\]\}|\{'CommandLine\|contains\|all':\ \['url\.dll',\ 'OpenURLA'\]\}|\{'CommandLine\|contains\|all':\
    \['url\.dll',\ 'FileProtocolHandler'\]\}|\{'CommandLine\|contains\|all':\ \['zipfldr\.dll',\
    'RouteTheCall'\]\}|\{'CommandLine\|contains\|all':\ \['shell32\.dll',\ 'Control_RunDLL'\]\}|\{'CommandLine\|contains\|all':\
    \['shell32\.dll',\ 'ShellExec_RunDLL'\]\}|\{'CommandLine\|contains\|all':\ \['mshtml\.dll',\
    'PrintHTML'\]\}|\{'CommandLine\|contains\|all':\ \['advpack\.dll',\ 'LaunchINFSection'\]\}|\{'CommandLine\|contains\|all':\
    \['advpack\.dll',\ 'RegisterOCX'\]\}|\{'CommandLine\|contains\|all':\ \['ieadvpack\.dll',\
    'LaunchINFSection'\]\}|\{'CommandLine\|contains\|all':\ \['ieadvpack\.dll',\ 'RegisterOCX'\]\}|\{'CommandLine\|contains\|all':\
    \['ieframe\.dll',\ 'OpenURL'\]\}|\{'CommandLine\|contains\|all':\ \['shdocvw\.dll',\
    'OpenURL'\]\}|\{'CommandLine\|contains\|all':\ \['syssetup\.dll',\ 'SetupInfObjectInstallAction'\]\}|\{'CommandLine\|contains\|all':\
    \['setupapi\.dll',\ 'InstallHinfSection'\]\}|\{'CommandLine\|contains\|all':\
    \['pcwutl\.dll',\ 'LaunchApplication'\]\}|\{'CommandLine\|contains\|all':\ \['dfshim\.dll',\
    'ShOpenVerbApplication'\]\}|\{'CommandLine\|contains\|all':\ \['dfshim\.dll',\
    'ShOpenVerbShortcut'\]\}|\{'CommandLine\|contains\|all':\ \['scrobj\.dll',\ 'GenerateTypeLib',\
    'http'\]\}|\{'CommandLine\|contains\|all':\ \['shimgvw\.dll',\ 'ImageView_Fullscreen',\
    'http'\]\}|\{'CommandLine\|contains\|all':\ \['comsvcs\.dll',\ 'MiniDump'\]\})
- name: '[Sigma] Potentially Suspicious Rundll32 Activity'
  tag: attack.defense-evasion,attack.t1218.011
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)shell32\.dll,Control_RunDLL\ desk\.cpl,screensaver,@screensaver
- name: '[Sigma] Potentially Suspicious Rundll32 Activity'
  tag: attack.defense-evasion,attack.t1218.011
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\control\.exe
- name: '[Sigma] Potentially Suspicious Rundll32 Activity'
  tag: attack.defense-evasion,attack.t1218.011
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\.cpl
- name: '[Sigma] Potentially Suspicious Rundll32 Activity'
  tag: attack.defense-evasion,attack.t1218.011
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Shell32\.dll|Control_RunDLL|\.cpl)
- name: '[Sigma] Potentially Suspicious Rundll32 Activity'
  tag: attack.defense-evasion,attack.t1218.011
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\control\.exe
- name: '[Sigma] Potentially Suspicious Rundll32 Activity'
  tag: attack.defense-evasion,attack.t1218.011
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^"C:\\Windows\\system32\\rundll32\.exe"\ Shell32\.dll,Control_RunDLL\ "C:\\Windows\\System32\\
- name: '[Sigma] Potentially Suspicious Rundll32 Activity'
  tag: attack.defense-evasion,attack.t1218.011
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\.cpl",$
- name: '[Sigma] Suspicious Control Panel DLL Load'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\System32\\control\.exe$
- name: '[Sigma] Suspicious Control Panel DLL Load'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\rundll32\.exe'\}|\{'OriginalFileName':\
    'RUNDLL32\.EXE'\})
- name: '[Sigma] Suspicious Control Panel DLL Load'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)Shell32\.dll
- name: '[Sigma] Suspicious Rundll32 Execution With Image Extension'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\rundll32\.exe'\}|\{'OriginalFileName':\
    'RUNDLL32\.exe'\})
- name: '[Sigma] Suspicious Rundll32 Execution With Image Extension'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.bmp|\.cr2|\.eps|\.gif|\.ico|\.jpeg|\.jpg|\.nef|\.orf|\.png|\.raw|\.sr2|\.tif|\.tiff)
- name: '[Sigma] Suspicious Usage Of ShellExec_RunDLL'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)ShellExec_RunDLL
- name: '[Sigma] Suspicious Usage Of ShellExec_RunDLL'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\Desktop\\|\\Temp\\|\\Users\\Public\\|comspec|iex|Invoke\-|msiexec|odbcconf|regsvr32)
- name: '[Sigma] Suspicious ShellExec_RunDLL Call Via Ordinal'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)SHELL32\.DLL
- name: '[Sigma] Suspicious ShellExec_RunDLL Call Via Ordinal'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\#568|\#570|\#572|\#576)
- name: '[Sigma] Suspicious ShellExec_RunDLL Call Via Ordinal'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'ParentCommandLine\|contains':\ \['comspec',\ 'iex',\ 'Invoke\-',\
    'msiexec',\ 'odbcconf',\ 'regsvr32'\]\}|\{'ParentCommandLine\|contains':\ \['\\\\Desktop\\\\',\
    '\\\\ProgramData\\\\',\ '\\\\Temp\\\\',\ '\\\\Users\\\\Public\\\\'\]\})
- name: '[Sigma] Suspicious ShellExec_RunDLL Call Via Ordinal'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\bash\.exe|\\bitsadmin\.exe|\\cmd\.exe|\\cscript\.exe|\\curl\.exe|\\mshta\.exe|\\msiexec\.exe|\\msxsl\.exe|\\odbcconf\.exe|\\powershell\.exe|\\pwsh\.exe|\\regsvr32\.exe|\\schtasks\.exe|\\wmic\.exe|\\wscript\.exe)$
- name: '[Sigma] ShimCache Flush'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(rundll32|apphelp\.dll)
- name: '[Sigma] ShimCache Flush'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(ShimFlushCache|\#250)
- name: '[Sigma] ShimCache Flush'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(rundll32|kernel32\.dll)
- name: '[Sigma] ShimCache Flush'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(BaseFlushAppcompatCache|\#46)
- name: '[Sigma] Suspicious Rundll32 Activity Invoking Sys File'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)rundll32\.exe
- name: '[Sigma] Suspicious Rundll32 Activity Invoking Sys File'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.sys,|\.sys\ )
- name: '[Sigma] Potentially Suspicious Rundll32.EXE Execution of UDL File'
  tag: attack.defense-evasion,attack.execution,attack.command-and-control,attack.t1218.011,attack.t1071
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\explorer\.exe$
- name: '[Sigma] Potentially Suspicious Rundll32.EXE Execution of UDL File'
  tag: attack.defense-evasion,attack.execution,attack.command-and-control,attack.t1218.011,attack.t1071
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\rundll32\.exe'\}|\{'OriginalFileName':\
    'RUNDLL32\.EXE'\})
- name: '[Sigma] Potentially Suspicious Rundll32.EXE Execution of UDL File'
  tag: attack.defense-evasion,attack.execution,attack.command-and-control,attack.t1218.011,attack.t1071
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(oledb32\.dll|,OpenDSLFile\ |\\\\Users\\\\.*\\\\Downloads\\\\)
- name: '[Sigma] Potentially Suspicious Rundll32.EXE Execution of UDL File'
  tag: attack.defense-evasion,attack.execution,attack.command-and-control,attack.t1218.011,attack.t1071
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\.udl$
- name: '[Sigma] Rundll32 Execution With Uncommon DLL Extension'
  tag: attack.defense-evasion,attack.t1218.011
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\rundll32\.exe'\}|\{'OriginalFileName':\
    'RUNDLL32\.EXE'\})
- name: '[Sigma] Rundll32 Execution With Uncommon DLL Extension'
  tag: attack.defense-evasion,attack.t1218.011
  score: 50
  target: Target_Path
  condition: regex
  pattern: None
- name: '[Sigma] Rundll32 Execution With Uncommon DLL Extension'
  tag: attack.defense-evasion,attack.t1218.011
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)
- name: '[Sigma] Rundll32 Execution With Uncommon DLL Extension'
  tag: attack.defense-evasion,attack.t1218.011
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains':\ \['\.cpl\ ',\ '\.cpl,',\ '\.cpl"',\ "\.cpl'",\
    '\.dll\ ',\ '\.dll,',\ '\.dll"',\ "\.dll'",\ '\.inf\ ',\ '\.inf,',\ '\.inf"',\
    "\.inf'"\]\}|\{'CommandLine\|endswith':\ \['\.cpl',\ '\.dll',\ '\.inf'\]\})
- name: '[Sigma] Rundll32 Execution With Uncommon DLL Extension'
  tag: attack.defense-evasion,attack.t1218.011
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-localserver\ '
- name: '[Sigma] Rundll32 Execution With Uncommon DLL Extension'
  tag: attack.defense-evasion,attack.t1218.011
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\msiexec\.exe$
- name: '[Sigma] Rundll32 Execution With Uncommon DLL Extension'
  tag: attack.defense-evasion,attack.t1218.011
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Windows\\Installer\\|\.tmp|zzzzInvokeManagedCustomActionOutOfProc)
- name: '[Sigma] Rundll32 Execution With Uncommon DLL Extension'
  tag: attack.defense-evasion,attack.t1218.011
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(:\\Users\\|\\AppData\\Local\\Microsoft\\EdgeUpdate\\Install\\\{|\\EDGEMITMP_|\.tmp\\setup\.exe|\-\-install\-archive=|\-\-previous\-version=|\-\-msedgewebview\
    \-\-verbose\-logging\ \-\-do\-not\-launch\-msedge\ \-\-user\-level)
- name: '[Sigma] Rundll32 UNC Path Execution'
  tag: attack.defense-evasion,attack.execution,attack.lateral-movement,attack.t1021.002,attack.t1218.011
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\rundll32\.exe'\}|\{'OriginalFileName':\
    'RUNDLL32\.EXE'\}|\{'CommandLine\|contains':\ 'rundll32'\})
- name: '[Sigma] Rundll32 UNC Path Execution'
  tag: attack.defense-evasion,attack.execution,attack.lateral-movement,attack.t1021.002,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\ \\\\\\\\
- name: '[Sigma] Suspicious Workstation Locking via Rundll32'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\rundll32\.exe'\}|\{'OriginalFileName':\
    'RUNDLL32\.EXE'\})
- name: '[Sigma] Suspicious Workstation Locking via Rundll32'
  tag: attack.defense-evasion
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\cmd\.exe$
- name: '[Sigma] Suspicious Workstation Locking via Rundll32'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)user32\.dll,
- name: '[Sigma] Suspicious Workstation Locking via Rundll32'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)LockWorkStation
- name: '[Sigma] WebDav Client Execution Via Rundll32.EXE'
  tag: attack.exfiltration,attack.t1048.003
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\svchost\.exe$
- name: '[Sigma] WebDav Client Execution Via Rundll32.EXE'
  tag: attack.exfiltration,attack.t1048.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\rundll32\.exe'\}|\{'OriginalFileName':\
    'RUNDLL32\.EXE'\})
- name: '[Sigma] WebDav Client Execution Via Rundll32.EXE'
  tag: attack.exfiltration,attack.t1048.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\windows\\system32\\davclnt\.dll,DavSetCookie
- name: '[Sigma] Suspicious WebDav Client Execution Via Rundll32.EXE'
  tag: attack.exfiltration,attack.t1048.003,cve.2023-23397
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\svchost\.exe$
- name: '[Sigma] Suspicious WebDav Client Execution Via Rundll32.EXE'
  tag: attack.exfiltration,attack.t1048.003,cve.2023-23397
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\-s\ WebClient
- name: '[Sigma] Suspicious WebDav Client Execution Via Rundll32.EXE'
  tag: attack.exfiltration,attack.t1048.003,cve.2023-23397
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\rundll32\.exe$
- name: '[Sigma] Suspicious WebDav Client Execution Via Rundll32.EXE'
  tag: attack.exfiltration,attack.t1048.003,cve.2023-23397
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\windows\\system32\\davclnt\.dll,DavSetCookie
- name: '[Sigma] Suspicious WebDav Client Execution Via Rundll32.EXE'
  tag: attack.exfiltration,attack.t1048.003,cve.2023-23397
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)://\\d\{1,3\}\\\.\\d\{1,3\}\\\.\\d\{1,3\}\\\.\\d\{1,3\}
- name: '[Sigma] Suspicious WebDav Client Execution Via Rundll32.EXE'
  tag: attack.exfiltration,attack.t1048.003,cve.2023-23397
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(://10\.|://192\.168\.|://172\.16\.|://172\.17\.|://172\.18\.|://172\.19\.|://172\.20\.|://172\.21\.|://172\.22\.|://172\.23\.|://172\.24\.|://172\.25\.|://172\.26\.|://172\.27\.|://172\.28\.|://172\.29\.|://172\.30\.|://172\.31\.|://127\.|://169\.254\.)
- name: '[Sigma] Rundll32 Execution Without Parameters'
  tag: attack.lateral-movement,attack.t1021.002,attack.t1570,attack.execution,attack.t1569.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(rundll32\.exe|rundll32)
- name: '[Sigma] Run Once Task Execution as Configured in Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\runonce\.exe'\}|\{'Description':\ 'Run\
    Once\ Wrapper'\})
- name: '[Sigma] Run Once Task Execution as Configured in Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains':\ '/AlternateShellStartup'\}|\{'CommandLine\|endswith':\
    '/r'\})
- name: '[Sigma] Suspicious Schtasks Execution AppData Folder'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\schtasks\.exe$
- name: '[Sigma] Suspicious Schtasks Execution AppData Folder'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(/Create|/RU|/TR|C:\\Users\\|\\AppData\\Local\\)
- name: '[Sigma] Suspicious Schtasks Execution AppData Folder'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(NT\ AUT|\ SYSTEM\ )
- name: '[Sigma] Suspicious Schtasks Execution AppData Folder'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005,attack.t1059.001
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\AppData\\Local\\Temp\\|TeamViewer_\.exe)
- name: '[Sigma] Suspicious Schtasks Execution AppData Folder'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\schtasks\.exe$
- name: '[Sigma] Suspicious Schtasks Execution AppData Folder'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)/TN\ TVInstallRestore
- name: '[Sigma] Suspicious Modification Of Scheduled Tasks'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\schtasks\.exe$
- name: '[Sigma] Suspicious Modification Of Scheduled Tasks'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /Change\ |\ /TN\ )
- name: '[Sigma] Suspicious Modification Of Scheduled Tasks'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\AppData\\Local\\Temp|\\AppData\\Roaming\\|\\Users\\Public\\|\\WINDOWS\\Temp\\|\\Desktop\\|\\Downloads\\|\\Temporary\
    Internet|C:\\ProgramData\\|C:\\Perflogs\\|%ProgramData%|%appdata%|%comspec%|%localappdata%)
- name: '[Sigma] Suspicious Modification Of Scheduled Tasks'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(regsvr32|rundll32|cmd\ /c\ |cmd\ /k\ |cmd\ /r\ |cmd\.exe\ /c\ |cmd\.exe\
    /k\ |cmd\.exe\ /r\ |powershell|mshta|wscript|cscript|certutil|bitsadmin|bash\.exe|bash\
    |scrcons|wmic\ |wmic\.exe|forfiles|scriptrunner|hh\.exe|hh\ )
- name: '[Sigma] Scheduled Task Creation Via Schtasks.EXE'
  tag: attack.execution,attack.persistence,attack.privilege-escalation,attack.t1053.005,attack.s0111,car.2013-08-001,stp.1u
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)\\schtasks\.exe$
- name: '[Sigma] Scheduled Task Creation Via Schtasks.EXE'
  tag: attack.execution,attack.persistence,attack.privilege-escalation,attack.t1053.005,attack.s0111,car.2013-08-001,stp.1u
  score: 20
  target: Target_Path
  condition: regex
  pattern: '(?i)\ /create\ '
- name: '[Sigma] Scheduled Task Creation Via Schtasks.EXE'
  tag: attack.execution,attack.persistence,attack.privilege-escalation,attack.t1053.005,attack.s0111,car.2013-08-001,stp.1u
  score: 20
  target: User
  condition: regex
  pattern: (?i)(AUTHORI|AUTORI)
- name: '[Sigma] Scheduled Task Creation Via Schtasks.EXE'
  tag: attack.execution,attack.persistence,attack.privilege-escalation,attack.t1053.005,attack.s0111,car.2013-08-001,stp.1u
  score: 20
  target: ParentPath
  condition: regex
  pattern: (?i)(C:\\Program\ Files\\Microsoft\ Office\\root\\integration\\integrator\.exe|C:\\Program\
    Files\ \(x86\)\\Microsoft\ Office\\root\\integration\\integrator\.exe)
- name: '[Sigma] Scheduled Task Creation Via Schtasks.EXE'
  tag: attack.execution,attack.persistence,attack.privilege-escalation,attack.t1053.005,attack.s0111,car.2013-08-001,stp.1u
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Windows\\System32\\schtasks\.exe|C:\\Windows\\SysWOW64\\schtasks\.exe)
- name: '[Sigma] Scheduled Task Creation Via Schtasks.EXE'
  tag: attack.execution,attack.persistence,attack.privilege-escalation,attack.t1053.005,attack.s0111,car.2013-08-001,stp.1u
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)Microsoft\\Office\\Office\ Performance\ Monitor
- name: '[Sigma] Suspicious Scheduled Task Creation Involving Temp Folder'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\schtasks\.exe$
- name: '[Sigma] Suspicious Scheduled Task Creation Involving Temp Folder'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /create\ |\ /sc\ once\ |\\Temp\\)
- name: '[Sigma] Delete Important Scheduled Task'
  tag: attack.impact,attack.t1489
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\schtasks\.exe$
- name: '[Sigma] Delete Important Scheduled Task'
  tag: attack.impact,attack.t1489
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(/delete|/tn)
- name: '[Sigma] Delete Important Scheduled Task'
  tag: attack.impact,attack.t1489
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\Windows\\BitLocker|\\Windows\\ExploitGuard|\\Windows\\SystemRestore\\SR|\\Windows\\UpdateOrchestrator\\|\\Windows\\Windows\
    Defender\\|\\Windows\\WindowsBackup\\|\\Windows\\WindowsUpdate\\)
- name: '[Sigma] Delete All Scheduled Tasks'
  tag: attack.impact,attack.t1489
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\schtasks\.exe$
- name: '[Sigma] Delete All Scheduled Tasks'
  tag: attack.impact,attack.t1489
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /delete\ |/tn\ \\.*|\ /f)
- name: '[Sigma] Disable Important Scheduled Task'
  tag: attack.impact,attack.t1489
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\schtasks\.exe$
- name: '[Sigma] Disable Important Scheduled Task'
  tag: attack.impact,attack.t1489
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(/Change|/TN|/disable)
- name: '[Sigma] Disable Important Scheduled Task'
  tag: attack.impact,attack.t1489
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\Windows\\BitLocker|\\Windows\\ExploitGuard|\\Windows\\ExploitGuard\\ExploitGuard\
    MDM\ policy\ Refresh|\\Windows\\SystemRestore\\SR|\\Windows\\UpdateOrchestrator\\|\\Windows\\Windows\
    Defender\\|\\Windows\\WindowsBackup\\|\\Windows\\WindowsUpdate\\)
- name: '[Sigma] Schedule Task Creation From Env Variable Or Potentially Suspicious
    Path Via Schtasks.EXE'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\schtasks\.exe$
- name: '[Sigma] Schedule Task Creation From Env Variable Or Potentially Suspicious
    Path Via Schtasks.EXE'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ /create\ '
- name: '[Sigma] Schedule Task Creation From Env Variable Or Potentially Suspicious
    Path Via Schtasks.EXE'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Perflogs|:\\Users\\All\ Users\\|:\\Users\\Default\\|:\\Users\\Public|:\\Windows\\Temp|\\AppData\\Local\\|\\AppData\\Roaming\\|%AppData%|%Public%)
- name: '[Sigma] Schedule Task Creation From Env Variable Or Potentially Suspicious
    Path Via Schtasks.EXE'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\svchost\.exe\ \-k\ netsvcs\ \-p\ \-s\ Schedule$
- name: '[Sigma] Schedule Task Creation From Env Variable Or Potentially Suspicious
    Path Via Schtasks.EXE'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Perflogs|:\\Windows\\Temp|\\Users\\Public|%Public%)
- name: '[Sigma] Schedule Task Creation From Env Variable Or Potentially Suspicious
    Path Via Schtasks.EXE'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'ParentCommandLine\|contains':\ 'unattended\.ini'\}|\{'CommandLine\|contains':\
    'update_task\.xml'\})
- name: '[Sigma] Schedule Task Creation From Env Variable Or Potentially Suspicious
    Path Via Schtasks.EXE'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)/Create\ /TN\ TVInstallRestore\ /TR
- name: '[Sigma] Schedule Task Creation From Env Variable Or Potentially Suspicious
    Path Via Schtasks.EXE'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/Create\ /Xml\ |\\Temp\\\.CR\.|\\Avira_Security_Installation\.xml)
- name: '[Sigma] Schedule Task Creation From Env Variable Or Potentially Suspicious
    Path Via Schtasks.EXE'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/Create\ /F\ /TN|/Xml\ |\\Temp\\|Avira_)
- name: '[Sigma] Schedule Task Creation From Env Variable Or Potentially Suspicious
    Path Via Schtasks.EXE'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\.tmp\\UpdateFallbackTask\.xml|\.tmp\\WatchdogServiceControlManagerTimeout\.xml|\.tmp\\SystrayAutostart\.xml|\.tmp\\MaintenanceTask\.xml)
- name: '[Sigma] Schedule Task Creation From Env Variable Or Potentially Suspicious
    Path Via Schtasks.EXE'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\Temp\\|/Create\ /TN\ "klcp_update"\ /XML\ |\\klcp_update_task\.xml)
- name: '[Sigma] Schtasks From Suspicious Folders'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\schtasks\.exe'\}|\{'OriginalFileName':\
    'schtasks\.exe'\})
- name: '[Sigma] Schtasks From Suspicious Folders'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ /create\ '
- name: '[Sigma] Schtasks From Suspicious Folders'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(powershell|pwsh|cmd\ /c\ |cmd\ /k\ |cmd\ /r\ |cmd\.exe\ /c\ |cmd\.exe\
    /k\ |cmd\.exe\ /r\ )
- name: '[Sigma] Schtasks From Suspicious Folders'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\ProgramData\\|%ProgramData%)
- name: '[Sigma] Suspicious Scheduled Task Name As GUID'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\schtasks\.exe$
- name: '[Sigma] Suspicious Scheduled Task Name As GUID'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)/Create\ '
- name: '[Sigma] Suspicious Scheduled Task Name As GUID'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/TN\ "\{|/TN\ '\{|/TN\ \{)
- name: '[Sigma] Suspicious Scheduled Task Name As GUID'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\}"|\}'|\}\ )
- name: '[Sigma] Uncommon One Time Only Scheduled Task At 00:00'
  tag: attack.execution,attack.persistence,attack.privilege-escalation,attack.t1053.005
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|contains':\ '\\\\schtasks\.exe'\}|\{'OriginalFileName':\
    'schtasks\.exe'\})
- name: '[Sigma] Uncommon One Time Only Scheduled Task At 00:00'
  tag: attack.execution,attack.persistence,attack.privilege-escalation,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(wscript|vbscript|cscript|wmic\ |wmic\.exe|regsvr32\.exe|powershell|\\AppData\\)
- name: '[Sigma] Uncommon One Time Only Scheduled Task At 00:00'
  tag: attack.execution,attack.persistence,attack.privilege-escalation,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(once|00:00)
- name: '[Sigma] Potential Persistence Via Microsoft Compatibility Appraiser'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\schtasks\.exe'\}|\{'OriginalFileName':\
    'schtasks\.exe'\})
- name: '[Sigma] Potential Persistence Via Microsoft Compatibility Appraiser'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(run\ |\\Application\ Experience\\Microsoft\ Compatibility\ Appraiser)
- name: '[Sigma] Potential Persistence Via Powershell Search Order Hijacking - Task'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005,attack.t1059.001
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\WINDOWS\\System32\\svchost\.exe
- name: '[Sigma] Potential Persistence Via Powershell Search Order Hijacking - Task'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005,attack.t1059.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\-k\ netsvcs|\-s\ Schedule)
- name: '[Sigma] Potential Persistence Via Powershell Search Order Hijacking - Task'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-windowstyle\ hidden|\ \-w\ hidden|\ \-ep\ bypass|\ \-noni)$
- name: '[Sigma] Scheduled Task Executing Payload from Registry'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005,attack.t1059.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\schtasks\.exe'\}|\{'OriginalFileName':\
    'schtasks\.exe'\})
- name: '[Sigma] Scheduled Task Executing Payload from Registry'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)/Create
- name: '[Sigma] Scheduled Task Executing Payload from Registry'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Get\-ItemProperty|\ gp\ )
- name: '[Sigma] Scheduled Task Executing Payload from Registry'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(HKCU:|HKLM:|registry::|HKEY_)
- name: '[Sigma] Scheduled Task Executing Payload from Registry'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(FromBase64String|encodedcommand)
- name: '[Sigma] Scheduled Task Executing Encoded Payload from Registry'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005,attack.t1059.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\schtasks\.exe'\}|\{'OriginalFileName':\
    'schtasks\.exe'\})
- name: '[Sigma] Scheduled Task Executing Encoded Payload from Registry'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)/Create
- name: '[Sigma] Scheduled Task Executing Encoded Payload from Registry'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(FromBase64String|encodedcommand)
- name: '[Sigma] Scheduled Task Executing Encoded Payload from Registry'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Get\-ItemProperty|\ gp\ )
- name: '[Sigma] Scheduled Task Executing Encoded Payload from Registry'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(HKCU:|HKLM:|registry::|HKEY_)
- name: '[Sigma] Suspicious Schtasks Schedule Types'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\schtasks\.exe'\}|\{'OriginalFileName':\
    'schtasks\.exe'\})
- name: '[Sigma] Suspicious Schtasks Schedule Types'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ ONLOGON\ |\ ONSTART\ |\ ONCE\ |\ ONIDLE\ )
- name: '[Sigma] Suspicious Schtasks Schedule Types'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(NT\ AUT|\ SYSTEM|HIGHEST)
- name: '[Sigma] Suspicious Schtasks Schedule Type With High Privileges'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\schtasks\.exe'\}|\{'OriginalFileName':\
    'schtasks\.exe'\})
- name: '[Sigma] Suspicious Schtasks Schedule Type With High Privileges'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ ONLOGON\ |\ ONSTART\ |\ ONCE\ |\ ONIDLE\ )
- name: '[Sigma] Suspicious Schtasks Schedule Type With High Privileges'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(NT\ AUT|\ SYSTEM|HIGHEST)
- name: '[Sigma] Suspicious Scheduled Task Creation via Masqueraded XML File'
  tag: attack.privilege-escalation,attack.execution,attack.defense-evasion,attack.persistence,attack.t1036.005,attack.t1053.005
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\schtasks\.exe'\}|\{'OriginalFileName':\
    'schtasks\.exe'\})
- name: '[Sigma] Suspicious Scheduled Task Creation via Masqueraded XML File'
  tag: attack.privilege-escalation,attack.execution,attack.defense-evasion,attack.persistence,attack.t1036.005,attack.t1053.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/create|\-create)
- name: '[Sigma] Suspicious Scheduled Task Creation via Masqueraded XML File'
  tag: attack.privilege-escalation,attack.execution,attack.defense-evasion,attack.persistence,attack.t1036.005,attack.t1053.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/xml|\-xml)
- name: '[Sigma] Suspicious Scheduled Task Creation via Masqueraded XML File'
  tag: attack.privilege-escalation,attack.execution,attack.defense-evasion,attack.persistence,attack.t1036.005,attack.t1053.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\.xml
- name: '[Sigma] Suspicious Scheduled Task Creation via Masqueraded XML File'
  tag: attack.privilege-escalation,attack.execution,attack.defense-evasion,attack.persistence,attack.t1036.005,attack.t1053.005
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(System|S\-1\-16\-16384)
- name: '[Sigma] Suspicious Scheduled Task Creation via Masqueraded XML File'
  tag: attack.privilege-escalation,attack.execution,attack.defense-evasion,attack.persistence,attack.t1036.005,attack.t1053.005
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\rundll32\.exe$
- name: '[Sigma] Suspicious Scheduled Task Creation via Masqueraded XML File'
  tag: attack.privilege-escalation,attack.execution,attack.defense-evasion,attack.persistence,attack.t1036.005,attack.t1053.005
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(:\\WINDOWS\\Installer\\MSI|\.tmp,zzzzInvokeManagedCustomActionOutOfProc)
- name: '[Sigma] Suspicious Scheduled Task Creation via Masqueraded XML File'
  tag: attack.privilege-escalation,attack.execution,attack.defense-evasion,attack.persistence,attack.t1036.005,attack.t1053.005
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(:\\ProgramData\\OEM\\UpgradeTool\\CareCenter_.*\\BUnzip\\Setup_msi\.exe|:\\Program\
    Files\\Axis\ Communications\\AXIS\ Camera\ Station\\SetupActions\.exe|:\\Program\
    Files\\Axis\ Communications\\AXIS\ Device\ Manager\\AdmSetupActions\.exe|:\\Program\
    Files\ \(x86\)\\Zemana\\AntiMalware\\AntiMalware\.exe|:\\Program\ Files\\Dell\\SupportAssist\\pcdrcui\.exe)$
- name: '[Sigma] Suspicious Command Patterns In Scheduled Task Creation'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\schtasks\.exe$
- name: '[Sigma] Suspicious Command Patterns In Scheduled Task Creation'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)/Create\ '
- name: '[Sigma] Suspicious Command Patterns In Scheduled Task Creation'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(/sc\ minute\ |/ru\ system\ )
- name: '[Sigma] Suspicious Command Patterns In Scheduled Task Creation'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(cmd\ /c|cmd\ /k|cmd\ /r|cmd\.exe\ /c\ |cmd\.exe\ /k\ |cmd\.exe\ /r\
    )
- name: '[Sigma] Suspicious Command Patterns In Scheduled Task Creation'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-decode\ |\ \-enc\ |\ \-w\ hidden\ |\ bypass\ |\ IEX|\.DownloadData|\.DownloadFile|\.DownloadString|/c\
    start\ /min\ |FromBase64String|mshta\ http|mshta\.exe\ http)
- name: '[Sigma] Suspicious Command Patterns In Scheduled Task Creation'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\ProgramData\\|:\\Temp\\|:\\Tmp\\|:\\Users\\Public\\|:\\Windows\\Temp\\|\\AppData\\|%AppData%|%Temp%|%tmp%)
- name: '[Sigma] Suspicious Command Patterns In Scheduled Task Creation'
  tag: attack.privilege-escalation,attack.persistence,attack.execution,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(cscript|curl|wscript)
- name: '[Sigma] Schtasks Creation Or Modification With SYSTEM Privileges'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\schtasks\.exe$
- name: '[Sigma] Schtasks Creation Or Modification With SYSTEM Privileges'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /change\ |\ /create\ )
- name: '[Sigma] Schtasks Creation Or Modification With SYSTEM Privileges'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)/ru\ '
- name: '[Sigma] Schtasks Creation Or Modification With SYSTEM Privileges'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(NT\ AUT|\ SYSTEM\ )
- name: '[Sigma] Schtasks Creation Or Modification With SYSTEM Privileges'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\schtasks\.exe$
- name: '[Sigma] Schtasks Creation Or Modification With SYSTEM Privileges'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(/TN\ TVInstallRestore|\\TeamViewer_\.exe)
- name: '[Sigma] Schtasks Creation Or Modification With SYSTEM Privileges'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Subscription\ Heartbeat|\\HeartbeatConfig\.xml|\\Microsoft\ Shared\\OFFICE)
- name: '[Sigma] Schtasks Creation Or Modification With SYSTEM Privileges'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(/Create\ /F\ /RU\ System\ /SC\ WEEKLY\ /TN\ AviraSystemSpeedupVerify\
    /TR\ |:\\Program\ Files\ \(x86\)\\Avira\\System\ Speedup\\setup\\avira_speedup_setup\.exe|/VERIFY\
    /VERYSILENT\ /NOSTART\ /NODOTNET\ /NORESTART"\ /RL\ HIGHEST)
- name: '[Sigma] Script Event Consumer Spawning Process'
  tag: attack.execution,attack.t1047
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\scrcons\.exe$
- name: '[Sigma] Script Event Consumer Spawning Process'
  tag: attack.execution,attack.t1047
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\svchost\.exe|\\dllhost\.exe|\\powershell\.exe|\\pwsh\.exe|\\wscript\.exe|\\cscript\.exe|\\schtasks\.exe|\\regsvr32\.exe|\\mshta\.exe|\\rundll32\.exe|\\msiexec\.exe|\\msbuild\.exe)$
- name: '[Sigma] Possible Privilege Escalation via Weak Service Permissions'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1574.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\sc\.exe$
- name: '[Sigma] Possible Privilege Escalation via Weak Service Permissions'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1574.011
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(Medium|S\-1\-16\-8192)
- name: '[Sigma] Possible Privilege Escalation via Weak Service Permissions'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1574.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(config|binPath)
- name: '[Sigma] Possible Privilege Escalation via Weak Service Permissions'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1574.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(failure|command)
- name: '[Sigma] New Service Creation Using Sc.EXE'
  tag: attack.persistence,attack.privilege-escalation,attack.t1543.003
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)\\sc\.exe$
- name: '[Sigma] New Service Creation Using Sc.EXE'
  tag: attack.persistence,attack.privilege-escalation,attack.t1543.003
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(create|binPath)
- name: '[Sigma] New Service Creation Using Sc.EXE'
  tag: attack.persistence,attack.privilege-escalation,attack.t1543.003
  score: 20
  target: ParentPath
  condition: regex
  pattern: ^(C:\\Program\ Files\ \(x86\)\\Dropbox\\Client\\|C:\\Program\ Files\\Dropbox\\Client\\)
- name: '[Sigma] New Service Creation Using Sc.EXE'
  tag: attack.persistence,attack.privilege-escalation,attack.t1543.003
  score: 20
  target: ParentPath
  condition: regex
  pattern: (?i)\\Dropbox\.exe$
- name: '[Sigma] Service StartupType Change Via Sc.EXE'
  tag: attack.execution,attack.defense-evasion,attack.t1562.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\sc\.exe'\}|\{'OriginalFileName':\ 'sc\.exe'\})
- name: '[Sigma] Service StartupType Change Via Sc.EXE'
  tag: attack.execution,attack.defense-evasion,attack.t1562.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ config\ |start)
- name: '[Sigma] Service StartupType Change Via Sc.EXE'
  tag: attack.execution,attack.defense-evasion,attack.t1562.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(disabled|demand)
- name: '[Sigma] New Kernel Driver Via SC.EXE'
  tag: attack.persistence,attack.privilege-escalation,attack.t1543.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\sc\.exe$
- name: '[Sigma] New Kernel Driver Via SC.EXE'
  tag: attack.persistence,attack.privilege-escalation,attack.t1543.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(create|config)
- name: '[Sigma] New Kernel Driver Via SC.EXE'
  tag: attack.persistence,attack.privilege-escalation,attack.t1543.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(binPath|type|kernel)
- name: '[Sigma] New Kernel Driver Via SC.EXE'
  tag: attack.persistence,attack.privilege-escalation,attack.t1543.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains\|all':\ \['create\ netprotection_network_filter',\
    'type=\ kernel\ start=\ ',\ 'binPath=\ System32\\\\drivers\\\\netprotection_network_filter',\
    'DisplayName=\ netprotection_network_filter',\ 'group=\ PNP_TDI\ tag=\ yes'\]\}|\{'CommandLine\|contains\|all':\
    \['create\ avelam\ binpath=C:\\\\Windows\\\\system32\\\\drivers\\\\avelam\.sys',\
    'type=kernel\ start=boot\ error=critical\ group=Early\-Launch'\]\})
- name: '[Sigma] Interesting Service Enumeration Via Sc.EXE'
  tag: attack.t1003,attack.credential-access
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\sc\.exe'\}|\{'OriginalFileName':\ 'sc\.exe'\})
- name: '[Sigma] Interesting Service Enumeration Via Sc.EXE'
  tag: attack.t1003,attack.credential-access
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)query
- name: '[Sigma] Interesting Service Enumeration Via Sc.EXE'
  tag: attack.t1003,attack.credential-access
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)termservice
- name: '[Sigma] Allow Service Access Using Security Descriptor Tampering Via Sc.EXE'
  tag: attack.privilege-escalation,attack.persistence,attack.t1543.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\sc\.exe'\}|\{'OriginalFileName':\ 'sc\.exe'\})
- name: '[Sigma] Allow Service Access Using Security Descriptor Tampering Via Sc.EXE'
  tag: attack.privilege-escalation,attack.persistence,attack.t1543.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(sdset|A;)
- name: '[Sigma] Allow Service Access Using Security Descriptor Tampering Via Sc.EXE'
  tag: attack.privilege-escalation,attack.persistence,attack.t1543.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(;IU|;SU|;BA|;SY|;WD)
- name: '[Sigma] Allow Service Access Using Security Descriptor Tampering Via Sc.EXE'
  tag: attack.privilege-escalation,attack.persistence,attack.t1543.003
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Hexnode\\Hexnode\ Agent\\Current\\HexnodeAgent\.exe
- name: '[Sigma] Deny Service Access Using Security Descriptor Tampering Via Sc.EXE'
  tag: attack.privilege-escalation,attack.persistence,attack.t1543.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\sc\.exe'\}|\{'OriginalFileName':\ 'sc\.exe'\})
- name: '[Sigma] Deny Service Access Using Security Descriptor Tampering Via Sc.EXE'
  tag: attack.privilege-escalation,attack.persistence,attack.t1543.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(sdset|D;)
- name: '[Sigma] Deny Service Access Using Security Descriptor Tampering Via Sc.EXE'
  tag: attack.privilege-escalation,attack.persistence,attack.t1543.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(;IU|;SU|;BA|;SY|;WD)
- name: '[Sigma] Service DACL Abuse To Hide Services Via Sc.EXE'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1574.011
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\sc\.exe'\}|\{'OriginalFileName':\ 'sc\.exe'\})
- name: '[Sigma] Service DACL Abuse To Hide Services Via Sc.EXE'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1574.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(sdset|DCLCWPDTSD)
- name: '[Sigma] Service Security Descriptor Tampering Via Sc.EXE'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1574.011
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\sc\.exe'\}|\{'OriginalFileName':\ 'sc\.exe'\})
- name: '[Sigma] Service Security Descriptor Tampering Via Sc.EXE'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1574.011
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)sdset
- name: '[Sigma] Suspicious Service Path Modification'
  tag: attack.persistence,attack.privilege-escalation,attack.t1543.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\sc\.exe$
- name: '[Sigma] Suspicious Service Path Modification'
  tag: attack.persistence,attack.privilege-escalation,attack.t1543.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(config|binPath)
- name: '[Sigma] Suspicious Service Path Modification'
  tag: attack.persistence,attack.privilege-escalation,attack.t1543.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(powershell|cmd\ |mshta|wscript|cscript|rundll32|svchost|dllhost|cmd\.exe\
    /c|cmd\.exe\ /k|cmd\.exe\ /r|cmd\ /c|cmd\ /k|cmd\ /r|C:\\Users\\Public|\\Downloads\\|\\Desktop\\|\\Microsoft\\Windows\\Start\
    Menu\\Programs\\Startup\\|C:\\Windows\\TEMP\\|\\AppData\\Local\\Temp)
- name: '[Sigma] Potential Persistence Attempt Via Existing Service Tampering'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.persistence,attack.t1543.003,attack.t1574.011
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains\|all':\ \['sc\ ',\ 'config\ ',\ 'binpath='\]\}|\{'CommandLine\|contains\|all':\
    \['sc\ ',\ 'failure',\ 'command='\]\})
- name: '[Sigma] Potential Persistence Attempt Via Existing Service Tampering'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.persistence,attack.t1543.003,attack.t1574.011
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains\|all':\ \['reg\ ',\ 'add\ ',\ 'FailureCommand'\]\}|\{'CommandLine\|contains\|all':\
    \['reg\ ',\ 'add\ ',\ 'ImagePath'\]\})
- name: '[Sigma] Potential Persistence Attempt Via Existing Service Tampering'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.persistence,attack.t1543.003,attack.t1574.011
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\.sh|\.exe|\.dll|\.bin\$|\.bat|\.cmd|\.js|\.msh\$|\.reg\$|\.scr|\.ps|\.vb|\.jar|\.pl)
- name: '[Sigma] Stop Windows Service Via Sc.EXE'
  tag: attack.impact,attack.t1489
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'sc\.exe'\}|\{'Image\|endswith':\ '\\\\sc\.exe'\})
- name: '[Sigma] Stop Windows Service Via Sc.EXE'
  tag: attack.impact,attack.t1489
  score: 20
  target: Target_Path
  condition: regex
  pattern: '(?i)\ stop\ '
- name: '[Sigma] Potential Shim Database Persistence via Sdbinst.EXE'
  tag: attack.persistence,attack.privilege-escalation,attack.t1546.011
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\sdbinst\.exe'\}|\{'OriginalFileName':\
    'sdbinst\.exe'\})
- name: '[Sigma] Potential Shim Database Persistence via Sdbinst.EXE'
  tag: attack.persistence,attack.privilege-escalation,attack.t1546.011
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\.sdb
- name: '[Sigma] Potential Shim Database Persistence via Sdbinst.EXE'
  tag: attack.persistence,attack.privilege-escalation,attack.t1546.011
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\msiexec\.exe$
- name: '[Sigma] Potential Shim Database Persistence via Sdbinst.EXE'
  tag: attack.persistence,attack.privilege-escalation,attack.t1546.011
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Program\ Files\ \(x86\)\\IIS\ Express\\iisexpressshim\.sdb|:\\Program\
    Files\\IIS\ Express\\iisexpressshim\.sdb)
- name: '[Sigma] Uncommon Extension Shim Database Installation Via Sdbinst.EXE'
  tag: attack.persistence,attack.privilege-escalation,attack.t1546.011
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\sdbinst\.exe'\}|\{'OriginalFileName':\
    'sdbinst\.exe'\})
- name: '[Sigma] Uncommon Extension Shim Database Installation Via Sdbinst.EXE'
  tag: attack.persistence,attack.privilege-escalation,attack.t1546.011
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\.sdb
- name: '[Sigma] Uncommon Extension Shim Database Installation Via Sdbinst.EXE'
  tag: attack.persistence,attack.privilege-escalation,attack.t1546.011
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|endswith':\ \['\ \-c',\ '\ \-f',\ '\ \-mm',\ '\ \-t'\]\}|\{'CommandLine\|contains':\
    '\ \-m\ \-bg'\})
- name: '[Sigma] Uncommon Extension Shim Database Installation Via Sdbinst.EXE'
  tag: attack.persistence,attack.privilege-escalation,attack.t1546.011
  score: 50
  target: Target_Path
  condition: regex
  pattern: None
- name: '[Sigma] Uncommon Extension Shim Database Installation Via Sdbinst.EXE'
  tag: attack.persistence,attack.privilege-escalation,attack.t1546.011
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)
- name: '[Sigma] Sdclt Child Processes'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\sdclt\.exe$
- name: '[Sigma] Sdiagnhost Calling Suspicious Child Process'
  tag: attack.defense-evasion,attack.t1036,attack.t1218
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\sdiagnhost\.exe$
- name: '[Sigma] Sdiagnhost Calling Suspicious Child Process'
  tag: attack.defense-evasion,attack.t1036,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\pwsh\.exe|\\cmd\.exe|\\mshta\.exe|\\cscript\.exe|\\wscript\.exe|\\taskkill\.exe|\\regsvr32\.exe|\\rundll32\.exe|\\calc\.exe)$
- name: '[Sigma] Sdiagnhost Calling Suspicious Child Process'
  tag: attack.defense-evasion,attack.t1036,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\cmd\.exe$
- name: '[Sigma] Sdiagnhost Calling Suspicious Child Process'
  tag: attack.defense-evasion,attack.t1036,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)bits
- name: '[Sigma] Sdiagnhost Calling Suspicious Child Process'
  tag: attack.defense-evasion,attack.t1036,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\powershell\.exe$
- name: '[Sigma] Sdiagnhost Calling Suspicious Child Process'
  tag: attack.defense-evasion,attack.t1036,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-noprofile\ \-|\-noprofile)$
- name: '[Sigma] Potential Suspicious Activity Using SeCEdit'
  tag: attack.collection,attack.discovery,attack.persistence,attack.defense-evasion,attack.credential-access,attack.privilege-escalation,attack.t1562.002,attack.t1547.001,attack.t1505.005,attack.t1556.002,attack.t1562,attack.t1574.007,attack.t1564.002,attack.t1546.008,attack.t1546.007,attack.t1547.014,attack.t1547.010,attack.t1547.002,attack.t1557,attack.t1082
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\secedit\.exe'\}|\{'OriginalFileName':\
    'SeCEdit'\})
- name: '[Sigma] Potential Suspicious Activity Using SeCEdit'
  tag: attack.collection,attack.discovery,attack.persistence,attack.defense-evasion,attack.credential-access,attack.privilege-escalation,attack.t1562.002,attack.t1547.001,attack.t1505.005,attack.t1556.002,attack.t1562,attack.t1574.007,attack.t1564.002,attack.t1546.008,attack.t1546.007,attack.t1547.014,attack.t1547.010,attack.t1547.002,attack.t1557,attack.t1082
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/export|/cfg)
- name: '[Sigma] Potential Suspicious Activity Using SeCEdit'
  tag: attack.collection,attack.discovery,attack.persistence,attack.defense-evasion,attack.credential-access,attack.privilege-escalation,attack.t1562.002,attack.t1547.001,attack.t1505.005,attack.t1556.002,attack.t1562,attack.t1574.007,attack.t1564.002,attack.t1546.008,attack.t1546.007,attack.t1547.014,attack.t1547.010,attack.t1547.002,attack.t1557,attack.t1082
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/configure|/db)
- name: '[Sigma] Suspicious Serv-U Process Pattern'
  tag: attack.credential-access,attack.t1555,cve.2021-35211
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\Serv\-U\.exe$
- name: '[Sigma] Suspicious Serv-U Process Pattern'
  tag: attack.credential-access,attack.t1555,cve.2021-35211
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\cmd\.exe|\\powershell\.exe|\\pwsh\.exe|\\wscript\.exe|\\cscript\.exe|\\sh\.exe|\\bash\.exe|\\schtasks\.exe|\\regsvr32\.exe|\\wmic\.exe|\\mshta\.exe|\\rundll32\.exe|\\msiexec\.exe|\\forfiles\.exe|\\scriptrunner\.exe)$
- name: '[Sigma] Uncommon Child Process Of Setres.EXE'
  tag: attack.defense-evasion,attack.t1218,attack.t1202
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\setres\.exe$
- name: '[Sigma] Uncommon Child Process Of Setres.EXE'
  tag: attack.defense-evasion,attack.t1218,attack.t1202
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\choice
- name: '[Sigma] Uncommon Child Process Of Setres.EXE'
  tag: attack.defense-evasion,attack.t1218,attack.t1202
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Windows\\System32\\choice\.exe|C:\\Windows\\SysWOW64\\choice\.exe)$
- name: '[Sigma] Potential SPN Enumeration Via Setspn.EXE'
  tag: attack.credential-access,attack.t1558.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\setspn\.exe'\}|\{'OriginalFileName':\ 'setspn\.exe'\}|\{'Description\|contains\|all':\
    \['Query\ or\ reset\ the\ computer',\ 'SPN\ attribute'\]\})
- name: '[Sigma] Potential SPN Enumeration Via Setspn.EXE'
  tag: attack.credential-access,attack.t1558.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-q\ |\ /q\ )
- name: '[Sigma] Setup16.EXE Execution With Custom .Lst File'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574.005
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Windows\\SysWOW64\\setup16\.exe
- name: '[Sigma] Setup16.EXE Execution With Custom .Lst File'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574.005
  score: 50
  target: Full_Path
  condition: regex
  pattern: '(?i)\ \-m\ '
- name: '[Sigma] Setup16.EXE Execution With Custom .Lst File'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^C:\\\~MSSETUP\.T\\
- name: '[Sigma] Suspicious Execution of Shutdown'
  tag: attack.impact,attack.t1529
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\shutdown\.exe$
- name: '[Sigma] Suspicious Execution of Shutdown'
  tag: attack.impact,attack.t1529
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/r\ |/s\ )
- name: '[Sigma] Suspicious Execution of Shutdown to Log Out'
  tag: attack.impact,attack.t1529
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\shutdown\.exe$
- name: '[Sigma] Suspicious Execution of Shutdown to Log Out'
  tag: attack.impact,attack.t1529
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)/l
- name: '[Sigma] Uncommon Sigverif.EXE Child Process'
  tag: attack.defense-evasion,attack.t1216
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\sigverif\.exe$
- name: '[Sigma] Uncommon Sigverif.EXE Child Process'
  tag: attack.defense-evasion,attack.t1216
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Windows\\System32\\WerFault\.exe|C:\\Windows\\SysWOW64\\WerFault\.exe)
- name: '[Sigma] Uncommon Child Processes Of SndVol.exe'
  tag: attack.execution
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\SndVol\.exe$
- name: '[Sigma] Uncommon Child Processes Of SndVol.exe'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\rundll32\.exe$
- name: '[Sigma] Uncommon Child Processes Of SndVol.exe'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ shell32\.dll,Control_RunDLL\ '
- name: '[Sigma] Audio Capture via SoundRecorder'
  tag: attack.collection,attack.t1123
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\SoundRecorder\.exe$
- name: '[Sigma] Audio Capture via SoundRecorder'
  tag: attack.collection,attack.t1123
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)/FILE
- name: '[Sigma] Suspicious Splwow64 Without Params'
  tag: attack.defense-evasion,attack.t1202
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\splwow64\.exe$
- name: '[Sigma] Suspicious Splwow64 Without Params'
  tag: attack.defense-evasion,attack.t1202
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)splwow64\.exe$
- name: '[Sigma] Suspicious Spool Service Child Process'
  tag: attack.execution,attack.t1203,attack.privilege-escalation,attack.t1068
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\spoolsv\.exe$
- name: '[Sigma] Suspicious Spool Service Child Process'
  tag: attack.execution,attack.t1203,attack.privilege-escalation,attack.t1068
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(System|S\-1\-16\-16384)
- name: '[Sigma] Suspicious Spool Service Child Process'
  tag: attack.execution,attack.t1203,attack.privilege-escalation,attack.t1068
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\gpupdate\.exe|\\whoami\.exe|\\nltest\.exe|\\taskkill\.exe|\\wmic\.exe|\\taskmgr\.exe|\\sc\.exe|\\findstr\.exe|\\curl\.exe|\\wget\.exe|\\certutil\.exe|\\bitsadmin\.exe|\\accesschk\.exe|\\wevtutil\.exe|\\bcdedit\.exe|\\fsutil\.exe|\\cipher\.exe|\\schtasks\.exe|\\write\.exe|\\wuauclt\.exe|\\systeminfo\.exe|\\reg\.exe|\\query\.exe)$
- name: '[Sigma] Suspicious Spool Service Child Process'
  tag: attack.execution,attack.t1203,attack.privilege-escalation,attack.t1068
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\net\.exe|\\net1\.exe)$
- name: '[Sigma] Suspicious Spool Service Child Process'
  tag: attack.execution,attack.t1203,attack.privilege-escalation,attack.t1068
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)start
- name: '[Sigma] Suspicious Spool Service Child Process'
  tag: attack.execution,attack.t1203,attack.privilege-escalation,attack.t1068
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\cmd\.exe$
- name: '[Sigma] Suspicious Spool Service Child Process'
  tag: attack.execution,attack.t1203,attack.privilege-escalation,attack.t1068
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.spl|route\ add|program\ files)
- name: '[Sigma] Suspicious Spool Service Child Process'
  tag: attack.execution,attack.t1203,attack.privilege-escalation,attack.t1068
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\netsh\.exe$
- name: '[Sigma] Suspicious Spool Service Child Process'
  tag: attack.execution,attack.t1203,attack.privilege-escalation,attack.t1068
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(add\ portopening|rule\ name)
- name: '[Sigma] Suspicious Spool Service Child Process'
  tag: attack.execution,attack.t1203,attack.privilege-escalation,attack.t1068
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\pwsh\.exe)$
- name: '[Sigma] Suspicious Spool Service Child Process'
  tag: attack.execution,attack.t1203,attack.privilege-escalation,attack.t1068
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\.spl
- name: '[Sigma] Suspicious Spool Service Child Process'
  tag: attack.execution,attack.t1203,attack.privilege-escalation,attack.t1068
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\rundll32\.exe'\}|\{'OriginalFileName':\
    'RUNDLL32\.EXE'\})
- name: '[Sigma] Suspicious Spool Service Child Process'
  tag: attack.execution,attack.t1203,attack.privilege-escalation,attack.t1068
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)rundll32\.exe$
- name: '[Sigma] Veeam Backup Database Suspicious Query'
  tag: attack.collection,attack.t1005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\sqlcmd\.exe$
- name: '[Sigma] Veeam Backup Database Suspicious Query'
  tag: attack.collection,attack.t1005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(VeeamBackup|From\ )
- name: '[Sigma] Veeam Backup Database Suspicious Query'
  tag: attack.collection,attack.t1005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(BackupRepositories|Backups|Credentials|HostCreds|SmbFileShares|Ssh_creds|VSphereInfo)
- name: '[Sigma] VeeamBackup Database Credentials Dump Via Sqlcmd.EXE'
  tag: attack.collection,attack.t1005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\sqlcmd\.exe$
- name: '[Sigma] VeeamBackup Database Credentials Dump Via Sqlcmd.EXE'
  tag: attack.collection,attack.t1005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(SELECT|TOP|\[VeeamBackup\]\.\[dbo\]\.\[Credentials\])
- name: '[Sigma] SQLite Chromium Profile Data DB Access'
  tag: attack.credential-access,attack.t1539,attack.t1555.003,attack.collection,attack.t1005
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Product':\ 'SQLite'\}|\{'Image\|endswith':\ \['\\\\sqlite\.exe',\
    '\\\\sqlite3\.exe'\]\})
- name: '[Sigma] SQLite Chromium Profile Data DB Access'
  tag: attack.credential-access,attack.t1539,attack.t1555.003,attack.collection,attack.t1005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\User\ Data\\|\\Opera\ Software\\|\\ChromiumViewer\\)
- name: '[Sigma] SQLite Chromium Profile Data DB Access'
  tag: attack.credential-access,attack.t1539,attack.t1555.003,attack.collection,attack.t1005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Login\ Data|Cookies|Web\ Data|History|Bookmarks)
- name: '[Sigma] SQLite Firefox Profile Data DB Access'
  tag: attack.credential-access,attack.t1539,attack.collection,attack.t1005
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Product':\ 'SQLite'\}|\{'Image\|endswith':\ \['\\\\sqlite\.exe',\
    '\\\\sqlite3\.exe'\]\})
- name: '[Sigma] SQLite Firefox Profile Data DB Access'
  tag: attack.credential-access,attack.t1539,attack.collection,attack.t1005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(cookies\.sqlite|places\.sqlite)
- name: '[Sigma] Arbitrary File Download Via Squirrel.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\squirrel\.exe|\\update\.exe)$
- name: '[Sigma] Arbitrary File Download Via Squirrel.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-\-download\ |\ \-\-update\ |\ \-\-updateRollback=)
- name: '[Sigma] Arbitrary File Download Via Squirrel.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)http
- name: '[Sigma] Process Proxy Execution Via Squirrel.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\squirrel\.exe|\\update\.exe)$
- name: '[Sigma] Process Proxy Execution Via Squirrel.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-\-processStart|\-\-processStartAndWait|\-\-createShortcut)
- name: '[Sigma] Process Proxy Execution Via Squirrel.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Users\\|\\AppData\\Local\\Discord\\Update\.exe|Discord\.exe)
- name: '[Sigma] Process Proxy Execution Via Squirrel.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-\-createShortcut|\-\-processStart)
- name: '[Sigma] Process Proxy Execution Via Squirrel.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Users\\|\\AppData\\Local\\GitHubDesktop\\Update\.exe|GitHubDesktop\.exe)
- name: '[Sigma] Process Proxy Execution Via Squirrel.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-\-createShortcut|\-\-processStartAndWait)
- name: '[Sigma] Process Proxy Execution Via Squirrel.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Users\\|\\AppData\\Local\\Microsoft\\Teams\\Update\.exe|Teams\.exe)
- name: '[Sigma] Process Proxy Execution Via Squirrel.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-\-processStart|\-\-createShortcut)
- name: '[Sigma] Process Proxy Execution Via Squirrel.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Users\\|\\AppData\\Local\\yammerdesktop\\Update\.exe|Yammer\.exe)
- name: '[Sigma] Process Proxy Execution Via Squirrel.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-\-processStart|\-\-createShortcut)
- name: '[Sigma] Port Forwarding Activity Via SSH.EXE'
  tag: attack.command-and-control,attack.lateral-movement,attack.t1572,attack.t1021.001,attack.t1021.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\ssh\.exe$
- name: '[Sigma] Port Forwarding Activity Via SSH.EXE'
  tag: attack.command-and-control,attack.lateral-movement,attack.t1572,attack.t1021.001,attack.t1021.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-R\ '
- name: '[Sigma] Program Executed Using Proxy/Local Command Via SSH.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\OpenSSH\\sshd\.exe
- name: '[Sigma] Program Executed Using Proxy/Local Command Via SSH.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\ssh\.exe'\}|\{'Product':\ 'OpenSSH\ for\
    Windows'\}|\{'Hashes\|contains':\ \['IMPHASH=55b4964d29aad5438b9e950052dbbbc0',\
    'IMPHASH=334d66c33503ccbf647c15b47c27eef4',\ 'IMPHASH=27b0da080ef92afb37983d30d839141e',\
    'IMPHASH=977eb4c263d384e47daa0712d34713ab',\ 'IMPHASH=3eaadce9ae43d5a918bb082065815c3b',\
    'IMPHASH=980fe6cf0d996ab1eedf877222e722aa',\ 'IMPHASH=5f959422308ac3d721010d66647e100e',\
    'IMPHASH=a49aaa3d03d1cd9c8dc7fca60f7f480b',\ 'IMPHASH=dd335f759b6d5d6a8382b71dd9d65791'\]\})
- name: '[Sigma] Program Executed Using Proxy/Local Command Via SSH.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains':\ 'ProxyCommand='\}|\{'CommandLine\|contains\|all':\
    \['PermitLocalCommand=yes',\ '\ LocalCommand'\]\})
- name: '[Sigma] Potential RDP Tunneling Via SSH'
  tag: attack.command-and-control,attack.t1572
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\ssh\.exe$
- name: '[Sigma] Potential RDP Tunneling Via SSH'
  tag: attack.command-and-control,attack.t1572
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i):3389
- name: '[Sigma] Potential Amazon SSM Agent Hijacking'
  tag: attack.command-and-control,attack.persistence,attack.t1219.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\amazon\-ssm\-agent\.exe$
- name: '[Sigma] Potential Amazon SSM Agent Hijacking'
  tag: attack.command-and-control,attack.persistence,attack.t1219.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-register\ |\-code\ |\-id\ |\-region\ )
- name: '[Sigma] Execution via stordiag.exe'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\stordiag\.exe$
- name: '[Sigma] Execution via stordiag.exe'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\schtasks\.exe|\\systeminfo\.exe|\\fltmc\.exe)$
- name: '[Sigma] Execution via stordiag.exe'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: ParentPath
  condition: regex
  pattern: ^(c:\\windows\\system32\\|c:\\windows\\syswow64\\)
- name: '[Sigma] Start of NT Virtual DOS Machine'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\ntvdm\.exe|\\csrstub\.exe)$
- name: '[Sigma] Abused Debug Privilege by Arbitrary Parent Processes'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\winlogon\.exe|\\services\.exe|\\lsass\.exe|\\csrss\.exe|\\smss\.exe|\\wininit\.exe|\\spoolsv\.exe|\\searchindexer\.exe)$
- name: '[Sigma] Abused Debug Privilege by Arbitrary Parent Processes'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548
  score: 80
  target: User
  condition: regex
  pattern: (?i)(AUTHORI|AUTORI)
- name: '[Sigma] Abused Debug Privilege by Arbitrary Parent Processes'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe',\
    '\\\\cmd\.exe'\]\}|\{'OriginalFileName':\ \['PowerShell\.EXE',\ 'pwsh\.dll',\
    'Cmd\.Exe'\]\})
- name: '[Sigma] Abused Debug Privilege by Arbitrary Parent Processes'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ route\ |\ ADD\ )
- name: '[Sigma] User Added to Local Administrators Group'
  tag: attack.privilege-escalation,attack.persistence,attack.t1098
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains\|all':\ \['localgroup\ ',\ '\ /add'\]\}|\{'CommandLine\|contains\|all':\
    \['Add\-LocalGroupMember\ ',\ '\ \-Group\ '\]\})
- name: '[Sigma] User Added to Local Administrators Group'
  tag: attack.privilege-escalation,attack.persistence,attack.t1098
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ administrators\ |\ administrateur)
- name: '[Sigma] User Added To Highly Privileged Group'
  tag: attack.privilege-escalation,attack.persistence,attack.t1098
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains\|all':\ \['localgroup\ ',\ '\ /add'\]\}|\{'CommandLine\|contains\|all':\
    \['Add\-LocalGroupMember\ ',\ '\ \-Group\ '\]\})
- name: '[Sigma] User Added To Highly Privileged Group'
  tag: attack.privilege-escalation,attack.persistence,attack.t1098
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Group\ Policy\ Creator\ Owners|Schema\ Admins)
- name: '[Sigma] User Added to Remote Desktop Users Group'
  tag: attack.initial-access,attack.persistence,attack.lateral-movement,attack.t1133,attack.t1136.001,attack.t1021.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains\|all':\ \['localgroup\ ',\ '\ /add'\]\}|\{'CommandLine\|contains\|all':\
    \['Add\-LocalGroupMember\ ',\ '\ \-Group\ '\]\})
- name: '[Sigma] User Added to Remote Desktop Users Group'
  tag: attack.initial-access,attack.persistence,attack.lateral-movement,attack.t1133,attack.t1136.001,attack.t1021.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Remote\ Desktop\ Users|Utilisateurs\ du\ Bureau\ \ distance|Usuarios\
    de\ escritorio\ remoto)
- name: '[Sigma] Execute From Alternate Data Streams'
  tag: attack.defense-evasion,attack.t1564.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)txt:'
- name: '[Sigma] Execute From Alternate Data Streams'
  tag: attack.defense-evasion,attack.t1564.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(type\ |\ >\ )
- name: '[Sigma] Execute From Alternate Data Streams'
  tag: attack.defense-evasion,attack.t1564.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(makecab\ |\.cab)
- name: '[Sigma] Execute From Alternate Data Streams'
  tag: attack.defense-evasion,attack.t1564.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(reg\ |\ export\ )
- name: '[Sigma] Execute From Alternate Data Streams'
  tag: attack.defense-evasion,attack.t1564.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(regedit\ |\ /E\ )
- name: '[Sigma] Execute From Alternate Data Streams'
  tag: attack.defense-evasion,attack.t1564.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(esentutl\ |\ /y\ |\ /d\ |\ /o\ )
- name: '[Sigma] Always Install Elevated Windows Installer'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 50
  target: User
  condition: regex
  pattern: (?i)(AUTHORI|AUTORI)
- name: '[Sigma] Always Install Elevated Windows Installer'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\Windows\\Installer\\|msi)
- name: '[Sigma] Always Install Elevated Windows Installer'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)tmp$
- name: '[Sigma] Always Install Elevated Windows Installer'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\msiexec\.exe$
- name: '[Sigma] Always Install Elevated Windows Installer'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(System|S\-1\-16\-16384)
- name: '[Sigma] Always Install Elevated Windows Installer'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\services\.exe
- name: '[Sigma] Always Install Elevated Windows Installer'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|endswith':\ '\\\\system32\\\\msiexec\.exe\ /V'\}|\{'ParentCommandLine\|endswith':\
    '\\\\system32\\\\msiexec\.exe\ /V'\})
- name: '[Sigma] Always Install Elevated Windows Installer'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 50
  target: ParentPath
  condition: regex
  pattern: ^C:\\ProgramData\\Sophos\\
- name: '[Sigma] Always Install Elevated Windows Installer'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 50
  target: ParentPath
  condition: regex
  pattern: ^C:\\ProgramData\\Avira\\
- name: '[Sigma] Always Install Elevated Windows Installer'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 50
  target: ParentPath
  condition: regex
  pattern: ^(C:\\Program\ Files\\Avast\ Software\\|C:\\Program\ Files\ \(x86\)\\Avast\
    Software\\)
- name: '[Sigma] Always Install Elevated Windows Installer'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 50
  target: ParentPath
  condition: regex
  pattern: ^(C:\\Program\ Files\\Google\\Update\\|C:\\Program\ Files\ \(x86\)\\Google\\Update\\)
- name: '[Sigma] Potentially Suspicious Windows App Activity'
  tag: attack.defense-evasion
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Program\ Files\\WindowsApps\\
- name: '[Sigma] Potentially Suspicious Windows App Activity'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\cmd\.exe|\\cscript\.exe|\\mshta\.exe|\\powershell\.exe|\\powershell_ise\.exe|\\pwsh\.exe|\\regsvr32\.exe|\\rundll32\.exe|\\wscript\.exe)$
- name: '[Sigma] Potentially Suspicious Windows App Activity'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(cmd\ /c|Invoke\-|Base64)
- name: '[Sigma] Potentially Suspicious Windows App Activity'
  tag: attack.defense-evasion
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i):\\Program\ Files\\WindowsApps\\Microsoft\.WindowsTerminal
- name: '[Sigma] Potentially Suspicious Windows App Activity'
  tag: attack.defense-evasion
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\WindowsTerminal\.exe$
- name: '[Sigma] Potentially Suspicious Windows App Activity'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\cmd\.exe|\\pwsh\.exe)$
- name: '[Sigma] Potentially Suspicious Windows App Activity'
  tag: attack.defense-evasion
  score: 50
  target: ParentPath
  condition: regex
  pattern: ^C:\\Program\ Files\\WindowsApps\\Microsoft\.SysinternalsSuite
- name: '[Sigma] Potentially Suspicious Windows App Activity'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\cmd\.exe$
- name: '[Sigma] Arbitrary Shell Command Execution Via Settingcontent-Ms'
  tag: attack.t1204,attack.t1566.001,attack.execution,attack.initial-access
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\.SettingContent\-ms
- name: '[Sigma] Arbitrary Shell Command Execution Via Settingcontent-Ms'
  tag: attack.t1204,attack.t1566.001,attack.execution,attack.initial-access
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)immersivecontrolpanel
- name: '[Sigma] Phishing Pattern ISO in Archive'
  tag: attack.initial-access,attack.t1566
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\Winrar\.exe|\\7zFM\.exe|\\peazip\.exe)$
- name: '[Sigma] Phishing Pattern ISO in Archive'
  tag: attack.initial-access,attack.t1566
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\isoburn\.exe|\\PowerISO\.exe|\\ImgBurn\.exe)$
- name: '[Sigma] Automated Collection Command Prompt'
  tag: attack.collection,attack.t1119,attack.credential-access,attack.t1552.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\.doc|\.docx|\.xls|\.xlsx|\.ppt|\.pptx|\.rtf|\.pdf|\.txt)
- name: '[Sigma] Automated Collection Command Prompt'
  tag: attack.collection,attack.t1119,attack.credential-access,attack.t1552.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(dir\ |\ /b\ |\ /s\ )
- name: '[Sigma] Automated Collection Command Prompt'
  tag: attack.collection,attack.t1119,attack.credential-access,attack.t1552.001
  score: 50
  target: FileName
  condition: regex
  pattern: (?i)FINDSTR\.EXE
- name: '[Sigma] Automated Collection Command Prompt'
  tag: attack.collection,attack.t1119,attack.credential-access,attack.t1552.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /e\ |\ /si\ )
- name: '[Sigma] Bad Opsec Defaults Sacrificial Processes With Improper Arguments'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\WerFault\.exe$
- name: '[Sigma] Bad Opsec Defaults Sacrificial Processes With Improper Arguments'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)WerFault\.exe$
- name: '[Sigma] Bad Opsec Defaults Sacrificial Processes With Improper Arguments'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\rundll32\.exe$
- name: '[Sigma] Bad Opsec Defaults Sacrificial Processes With Improper Arguments'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)rundll32\.exe$
- name: '[Sigma] Bad Opsec Defaults Sacrificial Processes With Improper Arguments'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\regsvcs\.exe$
- name: '[Sigma] Bad Opsec Defaults Sacrificial Processes With Improper Arguments'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)regsvcs\.exe$
- name: '[Sigma] Bad Opsec Defaults Sacrificial Processes With Improper Arguments'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\regasm\.exe$
- name: '[Sigma] Bad Opsec Defaults Sacrificial Processes With Improper Arguments'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)regasm\.exe$
- name: '[Sigma] Bad Opsec Defaults Sacrificial Processes With Improper Arguments'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\regsvr32\.exe$
- name: '[Sigma] Bad Opsec Defaults Sacrificial Processes With Improper Arguments'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)regsvr32\.exe$
- name: '[Sigma] Bad Opsec Defaults Sacrificial Processes With Improper Arguments'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\AppData\\Local\\Microsoft\\EdgeUpdate\\Install\\\{
- name: '[Sigma] Bad Opsec Defaults Sacrificial Processes With Improper Arguments'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\rundll32\.exe$
- name: '[Sigma] Bad Opsec Defaults Sacrificial Processes With Improper Arguments'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)rundll32\.exe$
- name: '[Sigma] Bad Opsec Defaults Sacrificial Processes With Improper Arguments'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\AppData\\Local\\BraveSoftware\\Brave\-Browser\\Application\\|\\AppData\\Local\\Google\\Chrome\\Application\\)
- name: '[Sigma] Bad Opsec Defaults Sacrificial Processes With Improper Arguments'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\Installer\\setup\.exe$
- name: '[Sigma] Bad Opsec Defaults Sacrificial Processes With Improper Arguments'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Full_Path
  condition: regex
  pattern: '(?i)\-\-uninstall\ '
- name: '[Sigma] Bad Opsec Defaults Sacrificial Processes With Improper Arguments'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\rundll32\.exe$
- name: '[Sigma] Bad Opsec Defaults Sacrificial Processes With Improper Arguments'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)rundll32\.exe$
- name: '[Sigma] Potential Suspicious Browser Launch From Document Reader Process'
  tag: attack.execution,attack.t1204.002
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(Acrobat\ Reader|Microsoft\ Office|PDF\ Reader)
- name: '[Sigma] Potential Suspicious Browser Launch From Document Reader Process'
  tag: attack.execution,attack.t1204.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\brave\.exe|\\chrome\.exe|\\firefox\.exe|\\msedge\.exe|\\opera\.exe|\\maxthon\.exe|\\seamonkey\.exe|\\vivaldi\.exe)$
- name: '[Sigma] Potential Suspicious Browser Launch From Document Reader Process'
  tag: attack.execution,attack.t1204.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)http
- name: '[Sigma] Potential Suspicious Browser Launch From Document Reader Process'
  tag: attack.execution,attack.t1204.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)https://go\.microsoft\.com/fwlink/
- name: '[Sigma] Potential Suspicious Browser Launch From Document Reader Process'
  tag: attack.execution,attack.t1204.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(http://ad\.foxitsoftware\.com/adlog\.php.|https://globe\-map\.foxitservice\.com/go\.php.do=redirect)
- name: '[Sigma] Suspicious Child Process Created as System'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1134.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(AUTHORI|AUTORI)
- name: '[Sigma] Suspicious Child Process Created as System'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1134.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\NETWORK\ SERVICE|\\LOCAL\ SERVICE)$
- name: '[Sigma] Suspicious Child Process Created as System'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1134.002
  score: 80
  target: User
  condition: regex
  pattern: (?i)(AUTHORI|AUTORI)
- name: '[Sigma] Suspicious Child Process Created as System'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1134.002
  score: 80
  target: User
  condition: regex
  pattern: (?i)(\\SYSTEM|\\Systme|\\)$
- name: '[Sigma] Suspicious Child Process Created as System'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1134.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(System|S\-1\-16\-16384)
- name: '[Sigma] Suspicious Child Process Created as System'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1134.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\rundll32\.exe$
- name: '[Sigma] Suspicious Child Process Created as System'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1134.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)DavSetCookie
- name: '[Sigma] Potential Commandline Obfuscation Using Escape Characters'
  tag: attack.defense-evasion,attack.t1140
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(h\^t\^t\^p|h"t"t"p)
- name: '[Sigma] Potential CommandLine Obfuscation Using Unicode Characters From Suspicious
    Image'
  tag: attack.defense-evasion,attack.t1027
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\cmd\.exe|\\cscript\.exe|\\powershell\.exe|\\powershell_ise\.exe|\\pwsh\.exe|\\wscript\.exe)$
- name: '[Sigma] Potential CommandLine Obfuscation Using Unicode Characters From Suspicious
    Image'
  tag: attack.defense-evasion,attack.t1027
  score: 80
  target: FileName
  condition: regex
  pattern: (?i)(Cmd\.EXE|cscript\.exe|PowerShell\.EXE|PowerShell_ISE\.EXE|pwsh\.dll|wscript\.exe)
- name: '[Sigma] Potential CommandLine Obfuscation Using Unicode Characters From Suspicious
    Image'
  tag: attack.defense-evasion,attack.t1027
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(|||||||||||)
- name: '[Sigma] Potential Command Line Path Traversal Evasion Attempt'
  tag: attack.defense-evasion,attack.t1036
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\Windows\\
- name: '[Sigma] Potential Command Line Path Traversal Evasion Attempt'
  tag: attack.defense-evasion,attack.t1036
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\\.\.\\Windows\\|\\\.\.\\System32\\|\\\.\.\\\.\.\\)
- name: '[Sigma] Potential Command Line Path Traversal Evasion Attempt'
  tag: attack.defense-evasion,attack.t1036
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\.exe\\\.\.\\
- name: '[Sigma] Potential Command Line Path Traversal Evasion Attempt'
  tag: attack.defense-evasion,attack.t1036
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\Google\\Drive\\googledrivesync\.exe\\\.\.\\
- name: '[Sigma] Potential Command Line Path Traversal Evasion Attempt'
  tag: attack.defense-evasion,attack.t1036
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\Citrix\\Virtual\ Smart\ Card\\Citrix\.Authentication\.VirtualSmartcard\.Launcher\.exe\\\.\.\\
- name: '[Sigma] Potential Browser Data Stealing'
  tag: attack.credential-access,attack.t1555.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains':\ \['copy\-item',\ 'copy\ ',\ 'cpi\ ',\
    '\ cp\ ',\ 'move\ ',\ 'move\-item',\ '\ mi\ ',\ '\ mv\ '\]\}|\{'Image\|endswith':\
    \['\\\\esentutl\.exe',\ '\\\\xcopy\.exe',\ '\\\\robocopy\.exe'\]\}|\{'OriginalFileName':\
    \['esentutl\.exe',\ 'XCOPY\.EXE',\ 'robocopy\.exe'\]\})
- name: '[Sigma] Potential Browser Data Stealing'
  tag: attack.credential-access,attack.t1555.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\Amigo\\User\ Data|\\BraveSoftware\\Brave\-Browser\\User\ Data|\\CentBrowser\\User\
    Data|\\Chromium\\User\ Data|\\CocCoc\\Browser\\User\ Data|\\Comodo\\Dragon\\User\
    Data|\\Elements\ Browser\\User\ Data|\\Epic\ Privacy\ Browser\\User\ Data|\\Google\\Chrome\
    Beta\\User\ Data|\\Google\\Chrome\ SxS\\User\ Data|\\Google\\Chrome\\User\ Data\\|\\Kometa\\User\
    Data|\\Maxthon5\\Users|\\Microsoft\\Edge\\User\ Data|\\Mozilla\\Firefox\\Profiles|\\Nichrome\\User\
    Data|\\Opera\ Software\\Opera\ GX\ Stable\\|\\Opera\ Software\\Opera\ Neon\\User\
    Data|\\Opera\ Software\\Opera\ Stable\\|\\Orbitum\\User\ Data|\\QIP\ Surf\\User\
    Data|\\Sputnik\\User\ Data|\\Torch\\User\ Data|\\uCozMedia\\Uran\\User\ Data|\\Vivaldi\\User\
    Data)
- name: '[Sigma] Copy From Or To Admin Share Or Sysvol Folder'
  tag: attack.lateral-movement,attack.collection,attack.exfiltration,attack.t1039,attack.t1048,attack.t1021.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\\\\\\\.*\\\\.*\$|\\Sysvol\\)
- name: '[Sigma] Copy From Or To Admin Share Or Sysvol Folder'
  tag: attack.lateral-movement,attack.collection,attack.exfiltration,attack.t1039,attack.t1048,attack.t1021.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\robocopy\.exe',\ '\\\\xcopy\.exe'\]\}|\{'OriginalFileName':\
    \['robocopy\.exe',\ 'XCOPY\.EXE'\]\})
- name: '[Sigma] Copy From Or To Admin Share Or Sysvol Folder'
  tag: attack.lateral-movement,attack.collection,attack.exfiltration,attack.t1039,attack.t1048,attack.t1021.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\cmd\.exe'\}|\{'OriginalFileName':\ 'Cmd\.Exe'\})
- name: '[Sigma] Copy From Or To Admin Share Or Sysvol Folder'
  tag: attack.lateral-movement,attack.collection,attack.exfiltration,attack.t1039,attack.t1048,attack.t1021.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)copy
- name: '[Sigma] Copy From Or To Admin Share Or Sysvol Folder'
  tag: attack.lateral-movement,attack.collection,attack.exfiltration,attack.t1039,attack.t1048,attack.t1021.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|contains':\ \['\\\\powershell_ise\.exe',\ '\\\\powershell\.exe',\
    '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\ \['powershell_ise\.exe',\ 'PowerShell\.EXE',\
    'pwsh\.dll'\]\})
- name: '[Sigma] Copy From Or To Admin Share Or Sysvol Folder'
  tag: attack.lateral-movement,attack.collection,attack.exfiltration,attack.t1039,attack.t1048,attack.t1021.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(copy\-item|copy\ |cpi\ |\ cp\ |move\ |\ move\-item|\ mi\ |\ mv\ )
- name: '[Sigma] Suspicious Copy From or To System Directory'
  tag: attack.defense-evasion,attack.t1036.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\cmd\.exe$
- name: '[Sigma] Suspicious Copy From or To System Directory'
  tag: attack.defense-evasion,attack.t1036.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)copy\ '
- name: '[Sigma] Suspicious Copy From or To System Directory'
  tag: attack.defense-evasion,attack.t1036.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\pwsh\.exe)$
- name: '[Sigma] Suspicious Copy From or To System Directory'
  tag: attack.defense-evasion,attack.t1036.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(copy\-item|\ copy\ |cpi\ |\ cp\ )
- name: '[Sigma] Suspicious Copy From or To System Directory'
  tag: attack.defense-evasion,attack.t1036.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\robocopy\.exe',\ '\\\\xcopy\.exe'\]\}|\{'OriginalFileName':\
    \['robocopy\.exe',\ 'XCOPY\.EXE'\]\})
- name: '[Sigma] Suspicious Copy From or To System Directory'
  tag: attack.defense-evasion,attack.t1036.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\s\['"\].C:\\\\Windows\\\\\(System32\|SysWOW64\|WinSxS\)
- name: '[Sigma] Suspicious Copy From or To System Directory'
  tag: attack.defense-evasion,attack.t1036.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\cmd\.exe$
- name: '[Sigma] Suspicious Copy From or To System Directory'
  tag: attack.defense-evasion,attack.t1036.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/c\ copy|\\Temp\\|\\avira_system_speedup\.exe)
- name: '[Sigma] Suspicious Copy From or To System Directory'
  tag: attack.defense-evasion,attack.t1036.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\\Avira\\|C:\\Program\ Files\ \(x86\)\\Avira\\)
- name: '[Sigma] LOL-Binary Copied From System Directory'
  tag: attack.defense-evasion,attack.t1036.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\cmd\.exe$
- name: '[Sigma] LOL-Binary Copied From System Directory'
  tag: attack.defense-evasion,attack.t1036.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)copy\ '
- name: '[Sigma] LOL-Binary Copied From System Directory'
  tag: attack.defense-evasion,attack.t1036.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\pwsh\.exe)$
- name: '[Sigma] LOL-Binary Copied From System Directory'
  tag: attack.defense-evasion,attack.t1036.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(copy\-item|\ copy\ |cpi\ |\ cp\ )
- name: '[Sigma] LOL-Binary Copied From System Directory'
  tag: attack.defense-evasion,attack.t1036.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\robocopy\.exe',\ '\\\\xcopy\.exe'\]\}|\{'OriginalFileName':\
    \['robocopy\.exe',\ 'XCOPY\.EXE'\]\})
- name: '[Sigma] LOL-Binary Copied From System Directory'
  tag: attack.defense-evasion,attack.t1036.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\System32|\\SysWOW64|\\WinSxS)
- name: '[Sigma] LOL-Binary Copied From System Directory'
  tag: attack.defense-evasion,attack.t1036.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\bitsadmin\.exe|\\calc\.exe|\\certutil\.exe|\\cmdl32\.exe|\\cscript\.exe|\\mshta\.exe|\\rundll32\.exe|\\wscript\.exe|\\ie4uinit\.exe)
- name: '[Sigma] Potential Crypto Mining Activity'
  tag: attack.impact,attack.t1496
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-\-cpu\-priority=|\-\-donate\-level=0|\ \-o\ pool\.|\ \-\-nicehash|\
    \-\-algo=rx/0\ |stratum\+tcp://|stratum\+udp://|LS1kb25hdGUtbGV2ZWw9|0tZG9uYXRlLWxldmVsP|tLWRvbmF0ZS1sZXZlbD|c3RyYXR1bSt0Y3A6Ly|N0cmF0dW0rdGNwOi8v|zdHJhdHVtK3RjcDovL|c3RyYXR1bSt1ZHA6Ly|N0cmF0dW0rdWRwOi8v|zdHJhdHVtK3VkcDovL)
- name: '[Sigma] Potential Crypto Mining Activity'
  tag: attack.impact,attack.t1496
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ pool\.c\ |\ pool\.o\ |gcc\ \-)
- name: '[Sigma] Potential Data Exfiltration Activity Via CommandLine Tools'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\powershell_ise\.exe|\\powershell\.exe|\\pwsh\.exe|\\cmd\.exe)$
- name: '[Sigma] Potential Data Exfiltration Activity Via CommandLine Tools'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(curl\ |Invoke\-RestMethod|Invoke\-WebRequest|irm\ |iwr\ |wget\ )
- name: '[Sigma] Potential Data Exfiltration Activity Via CommandLine Tools'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-ur|\ \-me|\ \-b|\ POST\ )
- name: '[Sigma] Potential Data Exfiltration Activity Via CommandLine Tools'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\curl\.exe$
- name: '[Sigma] Potential Data Exfiltration Activity Via CommandLine Tools'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\-\-ur
- name: '[Sigma] Potential Data Exfiltration Activity Via CommandLine Tools'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-d\ |\ \-\-data\ )
- name: '[Sigma] Potential Data Exfiltration Activity Via CommandLine Tools'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\wget\.exe$
- name: '[Sigma] Potential Data Exfiltration Activity Via CommandLine Tools'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-\-post\-data|\-\-post\-file)
- name: '[Sigma] Potential Data Exfiltration Activity Via CommandLine Tools'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|re':\ \['net\\\\s\+view',\ 'sc\\\\s\+query'\]\}|\{'CommandLine\|contains':\
    \['Get\-Content',\ 'GetBytes',\ 'hostname',\ 'ifconfig',\ 'ipconfig',\ 'netstat',\
    'nltest',\ 'qprocess',\ 'systeminfo',\ 'tasklist',\ 'ToBase64String',\ 'whoami'\]\}|\{'CommandLine\|contains\|all':\
    \['type\ ',\ '\ >\ ',\ '\ C:\\\\'\]\})
- name: '[Sigma] Raccine Uninstall'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(taskkill\ |RaccineSettings\.exe)
- name: '[Sigma] Raccine Uninstall'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(reg\.exe|delete|Raccine\ Tray)
- name: '[Sigma] Raccine Uninstall'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(schtasks|/DELETE|Raccine\ Rules\ Updater)
- name: '[Sigma] Suspicious Double Extension File Execution'
  tag: attack.initial-access,attack.t1566.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \ \ \ \ \ \.exe|______\.exe|\.doc\.exe|\.doc\.js|\.docx\.exe|\.docx\.js|\.gif\.exe|\.jpeg\.exe|\.jpg\.exe|\.mkv\.exe|\.mov\.exe|\.mp3\.exe|\.mp4\.exe|\.pdf\.exe|\.pdf\.js|\.png\.exe|\.ppt\.exe|\.ppt\.js|\.pptx\.exe|\.pptx\.js|\.rtf\.exe|\.rtf\.js|\.svg\.exe|\.txt\.exe|\.txt\.js|\.xls\.exe|\.xls\.js|\.xlsx\.exe|\.xlsx\.js|\.exe)$
- name: '[Sigma] Suspicious Double Extension File Execution'
  tag: attack.initial-access,attack.t1566.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \ \ \ \ \ \.exe|______\.exe|\.doc\.exe|\.doc\.js|\.docx\.exe|\.docx\.js|\.gif\.exe|\.jpeg\.exe|\.jpg\.exe|\.mkv\.exe|\.mov\.exe|\.mp3\.exe|\.mp4\.exe|\.pdf\.exe|\.pdf\.js|\.png\.exe|\.ppt\.exe|\.ppt\.js|\.pptx\.exe|\.pptx\.js|\.rtf\.exe|\.rtf\.js|\.svg\.exe|\.txt\.exe|\.txt\.js|\.xls\.exe|\.xls\.js|\.xlsx\.exe|\.xlsx\.js|\.exe)
- name: '[Sigma] Suspicious Parent Double Extension File Execution'
  tag: attack.defense-evasion,attack.t1036.007
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'ParentImage\|endswith':\ \['\.doc\.lnk',\ '\.docx\.lnk',\ '\.xls\.lnk',\
    '\.xlsx\.lnk',\ '\.ppt\.lnk',\ '\.pptx\.lnk',\ '\.rtf\.lnk',\ '\.pdf\.lnk',\ '\.txt\.lnk',\
    '\.doc\.js',\ '\.docx\.js',\ '\.xls\.js',\ '\.xlsx\.js',\ '\.ppt\.js',\ '\.pptx\.js',\
    '\.rtf\.js',\ '\.pdf\.js',\ '\.txt\.js'\]\}|\{'ParentCommandLine\|contains':\
    \['\.doc\.lnk',\ '\.docx\.lnk',\ '\.xls\.lnk',\ '\.xlsx\.lnk',\ '\.ppt\.lnk',\
    '\.pptx\.lnk',\ '\.rtf\.lnk',\ '\.pdf\.lnk',\ '\.txt\.lnk',\ '\.doc\.js',\ '\.docx\.js',\
    '\.xls\.js',\ '\.xlsx\.js',\ '\.ppt\.js',\ '\.pptx\.js',\ '\.rtf\.js',\ '\.pdf\.js',\
    '\.txt\.js'\]\})
- name: '[Sigma] Suspicious Download from Office Domain'
  tag: attack.command-and-control,attack.resource-development,attack.t1105,attack.t1608
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\curl\.exe',\ '\\\\wget\.exe'\]\}|\{'CommandLine\|contains':\
    \['Invoke\-WebRequest',\ 'iwr\ ',\ 'curl\ ',\ 'wget\ ',\ 'Start\-BitsTransfer',\
    '\.DownloadFile\(',\ '\.DownloadString\('\]\})
- name: '[Sigma] Suspicious Download from Office Domain'
  tag: attack.command-and-control,attack.resource-development,attack.t1105,attack.t1608
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(https://attachment\.outlook\.live\.net/owa/|https://onenoteonlinesync\.onenote\.com/onenoteonlinesync/)
- name: '[Sigma] DumpStack.log Defender Evasion'
  tag: attack.defense-evasion
  score: 100
  target: Target_Path
  condition: regex
  pattern: (?i)\\DumpStack\.log$
- name: '[Sigma] DumpStack.log Defender Evasion'
  tag: attack.defense-evasion
  score: 100
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-o\ DumpStack\.log
- name: '[Sigma] Always Install Elevated MSI Spawned Cmd And Powershell'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\cmd\.exe',\ '\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\
    \['Cmd\.Exe',\ 'PowerShell\.EXE',\ 'pwsh\.dll'\]\})
- name: '[Sigma] Always Install Elevated MSI Spawned Cmd And Powershell'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(\\Windows\\Installer\\|msi)
- name: '[Sigma] Always Install Elevated MSI Spawned Cmd And Powershell'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)tmp$
- name: '[Sigma] Suspicious Electron Application Child Processes'
  tag: attack.execution
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(\\chrome\.exe|\\discord\.exe|\\GitHubDesktop\.exe|\\keybase\.exe|\\msedge\.exe|\\msedgewebview2\.exe|\\msteams\.exe|\\slack\.exe|\\teams\.exe)$
- name: '[Sigma] Suspicious Electron Application Child Processes'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\cmd\.exe|\\cscript\.exe|\\mshta\.exe|\\powershell\.exe|\\pwsh\.exe|\\regsvr32\.exe|\\whoami\.exe|\\wscript\.exe)$
- name: '[Sigma] Suspicious Electron Application Child Processes'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\ProgramData\\|:\\Temp\\|\\AppData\\Local\\Temp\\|\\Users\\Public\\|\\Windows\\Temp\\)
- name: '[Sigma] Suspicious Electron Application Child Processes'
  tag: attack.execution
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\Discord\.exe$
- name: '[Sigma] Suspicious Electron Application Child Processes'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\cmd\.exe$
- name: '[Sigma] Suspicious Electron Application Child Processes'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\NVSMI\\nvidia\-smi\.exe
- name: '[Sigma] Potentially Suspicious Electron Application CommandLine'
  tag: attack.execution
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\chrome\.exe',\ '\\\\code\.exe',\ '\\\\discord\.exe',\
    '\\\\GitHubDesktop\.exe',\ '\\\\keybase\.exe',\ '\\\\msedge_proxy\.exe',\ '\\\\msedge\.exe',\
    '\\\\msedgewebview2\.exe',\ '\\\\msteams\.exe',\ '\\\\slack\.exe',\ '\\\\Teams\.exe'\]\}|\{'OriginalFileName':\
    \['chrome\.exe',\ 'code\.exe',\ 'discord\.exe',\ 'GitHubDesktop\.exe',\ 'keybase\.exe',\
    'msedge_proxy\.exe',\ 'msedge\.exe',\ 'msedgewebview2\.exe',\ 'msteams\.exe',\
    'slack\.exe',\ 'Teams\.exe'\]\})
- name: '[Sigma] Potentially Suspicious Electron Application CommandLine'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-\-browser\-subprocess\-path|\-\-gpu\-launcher|\-\-renderer\-cmd\-prefix|\-\-utility\-cmd\-prefix)
- name: '[Sigma] Elevated System Shell Spawned From Uncommon Parent Location'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.execution,attack.t1059
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\powershell_ise\.exe',\
    '\\\\pwsh\.exe',\ '\\\\cmd\.exe'\]\}|\{'OriginalFileName':\ \['PowerShell\.EXE',\
    'powershell_ise\.EXE',\ 'pwsh\.dll',\ 'Cmd\.Exe'\]\})
- name: '[Sigma] Elevated System Shell Spawned From Uncommon Parent Location'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.execution,attack.t1059
  score: 50
  target: User
  condition: regex
  pattern: (?i)(AUTHORI|AUTORI)
- name: '[Sigma] Elevated System Shell Spawned From Uncommon Parent Location'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.execution,attack.t1059
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)0x3e7
- name: '[Sigma] Elevated System Shell Spawned From Uncommon Parent Location'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.execution,attack.t1059
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(:\\Program\ Files\ \(x86\)\\|:\\Program\ Files\\|:\\ProgramData\\|:\\Windows\\System32\\|:\\Windows\\SysWOW64\\|:\\Windows\\Temp\\|:\\Windows\\WinSxS\\)
- name: '[Sigma] Elevated System Shell Spawned From Uncommon Parent Location'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.execution,attack.t1059
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i):\\ManageEngine\\ADManager\ Plus\\pgsql\\bin\\postgres\.exe$
- name: '[Sigma] Elevated System Shell Spawned From Uncommon Parent Location'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.execution,attack.t1059
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\cmd\.exe$
- name: '[Sigma] Elevated System Shell Spawned From Uncommon Parent Location'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.execution,attack.t1059
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i):\\WINDOWS\\system32\\cmd\.exe\ /c\ "
- name: '[Sigma] Elevated System Shell Spawned From Uncommon Parent Location'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.execution,attack.t1059
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i):\\WINDOWS\\Temp\\asgard2\-agent\\
- name: '[Sigma] Elevated System Shell Spawned From Uncommon Parent Location'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.execution,attack.t1059
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i):\\IBM\\SpectrumProtect\\webserver\\scripts\\
- name: '[Sigma] Elevated System Shell Spawned From Uncommon Parent Location'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.execution,attack.t1059
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i):\\IBM\\SpectrumProtect\\webserver\\scripts\\
- name: '[Sigma] Elevated System Shell Spawned From Uncommon Parent Location'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.execution,attack.t1059
  score: 50
  target: ParentPath
  condition: regex
  pattern: None
- name: '[Sigma] Elevated System Shell Spawned From Uncommon Parent Location'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.execution,attack.t1059
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(|\-)
- name: '[Sigma] Hidden Powershell in Link File Pattern'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Windows\\explorer\.exe
- name: '[Sigma] Hidden Powershell in Link File Pattern'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\cmd\.exe
- name: '[Sigma] Hidden Powershell in Link File Pattern'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(powershell|\.lnk)
- name: '[Sigma] Potential Defense Evasion Activity Via Emoji Usage In CommandLine
    - 1'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||)
- name: '[Sigma] Potential Defense Evasion Activity Via Emoji Usage In CommandLine
    - 2'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||)
- name: '[Sigma] Potential Defense Evasion Activity Via Emoji Usage In CommandLine
    - 3'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||0|1|2|3|4|5|6|7|8|9|||\#|.*|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||)
- name: '[Sigma] Potential Defense Evasion Activity Via Emoji Usage In CommandLine
    - 4'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||)
- name: '[Sigma] ETW Logging Tamper In .NET Processes Via CommandLine'
  tag: attack.defense-evasion,attack.t1562
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(COMPlus_ETWEnabled|COMPlus_ETWFlags)
- name: '[Sigma] ETW Trace Evasion Activity'
  tag: attack.defense-evasion,attack.t1070,attack.t1562.006,car.2016-04-002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(cl|/Trace)
- name: '[Sigma] ETW Trace Evasion Activity'
  tag: attack.defense-evasion,attack.t1070,attack.t1562.006,car.2016-04-002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(clear\-log|/Trace)
- name: '[Sigma] ETW Trace Evasion Activity'
  tag: attack.defense-evasion,attack.t1070,attack.t1562.006,car.2016-04-002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(sl|/e:false)
- name: '[Sigma] ETW Trace Evasion Activity'
  tag: attack.defense-evasion,attack.t1070,attack.t1562.006,car.2016-04-002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(set\-log|/e:false)
- name: '[Sigma] ETW Trace Evasion Activity'
  tag: attack.defense-evasion,attack.t1070,attack.t1562.006,car.2016-04-002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(logman|update|trace|\-\-p|\-ets)
- name: '[Sigma] ETW Trace Evasion Activity'
  tag: attack.defense-evasion,attack.t1070,attack.t1562.006,car.2016-04-002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)Remove\-EtwTraceProvider
- name: '[Sigma] ETW Trace Evasion Activity'
  tag: attack.defense-evasion,attack.t1070,attack.t1562.006,car.2016-04-002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Set\-EtwTraceProvider|0x11)
- name: '[Sigma] Suspicious Eventlog Clearing or Configuration Change Activity'
  tag: attack.defense-evasion,attack.t1070.001,attack.t1562.002,car.2016-04-002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\wevtutil\.exe'\}|\{'OriginalFileName':\
    'wevtutil\.exe'\})
- name: '[Sigma] Suspicious Eventlog Clearing or Configuration Change Activity'
  tag: attack.defense-evasion,attack.t1070.001,attack.t1562.002,car.2016-04-002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(clear\-log\ |\ cl\ |set\-log\ |\ sl\ |lfn:)
- name: '[Sigma] Suspicious Eventlog Clearing or Configuration Change Activity'
  tag: attack.defense-evasion,attack.t1070.001,attack.t1562.002,car.2016-04-002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\powershell_ise\.exe|\\pwsh\.exe)$
- name: '[Sigma] Suspicious Eventlog Clearing or Configuration Change Activity'
  tag: attack.defense-evasion,attack.t1070.001,attack.t1562.002,car.2016-04-002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains':\ \['Clear\-EventLog\ ',\ 'Remove\-EventLog\
    ',\ 'Limit\-EventLog\ ',\ 'Clear\-WinEvent\ '\]\}|\{'CommandLine\|contains\|all':\
    \['Eventing\.Reader\.EventLogSession',\ 'ClearLog'\]\}|\{'CommandLine\|contains\|all':\
    \['Diagnostics\.EventLog',\ 'Clear'\]\})
- name: '[Sigma] Suspicious Eventlog Clearing or Configuration Change Activity'
  tag: attack.defense-evasion,attack.t1070.001,attack.t1562.002,car.2016-04-002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\powershell_ise\.exe|\\pwsh\.exe|\\wmic\.exe)$
- name: '[Sigma] Suspicious Eventlog Clearing or Configuration Change Activity'
  tag: attack.defense-evasion,attack.t1070.001,attack.t1562.002,car.2016-04-002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)ClearEventLog
- name: '[Sigma] Suspicious Eventlog Clearing or Configuration Change Activity'
  tag: attack.defense-evasion,attack.t1070.001,attack.t1562.002,car.2016-04-002
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(C:\\Windows\\SysWOW64\\msiexec\.exe|C:\\Windows\\System32\\msiexec\.exe)
- name: '[Sigma] Suspicious Eventlog Clearing or Configuration Change Activity'
  tag: attack.defense-evasion,attack.t1070.001,attack.t1562.002,car.2016-04-002
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ sl\ '
- name: '[Sigma] Potentially Suspicious EventLog Recon Activity Using Log Query Utilities'
  tag: attack.credential-access,attack.discovery,attack.t1552,attack.t1087
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Select|Win32_NTLogEvent)
- name: '[Sigma] Potentially Suspicious EventLog Recon Activity Using Log Query Utilities'
  tag: attack.credential-access,attack.discovery,attack.t1552,attack.t1087
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\wevtutil\.exe'\}|\{'OriginalFileName':\
    'wevtutil\.exe'\})
- name: '[Sigma] Potentially Suspicious EventLog Recon Activity Using Log Query Utilities'
  tag: attack.credential-access,attack.discovery,attack.t1552,attack.t1087
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ qe\ |\ query\-events\ )
- name: '[Sigma] Potentially Suspicious EventLog Recon Activity Using Log Query Utilities'
  tag: attack.credential-access,attack.discovery,attack.t1552,attack.t1087
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\wmic\.exe'\}|\{'OriginalFileName':\ 'wmic\.exe'\})
- name: '[Sigma] Potentially Suspicious EventLog Recon Activity Using Log Query Utilities'
  tag: attack.credential-access,attack.discovery,attack.t1552,attack.t1087
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ ntevent
- name: '[Sigma] Potentially Suspicious EventLog Recon Activity Using Log Query Utilities'
  tag: attack.credential-access,attack.discovery,attack.t1552,attack.t1087
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Get\-WinEvent\ |get\-eventlog\ )
- name: '[Sigma] Potentially Suspicious EventLog Recon Activity Using Log Query Utilities'
  tag: attack.credential-access,attack.discovery,attack.t1552,attack.t1087
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Microsoft\-Windows\-PowerShell|Microsoft\-Windows\-Security\-Auditing|Microsoft\-Windows\-TerminalServices\-LocalSessionManager|Microsoft\-Windows\-TerminalServices\-RemoteConnectionManager|Microsoft\-Windows\-Windows\
    Defender|PowerShellCore|Security|Windows\ PowerShell)
- name: '[Sigma] Potentially Suspicious EventLog Recon Activity Using Log Query Utilities'
  tag: attack.credential-access,attack.discovery,attack.t1552,attack.t1087
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-InstanceId\ 462.|\.eventid\ \-eq\ 462.|\.ID\ \-eq\ 462.|EventCode=.462.|EventIdentifier=.462.|System\[EventID=462.\]|\-InstanceId\
    4778|\.eventid\ \-eq\ 4778|\.ID\ \-eq\ 4778|EventCode=.4778.|EventIdentifier=.4778.|System\[EventID=4778\]|\-InstanceId\
    25|\.eventid\ \-eq\ 25|\.ID\ \-eq\ 25|EventCode=.25.|EventIdentifier=.25.|System\[EventID=25\]|\-InstanceId\
    1149|\.eventid\ \-eq\ 1149|\.ID\ \-eq\ 1149|EventCode=.1149.|EventIdentifier=.1149.|System\[EventID=1149\]|\-InstanceId\
    21|\.eventid\ \-eq\ 21|\.ID\ \-eq\ 21|EventCode=.21.|EventIdentifier=.21.|System\[EventID=21\]|\-InstanceId\
    22|\.eventid\ \-eq\ 22|\.ID\ \-eq\ 22|EventCode=.22.|EventIdentifier=.22.|System\[EventID=22\])
- name: '[Sigma] Potentially Suspicious Execution From Parent Process In Public Folder'
  tag: attack.defense-evasion,attack.execution,attack.t1564,attack.t1059
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i):\\Users\\Public\\
- name: '[Sigma] Potentially Suspicious Execution From Parent Process In Public Folder'
  tag: attack.defense-evasion,attack.execution,attack.t1564,attack.t1059
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\bitsadmin\.exe',\ '\\\\certutil\.exe',\
    '\\\\cmd\.exe',\ '\\\\cscript\.exe',\ '\\\\mshta\.exe',\ '\\\\powershell\.exe',\
    '\\\\pwsh\.exe',\ '\\\\regsvr32\.exe',\ '\\\\rundll32\.exe',\ '\\\\wscript\.exe'\]\}|\{'CommandLine\|contains':\
    \['bitsadmin',\ 'certutil',\ 'cscript',\ 'mshta',\ 'powershell',\ 'regsvr32',\
    'rundll32',\ 'wscript'\]\})
- name: '[Sigma] Process Execution From A Potentially Suspicious Folder'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Perflogs\\|:\\Users\\All\ Users\\|:\\Users\\Default\\|:\\Users\\NetworkService\\|:\\Windows\\addins\\|:\\Windows\\debug\\|:\\Windows\\Fonts\\|:\\Windows\\Help\\|:\\Windows\\IME\\|:\\Windows\\Media\\|:\\Windows\\repair\\|:\\Windows\\security\\|:\\Windows\\System32\\Tasks\\|:\\Windows\\Tasks\\|\$Recycle\.bin|\\config\\systemprofile\\|\\Intel\\Logs\\|\\RSA\\MachineKeys\\)
- name: '[Sigma] Process Execution From A Potentially Suspicious Folder'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^C:\\Users\\Public\\IBM\\ClientSolutions\\Start_Programs\\
- name: '[Sigma] Process Execution From A Potentially Suspicious Folder'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^C:\\Windows\\SysWOW64\\config\\systemprofile\\Citrix\\UpdaterBinaries\\
- name: '[Sigma] Process Execution From A Potentially Suspicious Folder'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\CitrixReceiverUpdater\.exe$
- name: '[Sigma] Suspicious File Characteristics Due to Missing Fields'
  tag: attack.execution,attack.t1059.006
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\.
- name: '[Sigma] Suspicious File Characteristics Due to Missing Fields'
  tag: attack.execution,attack.t1059.006
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\.
- name: '[Sigma] Suspicious File Characteristics Due to Missing Fields'
  tag: attack.execution,attack.t1059.006
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\.
- name: '[Sigma] Suspicious File Characteristics Due to Missing Fields'
  tag: attack.execution,attack.t1059.006
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\.
- name: '[Sigma] Suspicious File Characteristics Due to Missing Fields'
  tag: attack.execution,attack.t1059.006
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\.
- name: '[Sigma] Suspicious File Characteristics Due to Missing Fields'
  tag: attack.execution,attack.t1059.006
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\.
- name: '[Sigma] Suspicious File Characteristics Due to Missing Fields'
  tag: attack.execution,attack.t1059.006
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\Downloads\\
- name: '[Sigma] Suspicious Reconnaissance Activity Via GatherNetworkInfo.VBS'
  tag: attack.discovery,attack.execution,attack.t1615,attack.t1059.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)gatherNetworkInfo\.vbs
- name: '[Sigma] Suspicious Reconnaissance Activity Via GatherNetworkInfo.VBS'
  tag: attack.discovery,attack.execution,attack.t1615,attack.t1059.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\cscript\.exe|\\wscript\.exe)$
- name: '[Sigma] Potential Hidden Directory Creation Via NTFS INDEX_ALLOCATION Stream
    - CLI'
  tag: attack.defense-evasion,attack.t1564.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)::\$index_allocation
- name: '[Sigma] Writing Of Malicious Files To The Fonts Folder'
  tag: attack.t1211,attack.t1059,attack.defense-evasion,attack.persistence,attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(echo|copy|type|file\ createnew|cacls)
- name: '[Sigma] Writing Of Malicious Files To The Fonts Folder'
  tag: attack.t1211,attack.t1059,attack.defense-evasion,attack.persistence,attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\Fonts\\
- name: '[Sigma] Writing Of Malicious Files To The Fonts Folder'
  tag: attack.t1211,attack.t1059,attack.defense-evasion,attack.persistence,attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\.sh|\.exe|\.dll|\.bin|\.bat|\.cmd|\.js|\.msh|\.reg|\.scr|\.ps|\.vb|\.jar|\.pl|\.inf|\.cpl|\.hta|\.msi|\.vbs)
- name: '[Sigma] Potential Homoglyph Attack Using Lookalike Characters'
  tag: attack.defense-evasion,attack.t1036,attack.t1036.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(||||||||||||||||||||||||||||||||)
- name: '[Sigma] Potential Homoglyph Attack Using Lookalike Characters'
  tag: attack.defense-evasion,attack.t1036,attack.t1036.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(||||||||||||||)
- name: '[Sigma] Execution Of Non-Existing File'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\
- name: '[Sigma] Execution Of Non-Existing File'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: None
- name: '[Sigma] Execution Of Non-Existing File'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-|)
- name: '[Sigma] Execution Of Non-Existing File'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image':\ \['System',\ 'Registry',\ 'MemCompression',\ 'vmmem'\]\}|\{'CommandLine':\
    \['Registry',\ 'MemCompression',\ 'vmmem'\]\})
- name: '[Sigma] Base64 MZ Header In CommandLine'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(TVqQAAMAAAAEAAAA|TVpQAAIAAAAEAA8A|TVqAAAEAAAAEABAA|TVoAAAAAAAAAAAAA|TVpTAQEAAAAEAAAA)
- name: '[Sigma] Potential WinAPI Calls Via CommandLine'
  tag: attack.execution,attack.t1106
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(AddSecurityPackage|AdjustTokenPrivileges|Advapi32|CloseHandle|CreateProcessWithToken|CreatePseudoConsole|CreateRemoteThread|CreateThread|CreateUserThread|DangerousGetHandle|DuplicateTokenEx|EnumerateSecurityPackages|FreeHGlobal|FreeLibrary|GetDelegateForFunctionPointer|GetLogonSessionData|GetModuleHandle|GetProcAddress|GetProcessHandle|GetTokenInformation|ImpersonateLoggedOnUser|kernel32|LoadLibrary|memcpy|MiniDumpWriteDump|ntdll|OpenDesktop|OpenProcess|OpenProcessToken|OpenThreadToken|OpenWindowStation|PtrToString|QueueUserApc|ReadProcessMemory|RevertToSelf|RtlCreateUserThread|secur32|SetThreadToken|VirtualAlloc|VirtualFree|VirtualProtect|WaitForSingleObject|WriteInt32|WriteProcessMemory|ZeroFreeGlobalAllocUnicode)
- name: '[Sigma] Potential WinAPI Calls Via CommandLine'
  tag: attack.execution,attack.t1106
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\MpCmdRun\.exe$
- name: '[Sigma] Potential WinAPI Calls Via CommandLine'
  tag: attack.execution,attack.t1106
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)GetLoadLibraryWAddress32
- name: '[Sigma] Potential WinAPI Calls Via CommandLine'
  tag: attack.execution,attack.t1106
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\CompatTelRunner\.exe$
- name: '[Sigma] Potential WinAPI Calls Via CommandLine'
  tag: attack.execution,attack.t1106
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(FreeHGlobal|PtrToString|kernel32|CloseHandle)
- name: '[Sigma] Potentially Suspicious JWT Token Search Via CLI'
  tag: attack.credential-access,attack.t1528,attack.t1552.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(find\ |find\.exe|findstr|select\-string\ |strings)
- name: '[Sigma] Potentially Suspicious JWT Token Search Via CLI'
  tag: attack.credential-access,attack.t1528,attack.t1552.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(eyJ0eXAiOi|eyJhbGciOi|\ eyJ0eX|\ "eyJ0eX"|\ 'eyJ0eX'|\ eyJhbG|\ "eyJhbG"|\
    'eyJhbG')
- name: '[Sigma] Local Accounts Discovery'
  tag: attack.discovery,attack.t1033,attack.t1087.001
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\whoami\.exe',\ '\\\\quser\.exe',\ '\\\\qwinsta\.exe'\]\}|\{'OriginalFileName':\
    \['whoami\.exe',\ 'quser\.exe',\ 'qwinsta\.exe'\]\})
- name: '[Sigma] Local Accounts Discovery'
  tag: attack.discovery,attack.t1033,attack.t1087.001
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)\\wmic\.exe$
- name: '[Sigma] Local Accounts Discovery'
  tag: attack.discovery,attack.t1033,attack.t1087.001
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(useraccount|get)
- name: '[Sigma] Local Accounts Discovery'
  tag: attack.discovery,attack.t1033,attack.t1087.001
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)\\cmdkey\.exe$
- name: '[Sigma] Local Accounts Discovery'
  tag: attack.discovery,attack.t1033,attack.t1087.001
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)\ /l
- name: '[Sigma] Local Accounts Discovery'
  tag: attack.discovery,attack.t1033,attack.t1087.001
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)\\cmd\.exe$
- name: '[Sigma] Local Accounts Discovery'
  tag: attack.discovery,attack.t1033,attack.t1087.001
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /c|dir\ |\\Users\\)
- name: '[Sigma] Local Accounts Discovery'
  tag: attack.discovery,attack.t1033,attack.t1087.001
  score: 20
  target: Target_Path
  condition: regex
  pattern: '(?i)\ rmdir\ '
- name: '[Sigma] Local Accounts Discovery'
  tag: attack.discovery,attack.t1033,attack.t1087.001
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(\\net\.exe|\\net1\.exe)$
- name: '[Sigma] Local Accounts Discovery'
  tag: attack.discovery,attack.t1033,attack.t1087.001
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)user
- name: '[Sigma] Local Accounts Discovery'
  tag: attack.discovery,attack.t1033,attack.t1087.001
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(/domain|/add|/delete|/active|/expires|/passwordreq|/scriptpath|/times|/workstations)
- name: '[Sigma] LOLBIN Execution From Abnormal Drive'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\calc\.exe',\ '\\\\certutil\.exe',\ '\\\\cmstp\.exe',\
    '\\\\cscript\.exe',\ '\\\\installutil\.exe',\ '\\\\mshta\.exe',\ '\\\\regsvr32\.exe',\
    '\\\\rundll32\.exe',\ '\\\\wscript\.exe'\]\}|\{'OriginalFileName':\ \['CALC\.EXE',\
    'CertUtil\.exe',\ 'CMSTP\.EXE',\ 'cscript\.exe',\ 'installutil\.exe',\ 'MSHTA\.EXE',\
    'REGSVR32\.EXE',\ 'RUNDLL32\.EXE',\ 'wscript\.exe'\]\})
- name: '[Sigma] LOLBIN Execution From Abnormal Drive'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)C:\\
- name: '[Sigma] LOLBIN Execution From Abnormal Drive'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)
- name: '[Sigma] LOLBIN Execution From Abnormal Drive'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: None
- name: '[Sigma] LSASS Dump Keyword In CommandLine'
  tag: attack.credential-access,attack.t1003.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains':\ \['lsass\.dmp',\ 'lsass\.zip',\ 'lsass\.rar',\
    'Andrew\.dmp',\ 'Coredump\.dmp',\ 'NotLSASS\.zip',\ 'lsass_2',\ 'lsassdump',\
    'lsassdmp'\]\}|\{'CommandLine\|contains\|all':\ \['lsass',\ '\.dmp'\]\}|\{'CommandLine\|contains\|all':\
    \['SQLDmpr',\ '\.mdmp'\]\}|\{'CommandLine\|contains\|all':\ \['nanodump',\ '\.dmp'\]\})
- name: '[Sigma] Potential File Download Via MS-AppInstaller Protocol Handler'
  tag: attack.defense-evasion,attack.execution,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(ms\-appinstaller://.source=|http)
- name: '[Sigma] Suspicious Network Command'
  tag: attack.discovery,attack.t1016
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(ipconfig\\s\+/all|netsh\\s\+interface\ show\ interface|arp\\s\+\-a|nbtstat\\s\+\-n|net\\s\+config|route\\s\+print)
- name: '[Sigma] Suspicious Scan Loop Network'
  tag: attack.execution,attack.t1059,attack.discovery,attack.t1018
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(for\ |foreach\ )
- name: '[Sigma] Suspicious Scan Loop Network'
  tag: attack.execution,attack.t1059,attack.discovery,attack.t1018
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(nslookup|ping)
- name: '[Sigma] Potential Network Sniffing Activity Using Network Tools'
  tag: attack.credential-access,attack.discovery,attack.t1040
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\tshark\.exe$
- name: '[Sigma] Potential Network Sniffing Activity Using Network Tools'
  tag: attack.credential-access,attack.discovery,attack.t1040
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\-i
- name: '[Sigma] Potential Network Sniffing Activity Using Network Tools'
  tag: attack.credential-access,attack.discovery,attack.t1040
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\windump\.exe$
- name: '[Sigma] Execution of Suspicious File Type Extension'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\.bin|\.cgi|\.com|\.exe|\.scr|\.tmp)$
- name: '[Sigma] Execution of Suspicious File Type Extension'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(System|Registry|MemCompression|vmmem)
- name: '[Sigma] Execution of Suspicious File Type Extension'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i):\\Windows\\Installer\\MSI
- name: '[Sigma] Execution of Suspicious File Type Extension'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i):\\Windows\\System32\\DriverStore\\FileRepository\\
- name: '[Sigma] Execution of Suspicious File Type Extension'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i):\\Config\.Msi\\
- name: '[Sigma] Execution of Suspicious File Type Extension'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\.rbf|\.rbs)$
- name: '[Sigma] Execution of Suspicious File Type Extension'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'ParentImage\|contains':\ ':\\\\Windows\\\\Temp\\\\'\}|\{'Image\|contains':\
    ':\\\\Windows\\\\Temp\\\\'\})
- name: '[Sigma] Execution of Suspicious File Type Extension'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i):\\\$Extend\\\$Deleted\\
- name: '[Sigma] Execution of Suspicious File Type Extension'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-|)
- name: '[Sigma] Execution of Suspicious File Type Extension'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: None
- name: '[Sigma] Execution of Suspicious File Type Extension'
  tag: attack.defense-evasion
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i):\\ProgramData\\Avira\\
- name: '[Sigma] Execution of Suspicious File Type Extension'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)NVIDIA\\NvBackend\\
- name: '[Sigma] Execution of Suspicious File Type Extension'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\.dat$
- name: '[Sigma] Execution of Suspicious File Type Extension'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Program\ Files\ \(x86\)\\WINPAKPRO\\|:\\Program\ Files\\WINPAKPRO\\)
- name: '[Sigma] Execution of Suspicious File Type Extension'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\.ngn$
- name: '[Sigma] Execution of Suspicious File Type Extension'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Program\ Files\ \(x86\)\\MyQ\\Server\\pcltool\.dll|:\\Program\
    Files\\MyQ\\Server\\pcltool\.dll)$
- name: '[Sigma] Execution of Suspicious File Type Extension'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\AppData\\Local\\Packages\\|\\LocalState\\rootfs\\)
- name: '[Sigma] Execution of Suspicious File Type Extension'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\LZMA_EXE$
- name: '[Sigma] Execution of Suspicious File Type Extension'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i):\\Program\ Files\\Mozilla\ Firefox\\
- name: '[Sigma] Execution of Suspicious File Type Extension'
  tag: attack.defense-evasion
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\services\.exe
- name: '[Sigma] Execution of Suspicious File Type Extension'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)com\.docker\.service$
- name: '[Sigma] Non-privileged Usage of Reg or Powershell'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains\|all':\ \['reg\ ',\ 'add'\]\}|\{'CommandLine\|contains':\
    \['powershell',\ 'set\-itemproperty',\ '\ sp\ ',\ 'new\-itemproperty'\]\})
- name: '[Sigma] Non-privileged Usage of Reg or Powershell'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(Medium|S\-1\-16\-8192)
- name: '[Sigma] Non-privileged Usage of Reg or Powershell'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(ControlSet|Services)
- name: '[Sigma] Non-privileged Usage of Reg or Powershell'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(ImagePath|FailureCommand|ServiceDLL)
- name: '[Sigma] Process Launched Without Image Name'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\\.exe$
- name: '[Sigma] Suspicious Process Patterns NTDS.DIT Exfil'
  tag: attack.credential-access,attack.t1003.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\NTDSDump\.exe',\ '\\\\NTDSDumpEx\.exe'\]\}|\{'CommandLine\|contains\|all':\
    \['ntds\.dit',\ 'system\.hiv'\]\}|\{'CommandLine\|contains':\ 'NTDSgrab\.ps1'\})
- name: '[Sigma] Suspicious Process Patterns NTDS.DIT Exfil'
  tag: attack.credential-access,attack.t1003.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(ac\ i\ ntds|create\ full)
- name: '[Sigma] Suspicious Process Patterns NTDS.DIT Exfil'
  tag: attack.credential-access,attack.t1003.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(/c\ copy\ |\\windows\\ntds\\ntds\.dit)
- name: '[Sigma] Suspicious Process Patterns NTDS.DIT Exfil'
  tag: attack.credential-access,attack.t1003.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(activate\ instance\ ntds|create\ full)
- name: '[Sigma] Suspicious Process Patterns NTDS.DIT Exfil'
  tag: attack.credential-access,attack.t1003.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(powershell|ntds\.dit)
- name: '[Sigma] Suspicious Process Patterns NTDS.DIT Exfil'
  tag: attack.credential-access,attack.t1003.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)ntds\.dit
- name: '[Sigma] Suspicious Process Patterns NTDS.DIT Exfil'
  tag: attack.credential-access,attack.t1003.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'ParentImage\|contains':\ \['\\\\apache',\ '\\\\tomcat',\ '\\\\AppData\\\\',\
    '\\\\Temp\\\\',\ '\\\\Public\\\\',\ '\\\\PerfLogs\\\\'\]\}|\{'Image\|contains':\
    \['\\\\apache',\ '\\\\tomcat',\ '\\\\AppData\\\\',\ '\\\\Temp\\\\',\ '\\\\Public\\\\',\
    '\\\\PerfLogs\\\\'\]\})
- name: '[Sigma] Potentially Suspicious Call To Win32_NTEventlogFile Class'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)Win32_NTEventlogFile
- name: '[Sigma] Potentially Suspicious Call To Win32_NTEventlogFile Class'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.BackupEventlog\(|\.ChangeSecurityPermissions\(|\.ChangeSecurityPermissionsEx\(|\.ClearEventLog\(|\.Delete\(|\.DeleteEx\(|\.Rename\(|\.TakeOwnerShip\(|\.TakeOwnerShipEx\()
- name: '[Sigma] Use Short Name Path in Image'
  tag: attack.defense-evasion,attack.t1564.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\~1\\|\~2\\)
- name: '[Sigma] Use Short Name Path in Image'
  tag: attack.defense-evasion,attack.t1564.004
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(C:\\Windows\\System32\\Dism\.exe|C:\\Windows\\System32\\cleanmgr\.exe)
- name: '[Sigma] Use Short Name Path in Image'
  tag: attack.defense-evasion,attack.t1564.004
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|contains\|all':\ \['\\\\AppData\\\\',\ '\\\\Temp\\\\'\]\}|\{'Image\|endswith':\
    \['\~1\\\\unzip\.exe',\ '\~1\\\\7zG\.exe'\]\})
- name: '[Sigma] Use Short Name Path in Image'
  tag: attack.defense-evasion,attack.t1564.004
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\WebEx\\WebexHost\.exe$
- name: '[Sigma] Use Short Name Path in Image'
  tag: attack.defense-evasion,attack.t1564.004
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\thor\\thor64\.exe$
- name: '[Sigma] Use Short Name Path in Image'
  tag: attack.defense-evasion,attack.t1564.004
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Product':\ 'InstallShield\ \(R\)'\}|\{'Description':\ 'InstallShield\
    \(R\)\ Setup\ Engine'\}|\{'Company':\ 'InstallShield\ Software\ Corporation'\})
- name: '[Sigma] Use NTFS Short Name in Command Line'
  tag: attack.defense-evasion,attack.t1564.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\~1\.exe|\~1\.bat|\~1\.msi|\~1\.vbe|\~1\.vbs|\~1\.dll|\~1\.ps1|\~1\.js|\~1\.hta|\~2\.exe|\~2\.bat|\~2\.msi|\~2\.vbe|\~2\.vbs|\~2\.dll|\~2\.ps1|\~2\.js|\~2\.hta)
- name: '[Sigma] Use NTFS Short Name in Command Line'
  tag: attack.defense-evasion,attack.t1564.004
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'ParentImage\|endswith':\ \['\\\\WebEx\\\\WebexHost\.exe',\ '\\\\thor\\\\thor64\.exe'\]\}|\{'CommandLine\|contains':\
    'C:\\\\xampp\\\\vcredist\\\\VCREDI\~1\.EXE'\})
- name: '[Sigma] Use NTFS Short Name in Image'
  tag: attack.defense-evasion,attack.t1564.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\~1\.bat|\~1\.dll|\~1\.exe|\~1\.hta|\~1\.js|\~1\.msi|\~1\.ps1|\~1\.tmp|\~1\.vbe|\~1\.vbs|\~2\.bat|\~2\.dll|\~2\.exe|\~2\.hta|\~2\.js|\~2\.msi|\~2\.ps1|\~2\.tmp|\~2\.vbe|\~2\.vbs)
- name: '[Sigma] Use NTFS Short Name in Image'
  tag: attack.defense-evasion,attack.t1564.004
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Windows\\explorer\.exe
- name: '[Sigma] Use NTFS Short Name in Image'
  tag: attack.defense-evasion,attack.t1564.004
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\WebEx\\WebexHost\.exe$
- name: '[Sigma] Use NTFS Short Name in Image'
  tag: attack.defense-evasion,attack.t1564.004
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\thor\\thor64\.exe$
- name: '[Sigma] Use NTFS Short Name in Image'
  tag: attack.defense-evasion,attack.t1564.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\PROGRA\~1\\WinZip\\WZPREL\~1\.EXE
- name: '[Sigma] Use NTFS Short Name in Image'
  tag: attack.defense-evasion,attack.t1564.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\VCREDI\~1\.EXE$
- name: '[Sigma] Obfuscated IP Download Activity'
  tag: attack.discovery
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Invoke\-WebRequest|iwr\ |Invoke\-RestMethod|irm\ |wget\ |curl\ |DownloadFile|DownloadString)
- name: '[Sigma] Obfuscated IP Download Activity'
  tag: attack.discovery
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ 0x|//0x|\.0x|\.00x)
- name: '[Sigma] Obfuscated IP Download Activity'
  tag: attack.discovery
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(http://%|%2e)
- name: '[Sigma] Obfuscated IP Download Activity'
  tag: attack.discovery
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|re':\ 'https.://\[0\-9\]\{1,3\}\\\\\.\[0\-9\]\{1,3\}\\\\\.0\[0\-9\]\{3,4\}'\}|\{'CommandLine\|re':\
    'https.://\[0\-9\]\{1,3\}\\\\\.0\[0\-9\]\{3,7\}'\}|\{'CommandLine\|re':\ 'https.://0\[0\-9\]\{3,11\}'\}|\{'CommandLine\|re':\
    'https.://\(0\[0\-9\]\{1,11\}\\\\\.\)\{3\}0\[0\-9\]\{1,11\}'\}|\{'CommandLine\|re':\
    'https.://0\[0\-9\]\{1,11\}'\}|\{'CommandLine\|re':\ '\ \[0\-7\]\{7,13\}'\})
- name: '[Sigma] Obfuscated IP Download Activity'
  tag: attack.discovery
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)https.://\(\(25\[0\-5\]\|\(2\[0\-4\]\|1\\d\|\[1\-9\]\).\\d\)\(\\\.\|\\b\)\)\{4\}
- name: '[Sigma] Obfuscated IP Via CLI'
  tag: attack.discovery
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\ping\.exe|\\arp\.exe)$
- name: '[Sigma] Obfuscated IP Via CLI'
  tag: attack.discovery
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ 0x|//0x|\.0x|\.00x)
- name: '[Sigma] Obfuscated IP Via CLI'
  tag: attack.discovery
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(http://%|%2e)
- name: '[Sigma] Obfuscated IP Via CLI'
  tag: attack.discovery
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|re':\ 'https.://\[0\-9\]\{1,3\}\\\\\.\[0\-9\]\{1,3\}\\\\\.0\[0\-9\]\{3,4\}'\}|\{'CommandLine\|re':\
    'https.://\[0\-9\]\{1,3\}\\\\\.0\[0\-9\]\{3,7\}'\}|\{'CommandLine\|re':\ 'https.://0\[0\-9\]\{3,11\}'\}|\{'CommandLine\|re':\
    'https.://\(0\[0\-9\]\{1,11\}\\\\\.\)\{3\}0\[0\-9\]\{1,11\}'\}|\{'CommandLine\|re':\
    'https.://0\[0\-9\]\{1,11\}'\}|\{'CommandLine\|re':\ '\ \[0\-7\]\{7,13\}'\})
- name: '[Sigma] Obfuscated IP Via CLI'
  tag: attack.discovery
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)https.://\(\(25\[0\-5\]\|\(2\[0\-4\]\|1\\d\|\[1\-9\]\).\\d\)\(\\\.\|\\b\)\)\{4\}
- name: '[Sigma] Suspicious Process Parents'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\minesweeper\.exe|\\winver\.exe|\\bitsadmin\.exe)$
- name: '[Sigma] Suspicious Process Parents'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\csrss\.exe|\\certutil\.exe|\\eventvwr\.exe|\\calc\.exe|\\notepad\.exe)$
- name: '[Sigma] Suspicious Process Parents'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\WerFault\.exe|\\wermgr\.exe|\\conhost\.exe|\\mmc\.exe|\\win32calc\.exe|\\notepad\.exe)$
- name: '[Sigma] Suspicious Process Parents'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: None
- name: '[Sigma] Potential PowerShell Execution Via DLL'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\InstallUtil\.exe',\ '\\\\RegAsm\.exe',\
    '\\\\RegSvcs\.exe',\ '\\\\regsvr32\.exe',\ '\\\\rundll32\.exe'\]\}|\{'OriginalFileName':\
    \['InstallUtil\.exe',\ 'RegAsm\.exe',\ 'RegSvcs\.exe',\ 'REGSVR32\.EXE',\ 'RUNDLL32\.EXE'\]\})
- name: '[Sigma] Potential PowerShell Execution Via DLL'
  tag: attack.defense-evasion,attack.t1218.011
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Default\.GetString|DownloadString|FromBase64String|ICM\ |IEX\ |Invoke\-Command|Invoke\-Expression)
- name: '[Sigma] Private Keys Reconnaissance Via CommandLine Tools'
  tag: attack.credential-access,attack.t1552.004
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\cmd\.exe'\}|\{'OriginalFileName':\ 'Cmd\.Exe'\})
- name: '[Sigma] Private Keys Reconnaissance Via CommandLine Tools'
  tag: attack.credential-access,attack.t1552.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)dir\ '
- name: '[Sigma] Private Keys Reconnaissance Via CommandLine Tools'
  tag: attack.credential-access,attack.t1552.004
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\
    \['PowerShell\.EXE',\ 'pwsh\.dll'\]\})
- name: '[Sigma] Private Keys Reconnaissance Via CommandLine Tools'
  tag: attack.credential-access,attack.t1552.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)Get\-ChildItem\ '
- name: '[Sigma] Private Keys Reconnaissance Via CommandLine Tools'
  tag: attack.credential-access,attack.t1552.004
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\findstr\.exe'\}|\{'OriginalFileName':\
    'FINDSTR\.EXE'\})
- name: '[Sigma] Private Keys Reconnaissance Via CommandLine Tools'
  tag: attack.credential-access,attack.t1552.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\.key|\.pgp|\.gpg|\.ppk|\.p12|\.pem|\.pfx|\.cer|\.p7b|\.asc)
- name: '[Sigma] Suspicious RunAs-Like Flag Combination'
  tag: attack.privilege-escalation
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-u\ system\ |\ \-\-user\ system\ |\ \-u\ NT|\ \-u\ "NT|\ \-u\ 'NT|\
    \-\-system\ |\ \-u\ administrator\ )
- name: '[Sigma] Suspicious RunAs-Like Flag Combination'
  tag: attack.privilege-escalation
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-c\ cmd|\ \-c\ "cmd|\ \-c\ powershell|\ \-c\ "powershell|\ \-\-command\
    cmd|\ \-\-command\ powershell|\ \-c\ whoami|\ \-c\ wscript|\ \-c\ cscript)
- name: '[Sigma] Privilege Escalation via Named Pipe Impersonation'
  tag: attack.lateral-movement,attack.t1021
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\cmd\.exe',\ '\\\\powershell\.exe'\]\}|\{'OriginalFileName':\
    \['Cmd\.Exe',\ 'PowerShell\.EXE'\]\})
- name: '[Sigma] Privilege Escalation via Named Pipe Impersonation'
  tag: attack.lateral-movement,attack.t1021
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(echo|>|\\\\\\\\\.\\\\pipe\\\\)
- name: '[Sigma] Windows Processes Suspicious Parent Directory'
  tag: attack.defense-evasion,attack.t1036.003,attack.t1036.005
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(\\svchost\.exe|\\taskhost\.exe|\\lsm\.exe|\\lsass\.exe|\\services\.exe|\\lsaiso\.exe|\\csrss\.exe|\\wininit\.exe|\\winlogon\.exe)$
- name: '[Sigma] Windows Processes Suspicious Parent Directory'
  tag: attack.defense-evasion,attack.t1036.003,attack.t1036.005
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'ParentImage\|endswith':\ \['\\\\SavService\.exe',\ '\\\\ngen\.exe'\]\}|\{'ParentImage\|contains':\
    \['\\\\System32\\\\',\ '\\\\SysWOW64\\\\'\]\})
- name: '[Sigma] Windows Processes Suspicious Parent Directory'
  tag: attack.defense-evasion,attack.t1036.003,attack.t1036.005
  score: 20
  target: ParentPath
  condition: regex
  pattern: (?i)(\\Windows\ Defender\\|\\Microsoft\ Security\ Client\\)
- name: '[Sigma] Windows Processes Suspicious Parent Directory'
  tag: attack.defense-evasion,attack.t1036.003,attack.t1036.005
  score: 20
  target: ParentPath
  condition: regex
  pattern: (?i)\\MsMpEng\.exe$
- name: '[Sigma] Windows Processes Suspicious Parent Directory'
  tag: attack.defense-evasion,attack.t1036.003,attack.t1036.005
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'ParentImage':\ None\}|\{'ParentImage':\ \['',\ '\-'\]\})
- name: '[Sigma] Suspicious Program Names'
  tag: attack.execution,attack.t1059
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|contains':\ \['\\\\CVE\-202',\ '\\\\CVE202'\]\}|\{'Image\|endswith':\
    \['\\\\poc\.exe',\ '\\\\artifact\.exe',\ '\\\\artifact64\.exe',\ '\\\\artifact_protected\.exe',\
    '\\\\artifact32\.exe',\ '\\\\artifact32big\.exe',\ 'obfuscated\.exe',\ 'obfusc\.exe',\
    '\\\\meterpreter'\]\})
- name: '[Sigma] Suspicious Program Names'
  tag: attack.execution,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(inject\.ps1|Invoke\-CVE|pupy\.ps1|payload\.ps1|beacon\.ps1|PowerView\.ps1|bypass\.ps1|obfuscated\.ps1|obfusc\.ps1|obfus\.ps1|obfs\.ps1|evil\.ps1|MiniDogz\.ps1|_enc\.ps1|\\shell\.ps1|\\rshell\.ps1|revshell\.ps1|\\av\.ps1|\\av_test\.ps1|adrecon\.ps1|mimikatz\.ps1|\\PowerUp_|powerup\.ps1|\\Temp\\a\.ps1|\\Temp\\p\.ps1|\\Temp\\1\.ps1|Hound\.ps1|encode\.ps1|powercat\.ps1)
- name: '[Sigma] Recon Information for Export with Command Prompt'
  tag: attack.collection,attack.t1119
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\tree\.com',\ '\\\\WMIC\.exe',\ '\\\\doskey\.exe',\
    '\\\\sc\.exe'\]\}|\{'OriginalFileName':\ \['wmic\.exe',\ 'DOSKEY\.EXE',\ 'sc\.exe'\]\})
- name: '[Sigma] Recon Information for Export with Command Prompt'
  tag: attack.collection,attack.t1119
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\ >\ %TEMP%\\|\ >\ %TMP%\\)
- name: '[Sigma] Suspicious Process Execution From Fake Recycle.Bin Folder'
  tag: attack.persistence,attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(RECYCLERS\.BIN\\|RECYCLER\.BIN\\)
- name: '[Sigma] Suspicious Redirection to Local Admin Share'
  tag: attack.exfiltration,attack.t1048
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)>
- name: '[Sigma] Suspicious Redirection to Local Admin Share'
  tag: attack.exfiltration,attack.t1048
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\\\\\\\127\.0\.0\.1\\\\admin\$\\\\|\\\\\\\\localhost\\\\admin\$\\\\)
- name: '[Sigma] Potential Remote Desktop Tunneling'
  tag: attack.lateral-movement,attack.t1021
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i):3389
- name: '[Sigma] Potential Remote Desktop Tunneling'
  tag: attack.lateral-movement,attack.t1021
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-L\ |\ \-P\ |\ \-R\ |\ \-pw\ |\ \-ssh\ )
- name: '[Sigma] Potential Defense Evasion Via Right-to-Left Override'
  tag: attack.defense-evasion,attack.t1036.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\u202e|\[U\+202E\])
- name: '[Sigma] Script Interpreter Execution From Suspicious Folder'
  tag: attack.execution,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\cscript\.exe|\\mshta\.exe|\\wscript\.exe)$
- name: '[Sigma] Script Interpreter Execution From Suspicious Folder'
  tag: attack.execution,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-ep\ bypass\ |\ \-ExecutionPolicy\ bypass\ |\ \-w\ hidden\ |/e:javascript\
    |/e:Jscript\ |/e:vbscript\ )
- name: '[Sigma] Script Interpreter Execution From Suspicious Folder'
  tag: attack.execution,attack.t1059
  score: 80
  target: FileName
  condition: regex
  pattern: (?i)(cscript\.exe|mshta\.exe|wscript\.exe)
- name: '[Sigma] Script Interpreter Execution From Suspicious Folder'
  tag: attack.execution,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Perflogs\\|:\\Users\\Public\\|\\AppData\\Local\\Temp|\\AppData\\Roaming\\Temp|\\Temporary\
    Internet|\\Windows\\Temp)
- name: '[Sigma] Script Interpreter Execution From Suspicious Folder'
  tag: attack.execution,attack.t1059
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains\|all':\ \[':\\\\Users\\\\',\ '\\\\Favorites\\\\'\]\}|\{'CommandLine\|contains\|all':\
    \[':\\\\Users\\\\',\ '\\\\Favourites\\\\'\]\}|\{'CommandLine\|contains\|all':\
    \[':\\\\Users\\\\',\ '\\\\Contacts\\\\'\]\})
- name: '[Sigma] Suspicious Script Execution From Temp Folder'
  tag: attack.execution,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\pwsh\.exe|\\mshta\.exe|\\wscript\.exe|\\cscript\.exe)$
- name: '[Sigma] Suspicious Script Execution From Temp Folder'
  tag: attack.execution,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\Windows\\Temp|\\Temporary\ Internet|\\AppData\\Local\\Temp|\\AppData\\Roaming\\Temp|%TEMP%|%TMP%|%LocalAppData%\\Temp)
- name: '[Sigma] Suspicious Script Execution From Temp Folder'
  tag: attack.execution,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ >|Out\-File|ConvertTo\-Json|\-WindowStyle\ hidden\ \-Verb\ runAs|\\Windows\\system32\\config\\systemprofile\\AppData\\Local\\Temp\\Amazon\\EC2\-Windows\\)
- name: '[Sigma] Sensitive File Access Via Volume Shadow Copy Backup'
  tag: attack.impact,attack.t1490
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\\\\\\\\\.\\\\GLOBALROOT\\\\Device\\\\HarddiskVolumeShadowCopy
- name: '[Sigma] Sensitive File Access Via Volume Shadow Copy Backup'
  tag: attack.impact,attack.t1490
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\\\NTDS\.dit|\\\\SYSTEM|\\\\SECURITY)
- name: '[Sigma] Suspicious New Service Creation'
  tag: attack.persistence,attack.privilege-escalation,attack.t1543.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\sc\.exe$
- name: '[Sigma] Suspicious New Service Creation'
  tag: attack.persistence,attack.privilege-escalation,attack.t1543.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(create|binPath=)
- name: '[Sigma] Suspicious New Service Creation'
  tag: attack.persistence,attack.privilege-escalation,attack.t1543.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(New\-Service|\-BinaryPathName)
- name: '[Sigma] Suspicious New Service Creation'
  tag: attack.persistence,attack.privilege-escalation,attack.t1543.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(powershell|mshta|wscript|cscript|svchost|dllhost|cmd\ |cmd\.exe\ /c|cmd\.exe\
    /k|cmd\.exe\ /r|rundll32|C:\\Users\\Public|\\Downloads\\|\\Desktop\\|\\Microsoft\\Windows\\Start\
    Menu\\Programs\\Startup\\|C:\\Windows\\TEMP\\|\\AppData\\Local\\Temp)
- name: '[Sigma] Suspicious Service Binary Directory'
  tag: attack.defense-evasion,attack.t1202
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\Users\\Public\\|\\\$Recycle\.bin|\\Users\\All\ Users\\|\\Users\\Default\\|\\Users\\Contacts\\|\\Users\\Searches\\|C:\\Perflogs\\|\\config\\systemprofile\\|\\Windows\\Fonts\\|\\Windows\\IME\\|\\Windows\\addins\\)
- name: '[Sigma] Suspicious Service Binary Directory'
  tag: attack.defense-evasion,attack.t1202
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\services\.exe|\\svchost\.exe)$
- name: '[Sigma] Suspicious Windows Service Tampering'
  tag: attack.defense-evasion,attack.impact,attack.t1489,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ \['net\.exe',\ 'net1\.exe',\ 'PowerShell_ISE\.EXE',\
    'PowerShell\.EXE',\ 'psservice\.exe',\ 'pwsh\.dll',\ 'sc\.exe',\ 'wmic\.exe'\]\}|\{'Image\|endswith':\
    \['\\\\net\.exe',\ '\\\\net1\.exe',\ '\\\\PowerShell_ISE\.EXE',\ '\\\\powershell\.exe',\
    '\\\\PsService\.exe',\ '\\\\PsService64\.exe',\ '\\\\pwsh\.exe',\ '\\\\sc\.exe',\
    '\\\\wmic\.exe'\]\})
- name: '[Sigma] Suspicious Windows Service Tampering'
  tag: attack.defense-evasion,attack.impact,attack.t1489,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains':\ \['\ delete\ ',\ '\.delete\(\)',\ '\ pause\
    ',\ '\ stop\ ',\ 'Stop\-Service\ ',\ 'Remove\-Service\ '\]\}|\{'CommandLine\|contains\|all':\
    \['config',\ 'start=disabled'\]\})
- name: '[Sigma] Suspicious Windows Service Tampering'
  tag: attack.defense-evasion,attack.impact,attack.t1489,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(143Svc|Acronis\ VSS\ Provider|AcronisAgent|AcrSch2Svc|AdobeARMservice|AHS\
    Service|Antivirus|Apache4|ARSM|aswBcc|AteraAgent|Avast\ Business\ Console\ Client\
    Antivirus\ Service|avast!\ Antivirus|AVG\ Antivirus|avgAdminClient|AvgAdminServer|AVP1|BackupExec|bedbg|BITS|BrokerInfrastructure|CASLicenceServer|CASWebServer|Client\
    Agent\ 7\.60|Core\ Browsing\ Protection|Core\ Mail\ Protection|Core\ Scanning\
    Server|DCAgent|dwmrcs|EhttpSr|ekrn|Enterprise\ Client\ Service|epag|EPIntegrationService|EPProtectedService|EPRedline|EPSecurityService|EPUpdateService|EraserSvc11710|EsgShKernel|ESHASRV|FA_Scheduler|FirebirdGuardianDefaultInstance|FirebirdServerDefaultInstance|FontCache3\.0\.0\.0|HealthTLService|hmpalertsvc|HMS|HostControllerService|hvdsvc|IAStorDataMgrSvc|IBMHPS|ibmspsvc|IISAdmin|IMANSVC|IMAP4Svc|instance2|KAVFS|KAVFSGT|kavfsslp|KeyIso|klbackupdisk|klbackupflt|klflt|klhk|KLIF|klim6|klkbdflt|klmouflt|klnagent|klpd|kltap|KSDE1\.0\.0|LogProcessorService|M8EndpointAgent|macmnsvc|masvc|MBAMService|MBCloudEA|MBEndpointAgent|McAfeeDLPAgentService|McAfeeEngineService|MCAFEEEVENTPARSERSRV|McAfeeFramework|MCAFEETOMCATSRV530|McShield|McTaskManager|mfefire|mfemms|mfevto|mfevtp|mfewc|MMS|mozyprobackup|mpssvc|MSComplianceAudit|MSDTC|MsDtsServer|MSExchange|msftesq1SPROO|msftesql\$PROD|msftesql\$SQLEXPRESS|MSOLAP\$SQL_2008|MSOLAP\$SYSTEM_BGC|MSOLAP\$TPS|MSOLAP\$TPSAMA|MSOLAPSTPS|MSOLAPSTPSAMA|mssecflt|MSSQ!I\.SPROFXENGAGEMEHT|MSSQ0SHAREPOINT|MSSQ0SOPHOS|MSSQL|MSSQLFDLauncher\$|MySQL|NanoServiceMain|NetMsmqActivator|NetPipeActivator|netprofm|NetTcpActivator|NetTcpPortSharing|ntrtscan|nvspwmi|ofcservice|Online\
    Protection\ System|OracleClientCache80|OracleDBConsole|OracleMTSRecoveryService|OracleOraDb11g_home1|OracleService|OracleVssWriter|osppsvc|PandaAetherAgent|PccNTUpd|PDVFSService|POP3Svc|postgresql\-x64\-9\.4|POVFSService|PSUAService|Quick\
    Update\ Service|RepairService|ReportServer|ReportServer\$|RESvc|RpcEptMapper|sacsvr|SamSs|SAVAdminService|SAVService|ScSecSvc|SDRSVC|SearchExchangeTracing|sense|SentinelAgent|SentinelHelperService|SepMasterService|ShMonitor|Smcinst|SmcService|SMTPSvc|SNAC|SntpService|Sophos|SQ1SafeOLRService|SQL\
    Backups|SQL\ Server|SQLAgent|SQLANYs_Sage_FAS_Fixed_Assets|SQLBrowser|SQLsafe|SQLSERVERAGENT|SQLTELEMETRY|SQLWriter|SSISTELEMETRY130|SstpSvc|storflt|svcGenericHost|swc_service|swi_filter|swi_service|swi_update|Symantec|sysmon|TeamViewer|Telemetryserver|ThreatLockerService|TMBMServer|TmCCSF|TmFilter|TMiCRCScanService|tmlisten|TMLWCSService|TmPfw|TmPreFilter|TmProxy|TMSmartRelayService|tmusa|Tomcat|Trend\
    Micro\ Deep\ Security\ Manager|TrueKey|UFNet|UI0Detect|UniFi|UTODetect|vds|Veeam|VeeamDeploySvc|Veritas\
    System\ Recovery|vmic|VMTools|vmvss|VSApiNt|VSS|W3Svc|wbengine|WdNisSvc|WeanClOudSve|Weems\
    JY|WinDefend|wmms|wozyprobackup|WPFFontCache_v0400|WRSVC|wsbexchange|WSearch|wscsvc|Zoolz\
    2\ Service)
- name: '[Sigma] Shadow Copies Creation Using Operating Systems Utilities'
  tag: attack.credential-access,attack.t1003,attack.t1003.002,attack.t1003.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe',\
    '\\\\wmic\.exe',\ '\\\\vssadmin\.exe'\]\}|\{'OriginalFileName':\ \['PowerShell\.EXE',\
    'pwsh\.dll',\ 'wmic\.exe',\ 'VSSADMIN\.EXE'\]\})
- name: '[Sigma] Shadow Copies Creation Using Operating Systems Utilities'
  tag: attack.credential-access,attack.t1003,attack.t1003.002,attack.t1003.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(shadow|create)
- name: '[Sigma] Shadow Copies Deletion Using Operating Systems Utilities'
  tag: attack.defense-evasion,attack.impact,attack.t1070,attack.t1490
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe',\
    '\\\\wmic\.exe',\ '\\\\vssadmin\.exe',\ '\\\\diskshadow\.exe'\]\}|\{'OriginalFileName':\
    \['PowerShell\.EXE',\ 'pwsh\.dll',\ 'wmic\.exe',\ 'VSSADMIN\.EXE',\ 'diskshadow\.exe'\]\})
- name: '[Sigma] Shadow Copies Deletion Using Operating Systems Utilities'
  tag: attack.defense-evasion,attack.impact,attack.t1070,attack.t1490
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(shadow|delete)
- name: '[Sigma] Shadow Copies Deletion Using Operating Systems Utilities'
  tag: attack.defense-evasion,attack.impact,attack.t1070,attack.t1490
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\wbadmin\.exe'\}|\{'OriginalFileName':\
    'WBADMIN\.EXE'\})
- name: '[Sigma] Shadow Copies Deletion Using Operating Systems Utilities'
  tag: attack.defense-evasion,attack.impact,attack.t1070,attack.t1490
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(delete|catalog|quiet)
- name: '[Sigma] Shadow Copies Deletion Using Operating Systems Utilities'
  tag: attack.defense-evasion,attack.impact,attack.t1070,attack.t1490
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\vssadmin\.exe'\}|\{'OriginalFileName':\
    'VSSADMIN\.EXE'\})
- name: '[Sigma] Shadow Copies Deletion Using Operating Systems Utilities'
  tag: attack.defense-evasion,attack.impact,attack.t1070,attack.t1490
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(resize|shadowstorage)
- name: '[Sigma] Shadow Copies Deletion Using Operating Systems Utilities'
  tag: attack.defense-evasion,attack.impact,attack.t1070,attack.t1490
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(unbounded|/MaxSize=)
- name: '[Sigma] Windows Shell/Scripting Processes Spawning Suspicious Programs'
  tag: attack.execution,attack.defense-evasion,attack.t1059.005,attack.t1059.001,attack.t1218
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\mshta\.exe|\\powershell\.exe|\\pwsh\.exe|\\rundll32\.exe|\\cscript\.exe|\\wscript\.exe|\\wmiprvse\.exe|\\regsvr32\.exe)$
- name: '[Sigma] Windows Shell/Scripting Processes Spawning Suspicious Programs'
  tag: attack.execution,attack.defense-evasion,attack.t1059.005,attack.t1059.001,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\schtasks\.exe|\\nslookup\.exe|\\certutil\.exe|\\bitsadmin\.exe|\\mshta\.exe)$
- name: '[Sigma] Windows Shell/Scripting Processes Spawning Suspicious Programs'
  tag: attack.execution,attack.defense-evasion,attack.t1059.005,attack.t1059.001,attack.t1218
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\ccmcache\\
- name: '[Sigma] Windows Shell/Scripting Processes Spawning Suspicious Programs'
  tag: attack.execution,attack.defense-evasion,attack.t1059.005,attack.t1059.001,attack.t1218
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Program\ Files\\Amazon\\WorkSpacesConfig\\Scripts\\setup\-scheduledtask\.ps1|\\Program\
    Files\\Amazon\\WorkSpacesConfig\\Scripts\\set\-selfhealing\.ps1|\\Program\ Files\\Amazon\\WorkSpacesConfig\\Scripts\\check\-workspacehealth\.ps1|\\nessus_)
- name: '[Sigma] Windows Shell/Scripting Processes Spawning Suspicious Programs'
  tag: attack.execution,attack.defense-evasion,attack.t1059.005,attack.t1059.001,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\nessus_
- name: '[Sigma] Windows Shell/Scripting Processes Spawning Suspicious Programs'
  tag: attack.execution,attack.defense-evasion,attack.t1059.005,attack.t1059.001,attack.t1218
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\mshta\.exe$
- name: '[Sigma] Windows Shell/Scripting Processes Spawning Suspicious Programs'
  tag: attack.execution,attack.defense-evasion,attack.t1059.005,attack.t1059.001,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\mshta\.exe$
- name: '[Sigma] Windows Shell/Scripting Processes Spawning Suspicious Programs'
  tag: attack.execution,attack.defense-evasion,attack.t1059.005,attack.t1059.001,attack.t1218
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(C:\\MEM_Configmgr_|\\splash\.hta|\{1E460BD7\-F1C3\-4B2E\-88BF\-4E770A288AF5\})
- name: '[Sigma] Windows Shell/Scripting Processes Spawning Suspicious Programs'
  tag: attack.execution,attack.defense-evasion,attack.t1059.005,attack.t1059.001,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\MEM_Configmgr_|\\SMSSETUP\\BIN\\|\\autorun\.hta|\{1E460BD7\-F1C3\-4B2E\-88BF\-4E770A288AF5\})
- name: '[Sigma] Process Creation Using Sysnative Folder'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1055
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains':\ ':\\\\Windows\\\\Sysnative\\\\'\}|\{'Image\|contains':\
    ':\\\\Windows\\\\Sysnative\\\\'\})
- name: '[Sigma] Process Creation Using Sysnative Folder'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1055
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Windows\\Microsoft\.NET\\Framework64\\v|C:\\Windows\\Microsoft\.NET\\Framework\\v|C:\\Windows\\Microsoft\.NET\\FrameworkArm\\v|C:\\Windows\\Microsoft\.NET\\FrameworkArm64\\v)
- name: '[Sigma] Process Creation Using Sysnative Folder'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1055
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\ngen\.exe$
- name: '[Sigma] Process Creation Using Sysnative Folder'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1055
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)install
- name: '[Sigma] Process Creation Using Sysnative Folder'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1055
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)("C:\\Windows\\sysnative\\cmd\.exe"|\\xampp\\|\\catalina_start\.bat)
- name: '[Sigma] System File Execution Location Anomaly'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\atbroker\.exe|\\audiodg\.exe|\\bcdedit\.exe|\\bitsadmin\.exe|\\certreq\.exe|\\certutil\.exe|\\cmstp\.exe|\\conhost\.exe|\\consent\.exe|\\cscript\.exe|\\csrss\.exe|\\dashost\.exe|\\defrag\.exe|\\dfrgui\.exe|\\dism\.exe|\\dllhost\.exe|\\dllhst3g\.exe|\\dwm\.exe|\\eventvwr\.exe|\\logonui\.exe|\\LsaIso\.exe|\\lsass\.exe|\\lsm\.exe|\\msiexec\.exe|\\ntoskrnl\.exe|\\powershell_ise\.exe|\\powershell\.exe|\\pwsh\.exe|\\regsvr32\.exe|\\rundll32\.exe|\\runonce\.exe|\\RuntimeBroker\.exe|\\schtasks\.exe|\\services\.exe|\\sihost\.exe|\\smartscreen\.exe|\\smss\.exe|\\spoolsv\.exe|\\svchost\.exe|\\taskhost\.exe|\\taskhostw\.exe|\\Taskmgr\.exe|\\userinit\.exe|\\werfault\.exe|\\werfaultsecure\.exe|\\wininit\.exe|\\winlogon\.exe|\\winver\.exe|\\wlanext\.exe|\\wscript\.exe|\\wsl\.exe|\\wsmprovhost\.exe)$
- name: '[Sigma] System File Execution Location Anomaly'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^(C:\\\$WINDOWS\.\~BT\\|C:\\\$WinREAgent\\|C:\\Windows\\SoftwareDistribution\\|C:\\Windows\\System32\\|C:\\Windows\\SystemTemp\\|C:\\Windows\\SysWOW64\\|C:\\Windows\\uus\\|C:\\Windows\\WinSxS\\)
- name: '[Sigma] System File Execution Location Anomaly'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\SystemRoot\\System32\\
- name: '[Sigma] System File Execution Location Anomaly'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\\PowerShell\\7\\|C:\\Program\ Files\\PowerShell\\7\-preview\\|C:\\Program\
    Files\\WindowsApps\\Microsoft\.PowerShellPreview|\\AppData\\Local\\Microsoft\\WindowsApps\\Microsoft\.PowerShellPreview)
- name: '[Sigma] System File Execution Location Anomaly'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\pwsh\.exe$
- name: '[Sigma] System File Execution Location Anomaly'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^(C:\\Program\ Files\\WindowsApps\\MicrosoftCorporationII\.WindowsSubsystemForLinux|C:\\Program\
    Files\\WSL\\)
- name: '[Sigma] System File Execution Location Anomaly'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\wsl\.exe$
- name: '[Sigma] System File Execution Location Anomaly'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^C:\\Users\\'
- name: '[Sigma] System File Execution Location Anomaly'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\AppData\\Local\\Microsoft\\WindowsApps\\
- name: '[Sigma] System File Execution Location Anomaly'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\wsl\.exe$
- name: '[Sigma] Suspicious SYSTEM User Process Creation'
  tag: attack.credential-access,attack.defense-evasion,attack.privilege-escalation,attack.t1134,attack.t1003,attack.t1027
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(System|S\-1\-16\-16384)
- name: '[Sigma] Suspicious SYSTEM User Process Creation'
  tag: attack.credential-access,attack.defense-evasion,attack.privilege-escalation,attack.t1134,attack.t1003,attack.t1027
  score: 80
  target: User
  condition: regex
  pattern: (?i)(AUTHORI|AUTORI)
- name: '[Sigma] Suspicious SYSTEM User Process Creation'
  tag: attack.credential-access,attack.defense-evasion,attack.privilege-escalation,attack.t1134,attack.t1003,attack.t1027
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\calc\.exe',\ '\\\\cscript\.exe',\ '\\\\forfiles\.exe',\
    '\\\\hh\.exe',\ '\\\\mshta\.exe',\ '\\\\ping\.exe',\ '\\\\wscript\.exe'\]\}|\{'CommandLine\|re':\
    'net\\\\s\+user\\\\s\+'\}|\{'CommandLine\|contains':\ \['\ \-NoP\ ',\ '\ \-W\
    Hidden\ ',\ '\ \-decode\ ',\ '\ /decode\ ',\ '\ /urlcache\ ',\ '\ \-urlcache\
    ',\ '\ \-e.*\ JAB',\ '\ \-e.*\ SUVYI',\ '\ \-e.*\ SQBFAFgA',\ '\ \-e.*\ aWV4I',\
    '\ \-e.*\ IAB',\ '\ \-e.*\ PAA',\ '\ \-e.*\ aQBlAHgA',\ 'vssadmin\ delete\ shadows',\
    'reg\ SAVE\ HKLM',\ '\ \-ma\ ',\ 'Microsoft\\\\Windows\\\\CurrentVersion\\\\Run',\
    '\.downloadstring\(',\ '\.downloadfile\(',\ '\ /ticket:',\ 'dpapi::',\ 'event::clear',\
    'event::drop',\ 'id::modify',\ 'kerberos::',\ 'lsadump::',\ 'misc::',\ 'privilege::',\
    'rpc::',\ 'sekurlsa::',\ 'sid::',\ 'token::',\ 'vault::cred',\ 'vault::list',\
    '\ p::d\ ',\ ';iex\(',\ 'MiniDump'\]\})
- name: '[Sigma] Suspicious SYSTEM User Process Creation'
  tag: attack.credential-access,attack.defense-evasion,attack.privilege-escalation,attack.t1134,attack.t1003,attack.t1027
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(ping|127\.0\.0\.1|\ \-n\ )
- name: '[Sigma] Suspicious SYSTEM User Process Creation'
  tag: attack.credential-access,attack.defense-evasion,attack.privilege-escalation,attack.t1134,attack.t1003,attack.t1027
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\PING\.EXE$
- name: '[Sigma] Suspicious SYSTEM User Process Creation'
  tag: attack.credential-access,attack.defense-evasion,attack.privilege-escalation,attack.t1134,attack.t1003,attack.t1027
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\DismFoDInstall\.cmd
- name: '[Sigma] Suspicious SYSTEM User Process Creation'
  tag: attack.credential-access,attack.defense-evasion,attack.privilege-escalation,attack.t1134,attack.t1003,attack.t1027
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i):\\Packages\\Plugins\\Microsoft\.GuestConfiguration\.ConfigurationforWindows\\
- name: '[Sigma] Suspicious SYSTEM User Process Creation'
  tag: attack.credential-access,attack.defense-evasion,attack.privilege-escalation,attack.t1134,attack.t1003,attack.t1027
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(:\\Program\ Files\ \(x86\)\\Java\\|:\\Program\ Files\\Java\\)
- name: '[Sigma] Suspicious SYSTEM User Process Creation'
  tag: attack.credential-access,attack.defense-evasion,attack.privilege-escalation,attack.t1134,attack.t1003,attack.t1027
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\bin\\javaws\.exe$
- name: '[Sigma] Suspicious SYSTEM User Process Creation'
  tag: attack.credential-access,attack.defense-evasion,attack.privilege-escalation,attack.t1134,attack.t1003,attack.t1027
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Program\ Files\ \(x86\)\\Java\\|:\\Program\ Files\\Java\\)
- name: '[Sigma] Suspicious SYSTEM User Process Creation'
  tag: attack.credential-access,attack.defense-evasion,attack.privilege-escalation,attack.t1134,attack.t1003,attack.t1027
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\bin\\jp2launcher\.exe$
- name: '[Sigma] Suspicious SYSTEM User Process Creation'
  tag: attack.credential-access,attack.defense-evasion,attack.privilege-escalation,attack.t1134,attack.t1003,attack.t1027
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-ma\ '
- name: '[Sigma] Suspicious SYSVOL Domain Group Policy Access'
  tag: attack.credential-access,attack.t1552.006
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\SYSVOL\\|\\policies\\)
- name: '[Sigma] Tasks Folder Evasion'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.persistence,attack.execution,attack.t1574.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(echo\ |copy\ |type\ |file\ createnew)
- name: '[Sigma] Tasks Folder Evasion'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.persistence,attack.execution,attack.t1574.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ C:\\Windows\\System32\\Tasks\\|\ C:\\Windows\\SysWow64\\Tasks\\)
- name: '[Sigma] Suspicious Userinit Child Process'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1055
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\userinit\.exe$
- name: '[Sigma] Suspicious Userinit Child Process'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1055
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\netlogon\\
- name: '[Sigma] Suspicious Userinit Child Process'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1055
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\explorer\.exe'\}|\{'OriginalFileName':\
    'explorer\.exe'\}|\{'CommandLine':\ 'C:\\\\Windows\\\\Explorer\.EXE'\})
- name: '[Sigma] Suspicious Userinit Child Process'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1055
  score: 50
  target: Target_Path
  condition: regex
  pattern: None
- name: '[Sigma] Malicious Windows Script Components File Execution by TAEF Detection'
  tag: attack.defense-evasion,attack.t1218
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\te\.exe'\}|\{'ParentImage\|endswith':\
    '\\\\te\.exe'\}|\{'OriginalFileName':\ '\\\\te\.exe'\})
- name: '[Sigma] Malicious PE Execution by Microsoft Visual Studio Debugger'
  tag: attack.t1218,attack.defense-evasion
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\vsjitdebugger\.exe$
- name: '[Sigma] Malicious PE Execution by Microsoft Visual Studio Debugger'
  tag: attack.t1218,attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\vsimmersiveactivatehelper.*\.exe$
- name: '[Sigma] Malicious PE Execution by Microsoft Visual Studio Debugger'
  tag: attack.t1218,attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\devenv\.exe$
- name: '[Sigma] Weak or Abused Passwords In CLI'
  tag: attack.defense-evasion,attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(123456789|123123qwE|Asd123\.aaaa|Decryptme|P@ssw0rd!|Pass8080|password123|test@202)
- name: '[Sigma] Usage Of Web Request Commands And Cmdlets'
  tag: attack.execution,attack.t1059.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\[System\.Net\.WebRequest\]::create|curl\ |Invoke\-RestMethod|Invoke\-WebRequest|\
    irm\ |iwr\ |Resume\-BitsTransfer|Start\-BitsTransfer|wget\ |WinHttp\.WinHttpRequest)
- name: '[Sigma] WhoAmI as Parameter'
  tag: attack.discovery,attack.t1033,car.2016-03-001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\.exe\ whoami
- name: '[Sigma] Execution via WorkFolders.exe'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\control\.exe$
- name: '[Sigma] Execution via WorkFolders.exe'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\WorkFolders\.exe$
- name: '[Sigma] Execution via WorkFolders.exe'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\control\.exe
- name: '[Sigma] Suspect Svchost Activity'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1055
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)svchost\.exe$
- name: '[Sigma] Suspect Svchost Activity'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1055
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\svchost\.exe$
- name: '[Sigma] Suspect Svchost Activity'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1055
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'ParentImage\|endswith':\ \['\\\\rpcnet\.exe',\ '\\\\rpcnetp\.exe'\]\}|\{'CommandLine':\
    None\})
- name: '[Sigma] Suspicious Process Masquerading As SvcHost.EXE'
  tag: attack.defense-evasion,attack.t1036.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\svchost\.exe$
- name: '[Sigma] Suspicious Process Masquerading As SvcHost.EXE'
  tag: attack.defense-evasion,attack.t1036.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Windows\\System32\\svchost\.exe|C:\\Windows\\SysWOW64\\svchost\.exe)
- name: '[Sigma] Suspicious Process Masquerading As SvcHost.EXE'
  tag: attack.defense-evasion,attack.t1036.005
  score: 80
  target: FileName
  condition: regex
  pattern: (?i)svchost\.exe
- name: '[Sigma] Terminal Service Process Spawn'
  tag: attack.initial-access,attack.t1190,attack.lateral-movement,attack.t1210,car.2013-07-002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\svchost\.exe|termsvcs)
- name: '[Sigma] Terminal Service Process Spawn'
  tag: attack.initial-access,attack.t1190,attack.lateral-movement,attack.t1210,car.2013-07-002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\rdpclip\.exe|:\\Windows\\System32\\csrss\.exe|:\\Windows\\System32\\wininit\.exe|:\\Windows\\System32\\winlogon\.exe)$
- name: '[Sigma] Terminal Service Process Spawn'
  tag: attack.initial-access,attack.t1190,attack.lateral-movement,attack.t1210,car.2013-07-002
  score: 80
  target: Target_Path
  condition: regex
  pattern: None
- name: '[Sigma] Uncommon Svchost Parent Process'
  tag: attack.defense-evasion,attack.t1036.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\svchost\.exe$
- name: '[Sigma] Uncommon Svchost Parent Process'
  tag: attack.defense-evasion,attack.t1036.005
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(\\Mrt\.exe|\\MsMpEng\.exe|\\ngen\.exe|\\rpcnet\.exe|\\services\.exe|\\TiWorker\.exe)$
- name: '[Sigma] Uncommon Svchost Parent Process'
  tag: attack.defense-evasion,attack.t1036.005
  score: 50
  target: ParentPath
  condition: regex
  pattern: None
- name: '[Sigma] Uncommon Svchost Parent Process'
  tag: attack.defense-evasion,attack.t1036.005
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(\-|)
- name: '[Sigma] Permission Check Via Accesschk.EXE'
  tag: attack.discovery,attack.t1069.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Product\|endswith':\ 'AccessChk'\}|\{'Description\|contains':\
    'Reports\ effective\ permissions'\}|\{'Image\|endswith':\ \['\\\\accesschk\.exe',\
    '\\\\accesschk64\.exe'\]\}|\{'OriginalFileName':\ 'accesschk\.exe'\})
- name: '[Sigma] Permission Check Via Accesschk.EXE'
  tag: attack.discovery,attack.t1069.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(uwcqv\ |kwsu\ |qwsu\ |uwdqs\ )
- name: '[Sigma] Active Directory Database Snapshot Via ADExplorer'
  tag: attack.discovery,attack.t1087.002,attack.t1069.002,attack.t1482
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\ADExp\.exe',\ '\\\\ADExplorer\.exe',\
    '\\\\ADExplorer64\.exe',\ '\\\\ADExplorer64a\.exe'\]\}|\{'OriginalFileName':\
    'AdExp'\}|\{'Description':\ 'Active\ Directory\ Editor'\}|\{'Product':\ 'Sysinternals\
    ADExplorer'\})
- name: '[Sigma] Active Directory Database Snapshot Via ADExplorer'
  tag: attack.discovery,attack.t1087.002,attack.t1069.002,attack.t1482
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)snapshot
- name: '[Sigma] Suspicious Active Directory Database Snapshot Via ADExplorer'
  tag: attack.discovery,attack.t1087.002,attack.t1069.002,attack.t1482
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\ADExp\.exe',\ '\\\\ADExplorer\.exe',\
    '\\\\ADExplorer64\.exe',\ '\\\\ADExplorer64a\.exe'\]\}|\{'OriginalFileName':\
    'AdExp'\}|\{'Description':\ 'Active\ Directory\ Editor'\}|\{'Product':\ 'Sysinternals\
    ADExplorer'\})
- name: '[Sigma] Suspicious Active Directory Database Snapshot Via ADExplorer'
  tag: attack.discovery,attack.t1087.002,attack.t1069.002,attack.t1482
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)snapshot
- name: '[Sigma] Suspicious Active Directory Database Snapshot Via ADExplorer'
  tag: attack.discovery,attack.t1087.002,attack.t1069.002,attack.t1482
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\Downloads\\|\\Users\\Public\\|\\AppData\\|\\Windows\\Temp\\)
- name: '[Sigma] Potential Execution of Sysinternals Tools'
  tag: attack.resource-development,attack.t1588.002
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-accepteula
- name: '[Sigma] Potential Memory Dumping Activity Via LiveKD'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\livekd\.exe',\ '\\\\livekd64\.exe'\]\}|\{'OriginalFileName':\
    'livekd\.exe'\})
- name: '[Sigma] Kernel Memory Dump Via LiveKD'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\livekd\.exe',\ '\\\\livekd64\.exe'\]\}|\{'OriginalFileName':\
    'livekd\.exe'\})
- name: '[Sigma] Kernel Memory Dump Via LiveKD'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-m
- name: '[Sigma] Procdump Execution'
  tag: attack.defense-evasion,attack.t1036,attack.t1003.001,attack.credential-access
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\procdump\.exe|\\procdump64\.exe)$
- name: '[Sigma] Potential SysInternals ProcDump Evasion'
  tag: attack.defense-evasion,attack.t1036,attack.t1003.001,attack.credential-access
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(copy\ procdump|move\ procdump)
- name: '[Sigma] Potential SysInternals ProcDump Evasion'
  tag: attack.defense-evasion,attack.t1036,attack.t1003.001,attack.credential-access
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(copy\ |\.dmp\ )
- name: '[Sigma] Potential SysInternals ProcDump Evasion'
  tag: attack.defense-evasion,attack.t1036,attack.t1003.001,attack.credential-access
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(2\.dmp|lsass|out\.dmp)
- name: '[Sigma] Potential SysInternals ProcDump Evasion'
  tag: attack.defense-evasion,attack.t1036,attack.t1003.001,attack.credential-access
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(copy\ lsass\.exe_|move\ lsass\.exe_)
- name: '[Sigma] Potential LSASS Process Dump Via Procdump'
  tag: attack.defense-evasion,attack.t1036,attack.credential-access,attack.t1003.001,car.2013-05-009
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-ma\ |\ \-mm\ |\ \-mp\ )
- name: '[Sigma] Potential LSASS Process Dump Via Procdump'
  tag: attack.defense-evasion,attack.t1036,attack.credential-access,attack.t1003.001,car.2013-05-009
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ ls|\ keyiso|\ samss)
- name: '[Sigma] Psexec Execution'
  tag: attack.execution,attack.lateral-movement,attack.t1569,attack.t1021
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\psexec\.exe'\}|\{'OriginalFileName':\ 'psexec\.c'\})
- name: '[Sigma] PsExec/PAExec Escalation to LOCAL SYSTEM'
  tag: attack.resource-development,attack.t1587.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-s\ cmd|\ \-s\ \-i\ cmd|\ \-i\ \-s\ cmd|\ \-s\ pwsh|\ \-s\ \-i\
    pwsh|\ \-i\ \-s\ pwsh|\ \-s\ powershell|\ \-s\ \-i\ powershell|\ \-i\ \-s\ powershell)
- name: '[Sigma] PsExec/PAExec Escalation to LOCAL SYSTEM'
  tag: attack.resource-development,attack.t1587.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(psexec|paexec|accepteula)
- name: '[Sigma] Potential PsExec Remote Execution'
  tag: attack.resource-development,attack.t1587.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(accepteula|\ \-u\ |\ \-p\ |\ \\\\\\\\)
- name: '[Sigma] Potential PsExec Remote Execution'
  tag: attack.resource-development,attack.t1587.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\\\\\\\localhost|\\\\\\\\127\.)
- name: '[Sigma] PsExec Service Execution'
  tag: attack.execution
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image':\ 'C:\\\\Windows\\\\PSEXESVC\.exe'\}|\{'OriginalFileName':\
    'psexesvc\.exe'\})
- name: '[Sigma] PsExec Service Child Process Execution as LOCAL SYSTEM'
  tag: attack.execution
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Windows\\PSEXESVC\.exe
- name: '[Sigma] PsExec Service Child Process Execution as LOCAL SYSTEM'
  tag: attack.execution
  score: 80
  target: User
  condition: regex
  pattern: (?i)(AUTHORI|AUTORI)
- name: '[Sigma] Suspicious Use of PsLogList'
  tag: attack.discovery,attack.t1087,attack.t1087.001,attack.t1087.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'psloglist\.exe'\}|\{'Image\|endswith':\ \['\\\\psloglist\.exe',\
    '\\\\psloglist64\.exe'\]\})
- name: '[Sigma] Suspicious Use of PsLogList'
  tag: attack.discovery,attack.t1087,attack.t1087.001,attack.t1087.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ security|\ application|\ system)
- name: '[Sigma] Suspicious Use of PsLogList'
  tag: attack.discovery,attack.t1087,attack.t1087.001,attack.t1087.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-d|\ \-x|\ \-s|\ \-c|\ \-g)
- name: '[Sigma] Sysinternals PsService Execution'
  tag: attack.privilege-escalation,attack.discovery,attack.persistence,attack.t1543.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'psservice\.exe'\}|\{'Image\|endswith':\ \['\\\\PsService\.exe',\
    '\\\\PsService64\.exe'\]\})
- name: '[Sigma] Sysinternals PsSuspend Execution'
  tag: attack.privilege-escalation,attack.discovery,attack.persistence,attack.t1543.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'pssuspend\.exe'\}|\{'Image\|endswith':\ \['\\\\pssuspend\.exe',\
    '\\\\pssuspend64\.exe'\]\})
- name: '[Sigma] Sysinternals PsSuspend Suspicious Execution'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'pssuspend\.exe'\}|\{'Image\|endswith':\ \['\\\\pssuspend\.exe',\
    '\\\\pssuspend64\.exe'\]\})
- name: '[Sigma] Sysinternals PsSuspend Suspicious Execution'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)msmpeng\.exe
- name: '[Sigma] Potential File Overwrite Via Sysinternals SDelete'
  tag: attack.impact,attack.t1485
  score: 80
  target: FileName
  condition: regex
  pattern: (?i)sdelete\.exe
- name: '[Sigma] Potential File Overwrite Via Sysinternals SDelete'
  tag: attack.impact,attack.t1485
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-h|\ \-c|\ \-z|\ /\\.)
- name: '[Sigma] Potential Privilege Escalation To LOCAL SYSTEM'
  tag: attack.resource-development,attack.t1587.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-s\ cmd|\ \-s\ \-i\ cmd|\ \-i\ \-s\ cmd|\ \-s\ pwsh|\ \-s\ \-i\
    pwsh|\ \-i\ \-s\ pwsh|\ \-s\ powershell|\ \-s\ \-i\ powershell|\ \-i\ \-s\ powershell)
- name: '[Sigma] Potential Privilege Escalation To LOCAL SYSTEM'
  tag: attack.resource-development,attack.t1587.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(paexec|PsExec|accepteula)
- name: '[Sigma] Sysmon Configuration Update'
  tag: attack.defense-evasion,attack.t1562.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\Sysmon64\.exe',\ '\\\\Sysmon\.exe'\]\}|\{'Description':\
    'System\ activity\ monitor'\})
- name: '[Sigma] Sysmon Configuration Update'
  tag: attack.defense-evasion,attack.t1562.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\-c
- name: '[Sigma] Uninstall Sysinternals Sysmon'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\Sysmon64\.exe',\ '\\\\Sysmon\.exe'\]\}|\{'Description':\
    'System\ activity\ monitor'\})
- name: '[Sigma] Uninstall Sysinternals Sysmon'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\-u
- name: '[Sigma] Potential Binary Impersonating Sysinternals Tools'
  tag: attack.execution,attack.defense-evasion,attack.t1218,attack.t1202,attack.t1036.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\accesschk\.exe|\\accesschk64\.exe|\\AccessEnum\.exe|\\ADExplorer\.exe|\\ADExplorer64\.exe|\\ADInsight\.exe|\\ADInsight64\.exe|\\adrestore\.exe|\\adrestore64\.exe|\\Autologon\.exe|\\Autologon64\.exe|\\Autoruns\.exe|\\Autoruns64\.exe|\\autorunsc\.exe|\\autorunsc64\.exe|\\Bginfo\.exe|\\Bginfo64\.exe|\\Cacheset\.exe|\\Cacheset64\.exe|\\Clockres\.exe|\\Clockres64\.exe|\\Contig\.exe|\\Contig64\.exe|\\Coreinfo\.exe|\\Coreinfo64\.exe|\\CPUSTRES\.EXE|\\CPUSTRES64\.EXE|\\ctrl2cap\.exe|\\Dbgview\.exe|\\dbgview64\.exe|\\Desktops\.exe|\\Desktops64\.exe|\\disk2vhd\.exe|\\disk2vhd64\.exe|\\diskext\.exe|\\diskext64\.exe|\\Diskmon\.exe|\\Diskmon64\.exe|\\DiskView\.exe|\\DiskView64\.exe|\\du\.exe|\\du64\.exe|\\efsdump\.exe|\\FindLinks\.exe|\\FindLinks64\.exe|\\handle\.exe|\\handle64\.exe|\\hex2dec\.exe|\\hex2dec64\.exe|\\junction\.exe|\\junction64\.exe|\\ldmdump\.exe|\\listdlls\.exe|\\listdlls64\.exe|\\livekd\.exe|\\livekd64\.exe|\\loadOrd\.exe|\\loadOrd64\.exe|\\loadOrdC\.exe|\\loadOrdC64\.exe|\\logonsessions\.exe|\\logonsessions64\.exe|\\movefile\.exe|\\movefile64\.exe|\\notmyfault\.exe|\\notmyfault64\.exe|\\notmyfaultc\.exe|\\notmyfaultc64\.exe|\\ntfsinfo\.exe|\\ntfsinfo64\.exe|\\pendmoves\.exe|\\pendmoves64\.exe|\\pipelist\.exe|\\pipelist64\.exe|\\portmon\.exe|\\procdump\.exe|\\procdump64\.exe|\\procexp\.exe|\\procexp64\.exe|\\Procmon\.exe|\\Procmon64\.exe|\\psExec\.exe|\\psExec64\.exe|\\psfile\.exe|\\psfile64\.exe|\\psGetsid\.exe|\\psGetsid64\.exe|\\psInfo\.exe|\\psInfo64\.exe|\\pskill\.exe|\\pskill64\.exe|\\pslist\.exe|\\pslist64\.exe|\\psLoggedon\.exe|\\psLoggedon64\.exe|\\psloglist\.exe|\\psloglist64\.exe|\\pspasswd\.exe|\\pspasswd64\.exe|\\psping\.exe|\\psping64\.exe|\\psService\.exe|\\psService64\.exe|\\psshutdown\.exe|\\psshutdown64\.exe|\\pssuspend\.exe|\\pssuspend64\.exe|\\RAMMap\.exe|\\RAMMap64\.exe|\\RDCMan\.exe|\\RegDelNull\.exe|\\RegDelNull64\.exe|\\regjump\.exe|\\ru\.exe|\\ru64\.exe|\\sdelete\.exe|\\sdelete64\.exe|\\ShareEnum\.exe|\\ShareEnum64\.exe|\\shellRunas\.exe|\\sigcheck\.exe|\\sigcheck64\.exe|\\streams\.exe|\\streams64\.exe|\\strings\.exe|\\strings64\.exe|\\sync\.exe|\\sync64\.exe|\\Sysmon\.exe|\\Sysmon64\.exe|\\tcpvcon\.exe|\\tcpvcon64\.exe|\\tcpview\.exe|\\tcpview64\.exe|\\Testlimit\.exe|\\Testlimit64\.exe|\\vmmap\.exe|\\vmmap64\.exe|\\Volumeid\.exe|\\Volumeid64\.exe|\\whois\.exe|\\whois64\.exe|\\Winobj\.exe|\\Winobj64\.exe|\\ZoomIt\.exe|\\ZoomIt64\.exe)$
- name: '[Sigma] Potential Binary Impersonating Sysinternals Tools'
  tag: attack.execution,attack.defense-evasion,attack.t1218,attack.t1202,attack.t1036.005
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\accesschk64a\.exe|\\ADExplorer64a\.exe|\\ADInsight64a\.exe|\\adrestore64a\.exe|\\Autologon64a\.exe|\\Autoruns64a\.exe|\\autorunsc64a\.exe|\\Clockres64a\.exe|\\Contig64a\.exe|\\Coreinfo64a\.exe|\\Dbgview64a\.exe|\\disk2vhd64a\.exe|\\diskext64a\.exe|\\DiskView64a\.exe|\\du64a\.exe|\\FindLinks64a\.exe|\\handle64a\.exe|\\hex2dec64a\.exe|\\junction64a\.exe|\\LoadOrd64a\.exe|\\LoadOrdC64a\.exe|\\logonsessions64a\.exe|\\movefile64a\.exe|\\notmyfault64a\.exe|\\notmyfaultc64a\.exe|\\pendmoves64a\.exe|\\pipelist64a\.exe|\\procdump64a\.exe|\\procexp64a\.exe|\\Procmon64a\.exe|\\PsExec64a\.exe|\\psfile64a\.exe|\\PsGetsid64a\.exe|\\PsInfo64a\.exe|\\pskill64a\.exe|\\psloglist64a\.exe|\\pspasswd64a\.exe|\\psping64a\.exe|\\PsService64a\.exe|\\pssuspend64a\.exe|\\RAMMap64a\.exe|\\RegDelNull64a\.exe|\\ru64a\.exe|\\sdelete64a\.exe|\\sigcheck64a\.exe|\\streams64a\.exe|\\strings64a\.exe|\\sync64a\.exe|\\Sysmon64a\.exe|\\tcpvcon64a\.exe|\\tcpview64a\.exe|\\vmmap64a\.exe|\\whois64a\.exe|\\Winobj64a\.exe|\\ZoomIt64a\.exe)$
- name: '[Sigma] Potential Binary Impersonating Sysinternals Tools'
  tag: attack.execution,attack.defense-evasion,attack.t1218,attack.t1202,attack.t1036.005
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Company':\ \['Sysinternals\ \-\ www\.sysinternals\.com',\ 'Sysinternals'\]\}|\{'Product\|startswith':\
    'Sysinternals'\})
- name: '[Sigma] Potential Binary Impersonating Sysinternals Tools'
  tag: attack.execution,attack.defense-evasion,attack.t1218,attack.t1202,attack.t1036.005
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Company':\ None\}|\{'Product':\ None\})
- name: '[Sigma] Sysprep on AppData Folder'
  tag: attack.execution,attack.t1059
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\sysprep\.exe$
- name: '[Sigma] Sysprep on AppData Folder'
  tag: attack.execution,attack.t1059
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\AppData\\
- name: '[Sigma] Suspicious Execution of Systeminfo'
  tag: attack.discovery,attack.t1082
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\systeminfo\.exe'\}|\{'OriginalFileName':\
    'sysinfo\.exe'\})
- name: '[Sigma] Potential Signing Bypass Via Windows Developer Features'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\SystemSettingsAdminFlows\.exe'\}|\{'OriginalFileName':\
    'SystemSettingsAdminFlows\.EXE'\})
- name: '[Sigma] Potential Signing Bypass Via Windows Developer Features'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)TurnOnDeveloperFeatures
- name: '[Sigma] Potential Signing Bypass Via Windows Developer Features'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(DeveloperUnlock|EnableSideloading)
- name: '[Sigma] Suspicious Recursive Takeown'
  tag: attack.defense-evasion,attack.t1222.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\takeown\.exe$
- name: '[Sigma] Suspicious Recursive Takeown'
  tag: attack.defense-evasion,attack.t1222.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/f\ |/r)
- name: '[Sigma] Tap Installer Execution'
  tag: attack.exfiltration,attack.t1048
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\tapinstall\.exe$
- name: '[Sigma] Tap Installer Execution'
  tag: attack.exfiltration,attack.t1048
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Program\ Files\\Avast\ Software\\SecureLine\ VPN\\|:\\Program\
    Files\ \(x86\)\\Avast\ Software\\SecureLine\ VPN\\)
- name: '[Sigma] Tap Installer Execution'
  tag: attack.exfiltration,attack.t1048
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i):\\Program\ Files\\OpenVPN\ Connect\\drivers\\tap\\
- name: '[Sigma] Tap Installer Execution'
  tag: attack.exfiltration,attack.t1048
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i):\\Program\ Files\ \(x86\)\\Proton\ Technologies\\ProtonVPNTap\\installer\\
- name: '[Sigma] Compressed File Creation Via Tar.EXE'
  tag: attack.collection,attack.exfiltration,attack.t1560,attack.t1560.001
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\tar\.exe'\}|\{'OriginalFileName':\ 'bsdtar'\})
- name: '[Sigma] Compressed File Creation Via Tar.EXE'
  tag: attack.collection,attack.exfiltration,attack.t1560,attack.t1560.001
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(\-c|\-r|\-u)
- name: '[Sigma] Compressed File Extraction Via Tar.EXE'
  tag: attack.collection,attack.exfiltration,attack.t1560,attack.t1560.001
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\tar\.exe'\}|\{'OriginalFileName':\ 'bsdtar'\})
- name: '[Sigma] Compressed File Extraction Via Tar.EXE'
  tag: attack.collection,attack.exfiltration,attack.t1560,attack.t1560.001
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)\-x
- name: '[Sigma] Taskkill Symantec Endpoint Protection'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(taskkill|\ /F\ |\ /IM\ |ccSvcHst\.exe)
- name: '[Sigma] Loaded Module Enumeration Via Tasklist.EXE'
  tag: attack.t1003,attack.credential-access
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\tasklist\.exe'\}|\{'OriginalFileName':\
    'tasklist\.exe'\})
- name: '[Sigma] Loaded Module Enumeration Via Tasklist.EXE'
  tag: attack.t1003,attack.credential-access
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\-m
- name: '[Sigma] Loaded Module Enumeration Via Tasklist.EXE'
  tag: attack.t1003,attack.credential-access
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)rdpcorets\.dll
- name: '[Sigma] Taskmgr as LOCAL_SYSTEM'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: User
  condition: regex
  pattern: (?i)(AUTHORI|AUTORI)
- name: '[Sigma] Taskmgr as LOCAL_SYSTEM'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\taskmgr\.exe$
- name: '[Sigma] New Process Created Via Taskmgr.EXE'
  tag: attack.defense-evasion,attack.t1036
  score: 20
  target: ParentPath
  condition: regex
  pattern: (?i)\\taskmgr\.exe$
- name: '[Sigma] New Process Created Via Taskmgr.EXE'
  tag: attack.defense-evasion,attack.t1036
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Windows\\System32\\mmc\.exe|:\\Windows\\System32\\resmon\.exe|:\\Windows\\System32\\Taskmgr\.exe)$
- name: '[Sigma] Potentially Suspicious Command Targeting Teams Sensitive Files'
  tag: attack.credential-access,attack.t1528
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\Microsoft\\Teams\\Cookies|\\Microsoft\\Teams\\Local\ Storage\\leveldb)
- name: '[Sigma] Potentially Suspicious Command Targeting Teams Sensitive Files'
  tag: attack.credential-access,attack.t1528
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Teams\\current\\Teams\.exe$
- name: '[Sigma] New Virtual Smart Card Created Via TpmVscMgr.EXE'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\tpmvscmgr\.exe$
- name: '[Sigma] New Virtual Smart Card Created Via TpmVscMgr.EXE'
  tag: attack.execution
  score: 50
  target: FileName
  condition: regex
  pattern: (?i)TpmVscMgr\.exe
- name: '[Sigma] New Virtual Smart Card Created Via TpmVscMgr.EXE'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)create
- name: '[Sigma] Suspicious TSCON Start as SYSTEM'
  tag: attack.command-and-control,attack.t1219.002
  score: 80
  target: User
  condition: regex
  pattern: (?i)(AUTHORI|AUTORI)
- name: '[Sigma] Suspicious TSCON Start as SYSTEM'
  tag: attack.command-and-control,attack.t1219.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\tscon\.exe$
- name: '[Sigma] Suspicious RDP Redirect Using TSCON'
  tag: attack.lateral-movement,attack.t1563.002,attack.t1021.001,car.2013-07-002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\ /dest:rdp\-tcp\#
- name: '[Sigma] Potential RDP Session Hijacking Activity'
  tag: attack.execution
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\tscon\.exe'\}|\{'OriginalFileName':\ 'tscon\.exe'\})
- name: '[Sigma] Potential RDP Session Hijacking Activity'
  tag: attack.execution
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(System|S\-1\-16\-16384)
- name: '[Sigma] UAC Bypass Using ChangePK and SLUI'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\changepk\.exe$
- name: '[Sigma] UAC Bypass Using ChangePK and SLUI'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\slui\.exe$
- name: '[Sigma] UAC Bypass Using ChangePK and SLUI'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(High|System|S\-1\-16\-16384|S\-1\-16\-12288)
- name: '[Sigma] UAC Bypass Using Disk Cleanup'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)"\\system32\\cleanmgr\.exe\ /autoclean\ /d\ C:$
- name: '[Sigma] UAC Bypass Using Disk Cleanup'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)C:\\Windows\\system32\\svchost\.exe\ \-k\ netsvcs\ \-p\ \-s\ Schedule
- name: '[Sigma] UAC Bypass Using Disk Cleanup'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(High|System|S\-1\-16\-16384|S\-1\-16\-12288)
- name: '[Sigma] Bypass UAC via CMSTP'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1548.002,attack.t1218.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\cmstp\.exe'\}|\{'OriginalFileName':\ 'CMSTP\.EXE'\})
- name: '[Sigma] Bypass UAC via CMSTP'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1548.002,attack.t1218.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(/s|\-s|/au|\-au|/ni|\-ni)
- name: '[Sigma] CMSTP UAC Bypass via COM Object Access'
  tag: attack.execution,attack.defense-evasion,attack.privilege-escalation,attack.t1548.002,attack.t1218.003,attack.g0069,car.2019-04-001
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\DllHost\.exe$
- name: '[Sigma] CMSTP UAC Bypass via COM Object Access'
  tag: attack.execution,attack.defense-evasion,attack.privilege-escalation,attack.t1548.002,attack.t1218.003,attack.g0069,car.2019-04-001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\ /Processid:\{3E5FC7F9\-9A51\-4367\-9063\-A120244FBEC7\}|\ /Processid:\{3E000D72\-A845\-4CD9\-BD83\-80C07C3B881F\}|\
    /Processid:\{BD54C901\-076B\-434E\-B6C7\-17C531F4AB41\}|\ /Processid:\{D2E7041B\-2927\-42FB\-8E9F\-7CE93B6DC937\}|\
    /Processid:\{E9495B87\-D950\-4AB5\-87A5\-FF6D70BF3E90\})
- name: '[Sigma] CMSTP UAC Bypass via COM Object Access'
  tag: attack.execution,attack.defense-evasion,attack.privilege-escalation,attack.t1548.002,attack.t1218.003,attack.g0069,car.2019-04-001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(High|System|S\-1\-16\-16384|S\-1\-16\-12288)
- name: '[Sigma] UAC Bypass Tools Using ComputerDefaults'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(High|System|S\-1\-16\-16384|S\-1\-16\-12288)
- name: '[Sigma] UAC Bypass Tools Using ComputerDefaults'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\ComputerDefaults\.exe
- name: '[Sigma] UAC Bypass Tools Using ComputerDefaults'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(:\\Windows\\System32|:\\Program\ Files)
- name: '[Sigma] UAC Bypass Using Consent and Comctl32 - Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\consent\.exe$
- name: '[Sigma] UAC Bypass Using Consent and Comctl32 - Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\werfault\.exe$
- name: '[Sigma] UAC Bypass Using Consent and Comctl32 - Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(High|System|S\-1\-16\-16384|S\-1\-16\-12288)
- name: '[Sigma] UAC Bypass Using DismHost'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(C:\\Users\\|\\AppData\\Local\\Temp\\|\\DismHost\.exe)
- name: '[Sigma] UAC Bypass Using DismHost'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(High|System|S\-1\-16\-16384|S\-1\-16\-12288)
- name: '[Sigma] UAC Bypass Using Event Viewer RecentViews'
  tag: attack.defense-evasion,attack.privilege-escalation
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\Event\ Viewer\\RecentViews|\\EventV\~1\\RecentViews)
- name: '[Sigma] UAC Bypass Using Event Viewer RecentViews'
  tag: attack.defense-evasion,attack.privilege-escalation
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)>
- name: '[Sigma] Bypass UAC via Fodhelper.exe'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\fodhelper\.exe$
- name: '[Sigma] UAC Bypass via Windows Firewall Snap-In Hijack'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\mmc\.exe$
- name: '[Sigma] UAC Bypass via Windows Firewall Snap-In Hijack'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)WF\.msc
- name: '[Sigma] UAC Bypass via Windows Firewall Snap-In Hijack'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\WerFault\.exe$
- name: '[Sigma] UAC Bypass via ICMLuaUtil'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\dllhost\.exe$
- name: '[Sigma] UAC Bypass via ICMLuaUtil'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(/Processid:\{3E5FC7F9\-9A51\-4367\-9063\-A120244FBEC7\}|/Processid:\{D2E7041B\-2927\-42FB\-8E9F\-7CE93B6DC937\})
- name: '[Sigma] UAC Bypass via ICMLuaUtil'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\WerFault\.exe'\}|\{'OriginalFileName':\
    'WerFault\.exe'\})
- name: '[Sigma] UAC Bypass Using IDiagnostic Profile'
  tag: attack.execution,attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\DllHost\.exe$
- name: '[Sigma] UAC Bypass Using IDiagnostic Profile'
  tag: attack.execution,attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\ /Processid:\{12C21EA7\-2EB8\-4B55\-9249\-AC243DA8C666\}
- name: '[Sigma] UAC Bypass Using IDiagnostic Profile'
  tag: attack.execution,attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(High|System|S\-1\-16\-16384|S\-1\-16\-12288)
- name: '[Sigma] UAC Bypass Using IEInstal - Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(High|System|S\-1\-16\-16384|S\-1\-16\-12288)
- name: '[Sigma] UAC Bypass Using IEInstal - Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\ieinstal\.exe$
- name: '[Sigma] UAC Bypass Using IEInstal - Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\AppData\\Local\\Temp\\
- name: '[Sigma] UAC Bypass Using IEInstal - Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)consent\.exe$
- name: '[Sigma] UAC Bypass Using MSConfig Token Modification - Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(High|System|S\-1\-16\-16384|S\-1\-16\-12288)
- name: '[Sigma] UAC Bypass Using MSConfig Token Modification - Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\AppData\\Local\\Temp\\pkgmgr\.exe$
- name: '[Sigma] UAC Bypass Using MSConfig Token Modification - Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)"C:\\Windows\\system32\\msconfig\.exe"\ \-5
- name: '[Sigma] UAC Bypass Using NTFS Reparse Point - Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^"C:\\Windows\\system32\\wusa\.exe"\ \ /quiet\ C:\\Users\\
- name: '[Sigma] UAC Bypass Using NTFS Reparse Point - Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\AppData\\Local\\Temp\\update\.msu$
- name: '[Sigma] UAC Bypass Using NTFS Reparse Point - Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(High|System|S\-1\-16\-16384|S\-1\-16\-12288)
- name: '[Sigma] UAC Bypass Using NTFS Reparse Point - Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)"C:\\Windows\\system32\\dism\.exe"\ /online\ /quiet\ /norestart\ /add\-package\
    /packagepath:"C:\\Windows\\system32\\pe386"\ /ignorecheck
- name: '[Sigma] UAC Bypass Using NTFS Reparse Point - Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(High|System)
- name: '[Sigma] UAC Bypass Using NTFS Reparse Point - Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Users\\|\\AppData\\Local\\Temp\\|\\dismhost\.exe\ \{)
- name: '[Sigma] UAC Bypass Using NTFS Reparse Point - Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\DismHost\.exe$
- name: '[Sigma] UAC Bypass Using PkgMgr and DISM'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\pkgmgr\.exe$
- name: '[Sigma] UAC Bypass Using PkgMgr and DISM'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\dism\.exe$
- name: '[Sigma] UAC Bypass Using PkgMgr and DISM'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(High|System|S\-1\-16\-16384|S\-1\-16\-12288)
- name: '[Sigma] Potential UAC Bypass Via Sdclt.EXE'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1548.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)sdclt\.exe$
- name: '[Sigma] Potential UAC Bypass Via Sdclt.EXE'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1548.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(High|S\-1\-16\-12288)
- name: '[Sigma] TrustedPath UAC Bypass Pattern'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1548.002
  score: 100
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Windows\ \\System32\\|C:\\Windows\ \\SysWOW64\\)
- name: '[Sigma] UAC Bypass Abusing Winsat Path Parsing - Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(High|System|S\-1\-16\-16384|S\-1\-16\-12288)
- name: '[Sigma] UAC Bypass Abusing Winsat Path Parsing - Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\AppData\\Local\\Temp\\system32\\winsat\.exe$
- name: '[Sigma] UAC Bypass Abusing Winsat Path Parsing - Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)C:\\Windows\ \\system32\\winsat\.exe
- name: '[Sigma] UAC Bypass Using Windows Media Player - Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Program\ Files\\Windows\ Media\ Player\\osk\.exe
- name: '[Sigma] UAC Bypass Using Windows Media Player - Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\cmd\.exe
- name: '[Sigma] UAC Bypass Using Windows Media Player - Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)"C:\\Windows\\system32\\mmc\.exe"\ "C:\\Windows\\system32\\eventvwr\.msc"\
    /s
- name: '[Sigma] UAC Bypass Using Windows Media Player - Process'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(High|System|S\-1\-16\-16384|S\-1\-16\-12288)
- name: '[Sigma] Bypass UAC via WSReset.exe'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1548.002
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\wsreset\.exe$
- name: '[Sigma] Bypass UAC via WSReset.exe'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\conhost\.exe'\}|\{'OriginalFileName':\
    'CONHOST\.EXE'\})
- name: '[Sigma] UAC Bypass WSReset'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\wsreset\.exe$
- name: '[Sigma] UAC Bypass WSReset'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(High|System|S\-1\-16\-16384|S\-1\-16\-12288)
- name: '[Sigma] Use of UltraVNC Remote Access Software'
  tag: attack.command-and-control,attack.t1219.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Description':\ 'VNCViewer'\}|\{'Product':\ 'UltraVNC\ VNCViewer'\}|\{'Company':\
    'UltraVNC'\}|\{'OriginalFileName':\ 'VNCViewer\.exe'\})
- name: '[Sigma] Suspicious UltraVNC Execution'
  tag: attack.lateral-movement,attack.g0047,attack.t1021.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-autoreconnect\ |\-connect\ |\-id:)
- name: '[Sigma] Uninstall Crowdstrike Falcon Sensor'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\WindowsSensor\.exe|\ /uninstall|\ /quiet)
- name: '[Sigma] Uncommon Userinit Child Process'
  tag: attack.privilege-escalation,attack.t1037.001,attack.persistence
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\userinit\.exe$
- name: '[Sigma] Uncommon Userinit Child Process'
  tag: attack.privilege-escalation,attack.t1037.001,attack.persistence
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i):\\WINDOWS\\explorer\.exe$
- name: '[Sigma] Uncommon Userinit Child Process'
  tag: attack.privilege-escalation,attack.t1037.001,attack.persistence
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(netlogon\.bat|UsrLogon\.cmd)
- name: '[Sigma] Uncommon Userinit Child Process'
  tag: attack.privilege-escalation,attack.t1037.001,attack.persistence
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)PowerShell\.exe
- name: '[Sigma] Uncommon Userinit Child Process'
  tag: attack.privilege-escalation,attack.t1037.001,attack.persistence
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Windows\\System32\\proquota\.exe|:\\Windows\\SysWOW64\\proquota\.exe)$
- name: '[Sigma] Uncommon Userinit Child Process'
  tag: attack.privilege-escalation,attack.t1037.001,attack.persistence
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Program\ Files\ \(x86\)\\Citrix\\HDX\\bin\\cmstart\.exe|:\\Program\
    Files\ \(x86\)\\Citrix\\HDX\\bin\\icast\.exe|:\\Program\ Files\ \(x86\)\\Citrix\\System32\\icast\.exe|:\\Program\
    Files\\Citrix\\HDX\\bin\\cmstart\.exe|:\\Program\ Files\\Citrix\\HDX\\bin\\icast\.exe|:\\Program\
    Files\\Citrix\\System32\\icast\.exe)$
- name: '[Sigma] Uncommon Userinit Child Process'
  tag: attack.privilege-escalation,attack.t1037.001,attack.persistence
  score: 80
  target: Target_Path
  condition: regex
  pattern: None
- name: '[Sigma] Windows Credential Manager Access via VaultCmd'
  tag: attack.credential-access,attack.t1555.004
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\VaultCmd\.exe'\}|\{'OriginalFileName':\
    'VAULTCMD\.EXE'\})
- name: '[Sigma] Windows Credential Manager Access via VaultCmd'
  tag: attack.credential-access,attack.t1555.004
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)/listcreds:'
- name: '[Sigma] Verclsid.exe Runs COM Object'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\verclsid\.exe'\}|\{'OriginalFileName':\
    'verclsid\.exe'\})
- name: '[Sigma] Verclsid.exe Runs COM Object'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/S|/C)
- name: '[Sigma] Verclsid.exe Runs COM Object'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\RuntimeBroker\.exe$
- name: '[Sigma] Verclsid.exe Runs COM Object'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(verclsid\.exe"\ /S\ /C\ \{|\}\ /I\ \{)
- name: '[Sigma] Virtualbox Driver Installation or Starting of VMs'
  tag: attack.defense-evasion,attack.t1564.006,attack.t1564
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(VBoxRT\.dll,RTR3Init|VBoxC\.dll|VBoxDrv\.sys)
- name: '[Sigma] Virtualbox Driver Installation or Starting of VMs'
  tag: attack.defense-evasion,attack.t1564.006,attack.t1564
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(startvm|controlvm)
- name: '[Sigma] Suspicious VBoxDrvInst.exe Parameters'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\VBoxDrvInst\.exe$
- name: '[Sigma] Suspicious VBoxDrvInst.exe Parameters'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(driver|executeinf)
- name: '[Sigma] Potential Persistence Via VMwareToolBoxCmd.EXE VM State Change Script'
  tag: attack.execution,attack.persistence,attack.t1059
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\VMwareToolBoxCmd\.exe'\}|\{'OriginalFileName':\
    'toolbox\-cmd\.exe'\})
- name: '[Sigma] Potential Persistence Via VMwareToolBoxCmd.EXE VM State Change Script'
  tag: attack.execution,attack.persistence,attack.t1059
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ script\ |\ set\ )
- name: '[Sigma] Suspicious Persistence Via VMwareToolBoxCmd.EXE VM State Change Script'
  tag: attack.execution,attack.persistence,attack.t1059
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\VMwareToolBoxCmd\.exe'\}|\{'OriginalFileName':\
    'toolbox\-cmd\.exe'\})
- name: '[Sigma] Suspicious Persistence Via VMwareToolBoxCmd.EXE VM State Change Script'
  tag: attack.execution,attack.persistence,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ script\ |\ set\ )
- name: '[Sigma] Suspicious Persistence Via VMwareToolBoxCmd.EXE VM State Change Script'
  tag: attack.execution,attack.persistence,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\PerfLogs\\|:\\Temp\\|:\\Windows\\System32\\Tasks\\|:\\Windows\\Tasks\\|:\\Windows\\Temp\\|\\AppData\\Local\\Temp)
- name: '[Sigma] VMToolsd Suspicious Child Process'
  tag: attack.execution,attack.persistence,attack.t1059
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\vmtoolsd\.exe$
- name: '[Sigma] VMToolsd Suspicious Child Process'
  tag: attack.execution,attack.persistence,attack.t1059
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\cmd\.exe',\ '\\\\cscript\.exe',\ '\\\\mshta\.exe',\
    '\\\\powershell\.exe',\ '\\\\pwsh\.exe',\ '\\\\regsvr32\.exe',\ '\\\\rundll32\.exe',\
    '\\\\wscript\.exe'\]\}|\{'OriginalFileName':\ \['Cmd\.Exe',\ 'cscript\.exe',\
    'MSHTA\.EXE',\ 'PowerShell\.EXE',\ 'pwsh\.dll',\ 'REGSVR32\.EXE',\ 'RUNDLL32\.EXE',\
    'wscript\.exe'\]\})
- name: '[Sigma] VMToolsd Suspicious Child Process'
  tag: attack.execution,attack.persistence,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\cmd\.exe$
- name: '[Sigma] VMToolsd Suspicious Child Process'
  tag: attack.execution,attack.persistence,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\VMware\\VMware\ Tools\\poweron\-vm\-default\.bat|\\VMware\\VMware\
    Tools\\poweroff\-vm\-default\.bat|\\VMware\\VMware\ Tools\\resume\-vm\-default\.bat|\\VMware\\VMware\
    Tools\\suspend\-vm\-default\.bat)
- name: '[Sigma] VMToolsd Suspicious Child Process'
  tag: attack.execution,attack.persistence,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\cmd\.exe$
- name: '[Sigma] VMToolsd Suspicious Child Process'
  tag: attack.execution,attack.persistence,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)
- name: '[Sigma] VMToolsd Suspicious Child Process'
  tag: attack.execution,attack.persistence,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\cmd\.exe$
- name: '[Sigma] VMToolsd Suspicious Child Process'
  tag: attack.execution,attack.persistence,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: None
- name: '[Sigma] Potentially Suspicious Child Process Of VsCode'
  tag: attack.execution,attack.defense-evasion,attack.t1218,attack.t1202
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\code\.exe$
- name: '[Sigma] Potentially Suspicious Child Process Of VsCode'
  tag: attack.execution,attack.defense-evasion,attack.t1218,attack.t1202
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\calc\.exe|\\regsvr32\.exe|\\rundll32\.exe|\\cscript\.exe|\\wscript\.exe)$
- name: '[Sigma] Potentially Suspicious Child Process Of VsCode'
  tag: attack.execution,attack.defense-evasion,attack.t1218,attack.t1202
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\pwsh\.exe|\\cmd\.exe)$
- name: '[Sigma] Potentially Suspicious Child Process Of VsCode'
  tag: attack.execution,attack.defense-evasion,attack.t1218,attack.t1202
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Invoke\-Expressions|IEX|Invoke\-Command|ICM|DownloadString|rundll32|regsvr32|wscript|cscript)
- name: '[Sigma] Potentially Suspicious Child Process Of VsCode'
  tag: attack.execution,attack.defense-evasion,attack.t1218,attack.t1202
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Users\\Public\\|:\\Windows\\Temp\\|:\\Temp\\)
- name: '[Sigma] Visual Studio Code Tunnel Execution'
  tag: attack.command-and-control,attack.t1071.001,attack.t1219
  score: 50
  target: FileName
  condition: regex
  pattern: None
- name: '[Sigma] Visual Studio Code Tunnel Execution'
  tag: attack.command-and-control,attack.t1071.001,attack.t1219
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\.exe\ tunnel$
- name: '[Sigma] Visual Studio Code Tunnel Execution'
  tag: attack.command-and-control,attack.t1071.001,attack.t1219
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\.exe\ tunnel|\-\-accept\-server\-license\-terms)
- name: '[Sigma] Visual Studio Code Tunnel Execution'
  tag: attack.command-and-control,attack.t1071.001,attack.t1219
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\ tunnel$
- name: '[Sigma] Visual Studio Code Tunnel Execution'
  tag: attack.command-and-control,attack.t1071.001,attack.t1219
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\cmd\.exe$
- name: '[Sigma] Visual Studio Code Tunnel Execution'
  tag: attack.command-and-control,attack.t1071.001,attack.t1219
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(/d\ /c\ |\\servers\\Stable\-|code\-server\.cmd)
- name: '[Sigma] Visual Studio Code Tunnel Shell Execution'
  tag: attack.command-and-control,attack.t1071.001
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\servers\\Stable\-
- name: '[Sigma] Visual Studio Code Tunnel Shell Execution'
  tag: attack.command-and-control,attack.t1071.001
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\server\\node\.exe$
- name: '[Sigma] Visual Studio Code Tunnel Shell Execution'
  tag: attack.command-and-control,attack.t1071.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\.vscode\-server
- name: '[Sigma] Visual Studio Code Tunnel Shell Execution'
  tag: attack.command-and-control,attack.t1071.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\powershell\.exe|\\pwsh\.exe)$
- name: '[Sigma] Visual Studio Code Tunnel Shell Execution'
  tag: attack.command-and-control,attack.t1071.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\terminal\\browser\\media\\shellIntegration\.ps1
- name: '[Sigma] Visual Studio Code Tunnel Shell Execution'
  tag: attack.command-and-control,attack.t1071.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\wsl\.exe|\\bash\.exe)$
- name: '[Sigma] Renamed Visual Studio Code Tunnel Execution'
  tag: attack.command-and-control,attack.t1071.001,attack.t1219
  score: 80
  target: FileName
  condition: regex
  pattern: None
- name: '[Sigma] Renamed Visual Studio Code Tunnel Execution'
  tag: attack.command-and-control,attack.t1071.001,attack.t1219
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\.exe\ tunnel$
- name: '[Sigma] Renamed Visual Studio Code Tunnel Execution'
  tag: attack.command-and-control,attack.t1071.001,attack.t1219
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.exe\ tunnel|\-\-accept\-server\-license\-terms)
- name: '[Sigma] Renamed Visual Studio Code Tunnel Execution'
  tag: attack.command-and-control,attack.t1071.001,attack.t1219
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(tunnel\ |service|internal\-run|tunnel\-service\.log)
- name: '[Sigma] Renamed Visual Studio Code Tunnel Execution'
  tag: attack.command-and-control,attack.t1071.001,attack.t1219
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\ tunnel$
- name: '[Sigma] Renamed Visual Studio Code Tunnel Execution'
  tag: attack.command-and-control,attack.t1071.001,attack.t1219
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\cmd\.exe$
- name: '[Sigma] Renamed Visual Studio Code Tunnel Execution'
  tag: attack.command-and-control,attack.t1071.001,attack.t1219
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(/d\ /c\ |\\servers\\Stable\-|code\-server\.cmd)
- name: '[Sigma] Renamed Visual Studio Code Tunnel Execution'
  tag: attack.command-and-control,attack.t1071.001,attack.t1219
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\code\-tunnel\.exe|\\code\.exe)$
- name: '[Sigma] Renamed Visual Studio Code Tunnel Execution'
  tag: attack.command-and-control,attack.t1071.001,attack.t1219
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\code\-tunnel\.exe|\\code\.exe)$
- name: '[Sigma] Visual Studio Code Tunnel Service Installation'
  tag: attack.command-and-control,attack.t1071.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(tunnel\ |service|internal\-run|tunnel\-service\.log)
- name: '[Sigma] Potential Binary Proxy Execution Via VSDiagnostics.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\VSDiagnostics\.exe'\}|\{'OriginalFileName':\
    'VSDiagnostics\.exe'\})
- name: '[Sigma] Potential Binary Proxy Execution Via VSDiagnostics.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)start
- name: '[Sigma] Potential Binary Proxy Execution Via VSDiagnostics.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /launch:|\ \-launch:)
- name: '[Sigma] Suspicious Vsls-Agent Command With AgentExtensionPath Load'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\vsls\-agent\.exe$
- name: '[Sigma] Suspicious Vsls-Agent Command With AgentExtensionPath Load'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\-\-agentExtensionPath
- name: '[Sigma] Suspicious Vsls-Agent Command With AgentExtensionPath Load'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)Microsoft\.VisualStudio\.LiveShare\.Agent\.
- name: '[Sigma] Use of W32tm as Timer'
  tag: attack.discovery,attack.t1124
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\w32tm\.exe'\}|\{'OriginalFileName':\ 'w32time\.dll'\})
- name: '[Sigma] Use of W32tm as Timer'
  tag: attack.discovery,attack.t1124
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(/stripchart|/computer:|/period:|/dataonly|/samples:)
- name: '[Sigma] Wab Execution From Non Default Location'
  tag: attack.defense-evasion,attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\wab\.exe|\\wabmig\.exe)$
- name: '[Sigma] Wab Execution From Non Default Location'
  tag: attack.defense-evasion,attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^(C:\\Windows\\WinSxS\\|C:\\Program\ Files\\Windows\ Mail\\|C:\\Program\
    Files\ \(x86\)\\Windows\ Mail\\)
- name: '[Sigma] Wab/Wabmig Unusual Parent Or Child Processes'
  tag: attack.defense-evasion,attack.execution
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\WmiPrvSE\.exe|\\svchost\.exe|\\dllhost\.exe)$
- name: '[Sigma] Wab/Wabmig Unusual Parent Or Child Processes'
  tag: attack.defense-evasion,attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\wab\.exe|\\wabmig\.exe)$
- name: '[Sigma] Wab/Wabmig Unusual Parent Or Child Processes'
  tag: attack.defense-evasion,attack.execution
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\wab\.exe|\\wabmig\.exe)$
- name: '[Sigma] All Backups Deleted Via Wbadmin.EXE'
  tag: attack.impact,attack.t1490
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\wbadmin\.exe'\}|\{'OriginalFileName':\
    'WBADMIN\.EXE'\})
- name: '[Sigma] All Backups Deleted Via Wbadmin.EXE'
  tag: attack.impact,attack.t1490
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(delete|backup)
- name: '[Sigma] All Backups Deleted Via Wbadmin.EXE'
  tag: attack.impact,attack.t1490
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)keepVersions:0
- name: '[Sigma] Windows Backup Deleted Via Wbadmin.EXE'
  tag: attack.impact,attack.t1490
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\wbadmin\.exe'\}|\{'OriginalFileName':\
    'WBADMIN\.EXE'\})
- name: '[Sigma] Windows Backup Deleted Via Wbadmin.EXE'
  tag: attack.impact,attack.t1490
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(delete\ |backup)
- name: '[Sigma] Windows Backup Deleted Via Wbadmin.EXE'
  tag: attack.impact,attack.t1490
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)keepVersions:0
- name: '[Sigma] Sensitive File Dump Via Wbadmin.EXE'
  tag: attack.credential-access,attack.t1003.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\wbadmin\.exe'\}|\{'OriginalFileName':\
    'WBADMIN\.EXE'\})
- name: '[Sigma] Sensitive File Dump Via Wbadmin.EXE'
  tag: attack.credential-access,attack.t1003.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(start|backup)
- name: '[Sigma] Sensitive File Dump Via Wbadmin.EXE'
  tag: attack.credential-access,attack.t1003.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\config\\SAM|\\config\\SECURITY|\\config\\SYSTEM|\\Windows\\NTDS\\NTDS\.dit)
- name: '[Sigma] File Recovery From Backup Via Wbadmin.EXE'
  tag: attack.impact,attack.t1490
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\wbadmin\.exe'\}|\{'OriginalFileName':\
    'WBADMIN\.EXE'\})
- name: '[Sigma] File Recovery From Backup Via Wbadmin.EXE'
  tag: attack.impact,attack.t1490
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ recovery|recoveryTarget|itemtype:File)
- name: '[Sigma] Sensitive File Recovery From Backup Via Wbadmin.EXE'
  tag: attack.credential-access,attack.t1003.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\wbadmin\.exe'\}|\{'OriginalFileName':\
    'WBADMIN\.EXE'\})
- name: '[Sigma] Sensitive File Recovery From Backup Via Wbadmin.EXE'
  tag: attack.credential-access,attack.t1003.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ recovery|recoveryTarget|itemtype:File)
- name: '[Sigma] Sensitive File Recovery From Backup Via Wbadmin.EXE'
  tag: attack.credential-access,attack.t1003.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\config\\SAM|\\config\\SECURITY|\\config\\SYSTEM|\\Windows\\NTDS\\NTDS\.dit)
- name: '[Sigma] Potentially Suspicious WebDAV LNK Execution'
  tag: attack.execution,attack.t1059.001,attack.t1204
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\explorer\.exe$
- name: '[Sigma] Potentially Suspicious WebDAV LNK Execution'
  tag: attack.execution,attack.t1059.001,attack.t1204
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\cmd\.exe|\\cscript\.exe|\\mshta\.exe|\\powershell\.exe|\\pwsh\.exe|\\wscript\.exe)$
- name: '[Sigma] Potentially Suspicious WebDAV LNK Execution'
  tag: attack.execution,attack.t1059.001,attack.t1204
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\DavWWWRoot\\
- name: '[Sigma] Chopper Webshell Process Pattern'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\w3wp\.exe'\}|\{'ParentImage\|endswith':\
    '\\\\w3wp\.exe'\})
- name: '[Sigma] Chopper Webshell Process Pattern'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\&ipconfig\&echo|\&quser\&echo|\&whoami\&echo|\&c:\&echo|\&cd\&echo|\&dir\&echo|\&echo\
    \[E\]|\&echo\ \[S\])
- name: '[Sigma] Webshell Hacking Activity Patterns'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\caddy\.exe|\\httpd\.exe|\\nginx\.exe|\\php\-cgi\.exe|\\w3wp\.exe|\\ws_tomcatservice\.exe)$
- name: '[Sigma] Webshell Hacking Activity Patterns'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\java\.exe|\\javaw\.exe)$
- name: '[Sigma] Webshell Hacking Activity Patterns'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\-tomcat\-|\\tomcat)
- name: '[Sigma] Webshell Hacking Activity Patterns'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\java\.exe|\\javaw\.exe)$
- name: '[Sigma] Webshell Hacking Activity Patterns'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(catalina\.jar|CATALINA_HOME)
- name: '[Sigma] Webshell Hacking Activity Patterns'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(rundll32|comsvcs)
- name: '[Sigma] Webshell Hacking Activity Patterns'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-hp|\ a\ |\ \-m)
- name: '[Sigma] Webshell Hacking Activity Patterns'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(net|\ user\ |\ /add)
- name: '[Sigma] Webshell Hacking Activity Patterns'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(net|\ localgroup\ |\ administrators\ |/add)
- name: '[Sigma] Webshell Hacking Activity Patterns'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\ntdsutil\.exe|\\ldifde\.exe|\\adfind\.exe|\\procdump\.exe|\\Nanodump\.exe|\\vssadmin\.exe|\\fsutil\.exe)$
- name: '[Sigma] Webshell Hacking Activity Patterns'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-decode\ |\ \-NoP\ |\ \-W\ Hidden\ |\ /decode\ |\ /ticket:|\ sekurlsa|\.dmp\
    full|\.downloadfile\(|\.downloadstring\(|FromBase64String|process\ call\ create|reg\
    save\ |whoami\ /priv)
- name: '[Sigma] Webshell Detection With Command Line Keywords'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\w3wp\.exe|\\php\-cgi\.exe|\\nginx\.exe|\\httpd\.exe|\\caddy\.exe|\\ws_tomcatservice\.exe)$
- name: '[Sigma] Webshell Detection With Command Line Keywords'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\java\.exe|\\javaw\.exe)$
- name: '[Sigma] Webshell Detection With Command Line Keywords'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\-tomcat\-|\\tomcat)
- name: '[Sigma] Webshell Detection With Command Line Keywords'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\java\.exe|\\javaw\.exe)$
- name: '[Sigma] Webshell Detection With Command Line Keywords'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(catalina\.jar|CATALINA_HOME)
- name: '[Sigma] Webshell Detection With Command Line Keywords'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: FileName
  condition: regex
  pattern: (?i)(net\.exe|net1\.exe)
- name: '[Sigma] Webshell Detection With Command Line Keywords'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ user\ |\ use\ |\ group\ )
- name: '[Sigma] Webshell Detection With Command Line Keywords'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: FileName
  condition: regex
  pattern: (?i)ping\.exe
- name: '[Sigma] Webshell Detection With Command Line Keywords'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-n\ '
- name: '[Sigma] Webshell Detection With Command Line Keywords'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\&cd\&echo|cd\ /d\ )
- name: '[Sigma] Webshell Detection With Command Line Keywords'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: FileName
  condition: regex
  pattern: (?i)wmic\.exe
- name: '[Sigma] Webshell Detection With Command Line Keywords'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ /node:'
- name: '[Sigma] Webshell Detection With Command Line Keywords'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\cmd\.exe|\\powershell\.exe|\\pwsh\.exe)$
- name: '[Sigma] Webshell Detection With Command Line Keywords'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-enc\ |\ \-EncodedCommand\ |\ \-w\ hidden\ |\ \-windowstyle\ hidden|\.WebClient\)\.Download)
- name: '[Sigma] Webshell Detection With Command Line Keywords'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\dsquery\.exe',\ '\\\\find\.exe',\ '\\\\findstr\.exe',\
    '\\\\ipconfig\.exe',\ '\\\\netstat\.exe',\ '\\\\nslookup\.exe',\ '\\\\pathping\.exe',\
    '\\\\quser\.exe',\ '\\\\schtasks\.exe',\ '\\\\systeminfo\.exe',\ '\\\\tasklist\.exe',\
    '\\\\tracert\.exe',\ '\\\\ver\.exe',\ '\\\\wevtutil\.exe',\ '\\\\whoami\.exe'\]\}|\{'OriginalFileName':\
    \['dsquery\.exe',\ 'find\.exe',\ 'findstr\.exe',\ 'ipconfig\.exe',\ 'netstat\.exe',\
    'nslookup\.exe',\ 'pathping\.exe',\ 'quser\.exe',\ 'schtasks\.exe',\ 'sysinfo\.exe',\
    'tasklist\.exe',\ 'tracert\.exe',\ 'ver\.exe',\ 'VSSADMIN\.EXE',\ 'wevtutil\.exe',\
    'whoami\.exe'\]\})
- name: '[Sigma] Webshell Detection With Command Line Keywords'
  tag: attack.persistence,attack.discovery,attack.t1505.003,attack.t1018,attack.t1033,attack.t1087
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ Test\-NetConnection\ |dir\ \\)
- name: '[Sigma] Suspicious Process By Web Server Process'
  tag: attack.persistence,attack.initial-access,attack.t1505.003,attack.t1190
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\caddy\.exe|\\httpd\.exe|\\nginx\.exe|\\php\-cgi\.exe|\\php\.exe|\\tomcat\.exe|\\UMWorkerProcess\.exe|\\w3wp\.exe|\\ws_TomcatService\.exe)$
- name: '[Sigma] Suspicious Process By Web Server Process'
  tag: attack.persistence,attack.initial-access,attack.t1505.003,attack.t1190
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\java\.exe|\\javaw\.exe)$
- name: '[Sigma] Suspicious Process By Web Server Process'
  tag: attack.persistence,attack.initial-access,attack.t1505.003,attack.t1190
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\-tomcat\-|\\tomcat)
- name: '[Sigma] Suspicious Process By Web Server Process'
  tag: attack.persistence,attack.initial-access,attack.t1505.003,attack.t1190
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\java\.exe|\\javaw\.exe)$
- name: '[Sigma] Suspicious Process By Web Server Process'
  tag: attack.persistence,attack.initial-access,attack.t1505.003,attack.t1190
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(CATALINA_HOME|catalina\.home|catalina\.jar)
- name: '[Sigma] Suspicious Process By Web Server Process'
  tag: attack.persistence,attack.initial-access,attack.t1505.003,attack.t1190
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\arp\.exe|\\at\.exe|\\bash\.exe|\\bitsadmin\.exe|\\certutil\.exe|\\cmd\.exe|\\cscript\.exe|\\dsget\.exe|\\hostname\.exe|\\nbtstat\.exe|\\net\.exe|\\net1\.exe|\\netdom\.exe|\\netsh\.exe|\\nltest\.exe|\\ntdsutil\.exe|\\powershell_ise\.exe|\\powershell\.exe|\\pwsh\.exe|\\qprocess\.exe|\\query\.exe|\\qwinsta\.exe|\\reg\.exe|\\rundll32\.exe|\\sc\.exe|\\sh\.exe|\\wmic\.exe|\\wscript\.exe|\\wusa\.exe)$
- name: '[Sigma] Suspicious Process By Web Server Process'
  tag: attack.persistence,attack.initial-access,attack.t1505.003,attack.t1190
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\java\.exe$
- name: '[Sigma] Suspicious Process By Web Server Process'
  tag: attack.persistence,attack.initial-access,attack.t1505.003,attack.t1190
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)Windows\\system32\\cmd\.exe\ /c\ C:\\ManageEngine\\ADManager\ "Plus\\ES\\bin\\elasticsearch\.bat\
    \-Enode\.name=RMP\-NODE1\ \-pelasticsearch\-pid\.txt$
- name: '[Sigma] Suspicious Process By Web Server Process'
  tag: attack.persistence,attack.initial-access,attack.t1505.003,attack.t1190
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\java\.exe$
- name: '[Sigma] Suspicious Process By Web Server Process'
  tag: attack.persistence,attack.initial-access,attack.t1505.003,attack.t1190
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(sc\ query|ADManager\ Plus)
- name: '[Sigma] Webshell Tool Reconnaissance Activity'
  tag: attack.persistence,attack.t1505.003
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\caddy\.exe|\\httpd\.exe|\\nginx\.exe|\\php\-cgi\.exe|\\w3wp\.exe|\\ws_tomcatservice\.exe)$
- name: '[Sigma] Webshell Tool Reconnaissance Activity'
  tag: attack.persistence,attack.t1505.003
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\java\.exe|\\javaw\.exe)$
- name: '[Sigma] Webshell Tool Reconnaissance Activity'
  tag: attack.persistence,attack.t1505.003
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\-tomcat\-|\\tomcat)
- name: '[Sigma] Webshell Tool Reconnaissance Activity'
  tag: attack.persistence,attack.t1505.003
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\java\.exe|\\javaw\.exe)$
- name: '[Sigma] Webshell Tool Reconnaissance Activity'
  tag: attack.persistence,attack.t1505.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(CATALINA_HOME|catalina\.jar)
- name: '[Sigma] Webshell Tool Reconnaissance Activity'
  tag: attack.persistence,attack.t1505.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(perl\ \-\-help|perl\ \-h|python\ \-\-help|python\ \-h|python3\ \-\-help|python3\
    \-h|wget\ \-\-help)
- name: '[Sigma] Potential Credential Dumping Via WER'
  tag: attack.credential-access,attack.t1003.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\Werfault\.exe'\}|\{'OriginalFileName':\
    'WerFault\.exe'\})
- name: '[Sigma] Potential Credential Dumping Via WER'
  tag: attack.credential-access,attack.t1003.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(AUTHORI|AUTORI)
- name: '[Sigma] Potential Credential Dumping Via WER'
  tag: attack.credential-access,attack.t1003.001
  score: 80
  target: User
  condition: regex
  pattern: (?i)(AUTHORI|AUTORI)
- name: '[Sigma] Potential Credential Dumping Via WER'
  tag: attack.credential-access,attack.t1003.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-u\ \-p\ |\ \-ip\ |\ \-s\ )
- name: '[Sigma] Potential Credential Dumping Via WER'
  tag: attack.credential-access,attack.t1003.001
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\lsass\.exe
- name: '[Sigma] Potential ReflectDebugger Content Execution Via WerFault.EXE'
  tag: attack.execution,attack.defense-evasion,attack.t1036
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\WerFault\.exe'\}|\{'OriginalFileName':\
    'WerFault\.exe'\})
- name: '[Sigma] Potential ReflectDebugger Content Execution Via WerFault.EXE'
  tag: attack.execution,attack.defense-evasion,attack.t1036
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)\ \-pr\ '
- name: '[Sigma] Suspicious Child Process Of Wermgr.EXE'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1055,attack.t1036
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\wermgr\.exe$
- name: '[Sigma] Suspicious Child Process Of Wermgr.EXE'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1055,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\cmd\.exe|\\cscript\.exe|\\ipconfig\.exe|\\mshta\.exe|\\net\.exe|\\net1\.exe|\\netstat\.exe|\\nslookup\.exe|\\powershell_ise\.exe|\\powershell\.exe|\\pwsh\.exe|\\regsvr32\.exe|\\rundll32\.exe|\\systeminfo\.exe|\\whoami\.exe|\\wscript\.exe)$
- name: '[Sigma] Suspicious Child Process Of Wermgr.EXE'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1055,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\rundll32\.exe$
- name: '[Sigma] Suspicious Child Process Of Wermgr.EXE'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1055,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Windows\\system32\\WerConCpl\.dll|LaunchErcApp\ )
- name: '[Sigma] Suspicious Child Process Of Wermgr.EXE'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1055,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\-queuereporting|\-responsepester)
- name: '[Sigma] Suspicious Execution Location Of Wermgr.EXE'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\wermgr\.exe$
- name: '[Sigma] Suspicious Execution Location Of Wermgr.EXE'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^(C:\\Windows\\System32\\|C:\\Windows\\SysWOW64\\|C:\\Windows\\WinSxS\\)
- name: '[Sigma] Suspicious File Download From IP Via Wget.EXE'
  tag: attack.execution
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\wget\.exe'\}|\{'OriginalFileName':\ 'wget\.exe'\})
- name: '[Sigma] Suspicious File Download From IP Via Wget.EXE'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)://\[0\-9\]\{1,3\}\\\.\[0\-9\]\{1,3\}\\\.\[0\-9\]\{1,3\}\\\.\[0\-9\]\{1,3\}
- name: '[Sigma] Suspicious File Download From IP Via Wget.EXE'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)http
- name: '[Sigma] Suspicious File Download From IP Via Wget.EXE'
  tag: attack.execution
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|re':\ '\\\\s\-O\\\\s'\}|\{'CommandLine\|contains':\
    '\-\-output\-document'\})
- name: '[Sigma] Suspicious File Download From IP Via Wget.EXE'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.ps1|\.ps1'|\.ps1"|\.dat|\.dat'|\.dat"|\.msi|\.msi'|\.msi"|\.bat|\.bat'|\.bat"|\.exe|\.exe'|\.exe"|\.vbs|\.vbs'|\.vbs"|\.vbe|\.vbe'|\.vbe"|\.hta|\.hta'|\.hta"|\.dll|\.dll'|\.dll"|\.psm1|\.psm1'|\.psm1")$
- name: '[Sigma] Suspicious File Download From File Sharing Domain Via Wget.EXE'
  tag: attack.execution
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\wget\.exe'\}|\{'OriginalFileName':\ 'wget\.exe'\})
- name: '[Sigma] Suspicious File Download From File Sharing Domain Via Wget.EXE'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.githubusercontent\.com|anonfiles\.com|cdn\.discordapp\.com|ddns\.net|dl\.dropboxusercontent\.com|ghostbin\.co|github\.com|glitch\.me|gofile\.io|hastebin\.com|mediafire\.com|mega\.nz|onrender\.com|pages\.dev|paste\.ee|pastebin\.com|pastebin\.pl|pastetext\.net|pixeldrain\.com|privatlab\.com|privatlab\.net|send\.exploit\.in|sendspace\.com|storage\.googleapis\.com|storjshare\.io|supabase\.co|temp\.sh|transfer\.sh|trycloudflare\.com|ufile\.io|w3spaces\.com|workers\.dev)
- name: '[Sigma] Suspicious File Download From File Sharing Domain Via Wget.EXE'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)http
- name: '[Sigma] Suspicious File Download From File Sharing Domain Via Wget.EXE'
  tag: attack.execution
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|re':\ '\\\\s\-O\\\\s'\}|\{'CommandLine\|contains':\
    '\-\-output\-document'\})
- name: '[Sigma] Suspicious File Download From File Sharing Domain Via Wget.EXE'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.ps1|\.ps1'|\.ps1"|\.dat|\.dat'|\.dat"|\.msi|\.msi'|\.msi"|\.bat|\.bat'|\.bat"|\.exe|\.exe'|\.exe"|\.vbs|\.vbs'|\.vbs"|\.vbe|\.vbe'|\.vbe"|\.hta|\.hta'|\.hta"|\.dll|\.dll'|\.dll"|\.psm1|\.psm1'|\.psm1")$
- name: '[Sigma] Suspicious File Download From IP Via Wget.EXE - Paths'
  tag: attack.execution
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\wget\.exe'\}|\{'OriginalFileName':\ 'wget\.exe'\})
- name: '[Sigma] Suspicious File Download From IP Via Wget.EXE - Paths'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)://\[0\-9\]\{1,3\}\\\.\[0\-9\]\{1,3\}\\\.\[0\-9\]\{1,3\}\\\.\[0\-9\]\{1,3\}
- name: '[Sigma] Suspicious File Download From IP Via Wget.EXE - Paths'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)http
- name: '[Sigma] Suspicious File Download From IP Via Wget.EXE - Paths'
  tag: attack.execution
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|re':\ '\\\\s\-O\\\\s'\}|\{'CommandLine\|contains':\
    '\-\-output\-document'\})
- name: '[Sigma] Suspicious File Download From IP Via Wget.EXE - Paths'
  tag: attack.execution
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains':\ \[':\\\\PerfLogs\\\\',\ ':\\\\Temp\\\\',\
    ':\\\\Users\\\\Public\\\\',\ ':\\\\Windows\\\\Help\\\\',\ ':\\\\Windows\\\\Temp\\\\',\
    '\\\\Temporary\ Internet'\]\}|\{'CommandLine\|contains\|all':\ \[':\\\\Users\\\\',\
    '\\\\Favorites\\\\'\]\}|\{'CommandLine\|contains\|all':\ \[':\\\\Users\\\\',\
    '\\\\Favourites\\\\'\]\}|\{'CommandLine\|contains\|all':\ \[':\\\\Users\\\\',\
    '\\\\Contacts\\\\'\]\}|\{'CommandLine\|contains\|all':\ \[':\\\\Users\\\\',\ '\\\\Pictures\\\\'\]\})
- name: '[Sigma] Suspicious Where Execution'
  tag: attack.discovery,attack.t1217
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\where\.exe'\}|\{'OriginalFileName':\ 'where\.exe'\})
- name: '[Sigma] Suspicious Where Execution'
  tag: attack.discovery,attack.t1217
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)(places\.sqlite|cookies\.sqlite|formhistory\.sqlite|logins\.json|key4\.db|key3\.db|sessionstore\.jsonlz4|History|Bookmarks|Cookies|Login\
    Data)
- name: '[Sigma] Enumerate All Information With Whoami.EXE'
  tag: attack.discovery,attack.t1033,car.2016-03-001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\whoami\.exe'\}|\{'OriginalFileName':\ 'whoami\.exe'\})
- name: '[Sigma] Enumerate All Information With Whoami.EXE'
  tag: attack.discovery,attack.t1033,car.2016-03-001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ \-all
- name: '[Sigma] Whoami.EXE Execution From Privileged Process'
  tag: attack.privilege-escalation,attack.discovery,attack.t1033
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'whoami\.exe'\}|\{'Image\|endswith':\ '\\\\whoami\.exe'\})
- name: '[Sigma] Whoami.EXE Execution From Privileged Process'
  tag: attack.privilege-escalation,attack.discovery,attack.t1033
  score: 80
  target: User
  condition: regex
  pattern: (?i)(AUTHORI|AUTORI|TrustedInstaller)
- name: '[Sigma] Group Membership Reconnaissance Via Whoami.EXE'
  tag: attack.discovery,attack.t1033
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\whoami\.exe'\}|\{'OriginalFileName':\ 'whoami\.exe'\})
- name: '[Sigma] Group Membership Reconnaissance Via Whoami.EXE'
  tag: attack.discovery,attack.t1033
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /groups|\ \-groups)
- name: '[Sigma] Whoami.EXE Execution With Output Option'
  tag: attack.discovery,attack.t1033,car.2016-03-001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\whoami\.exe'\}|\{'OriginalFileName':\ 'whoami\.exe'\})
- name: '[Sigma] Whoami.EXE Execution With Output Option'
  tag: attack.discovery,attack.t1033,car.2016-03-001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /FO\ CSV|\ \-FO\ CSV)
- name: '[Sigma] Whoami.EXE Execution With Output Option'
  tag: attack.discovery,attack.t1033,car.2016-03-001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)whoami.*>
- name: '[Sigma] Whoami.EXE Execution Anomaly'
  tag: attack.discovery,attack.t1033,car.2016-03-001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\whoami\.exe'\}|\{'OriginalFileName':\ 'whoami\.exe'\})
- name: '[Sigma] Whoami.EXE Execution Anomaly'
  tag: attack.discovery,attack.t1033,car.2016-03-001
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(\\cmd\.exe|\\powershell_ise\.exe|\\powershell\.exe|\\pwsh\.exe)$
- name: '[Sigma] Whoami.EXE Execution Anomaly'
  tag: attack.discovery,attack.t1033,car.2016-03-001
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i):\\Program\ Files\\Microsoft\ Monitoring\ Agent\\Agent\\MonitoringHost\.exe$
- name: '[Sigma] Whoami.EXE Execution Anomaly'
  tag: attack.discovery,attack.t1033,car.2016-03-001
  score: 50
  target: ParentPath
  condition: regex
  pattern: None
- name: '[Sigma] Whoami.EXE Execution Anomaly'
  tag: attack.discovery,attack.t1033,car.2016-03-001
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(|\-)
- name: '[Sigma] Security Privileges Enumeration Via Whoami.EXE'
  tag: attack.privilege-escalation,attack.discovery,attack.t1033
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\whoami\.exe'\}|\{'OriginalFileName':\ 'whoami\.exe'\})
- name: '[Sigma] Security Privileges Enumeration Via Whoami.EXE'
  tag: attack.privilege-escalation,attack.discovery,attack.t1033
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\ /priv|\ \-priv)
- name: '[Sigma] Suspicious WindowsTerminal Child Processes'
  tag: attack.execution,attack.persistence
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(\\WindowsTerminal\.exe|\\wt\.exe)$
- name: '[Sigma] Suspicious WindowsTerminal Child Processes'
  tag: attack.execution,attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\rundll32\.exe',\ '\\\\regsvr32\.exe',\
    '\\\\certutil\.exe',\ '\\\\cscript\.exe',\ '\\\\wscript\.exe',\ '\\\\csc\.exe'\]\}|\{'Image\|contains':\
    \['C:\\\\Users\\\\Public\\\\',\ '\\\\Downloads\\\\',\ '\\\\Desktop\\\\',\ '\\\\AppData\\\\Local\\\\Temp\\\\',\
    '\\\\Windows\\\\TEMP\\\\'\]\}|\{'CommandLine\|contains':\ \['\ iex\ ',\ '\ icm',\
    'Invoke\-',\ 'Import\-Module\ ',\ 'ipmo\ ',\ 'DownloadString\(',\ '\ /c\ ',\ '\
    /k\ ',\ '\ /r\ '\]\})
- name: '[Sigma] Suspicious WindowsTerminal Child Processes'
  tag: attack.execution,attack.persistence
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Import\-Module|Microsoft\.VisualStudio\.DevShell\.dll|Enter\-VsDevShell)
- name: '[Sigma] Suspicious WindowsTerminal Child Processes'
  tag: attack.execution,attack.persistence
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\AppData\\Local\\Packages\\Microsoft\.WindowsTerminal_|\\LocalState\\settings\.json)
- name: '[Sigma] Suspicious WindowsTerminal Child Processes'
  tag: attack.execution,attack.persistence
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\\Microsoft\ Visual\ Studio\\|\\Common7\\Tools\\VsDevCmd\.bat)
- name: '[Sigma] Add New Download Source To Winget'
  tag: attack.defense-evasion,attack.execution,attack.t1059
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\winget\.exe'\}|\{'OriginalFileName':\ 'winget\.exe'\})
- name: '[Sigma] Add New Download Source To Winget'
  tag: attack.defense-evasion,attack.execution,attack.t1059
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(source\ |add\ )
- name: '[Sigma] Add Insecure Download Source To Winget'
  tag: attack.defense-evasion,attack.execution,attack.t1059
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\winget\.exe'\}|\{'OriginalFileName':\ 'winget\.exe'\})
- name: '[Sigma] Add Insecure Download Source To Winget'
  tag: attack.defense-evasion,attack.execution,attack.t1059
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(source\ |add\ |http://)
- name: '[Sigma] Add Potential Suspicious New Download Source To Winget'
  tag: attack.defense-evasion,attack.execution,attack.t1059
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\winget\.exe'\}|\{'OriginalFileName':\ 'winget\.exe'\})
- name: '[Sigma] Add Potential Suspicious New Download Source To Winget'
  tag: attack.defense-evasion,attack.execution,attack.t1059
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(source\ |add\ )
- name: '[Sigma] Add Potential Suspicious New Download Source To Winget'
  tag: attack.defense-evasion,attack.execution,attack.t1059
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)://\\d\{1,3\}\\\.\\d\{1,3\}\\\.\\d\{1,3\}\\\.\\d\{1,3\}
- name: '[Sigma] Install New Package Via Winget Local Manifest'
  tag: attack.defense-evasion,attack.execution,attack.t1059
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\winget\.exe'\}|\{'OriginalFileName':\ 'winget\.exe'\})
- name: '[Sigma] Install New Package Via Winget Local Manifest'
  tag: attack.defense-evasion,attack.execution,attack.t1059
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(install|\ add\ )
- name: '[Sigma] Install New Package Via Winget Local Manifest'
  tag: attack.defense-evasion,attack.execution,attack.t1059
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\-m\ |\-\-manifest)
- name: '[Sigma] Winrar Compressing Dump Files'
  tag: attack.collection,attack.t1560.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\rar\.exe',\ '\\\\winrar\.exe'\]\}|\{'Description':\
    'Command\ line\ RAR'\})
- name: '[Sigma] Winrar Compressing Dump Files'
  tag: attack.collection,attack.t1560.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\.dmp|\.dump|\.hdmp)
- name: '[Sigma] Potentially Suspicious Child Process Of WinRAR.EXE'
  tag: attack.execution,attack.t1203
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\WinRAR\.exe$
- name: '[Sigma] Potentially Suspicious Child Process Of WinRAR.EXE'
  tag: attack.execution,attack.t1203
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\cmd\.exe',\ '\\\\cscript\.exe',\ '\\\\mshta\.exe',\
    '\\\\powershell\.exe',\ '\\\\pwsh\.exe',\ '\\\\regsvr32\.exe',\ '\\\\rundll32\.exe',\
    '\\\\wscript\.exe'\]\}|\{'OriginalFileName':\ \['Cmd\.Exe',\ 'cscript\.exe',\
    'mshta\.exe',\ 'PowerShell\.EXE',\ 'pwsh\.dll',\ 'regsvr32\.exe',\ 'RUNDLL32\.EXE',\
    'wscript\.exe'\]\})
- name: '[Sigma] WinRAR Execution in Non-Standard Folder'
  tag: attack.collection,attack.t1560.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\rar\.exe',\ '\\\\winrar\.exe'\]\}|\{'Description':\
    \['Command\ line\ RAR',\ 'WinRAR'\]\})
- name: '[Sigma] WinRAR Execution in Non-Standard Folder'
  tag: attack.collection,attack.t1560.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\UnRAR\.exe$
- name: '[Sigma] WinRAR Execution in Non-Standard Folder'
  tag: attack.collection,attack.t1560.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Program\ Files\ \(x86\)\\WinRAR\\|:\\Program\ Files\\WinRAR\\)
- name: '[Sigma] WinRAR Execution in Non-Standard Folder'
  tag: attack.collection,attack.t1560.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i):\\Windows\\Temp\\
- name: '[Sigma] AWL Bypass with Winrm.vbs and Malicious WsmPty.xsl/WsmTxt.xsl'
  tag: attack.defense-evasion,attack.t1216
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(format:pretty|format:"pretty"|format:"text"|format:text)
- name: '[Sigma] AWL Bypass with Winrm.vbs and Malicious WsmPty.xsl/WsmTxt.xsl'
  tag: attack.defense-evasion,attack.t1216
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^(C:\\Windows\\System32\\|C:\\Windows\\SysWOW64\\)
- name: '[Sigma] AWL Bypass with Winrm.vbs and Malicious WsmPty.xsl/WsmTxt.xsl'
  tag: attack.defense-evasion,attack.t1216
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)winrm
- name: '[Sigma] Remote Code Execute via Winrm.vbs'
  tag: attack.defense-evasion,attack.t1216
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\cscript\.exe'\}|\{'OriginalFileName':\
    'cscript\.exe'\})
- name: '[Sigma] Remote Code Execute via Winrm.vbs'
  tag: attack.defense-evasion,attack.t1216
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(winrm|invoke\ Create\ wmicimv2/Win32_|\-r:http)
- name: '[Sigma] Remote PowerShell Session Host Process (WinRM)'
  tag: attack.execution,attack.lateral-movement,attack.t1059.001,attack.t1021.006
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\wsmprovhost\.exe'\}|\{'ParentImage\|endswith':\
    '\\\\wsmprovhost\.exe'\})
- name: '[Sigma] Suspicious Processes Spawned by WinRM'
  tag: attack.t1190,attack.initial-access,attack.persistence,attack.privilege-escalation
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\wsmprovhost\.exe$
- name: '[Sigma] Suspicious Processes Spawned by WinRM'
  tag: attack.t1190,attack.initial-access,attack.persistence,attack.privilege-escalation
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\cmd\.exe|\\sh\.exe|\\bash\.exe|\\powershell\.exe|\\pwsh\.exe|\\wsl\.exe|\\schtasks\.exe|\\certutil\.exe|\\whoami\.exe|\\bitsadmin\.exe)$
- name: '[Sigma] Compress Data and Lock With Password for Exfiltration With WINZIP'
  tag: attack.collection,attack.t1560.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(winzip\.exe|winzip64\.exe)
- name: '[Sigma] Compress Data and Lock With Password for Exfiltration With WINZIP'
  tag: attack.collection,attack.t1560.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\-s"
- name: '[Sigma] Compress Data and Lock With Password for Exfiltration With WINZIP'
  tag: attack.collection,attack.t1560.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ \-min\ |\ \-a\ )
- name: '[Sigma] New ActiveScriptEventConsumer Created Via Wmic.EXE'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.003
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(ActiveScriptEventConsumer|\ CREATE\ )
- name: '[Sigma] Potential Windows Defender Tampering Via Wmic.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1047,attack.t1562
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'wmic\.exe'\}|\{'Image\|endswith':\ '\\\\WMIC\.exe'\})
- name: '[Sigma] Potential Windows Defender Tampering Via Wmic.EXE'
  tag: attack.defense-evasion,attack.execution,attack.t1047,attack.t1562
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)/Namespace:\\\\\\\\root\\\\Microsoft\\\\Windows\\\\Defender
- name: '[Sigma] New Process Created Via Wmic.EXE'
  tag: attack.execution,attack.t1047,car.2016-03-002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\wmic\.exe'\}|\{'OriginalFileName':\ 'wmic\.exe'\})
- name: '[Sigma] New Process Created Via Wmic.EXE'
  tag: attack.execution,attack.t1047,car.2016-03-002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(process|call|create)
- name: '[Sigma] Computer System Reconnaissance Via Wmic.EXE'
  tag: attack.discovery,attack.execution,attack.t1047
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\wmic\.exe'\}|\{'OriginalFileName':\ 'wmic\.exe'\})
- name: '[Sigma] Computer System Reconnaissance Via Wmic.EXE'
  tag: attack.discovery,attack.execution,attack.t1047
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)computersystem
- name: '[Sigma] Hardware Model Reconnaissance Via Wmic.EXE'
  tag: attack.execution,attack.t1047,car.2016-03-002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\wmic\.exe'\}|\{'OriginalFileName':\ 'wmic\.exe'\})
- name: '[Sigma] Hardware Model Reconnaissance Via Wmic.EXE'
  tag: attack.execution,attack.t1047,car.2016-03-002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)csproduct
- name: '[Sigma] Local Groups Reconnaissance Via Wmic.EXE'
  tag: attack.discovery,attack.t1069.001
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\wmic\.exe'\}|\{'OriginalFileName':\ 'wmic\.exe'\})
- name: '[Sigma] Local Groups Reconnaissance Via Wmic.EXE'
  tag: attack.discovery,attack.t1069.001
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)\ group
- name: '[Sigma] Windows Hotfix Updates Reconnaissance Via Wmic.EXE'
  tag: attack.execution,attack.t1047
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'wmic\.exe'\}|\{'Image\|endswith':\ '\\\\WMIC\.exe'\})
- name: '[Sigma] Windows Hotfix Updates Reconnaissance Via Wmic.EXE'
  tag: attack.execution,attack.t1047
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\ qfe
- name: '[Sigma] Process Reconnaissance Via Wmic.EXE'
  tag: attack.execution,attack.t1047
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\WMIC\.exe'\}|\{'OriginalFileName':\ 'wmic\.exe'\})
- name: '[Sigma] Process Reconnaissance Via Wmic.EXE'
  tag: attack.execution,attack.t1047
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)process
- name: '[Sigma] Process Reconnaissance Via Wmic.EXE'
  tag: attack.execution,attack.t1047
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(call|create)
- name: '[Sigma] Potential Product Reconnaissance Via Wmic.EXE'
  tag: attack.execution,attack.t1047
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\wmic\.exe'\}|\{'OriginalFileName':\ 'wmic\.exe'\})
- name: '[Sigma] Potential Product Reconnaissance Via Wmic.EXE'
  tag: attack.execution,attack.t1047
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)Product
- name: '[Sigma] Potential Product Reconnaissance Via Wmic.EXE'
  tag: attack.execution,attack.t1047
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ uninstall|\ install)
- name: '[Sigma] Potential Product Class Reconnaissance Via Wmic.EXE'
  tag: attack.execution,attack.t1047,attack.discovery,attack.t1082
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\wmic\.exe'\}|\{'OriginalFileName':\ 'wmic\.exe'\})
- name: '[Sigma] Potential Product Class Reconnaissance Via Wmic.EXE'
  tag: attack.execution,attack.t1047,attack.discovery,attack.t1082
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(AntiVirusProduct|AntiSpywareProduct|FirewallProduct)
- name: '[Sigma] Service Reconnaissance Via Wmic.EXE'
  tag: attack.execution,attack.t1047
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\WMIC\.exe'\}|\{'OriginalFileName':\ 'wmic\.exe'\})
- name: '[Sigma] Service Reconnaissance Via Wmic.EXE'
  tag: attack.execution,attack.t1047
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)service
- name: '[Sigma] Uncommon System Information Discovery Via Wmic.EXE'
  tag: attack.discovery,attack.t1082
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Description':\ 'WMI\ Commandline\ Utility'\}|\{'OriginalFileName':\
    'wmic\.exe'\}|\{'Image\|endswith':\ '\\\\WMIC\.exe'\})
- name: '[Sigma] Uncommon System Information Discovery Via Wmic.EXE'
  tag: attack.discovery,attack.t1082
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(LOGICALDISK\ get\ Name,Size,FreeSpace|os\ get\ Caption,OSArchitecture,Version)
- name: '[Sigma] Potential Unquoted Service Path Reconnaissance Via Wmic.EXE'
  tag: attack.execution,attack.t1047
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'wmic\.exe'\}|\{'Image\|endswith':\ '\\\\WMIC\.exe'\})
- name: '[Sigma] Potential Unquoted Service Path Reconnaissance Via Wmic.EXE'
  tag: attack.execution,attack.t1047
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ service\ get\ |name,displayname,pathname,startmode)
- name: '[Sigma] System Disk And Volume Reconnaissance Via Wmic.EXE'
  tag: attack.execution,attack.discovery,attack.t1047,attack.t1082
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\WMIC\.exe'\}|\{'OriginalFileName':\ 'wmic\.exe'\})
- name: '[Sigma] System Disk And Volume Reconnaissance Via Wmic.EXE'
  tag: attack.execution,attack.discovery,attack.t1047,attack.t1082
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'CommandLine\|contains':\ \['\ volumename',\ '\ logicaldisk'\]\}|\{'CommandLine\|contains\|all':\
    \['path',\ 'win32_logicaldisk'\]\}|\{'CommandLine\|contains\|all':\ \['\ volume',\
    '\ list\ '\]\})
- name: '[Sigma] WMIC Remote Command Execution'
  tag: attack.execution,attack.t1047
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\WMIC\.exe'\}|\{'OriginalFileName':\ 'wmic\.exe'\})
- name: '[Sigma] WMIC Remote Command Execution'
  tag: attack.execution,attack.t1047
  score: 50
  target: Target_Path
  condition: regex
  pattern: '(?i)/node:'
- name: '[Sigma] WMIC Remote Command Execution'
  tag: attack.execution,attack.t1047
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(localhost|127\.0\.0\.1)
- name: '[Sigma] Service Started/Stopped Via Wmic.EXE'
  tag: attack.execution,attack.t1047
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ 'wmic\.exe'\}|\{'Image\|endswith':\ '\\\\WMIC\.exe'\})
- name: '[Sigma] Service Started/Stopped Via Wmic.EXE'
  tag: attack.execution,attack.t1047
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\ service\ |\ call\ )
- name: '[Sigma] Service Started/Stopped Via Wmic.EXE'
  tag: attack.execution,attack.t1047
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(stopservice|startservice)
- name: '[Sigma] Potential SquiblyTwo Technique Execution'
  tag: attack.defense-evasion,attack.t1047,attack.t1220,attack.execution,attack.t1059.005,attack.t1059.007
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\wmic\.exe'\}|\{'OriginalFileName':\ 'wmic\.exe'\}|\{'Hashes\|contains':\
    \['IMPHASH=1B1A3F43BF37B5BFE60751F2EE2F326E',\ 'IMPHASH=37777A96245A3C74EB217308F3546F4C',\
    'IMPHASH=9D87C9D67CE724033C0B40CC4CA1B206'\]\})
- name: '[Sigma] Potential SquiblyTwo Technique Execution'
  tag: attack.defense-evasion,attack.t1047,attack.t1220,attack.execution,attack.t1059.005,attack.t1059.007
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(format:|http)
- name: '[Sigma] Suspicious WMIC Execution Via Office Process'
  tag: attack.t1204.002,attack.t1047,attack.t1218.010,attack.execution,attack.defense-evasion
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(\\WINWORD\.EXE|\\EXCEL\.EXE|\\POWERPNT\.exe|\\MSPUB\.exe|\\VISIO\.exe|\\MSACCESS\.EXE|\\EQNEDT32\.EXE|\\ONENOTE\.EXE|\\wordpad\.exe|\\wordview\.exe)$
- name: '[Sigma] Suspicious WMIC Execution Via Office Process'
  tag: attack.t1204.002,attack.t1047,attack.t1218.010,attack.execution,attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\wbem\\\\WMIC\.exe'\}|\{'OriginalFileName':\
    'wmic\.exe'\})
- name: '[Sigma] Suspicious WMIC Execution Via Office Process'
  tag: attack.t1204.002,attack.t1047,attack.t1218.010,attack.execution,attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(process|create|call)
- name: '[Sigma] Suspicious WMIC Execution Via Office Process'
  tag: attack.t1204.002,attack.t1047,attack.t1218.010,attack.execution,attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(regsvr32|rundll32|msiexec|mshta|verclsid|wscript|cscript)
- name: '[Sigma] Suspicious Process Created Via Wmic.EXE'
  tag: attack.execution,attack.t1047
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(process\ |call\ |create\ )
- name: '[Sigma] Suspicious Process Created Via Wmic.EXE'
  tag: attack.execution,attack.t1047
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(rundll32|bitsadmin|regsvr32|cmd\.exe\ /c\ |cmd\.exe\ /k\ |cmd\.exe\
    /r\ |cmd\ /c\ |cmd\ /k\ |cmd\ /r\ |powershell|pwsh|certutil|cscript|wscript|mshta|\\Users\\Public\\|\\Windows\\Temp\\|\\AppData\\Local\\|%temp%|%tmp%|%ProgramData%|%appdata%|%comspec%|%localappdata%)
- name: '[Sigma] Application Terminated Via Wmic.EXE'
  tag: attack.execution,attack.t1047
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\WMIC\.exe'\}|\{'OriginalFileName':\ 'wmic\.exe'\})
- name: '[Sigma] Application Terminated Via Wmic.EXE'
  tag: attack.execution,attack.t1047
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(call|terminate)
- name: '[Sigma] Application Removed Via Wmic.EXE'
  tag: attack.execution,attack.t1047
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\WMIC\.exe'\}|\{'OriginalFileName':\ 'wmic\.exe'\})
- name: '[Sigma] Application Removed Via Wmic.EXE'
  tag: attack.execution,attack.t1047
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(call|uninstall)
- name: '[Sigma] Potential Tampering With Security Products Via WMIC'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(wmic|product\ where\ |call|uninstall|/nointeractive)
- name: '[Sigma] Potential Tampering With Security Products Via WMIC'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(wmic|caption\ like\ )
- name: '[Sigma] Potential Tampering With Security Products Via WMIC'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(call\ delete|call\ terminate)
- name: '[Sigma] Potential Tampering With Security Products Via WMIC'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(process\ |where\ |delete)
- name: '[Sigma] Potential Tampering With Security Products Via WMIC'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(%carbon%|%cylance%|%endpoint%|%eset%|%malware%|%Sophos%|%symantec%|Antivirus|AVG\
    |Carbon\ Black|CarbonBlack|Cb\ Defense\ Sensor\ 64\-bit|Crowdstrike\ Sensor|Cylance\
    |Dell\ Threat\ Defense|DLP\ Endpoint|Endpoint\ Detection|Endpoint\ Protection|Endpoint\
    Security|Endpoint\ Sensor|ESET\ File\ Security|LogRhythm\ System\ Monitor\ Service|Malwarebytes|McAfee\
    Agent|Microsoft\ Security\ Client|Sophos\ Anti\-Virus|Sophos\ AutoUpdate|Sophos\
    Credential\ Store|Sophos\ Management\ Console|Sophos\ Management\ Database|Sophos\
    Management\ Server|Sophos\ Remote\ Management\ System|Sophos\ Update\ Manager|Threat\
    Protection|VirusScan|Webroot\ SecureAnywhere|Windows\ Defender)
- name: '[Sigma] XSL Script Execution Via WMIC.EXE'
  tag: attack.defense-evasion,attack.t1220
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\wmic\.exe$
- name: '[Sigma] XSL Script Execution Via WMIC.EXE'
  tag: attack.defense-evasion,attack.t1220
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\-format
- name: '[Sigma] XSL Script Execution Via WMIC.EXE'
  tag: attack.defense-evasion,attack.t1220
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(Format:List|Format:htable|Format:hform|Format:table|Format:mof|Format:value|Format:rawxml|Format:xml|Format:csv)
- name: '[Sigma] WmiPrvSE Spawned A Process'
  tag: attack.execution,attack.t1047
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\WmiPrvSe\.exe$
- name: '[Sigma] WmiPrvSE Spawned A Process'
  tag: attack.execution,attack.t1047
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(0x3e7|null)
- name: '[Sigma] WmiPrvSE Spawned A Process'
  tag: attack.execution,attack.t1047
  score: 50
  target: User
  condition: regex
  pattern: (?i)(AUTHORI|AUTORI)
- name: '[Sigma] WmiPrvSE Spawned A Process'
  tag: attack.execution,attack.t1047
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\WmiPrvSE\.exe$
- name: '[Sigma] WmiPrvSE Spawned A Process'
  tag: attack.execution,attack.t1047
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\WerFault\.exe$
- name: '[Sigma] WmiPrvSE Spawned A Process'
  tag: attack.execution,attack.t1047
  score: 50
  target: Full_Path
  condition: regex
  pattern: None
- name: '[Sigma] Potential WMI Lateral Movement WmiPrvSE Spawned PowerShell'
  tag: attack.execution,attack.t1047,attack.t1059.001
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)\\WmiPrvSE\.exe$
- name: '[Sigma] Potential WMI Lateral Movement WmiPrvSE Spawned PowerShell'
  tag: attack.execution,attack.t1047,attack.t1059.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ \['\\\\powershell\.exe',\ '\\\\pwsh\.exe'\]\}|\{'OriginalFileName':\
    \['PowerShell\.EXE',\ 'pwsh\.dll'\]\})
- name: '[Sigma] Suspicious WmiPrvSE Child Process'
  tag: attack.execution,attack.defense-evasion,attack.t1047,attack.t1204.002,attack.t1218.010
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)\\wbem\\WmiPrvSE\.exe$
- name: '[Sigma] Suspicious WmiPrvSE Child Process'
  tag: attack.execution,attack.defense-evasion,attack.t1047,attack.t1204.002,attack.t1218.010
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\certutil\.exe|\\cscript\.exe|\\mshta\.exe|\\msiexec\.exe|\\regsvr32\.exe|\\rundll32\.exe|\\verclsid\.exe|\\wscript\.exe)$
- name: '[Sigma] Suspicious WmiPrvSE Child Process'
  tag: attack.execution,attack.defense-evasion,attack.t1047,attack.t1204.002,attack.t1218.010
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\cmd\.exe$
- name: '[Sigma] Suspicious WmiPrvSE Child Process'
  tag: attack.execution,attack.defense-evasion,attack.t1047,attack.t1204.002,attack.t1218.010
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(cscript|mshta|powershell|pwsh|regsvr32|rundll32|wscript)
- name: '[Sigma] Suspicious WmiPrvSE Child Process'
  tag: attack.execution,attack.defense-evasion,attack.t1047,attack.t1204.002,attack.t1218.010
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\WerFault\.exe$
- name: '[Sigma] Suspicious WmiPrvSE Child Process'
  tag: attack.execution,attack.defense-evasion,attack.t1047,attack.t1204.002,attack.t1218.010
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\WmiPrvSE\.exe$
- name: '[Sigma] Suspicious WmiPrvSE Child Process'
  tag: attack.execution,attack.defense-evasion,attack.t1047,attack.t1204.002,attack.t1218.010
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\msiexec\.exe$
- name: '[Sigma] Suspicious WmiPrvSE Child Process'
  tag: attack.execution,attack.defense-evasion,attack.t1047,attack.t1204.002,attack.t1218.010
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)/i\ '
- name: '[Sigma] WMI Backdoor Exchange Transport Agent'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.003
  score: 100
  target: ParentPath
  condition: regex
  pattern: (?i)\\EdgeTransport\.exe$
- name: '[Sigma] WMI Backdoor Exchange Transport Agent'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.003
  score: 100
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\conhost\.exe
- name: '[Sigma] WMI Backdoor Exchange Transport Agent'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.003
  score: 100
  target: Target_Path
  condition: regex
  pattern: ^C:\\Program\ Files\\Microsoft\\Exchange\ Server\\
- name: '[Sigma] WMI Backdoor Exchange Transport Agent'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.003
  score: 100
  target: Target_Path
  condition: regex
  pattern: (?i)\\Bin\\OleConverter\.exe$
- name: '[Sigma] WMI Persistence - Script Event Consumer'
  tag: attack.persistence,attack.privilege-escalation,attack.t1546.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\WINDOWS\\system32\\wbem\\scrcons\.exe
- name: '[Sigma] WMI Persistence - Script Event Consumer'
  tag: attack.persistence,attack.privilege-escalation,attack.t1546.003
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\svchost\.exe
- name: '[Sigma] UEFI Persistence Via Wpbbin - ProcessCreation'
  tag: attack.persistence,attack.defense-evasion,attack.t1542.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\wpbbin\.exe
- name: '[Sigma] Potential Dropper Script Execution Via WScript/CScript'
  tag: attack.execution,attack.t1059.005,attack.t1059.007
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\wscript\.exe|\\cscript\.exe)$
- name: '[Sigma] Potential Dropper Script Execution Via WScript/CScript'
  tag: attack.execution,attack.t1059.005,attack.t1059.007
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Temp\\|:\\Tmp\\|:\\Users\\Public\\|:\\Windows\\Temp\\|\\AppData\\Local\\Temp\\)
- name: '[Sigma] Potential Dropper Script Execution Via WScript/CScript'
  tag: attack.execution,attack.t1059.005,attack.t1059.007
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\.js|\.jse|\.vba|\.vbe|\.vbs|\.wsf)
- name: '[Sigma] Cscript/Wscript Potentially Suspicious Child Process'
  tag: attack.execution
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(\\wscript\.exe|\\cscript\.exe)$
- name: '[Sigma] Cscript/Wscript Potentially Suspicious Child Process'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\cmd\.exe|\\powershell\.exe|\\pwsh\.exe)$
- name: '[Sigma] Cscript/Wscript Potentially Suspicious Child Process'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(mshta|http)
- name: '[Sigma] Cscript/Wscript Potentially Suspicious Child Process'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(rundll32|regsvr32|msiexec)
- name: '[Sigma] Cscript/Wscript Potentially Suspicious Child Process'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\rundll32\.exe$
- name: '[Sigma] Cscript/Wscript Potentially Suspicious Child Process'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\rundll32\.exe$
- name: '[Sigma] Cscript/Wscript Potentially Suspicious Child Process'
  tag: attack.execution
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(UpdatePerUserSystemParameters|PrintUIEntry|ClearMyTracksByProcess)
- name: '[Sigma] Cscript/Wscript Uncommon Script Extension Execution'
  tag: attack.execution,attack.t1059.005,attack.t1059.007
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'OriginalFileName':\ \['wscript\.exe',\ 'cscript\.exe'\]\}|\{'Image\|endswith':\
    \['\\\\wscript\.exe',\ '\\\\cscript\.exe'\]\})
- name: '[Sigma] Cscript/Wscript Uncommon Script Extension Execution'
  tag: attack.execution,attack.t1059.005,attack.t1059.007
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\.csv|\.dat|\.doc|\.gif|\.jpeg|\.jpg|\.png|\.ppt|\.txt|\.xls|\.xml)
- name: '[Sigma] WSL Child Process Anomaly'
  tag: attack.execution,attack.defense-evasion,attack.t1218,attack.t1202
  score: 50
  target: ParentPath
  condition: regex
  pattern: (?i)(\\wsl\.exe|\\wslhost\.exe)$
- name: '[Sigma] WSL Child Process Anomaly'
  tag: attack.execution,attack.defense-evasion,attack.t1218,attack.t1202
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\calc\.exe|\\cmd\.exe|\\cscript\.exe|\\mshta\.exe|\\powershell\.exe|\\pwsh\.exe|\\regsvr32\.exe|\\rundll32\.exe|\\wscript\.exe)$
- name: '[Sigma] WSL Child Process Anomaly'
  tag: attack.execution,attack.defense-evasion,attack.t1218,attack.t1202
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\AppData\\Local\\Temp\\|C:\\Users\\Public\\|C:\\Windows\\Temp\\|C:\\Temp\\|\\Downloads\\|\\Desktop\\)
- name: '[Sigma] Windows Binary Executed From WSL'
  tag: attack.execution,attack.defense-evasion,attack.t1202
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\[a\-zA\-Z\]:\\\\
- name: '[Sigma] Windows Binary Executed From WSL'
  tag: attack.execution,attack.defense-evasion,attack.t1202
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\\\\\\\wsl\.localhost
- name: '[Sigma] Proxy Execution Via Wuauclt.EXE'
  tag: attack.defense-evasion,attack.t1218,attack.execution
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\wuauclt\.exe'\}|\{'OriginalFileName':\
    'wuauclt\.exe'\})
- name: '[Sigma] Proxy Execution Via Wuauclt.EXE'
  tag: attack.defense-evasion,attack.t1218,attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(UpdateDeploymentProvider|RunHandlerComServer)
- name: '[Sigma] Proxy Execution Via Wuauclt.EXE'
  tag: attack.defense-evasion,attack.t1218,attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ /UpdateDeploymentProvider\ UpdateDeploymentProvider\.dll\ '
- name: '[Sigma] Proxy Execution Via Wuauclt.EXE'
  tag: attack.defense-evasion,attack.t1218,attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)\ wuaueng\.dll\ '
- name: '[Sigma] Proxy Execution Via Wuauclt.EXE'
  tag: attack.defense-evasion,attack.t1218,attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Windows\\UUS\\Packages\\Preview\\amd64\\updatedeploy\.dll\ /ClassId|:\\Windows\\UUS\\amd64\\UpdateDeploy\.dll\
    /ClassId)
- name: '[Sigma] Proxy Execution Via Wuauclt.EXE'
  tag: attack.defense-evasion,attack.t1218,attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Windows\\WinSxS\\|\\UpdateDeploy\.dll\ /ClassId\ )
- name: '[Sigma] Suspicious Windows Update Agent Empty Cmdline'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\Wuauclt\.exe'\}|\{'OriginalFileName':\
    'Wuauclt\.exe'\})
- name: '[Sigma] Suspicious Windows Update Agent Empty Cmdline'
  tag: attack.defense-evasion,attack.t1036
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(Wuauclt|Wuauclt\.exe)$
- name: '[Sigma] Cab File Extraction Via Wusa.EXE From Potentially Suspicious Paths'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\wusa\.exe$
- name: '[Sigma] Cab File Extraction Via Wusa.EXE From Potentially Suspicious Paths'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: '(?i)/extract:'
- name: '[Sigma] Cab File Extraction Via Wusa.EXE From Potentially Suspicious Paths'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\PerfLogs\\|:\\Users\\Public\\|:\\Windows\\Temp\\|\\Appdata\\Local\\Temp\\)
- name: '[Sigma] Wusa.EXE Executed By Parent Process Located In Suspicious Location'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\wusa\.exe$
- name: '[Sigma] Wusa.EXE Executed By Parent Process Located In Suspicious Location'
  tag: attack.execution
  score: 80
  target: ParentPath
  condition: regex
  pattern: (?i)(:\\Perflogs\\|:\\Users\\Public\\|:\\Windows\\Temp\\|\\Appdata\\Local\\Temp\\|\\Temporary\
    Internet)
- name: '[Sigma] Wusa.EXE Executed By Parent Process Located In Suspicious Location'
  tag: attack.execution
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'ParentImage\|contains\|all':\ \[':\\\\Users\\\\',\ '\\\\Favorites\\\\'\]\}|\{'ParentImage\|contains\|all':\
    \[':\\\\Users\\\\',\ '\\\\Favourites\\\\'\]\}|\{'ParentImage\|contains\|all':\
    \[':\\\\Users\\\\',\ '\\\\Contacts\\\\'\]\}|\{'ParentImage\|contains\|all':\ \[':\\\\Users\\\\',\
    '\\\\Pictures\\\\'\]\})
- name: '[Sigma] Wusa.EXE Executed By Parent Process Located In Suspicious Location'
  tag: attack.execution
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\.msu
- name: '[Sigma] Xwizard.EXE Execution From Non-Default Location'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|endswith':\ '\\\\xwizard\.exe'\}|\{'OriginalFileName':\
    'xwizard\.exe'\})
- name: '[Sigma] Xwizard.EXE Execution From Non-Default Location'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^(C:\\Windows\\System32\\|C:\\Windows\\SysWOW64\\|C:\\Windows\\WinSxS\\)
- name: '[Sigma] COM Object Execution via Xwizard.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)RunWizard
- name: '[Sigma] COM Object Execution via Xwizard.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\\{\[a\-fA\-F0\-9\]\{8\}\-\[a\-fA\-F0\-9\]\{4\}\-\[a\-fA\-F0\-9\]\{4\}\-\[a\-fA\-F0\-9\]\{4\}\-\[a\-fA\-F0\-9\]\{12\}\\\}
noise_filters: []
