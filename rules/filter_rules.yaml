# ============================================================
#  SkiaHelios Centralized Noise Filters
#  filter_rules.yaml v2.0
#  Mission: Consolidated noise definitions from Chronos/Pandora/Lachesis
# ============================================================

noise_filters:
  # ═══════════════════════════════════════════════════════════════
  # System Paths - Windows Core
  # ═══════════════════════════════════════════════════════════════
  - target: "ParentPath"
    condition: "contains"
    pattern: "windows\\winsxs"
  - target: "ParentPath"
    condition: "contains"
    pattern: "windows\\assembly"
  - target: "ParentPath"
    condition: "contains"
    pattern: "windows\\installer"
  - target: "ParentPath"
    condition: "contains"
    pattern: "windows\\servicing"
  - target: "ParentPath"
    condition: "contains"
    pattern: "microsoft.net"
  - target: "ParentPath"
    condition: "contains"
    pattern: "windows\\system32\\config"
  - target: "ParentPath"
    condition: "contains"
    pattern: "softwaredistribution"
  - target: "ParentPath"
    condition: "contains"
    pattern: "program files\\windowsapps"
  - target: "ParentPath"
    condition: "contains"
    pattern: "windows\\infusedapps"

  # ═══════════════════════════════════════════════════════════════
  # Application Noise
  # ═══════════════════════════════════════════════════════════════
  - target: "ParentPath"
    condition: "contains"
    pattern: "onedrive"
  - target: "ParentPath"
    condition: "contains"
    pattern: "dropbox"
  - target: "ParentPath"
    condition: "contains"
    pattern: "googledrivesync"
  - target: "ParentPath"
    condition: "contains"
    pattern: "macromedia"
  - target: "ParentPath"
    condition: "contains"
    pattern: "flash player"
  - target: "ParentPath"
    condition: "contains"
    pattern: "sharedobjects"
  - target: "ParentPath"
    condition: "contains"
    pattern: "appdata\\local\\packages"
  - target: "ParentPath"
    condition: "contains"
    pattern: "templates"
  - target: "ParentPath"
    condition: "contains"
    pattern: "windows defender"
  - target: "ParentPath"
    condition: "contains"
    pattern: "windows media player"
  - target: "ParentPath"
    condition: "contains"
    pattern: "mcafee"
  - target: "ParentPath"
    condition: "contains"
    pattern: "true key"

  # ═══════════════════════════════════════════════════════════════
  # Browser Cache / Temp
  # ═══════════════════════════════════════════════════════════════
  - target: "ParentPath"
    condition: "contains"
    pattern: "inetcache"
  - target: "ParentPath"
    condition: "contains"
    pattern: "temporary internet files"
  - target: "ParentPath"
    condition: "contains"
    pattern: "appdata\\local\\temp"
  - target: "ParentPath"
    condition: "contains"
    pattern: "windows\\temp"

  # ═══════════════════════════════════════════════════════════════
  # [v6.7] Windows UI Components - False Positive Patterns
  # ═══════════════════════════════════════════════════════════════
  - target: "ParentPath"
    condition: "contains"
    pattern: "windows\\systemresources"
  - target: "FileName"
    condition: "contains"
    pattern: "deeplink"
  - target: "FileName"
    condition: "contains"
    pattern: "deeplinkitem"
  - target: "FileName"
    condition: "contains"
    pattern: "deeplinkslist"
  - target: "FileName"
    condition: "contains"
    pattern: "passwordbox"
  - target: "FileName"
    condition: "contains"
    pattern: "password.xaml"
  - target: "FileName"
    condition: "contains"
    pattern: "loginmanager.js"
  - target: "FileName"
    condition: "contains"
    pattern: "loginhandlermanager.js"
  - target: "FileName"
    condition: "contains"
    pattern: "login-bg.svg"

  # ═══════════════════════════════════════════════════════════════
  # [v6.9.6] OneDrive SyncEngine Log Files (Massive Noise)
  # ═══════════════════════════════════════════════════════════════
  - target: "FileName"
    condition: "regex"
    pattern: "(?i)(syncengine|filecoauth)-[0-9]{4}-[0-9]{2}-[0-9]{2}\\.[0-9]+\\.[0-9]+\\.[0-9]+\\.(odl|aodl|odlgz|odlsent)"
  
  # ═══════════════════════════════════════════════════════════════
  # [v6.9.6] Office Copilot / PowerPoint JS Cache
  # ═══════════════════════════════════════════════════════════════
  - target: "FileName"
    condition: "regex"
    pattern: "(?i)(powerpoint|word|excel|onenote)-[a-z0-9.-]+.*_[a-f0-9]{32}\\.js"
  - target: "FileName"
    condition: "regex"
    pattern: "(?i)[a-z]{2}-[a-z]{2}-ui-strings-json_[a-f0-9]{32}\\.js"
  - target: "FileName"
    condition: "regex"
    pattern: "(?i)sccserviceciq_[a-f0-9]{32}\\.js"
  
  # ═══════════════════════════════════════════════════════════════
  # [v6.9.6] Windows Defender Delta Patches
  # ═══════════════════════════════════════════════════════════════
  - target: "FileName"
    condition: "regex"
    pattern: "(?i)(am_delta_patch|mpas-fe|mpas-seam|nis_full).*\\.exe"

  # ═══════════════════════════════════════════════════════════════
  # [v6.9.6] TokenBroker Cache Files (.tbres)
  # ═══════════════════════════════════════════════════════════════
  - target: "FileName"
    condition: "regex"
    pattern: "(?i)[a-f0-9]{40}\\.tbres"

  # ═══════════════════════════════════════════════════════════════
  # [v6.9.7] Windows SxS / Servicing / Component Noise
  # ═══════════════════════════════════════════════════════════════
  - target: "FileName"
    condition: "regex"
    pattern: "(?i)(amd64|wow64|msil)_.*_31bf3856ad364e35"
  - target: "FileName"
    condition: "regex"
    pattern: "(?i)\\.(mum|cat|manifest|cdf-ms)$"
  - target: "FileName"
    condition: "regex"
    pattern: "(?i)bootmgr\\.exe\\.mui"
  
  - target: "FileName"
    condition: "contains"
    pattern: "settingcontent-ms"
  - target: "FileName"
    condition: "contains"
    pattern: "destinationmapcontrol"
  - target: "FileName"
    condition: "contains"
    pattern: "emoticontranslationmap"

  # ═══════════════════════════════════════════════════════════════
  # [v6.7] Browser Cache Artifacts
  # ═══════════════════════════════════════════════════════════════
  - target: "FileName"
    condition: "contains"
    pattern: "shadow[1]"
  - target: "FileName"
    condition: "contains"
    pattern: "slide_shadow"
  - target: "FileName"
    condition: "contains"
    pattern: "floor_shadow"
  - target: "FileName"
    condition: "contains"
    pattern: "secret[1].png"
  - target: "FileName"
    condition: "contains"
    pattern: "login[1].js"
  - target: "FileName"
    condition: "contains"
    pattern: "accountlogininfo"
  - target: "FileName"
    condition: "ends_with"
    pattern: ".eftx"
  - target: "FileName"
    condition: "contains"
    pattern: "drive-gdoc"
  - target: "FileName"
    condition: "contains"
    pattern: "drive-sync"
  - target: "FileName"
    condition: "contains"
    pattern: "fatsecret"
  - target: "FileName"
    condition: "contains"
    pattern: "callback.js"

  # ═══════════════════════════════════════════════════════════════
  # [v6.7] GUID Pattern Files - System Cache (Not WebShells)
  # ═══════════════════════════════════════════════════════════════
  - target: "FileName"
    condition: "regex"
    pattern: "^classic_\\{[0-9a-f]{8}-"
  - target: "FileName"
    condition: "regex"
    pattern: "^\\{[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-"
  - target: "FileName"
    condition: "regex"
    pattern: "^\\^[0-9a-f]{32,}"
  - target: "FileName"
    condition: "contains"
    pattern: "pwin10_"

  # ═══════════════════════════════════════════════════════════════
  # [v6.7] XAMPP Component Noise (False Positives)
  # ═══════════════════════════════════════════════════════════════
  - target: "ParentPath"
    condition: "contains"
    pattern: "xampp\\php\\pear"
  - target: "ParentPath"
    condition: "contains"
    pattern: "xampp\\apache\\manual"
  - target: "ParentPath"
    condition: "contains"
    pattern: "xampp\\tomcat\\webapps\\docs"
  - target: "ParentPath"
    condition: "contains"
    pattern: "xampp\\tomcat\\webapps\\examples"
  - target: "ParentPath"
    condition: "contains"
    pattern: "xampp\\licenses"
  - target: "ParentPath"
    condition: "contains"
    pattern: "xampp\\locale"
  - target: "ParentPath"
    condition: "contains"
    pattern: "xampp\\php\\docs"
  - target: "ParentPath"
    condition: "contains"
    pattern: "xampp\\cgi-bin"
  - target: "ParentPath"
    condition: "contains"
    pattern: "xampp\\contrib"
  - target: "ParentPath"
    condition: "contains"
    pattern: "xampp\\perl\\lib"
  - target: "ParentPath"
    condition: "contains"
    pattern: "xampp\\perl\\vendor"
  - target: "ParentPath"
    condition: "contains"
    pattern: "apache\\icons"
  - target: "ParentPath"
    condition: "contains"
    pattern: "mercurymail"
  - target: "ParentPath"
    condition: "contains"
    pattern: "mysql\\data"
  - target: "ParentPath"
    condition: "contains"
    pattern: "phpmyadmin"
  - target: "ParentPath"
    condition: "contains"
    pattern: "webalizer"
  - target: "ParentPath"
    condition: "contains"
    pattern: "sendmail"
  - target: "ParentPath"
    condition: "contains"
    pattern: "tomcat\\webapps"
  - target: "FileName"
    condition: "starts_with"
    pattern: "sess_"
  - target: "ParentPath"
    condition: "contains"
    pattern: "pear\\tests"
  - target: "ParentPath"
    condition: "contains"
    pattern: "dashboard"
  - target: "ParentPath"
    condition: "contains"
    pattern: "php\\extras"
  - target: "ParentPath"
    condition: "contains"
    pattern: "php\\tests"
  - target: "ParentPath"
    condition: "contains"
    pattern: "perl\\bin"
  - target: "ParentPath"
    condition: "contains"
    pattern: "perl\\site"
  - target: "ParentPath"
    condition: "contains"
    pattern: "apache\\include"
  - target: "ParentPath"
    condition: "contains"
    pattern: "apache\\modules"
  - target: "ParentPath"
    condition: "contains"
    pattern: "mysql\\share"
  - target: "ParentPath"
    condition: "contains"
    pattern: "webdav"
  - target: "ParentPath"
    condition: "contains"
    pattern: "dvwa\\dvwa\\images"
  - target: "ParentPath"
    condition: "contains"
    pattern: "dvwa\\dvwa\\css"
  - target: "ParentPath"
    condition: "contains"
    pattern: "dvwa\\external"

  - target: "ParentPath"
    condition: "contains"
    pattern: "xampp\\img"
  - target: "ParentPath"
    condition: "contains"
    pattern: "hackable\\users"
  - target: "FileName"
    condition: "equals"
    pattern: "favicon.ico"
  - target: "ParentPath"
    condition: "contains"
    pattern: "apache\\include"
  - target: "ParentPath"
    condition: "contains"
    pattern: "apache\\modules"
  - target: "ParentPath"
    condition: "contains"
    pattern: "mysql\\share"
  - target: "ParentPath"
    condition: "contains"
    pattern: "phpmyadmin\\locale"

  # ═══════════════════════════════════════════════════════════════
  # Extension-Based Noise
  # ═══════════════════════════════════════════════════════════════
  - target: "FileName"
    condition: "ends_with"
    pattern: ".mui"
  - target: "FileName"
    condition: "ends_with"
    pattern: ".nls"
  - target: "FileName"
    condition: "ends_with"
    pattern: ".lng"
  - target: "FileName"
    condition: "ends_with"
    pattern: ".template"
  - target: "FileName"
    condition: "ends_with"
    pattern: ".provxml"
  - target: "FileName"
    condition: "ends_with"
    pattern: ".pak"
  - target: "FileName"
    condition: "ends_with"
    pattern: ".dll"
  - target: "FileName"
    condition: "ends_with"
    pattern: ".jar"
  - target: "FileName"
    condition: "ends_with"
    pattern: ".so"
  - target: "FileName"
    condition: "ends_with"
    pattern: ".chm"
  - target: "FileName"
    condition: "ends_with"
    pattern: ".hlp"
  - target: "FileName"
    condition: "is_in"
    pattern: ["readme.txt", "license.txt", "install.txt"]

  # ═══════════════════════════════════════════════════════════════
  # Exact File Name Noise
  # ═══════════════════════════════════════════════════════════════
  - target: "FileName"
    condition: "is_in"
    pattern:
      - "desktop.ini"
      - "thumbs.db"
      - "ntuser.dat"
      - "usrclass.dat"
      - "iconcache.db"
      - "gdipfontcache"
      - "bistats.lock"
      - "edb.log"

  # ═══════════════════════════════════════════════════════════════
  # Partial Match Noise (Keywords)
  # ═══════════════════════════════════════════════════════════════
  - target: "FileName"
    condition: "contains"
    pattern: "safe browsing"
  - target: "FileName"
    condition: "contains"
    pattern: ".qml"
  - target: "FileName"
    condition: "contains"
    pattern: "edb00"

# ═══════════════════════════════════════════════════════════════
# Dual-Use Tool Trap Configuration
# ═══════════════════════════════════════════════════════════════
dual_use_tools:
  folders:
    - "nmap"
    - "wireshark"
    - "python"
    - "perl"
    - "ruby"
    - "java"
    - "jdk"
    - "jre"
    - "tcl"
    - "tor browser"
  protected_binaries:
    - "nmap.exe"
    - "zenmap.exe"
    - "ncat.exe"
    - "wireshark.exe"
    - "tshark.exe"
    - "capinfos.exe"
    - "dumpcap.exe"
    - "python.exe"
    - "pythonw.exe"
    - "pip.exe"
    - "java.exe"
    - "javaw.exe"
    - "javac.exe"
    - "ruby.exe"
    - "perl.exe"
    - "tor.exe"

# ═══════════════════════════════════════════════════════════════
# Triage Mode Aggressive Extensions (Optional)
# ═══════════════════════════════════════════════════════════════
triage_extensions:
  - ".ldb"
  - "-journal"
  - ".sys"
  - ".lst"
  - ".cab"
  - ".pyd"
  - ".lock"
  - ".log"
  - ".aux"
  - ".bmp"
  - ".gif"
  - ".rbf"
  - ".ni.dll"
