'#': Imported by SH_CharonBridge on registry
threat_signatures:
- name: '[Sigma] Potential Persistence Via Disk Cleanup Handler - Registry'
  tag: attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)CreateKey
- name: '[Sigma] Potential Persistence Via Disk Cleanup Handler - Registry'
  tag: attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\VolumeCaches\\
- name: '[Sigma] Potential Persistence Via Disk Cleanup Handler - Registry'
  tag: attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Active\ Setup\ Temp\ Folders|\\BranchCache|\\Content\ Indexer\ Cleaner|\\D3D\
    Shader\ Cache|\\Delivery\ Optimization\ Files|\\Device\ Driver\ Packages|\\Diagnostic\
    Data\ Viewer\ database\ files|\\Downloaded\ Program\ Files|\\DownloadsFolder|\\Feedback\
    Hub\ Archive\ log\ files|\\Internet\ Cache\ Files|\\Language\ Pack|\\Microsoft\
    Office\ Temp\ Files|\\Offline\ Pages\ Files|\\Old\ ChkDsk\ Files|\\Previous\ Installations|\\Recycle\
    Bin|\\RetailDemo\ Offline\ Content|\\Setup\ Log\ Files|\\System\ error\ memory\
    dump\ files|\\System\ error\ minidump\ files|\\Temporary\ Files|\\Temporary\ Setup\
    Files|\\Temporary\ Sync\ Files|\\Thumbnail\ Cache|\\Update\ Cleanup|\\Upgrade\
    Discarded\ Files|\\User\ file\ versions|\\Windows\ Defender|\\Windows\ Error\
    Reporting\ Files|\\Windows\ ESD\ installation\ files|\\Windows\ Upgrade\ Log\
    Files)$
- name: '[Sigma] Windows Recall Feature Enabled - DisableAIDataAnalysis Value Deleted'
  tag: attack.collection,attack.t1113
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DeleteValue
- name: '[Sigma] Windows Recall Feature Enabled - DisableAIDataAnalysis Value Deleted'
  tag: attack.collection,attack.t1113
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Windows\\WindowsAI\\DisableAIDataAnalysis$
- name: '[Sigma] Folder Removed From Exploit Guard ProtectedFolders List - Registry'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DeleteValue
- name: '[Sigma] Folder Removed From Exploit Guard ProtectedFolders List - Registry'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)SOFTWARE\\Microsoft\\Windows\ Defender\\Windows\ Defender\ Exploit\
    Guard\\Controlled\ Folder\ Access\\ProtectedFolders
- name: '[Sigma] Terminal Server Client Connection History Cleared - Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1070,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DeleteValue
- name: '[Sigma] Terminal Server Client Connection History Cleared - Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1070,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Terminal\ Server\ Client\\Default\\MRU
- name: '[Sigma] Terminal Server Client Connection History Cleared - Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1070,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DeleteKey
- name: '[Sigma] Terminal Server Client Connection History Cleared - Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1070,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Terminal\ Server\ Client\\Servers\\
- name: '[Sigma] Removal Of AMSI Provider Registry Keys'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{2781761E\-28E0\-4109\-99FE\-B9D127C57AFE\}|\{A7C452EF\-8E9F\-42EB\-9F2B\-245613CA0DC9\})$
- name: '[Sigma] Removal Of AMSI Provider Registry Keys'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^(C:\\ProgramData\\Microsoft\\Windows\ Defender\\Platform\\|C:\\Program\
    Files\\Windows\ Defender\\|C:\\Program\ Files\ \(x86\)\\Windows\ Defender\\)
- name: '[Sigma] Removal Of AMSI Provider Registry Keys'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\MsMpEng\.exe$
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\shell\\open\\command$
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\explorer\.exe$
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\system32\\svchost\.exe
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Windows\\System32\\msiexec\.exe|C:\\Windows\\SysWOW64\\msiexec\.exe)
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^(C:\\Program\ Files\\|C:\\Program\ Files\ \(x86\)\\)
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\OpenWith\.exe
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\Dropbox\.exe$
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Dropbox\.
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\AppData\\Local\\Temp\\Wireshark_uninstaller\.exe$
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\wireshark\-capture\-file\\
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)peazip
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\PeaZip\.
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\Everything\.exe$
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Everything\.
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^C:\\Windows\\Installer\\MSI
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^C:\\Program\ Files\ \(x86\)\\Java\\
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\installer\.exe$
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Classes\\WOW6432Node\\CLSID\\\{4299124F\-F2C3\-41b4\-9C73\-9236B2AD0E8F\}
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\Microsoft\\EdgeUpdate\\Install
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\ \(x86\)\\Avira\\Antivirus\\|C:\\Program\ Files\\Avira\\Antivirus\\)
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\CLSID\\\{305CA226\-D286\-468e\-B848\-2B2E8E697B74\}\\Shell\\Open\\Command|\\AntiVir\.Keyfile\\shell\\open\\command)$
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Image\|contains\|all':\ \['AppData\\\\Local\\\\Temp',\ '\\\\setup\.exe'\]\}|\{'Image\|contains\|all':\
    \['\\\\Temp\\\\is\-',\ '\\\\target\.tmp'\]\})
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\ninite\.exe$
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\reg\.exe$
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Discord\\shell\\open\\command$
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\Spotify\.exe$
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Spotify\\shell\\open\\command$
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\eclipse\\eclipse\.exe$
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)_Classes\\eclipse\+
- name: '[Sigma] Removal of Potential COM Hijacking Registry Keys'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\Temp|\\TeamViewer)
- name: '[Sigma] Removal Of Index Value to Hide Schedule Task - Registry'
  tag: attack.defense-evasion,attack.t1562
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\SOFTWARE\\Microsoft\\Windows\ NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\|Index)
- name: '[Sigma] Removal Of SD Value to Hide Schedule Task - Registry'
  tag: attack.defense-evasion,attack.t1562
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\SOFTWARE\\Microsoft\\Windows\ NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\|SD)
- name: '[Sigma] Creation of a Local Hidden User Account by Registry'
  tag: attack.persistence,attack.t1136.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\SAM\\SAM\\Domains\\Account\\Users\\Names\\
- name: '[Sigma] Creation of a Local Hidden User Account by Registry'
  tag: attack.persistence,attack.t1136.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\$\\\(Default\)$
- name: '[Sigma] Creation of a Local Hidden User Account by Registry'
  tag: attack.persistence,attack.t1136.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\lsass\.exe$
- name: '[Sigma] UAC Bypass Via Wsreset'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\AppX82a6gwre4fdg3bt635tn5ctqjf8msdd2\\Shell\\open\\command$
- name: '[Sigma] CMSTP Execution Registry Event'
  tag: attack.defense-evasion,attack.execution,attack.t1218.003,attack.g0069,car.2019-04-001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\cmmgr32\.exe
- name: '[Sigma] Disable Security Events Logging Adding Reg Key MiniNt'
  tag: attack.persistence,attack.defense-evasion,attack.t1562.002,attack.t1112,car.2022-03-001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'TargetObject':\ 'HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\MiniNt',\
    'EventType':\ 'CreateKey'\}|\{'NewName':\ 'HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\MiniNt'\})
- name: '[Sigma] Wdigest CredGuard Registry Modification'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\IsCredGuardEnabled$
- name: '[Sigma] Esentutl Volume Shadow Copy Service Keys'
  tag: attack.credential-access,attack.t1003.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)System\\CurrentControlSet\\Services\\VSS
- name: '[Sigma] Esentutl Volume Shadow Copy Service Keys'
  tag: attack.credential-access,attack.t1003.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)esentutl\.exe$
- name: '[Sigma] Esentutl Volume Shadow Copy Service Keys'
  tag: attack.credential-access,attack.t1003.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)System\\CurrentControlSet\\Services\\VSS\\Start
- name: '[Sigma] Windows Credential Editor Registry'
  tag: attack.credential-access,attack.t1003.001,attack.s0005
  score: 100
  target: Full_Path
  condition: regex
  pattern: (?i)Services\\WCESERVICE\\Start
- name: '[Sigma] HybridConnectionManager Service Installation - Registry'
  tag: attack.resource-development,attack.t1608
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Services\\HybridConnectionManager
- name: '[Sigma] HybridConnectionManager Service Installation - Registry'
  tag: attack.resource-development,attack.t1608
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)SetValue
- name: '[Sigma] HybridConnectionManager Service Installation - Registry'
  tag: attack.resource-development,attack.t1608
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)Microsoft\.HybridConnectionManager\.Listener\.exe
- name: '[Sigma] Potential Qakbot Registry Activity'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Software\\firm\\soft\\Name$
- name: '[Sigma] Registry Entries For Azorult Malware'
  tag: attack.defense-evasion,attack.persistence,attack.execution,attack.t1112
  score: 100
  target: Full_Path
  condition: regex
  pattern: (?i)(12|13)
- name: '[Sigma] Registry Entries For Azorult Malware'
  tag: attack.defense-evasion,attack.persistence,attack.execution,attack.t1112
  score: 100
  target: Full_Path
  condition: regex
  pattern: (?i)SYSTEM\\
- name: '[Sigma] Registry Entries For Azorult Malware'
  tag: attack.defense-evasion,attack.persistence,attack.execution,attack.t1112
  score: 100
  target: Full_Path
  condition: regex
  pattern: (?i)\\services\\localNETService$
- name: '[Sigma] Path To Screensaver Binary Modified'
  tag: attack.persistence,attack.privilege-escalation,attack.t1546.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Control\ Panel\\Desktop\\SCRNSAVE\.EXE$
- name: '[Sigma] Path To Screensaver Binary Modified'
  tag: attack.persistence,attack.privilege-escalation,attack.t1546.002
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\rundll32\.exe|\\explorer\.exe)$
- name: '[Sigma] Narrator''s Feedback-Hub Persistence'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DeleteValue
- name: '[Sigma] Narrator''s Feedback-Hub Persistence'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\AppXypsaf9f1qserqevf0sws76dx4k9a5206\\Shell\\open\\command\\DelegateExecute$
- name: '[Sigma] Narrator''s Feedback-Hub Persistence'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\AppXypsaf9f1qserqevf0sws76dx4k9a5206\\Shell\\open\\command\\\(Default\)$
- name: '[Sigma] NetNTLM Downgrade Attack - Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1562.001,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(SYSTEM\\|ControlSet|\\Control\\Lsa)
- name: '[Sigma] NetNTLM Downgrade Attack - Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1562.001,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\lmcompatibilitylevel$
- name: '[Sigma] NetNTLM Downgrade Attack - Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1562.001,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(DWORD\ \(0x00000000\)|DWORD\ \(0x00000001\)|DWORD\ \(0x00000002\))
- name: '[Sigma] NetNTLM Downgrade Attack - Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1562.001,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\NtlmMinClientSec$
- name: '[Sigma] NetNTLM Downgrade Attack - Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1562.001,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(DWORD\ \(0x00000000\)|DWORD\ \(0x00000010\)|DWORD\ \(0x00000020\)|DWORD\
    \(0x00000030\))
- name: '[Sigma] NetNTLM Downgrade Attack - Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1562.001,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\RestrictSendingNTLMTraffic$
- name: '[Sigma] New DLL Added to AppCertDlls Registry Key'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.009
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'TargetObject':\ 'HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Session\
    Manager\\\\AppCertDlls'\}|\{'NewName':\ 'HKLM\\\\SYSTEM\\\\CurentControlSet\\\\Control\\\\Session\
    Manager\\\\AppCertDlls'\})
- name: '[Sigma] New DLL Added to AppInit_DLLs Registry Key'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.010
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'TargetObject\|endswith':\ \['\\\\SOFTWARE\\\\Microsoft\\\\Windows\
    NT\\\\CurrentVersion\\\\Windows\\\\AppInit_Dlls',\ '\\\\SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\Windows\
    NT\\\\CurrentVersion\\\\Windows\\\\AppInit_Dlls'\]\}|\{'NewName\|endswith':\ \['\\\\SOFTWARE\\\\Microsoft\\\\Windows\
    NT\\\\CurrentVersion\\\\Windows\\\\AppInit_Dlls',\ '\\\\SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\Windows\
    NT\\\\CurrentVersion\\\\Windows\\\\AppInit_Dlls'\]\})
- name: '[Sigma] New DLL Added to AppInit_DLLs Registry Key'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.010
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\(Empty\)
- name: '[Sigma] Office Application Startup - Office Test'
  tag: attack.persistence,attack.t1137.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Software\\Microsoft\\Office\ test\\Special\\Perf
- name: '[Sigma] Windows Registry Trust Record Modification'
  tag: attack.initial-access,attack.t1566.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Security\\Trusted\ Documents\\TrustRecords
- name: '[Sigma] Registry Persistence Mechanisms in Recycle Bin'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)RenameKey
- name: '[Sigma] Registry Persistence Mechanisms in Recycle Bin'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\CLSID\\\{645FF040\-5081\-101B\-9F08\-00AA002F954E\}\\shell\\open
- name: '[Sigma] Registry Persistence Mechanisms in Recycle Bin'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)SetValue
- name: '[Sigma] Registry Persistence Mechanisms in Recycle Bin'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\CLSID\\\{645FF040\-5081\-101B\-9F08\-00AA002F954E\}\\shell\\open\\command\\\(Default\)
- name: '[Sigma] New PortProxy Registry Entry Added'
  tag: attack.lateral-movement,attack.defense-evasion,attack.command-and-control,attack.t1090
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Services\\PortProxy\\v4tov4\\tcp\\
- name: '[Sigma] RedMimicry Winnti Playbook Registry Manipulation'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)HKLM\\SOFTWARE\\Microsoft\\HTMLHelp\\data
- name: '[Sigma] WINEKEY Registry Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Backup\ Mgr$
- name: '[Sigma] Run Once Task Configuration in Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Active\ Setup\\Installed\ Components
- name: '[Sigma] Run Once Task Configuration in Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\StubPath$
- name: '[Sigma] Run Once Task Configuration in Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\\Google\\Chrome\\Application\\|\\Installer\\chrmstp\.exe"\
    \-\-configure\-user\-settings\ \-\-verbose\-logging\ \-\-system\-level)
- name: '[Sigma] Run Once Task Configuration in Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\ \(x86\)\\Microsoft\\Edge\\Application\\|C:\\Program\
    Files\\Microsoft\\Edge\\Application\\)
- name: '[Sigma] Run Once Task Configuration in Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Installer\\setup\.exe"\ \-\-configure\-user\-settings\ \-\-verbose\-logging\
    \-\-system\-level\ \-\-msedge\ \-\-channel=stable$
- name: '[Sigma] Shell Open Registry Keys Manipulation'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1548.002,attack.t1546.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)SetValue
- name: '[Sigma] Shell Open Registry Keys Manipulation'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1548.002,attack.t1546.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)Classes\\ms\-settings\\shell\\open\\command\\SymbolicLinkValue$
- name: '[Sigma] Shell Open Registry Keys Manipulation'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1548.002,attack.t1546.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Software\\Classes\\\{
- name: '[Sigma] Shell Open Registry Keys Manipulation'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1548.002,attack.t1546.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)Classes\\ms\-settings\\shell\\open\\command\\DelegateExecute$
- name: '[Sigma] Shell Open Registry Keys Manipulation'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1548.002,attack.t1546.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)SetValue
- name: '[Sigma] Shell Open Registry Keys Manipulation'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1548.002,attack.t1546.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(Classes\\ms\-settings\\shell\\open\\command\\\(Default\)|Classes\\exefile\\shell\\open\\command\\\(Default\))$
- name: '[Sigma] Shell Open Registry Keys Manipulation'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1548.002,attack.t1546.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\(Empty\)
- name: '[Sigma] Potential Credential Dumping Via LSASS SilentProcessExit Technique'
  tag: attack.credential-access,attack.t1003.001
  score: 100
  target: Full_Path
  condition: regex
  pattern: (?i)Microsoft\\Windows\ NT\\CurrentVersion\\SilentProcessExit\\lsass\.exe
- name: '[Sigma] Security Support Provider (SSP) Added to LSA Configuration'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.005
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Control\\Lsa\\Security\ Packages|\\Control\\Lsa\\OSConfig\\Security\
    Packages)$
- name: '[Sigma] Security Support Provider (SSP) Added to LSA Configuration'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Windows\\system32\\msiexec\.exe|C:\\Windows\\syswow64\\MsiExec\.exe)
- name: '[Sigma] Sticky Key Like Backdoor Usage - Registry'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.008,car.2014-11-003,car.2014-11-008
  score: 100
  target: Full_Path
  condition: regex
  pattern: (?i)(\\SOFTWARE\\Microsoft\\Windows\ NT\\CurrentVersion\\Image\ File\ Execution\
    Options\\sethc\.exe\\Debugger|\\SOFTWARE\\Microsoft\\Windows\ NT\\CurrentVersion\\Image\
    File\ Execution\ Options\\utilman\.exe\\Debugger|\\SOFTWARE\\Microsoft\\Windows\
    NT\\CurrentVersion\\Image\ File\ Execution\ Options\\osk\.exe\\Debugger|\\SOFTWARE\\Microsoft\\Windows\
    NT\\CurrentVersion\\Image\ File\ Execution\ Options\\Magnify\.exe\\Debugger|\\SOFTWARE\\Microsoft\\Windows\
    NT\\CurrentVersion\\Image\ File\ Execution\ Options\\Narrator\.exe\\Debugger|\\SOFTWARE\\Microsoft\\Windows\
    NT\\CurrentVersion\\Image\ File\ Execution\ Options\\DisplaySwitch\.exe\\Debugger|\\SOFTWARE\\Microsoft\\Windows\
    NT\\CurrentVersion\\Image\ File\ Execution\ Options\\atbroker\.exe\\Debugger|\\SOFTWARE\\Microsoft\\Windows\
    NT\\CurrentVersion\\Image\ File\ Execution\ Options\\HelpPane\.exe\\Debugger)$
- name: '[Sigma] Atbroker Registry Change'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1218,attack.persistence,attack.t1547
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(Software\\Microsoft\\Windows\ NT\\CurrentVersion\\Accessibility\\ATs|Software\\Microsoft\\Windows\
    NT\\CurrentVersion\\Accessibility\\Configuration)
- name: '[Sigma] Atbroker Registry Change'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1218,attack.persistence,attack.t1547
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\system32\\atbroker\.exe
- name: '[Sigma] Atbroker Registry Change'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1218,attack.persistence,attack.t1547
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Windows\ NT\\CurrentVersion\\Accessibility\\Configuration
- name: '[Sigma] Atbroker Registry Change'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1218,attack.persistence,attack.t1547
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\(Empty\)
- name: '[Sigma] Atbroker Registry Change'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1218,attack.persistence,attack.t1547
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^C:\\Windows\\Installer\\MSI
- name: '[Sigma] Atbroker Registry Change'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1218,attack.persistence,attack.t1547
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)Software\\Microsoft\\Windows\ NT\\CurrentVersion\\Accessibility\\ATs
- name: '[Sigma] Suspicious Run Key from Download'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\AppData\\Local\\Packages\\Microsoft\.Outlook_|\\AppData\\Local\\Microsoft\\Olk\\Attachments\\|\\Downloads\\|\\Temporary\
    Internet\ Files\\Content\.Outlook\\|\\Local\ Settings\\Temporary\ Internet\ Files\\)
- name: '[Sigma] Suspicious Run Key from Download'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Software\\Microsoft\\Windows\\CurrentVersion\\Run|\\Software\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Run|\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run)
- name: '[Sigma] DLL Load via LSASS'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1547.008
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\CurrentControlSet\\Services\\NTDS\\DirectoryServiceExtPt|\\CurrentControlSet\\Services\\NTDS\\LsaDbExtPt)
- name: '[Sigma] DLL Load via LSASS'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1547.008
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\system32\\lsass\.exe
- name: '[Sigma] DLL Load via LSASS'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1547.008
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(%%systemroot%%\\system32\\ntdsa\.dll|%%systemroot%%\\system32\\lsadb\.dll)
- name: '[Sigma] Suspicious Camera and Microphone Access'
  tag: attack.collection,attack.t1125,attack.t1123
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Software\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\|\\NonPackaged)
- name: '[Sigma] Suspicious Camera and Microphone Access'
  tag: attack.collection,attack.t1125,attack.t1123
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(microphone|webcam)
- name: '[Sigma] Suspicious Camera and Microphone Access'
  tag: attack.collection,attack.t1125,attack.t1123
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(:\#Windows\#Temp\#|:\#\$Recycle\.bin\#|:\#Temp\#|:\#Users\#Public\#|:\#Users\#Default\#|:\#Users\#Desktop\#)
- name: '[Sigma] Enable Remote Connection Between Anonymous Computer - AllowAnonymousCallback'
  tag: attack.defense-evasion,attack.t1562.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\WBEM\\CIMOM\\AllowAnonymousCallback
- name: '[Sigma] Enable Remote Connection Between Anonymous Computer - AllowAnonymousCallback'
  tag: attack.defense-evasion,attack.t1562.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] Registry Persistence via Service in Safe Mode'
  tag: attack.defense-evasion,attack.t1564.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Control\\SafeBoot\\Minimal\\|\\Control\\SafeBoot\\Network\\)
- name: '[Sigma] Registry Persistence via Service in Safe Mode'
  tag: attack.defense-evasion,attack.t1564.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\\(Default\)$
- name: '[Sigma] Registry Persistence via Service in Safe Mode'
  tag: attack.defense-evasion,attack.t1564.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)Service
- name: '[Sigma] Registry Persistence via Service in Safe Mode'
  tag: attack.defense-evasion,attack.t1564.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\WINDOWS\\system32\\msiexec\.exe
- name: '[Sigma] Registry Persistence via Service in Safe Mode'
  tag: attack.defense-evasion,attack.t1564.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Control\\SafeBoot\\Minimal\\SAVService\\\(Default\)|\\Control\\SafeBoot\\Network\\SAVService\\\(Default\))$
- name: '[Sigma] Registry Persistence via Service in Safe Mode'
  tag: attack.defense-evasion,attack.t1564.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\MBAMInstallerService\.exe$
- name: '[Sigma] Registry Persistence via Service in Safe Mode'
  tag: attack.defense-evasion,attack.t1564.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\MBAMService\\\(Default\)$
- name: '[Sigma] Registry Persistence via Service in Safe Mode'
  tag: attack.defense-evasion,attack.t1564.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)Service
- name: '[Sigma] Registry Persistence via Service in Safe Mode'
  tag: attack.defense-evasion,attack.t1564.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Hexnode\\Hexnode\ Agent\\Current\\HexnodeAgent\.exe
- name: '[Sigma] Registry Persistence via Service in Safe Mode'
  tag: attack.defense-evasion,attack.t1564.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Control\\SafeBoot\\Minimal\\Hexnode\ Updater\\\(Default\)|\\Control\\SafeBoot\\Network\\Hexnode\
    Updater\\\(Default\)|\\Control\\SafeBoot\\Minimal\\Hexnode\ Agent\\\(Default\)|\\Control\\SafeBoot\\Network\\Hexnode\
    Agent\\\(Default\))$
- name: '[Sigma] Registry Persistence via Service in Safe Mode'
  tag: attack.defense-evasion,attack.t1564.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)Service
- name: '[Sigma] Add Port Monitor Persistence in Registry'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.010
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Control\\Print\\Monitors\\
- name: '[Sigma] Add Port Monitor Persistence in Registry'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.010
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\.dll$
- name: '[Sigma] Add Port Monitor Persistence in Registry'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.010
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\spoolsv\.exe
- name: '[Sigma] Add Port Monitor Persistence in Registry'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.010
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Control\\Print\\Monitors\\CutePDF\ Writer\ Monitor\ v4\.0\\Driver
- name: '[Sigma] Add Port Monitor Persistence in Registry'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.010
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)cpwmon64_v40\.dll
- name: '[Sigma] Add Port Monitor Persistence in Registry'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.010
  score: 50
  target: User
  condition: regex
  pattern: (?i)(AUTHORI|AUTORI)
- name: '[Sigma] Add Port Monitor Persistence in Registry'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.010
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Control\\Print\\Monitors\\MONVNC\\Driver
- name: '[Sigma] Add Port Monitor Persistence in Registry'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.010
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(Control\\Print\\Environments\\|\\Drivers\\|\\VNC\ Printer)
- name: '[Sigma] Add Debugger Entry To AeDebug For Persistence'
  tag: attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Windows\ NT\\CurrentVersion\\AeDebug\\Debugger
- name: '[Sigma] Add Debugger Entry To AeDebug For Persistence'
  tag: attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\.dll$
- name: '[Sigma] Add Debugger Entry To AeDebug For Persistence'
  tag: attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)"C:\\WINDOWS\\system32\\vsjitdebugger\.exe"\ \-p\ %ld\ \-e\ %ld\ \-j\
    0x%p
- name: '[Sigma] Allow RDP Remote Assistance Feature'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)System\\CurrentControlSet\\Control\\Terminal\ Server\\fAllowToGetHelp$
- name: '[Sigma] Allow RDP Remote Assistance Feature'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] Potential AMSI COM Server Hijacking'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\CLSID\\\{fdb00e52\-a214\-4aa1\-8fba\-4357bb0072ec\}\\InProcServer32\\\(Default\)$
- name: '[Sigma] Potential AMSI COM Server Hijacking'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)%windir%\\system32\\amsi\.dll
- name: '[Sigma] Classes Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Software\\Classes
- name: '[Sigma] Classes Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Folder\\ShellEx\\ExtShellFolderViews|\\Folder\\ShellEx\\DragDropHandlers|\\Folder\\Shellex\\ColumnHandlers|\\Filter|\\Exefile\\Shell\\Open\\Command\\\(Default\)|\\Directory\\Shellex\\DragDropHandlers|\\Directory\\Shellex\\CopyHookHandlers|\\CLSID\\\{AC757296\-3522\-4E11\-9862\-C17BE5A1767E\}\\Instance|\\CLSID\\\{ABE3B9A4\-257D\-4B97\-BD1A\-294AF496222E\}\\Instance|\\CLSID\\\{7ED96837\-96F0\-4812\-B211\-F13C24117ED3\}\\Instance|\\CLSID\\\{083863F1\-70DE\-11d0\-BD40\-00A0C911CE86\}\\Instance|\\Classes\\AllFileSystemObjects\\ShellEx\\DragDropHandlers|\\\.exe|\\\.cmd|\\ShellEx\\PropertySheetHandlers|\\ShellEx\\ContextMenuHandlers)
- name: '[Sigma] Classes Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\drvinst\.exe
- name: '[Sigma] Classes Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\(Empty\)
- name: '[Sigma] Classes Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: None
- name: '[Sigma] Classes Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\svchost\.exe
- name: '[Sigma] Classes Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\lnkfile\\shellex\\ContextMenuHandlers\\
- name: '[Sigma] Classes Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\{807583E5\-5146\-11D5\-A672\-00B0D022E945\}
- name: '[Sigma] Common Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\ CE\ Services\\AutoStart|\\Software\\Wow6432Node\\Microsoft\\Command\
    Processor\\Autorun|\\SOFTWARE\\Wow6432Node\\Microsoft\\Active\ Setup\\Installed\
    Components|\\SOFTWARE\\Microsoft\\Windows\ CE\ Services\\AutoStartOnDisconnect|\\SOFTWARE\\Microsoft\\Windows\
    CE\ Services\\AutoStartOnConnect|\\SYSTEM\\Setup\\CmdLine|\\Software\\Microsoft\\Ctf\\LangBarAddin|\\Software\\Microsoft\\Command\
    Processor\\Autorun|\\SOFTWARE\\Microsoft\\Active\ Setup\\Installed\ Components|\\SOFTWARE\\Classes\\Protocols\\Handler|\\SOFTWARE\\Classes\\Protocols\\Filter|\\SOFTWARE\\Classes\\Htmlfile\\Shell\\Open\\Command\\\(Default\)|\\Environment\\UserInitMprLogonScript|\\SOFTWARE\\Policies\\Microsoft\\Windows\\Control\
    Panel\\Desktop\\Scrnsave\.exe|\\Software\\Microsoft\\Internet\ Explorer\\UrlSearchHooks|\\SOFTWARE\\Microsoft\\Internet\
    Explorer\\Desktop\\Components|\\Software\\Classes\\Clsid\\\{AB8902B4\-09CA\-4bb6\-B78D\-A8F59079A8D5\}\\Inprocserver32|\\Control\
    Panel\\Desktop\\Scrnsave\.exe)
- name: '[Sigma] Common Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\(Empty\)
- name: '[Sigma] Common Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: None
- name: '[Sigma] Common Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\poqexec\.exe
- name: '[Sigma] Common Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'TargetObject\|contains':\ \['\\\\Office\\\\ClickToRun\\\\REGISTRY\\\\MACHINE\\\\Software\\\\Classes\\\\PROTOCOLS\\\\Handler\\\\',\
    '\\\\ClickToRunStore\\\\HKMU\\\\SOFTWARE\\\\Classes\\\\PROTOCOLS\\\\Handler\\\\'\]\}|\{'Details':\
    \['\{314111c7\-a502\-11d2\-bbca\-00c04f8ec294\}',\ '\{3459B272\-CC19\-4448\-86C9\-DDC3B4B2FAD3\}',\
    '\{42089D2D\-912D\-4018\-9087\-2B87803E93FB\}',\ '\{5504BE45\-A83B\-4808\-900A\-3A5C36E7F77A\}',\
    '\{807583E5\-5146\-11D5\-A672\-00B0D022E945\}'\]\})
- name: '[Sigma] Common Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Active\ Setup\\Installed\ Components\\\{8A69D345\-D564\-463c\-AFF1\-A69D9E530F96\}
- name: '[Sigma] Common Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Active\ Setup\\Installed\ Components\\\{9459C573\-B17A\-45AE\-9F64\-1857B5D58CEE\}
- name: '[Sigma] Common Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Software\\Microsoft\\Active\ Setup\\Installed\ Components\\\{89820200\-ECBD\-11cf\-8B85\-00AA005B4383\}
- name: '[Sigma] Common Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\ \(x86\)\\Microsoft\ Office\\root\\integration\\integrator\.exe|C:\\Program\
    Files\\Microsoft\ Office\\root\\integration\\integrator\.exe)
- name: '[Sigma] Common Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^(C:\\Program\ Files\\Common\ Files\\Microsoft\ Shared\\ClickToRun\\|C:\\Program\
    Files\\Common\ Files\\Microsoft\ Shared\\ClickToRun\\Updates\\)
- name: '[Sigma] Common Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\OfficeClickToRun\.exe$
- name: '[Sigma] CurrentControlSet Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SYSTEM\\CurrentControlSet\\Control
- name: '[Sigma] CurrentControlSet Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Terminal\ Server\\WinStations\\RDP\-Tcp\\InitialProgram|\\Terminal\
    Server\\Wds\\rdpwd\\StartupPrograms|\\SecurityProviders\\SecurityProviders|\\SafeBoot\\AlternateShell|\\Print\\Providers|\\Print\\Monitors|\\NetworkProvider\\Order|\\Lsa\\Notification\
    Packages|\\Lsa\\Authentication\ Packages|\\BootVerificationProgram\\ImagePath)
- name: '[Sigma] CurrentControlSet Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\(Empty\)
- name: '[Sigma] CurrentControlSet Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\spoolsv\.exe
- name: '[Sigma] CurrentControlSet Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Print\\Monitors\\CutePDF\ Writer\ Monitor
- name: '[Sigma] CurrentControlSet Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(cpwmon64_v40\.dll|CutePDF\ Writer)
- name: '[Sigma] CurrentControlSet Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\spoolsv\.exe
- name: '[Sigma] CurrentControlSet Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)Print\\Monitors\\Appmon\\Ports\\Microsoft\.Office\.OneNote_
- name: '[Sigma] CurrentControlSet Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: User
  condition: regex
  pattern: (?i)(AUTHORI|AUTORI)
- name: '[Sigma] CurrentControlSet Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\poqexec\.exe
- name: '[Sigma] CurrentControlSet Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\NetworkProvider\\Order\\ProviderOrder$
- name: '[Sigma] CurrentControlSet Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\spoolsv\.exe
- name: '[Sigma] CurrentControlSet Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Print\\Monitors\\MONVNC\\Driver$
- name: '[Sigma] CurrentControlSet Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)VNCpm\.dll
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\ShellServiceObjectDelayLoad|\\Run\\|\\RunOnce\\|\\RunOnceEx\\|\\RunServices\\|\\RunServicesOnce\\|\\Policies\\System\\Shell|\\Policies\\Explorer\\Run|\\Group\
    Policy\\Scripts\\Startup|\\Group\ Policy\\Scripts\\Shutdown|\\Group\ Policy\\Scripts\\Logon|\\Group\
    Policy\\Scripts\\Logoff|\\Explorer\\ShellServiceObjects|\\Explorer\\ShellIconOverlayIdentifiers|\\Explorer\\ShellExecuteHooks|\\Explorer\\SharedTaskScheduler|\\Explorer\\Browser\
    Helper\ Objects|\\Authentication\\PLAP\ Providers|\\Authentication\\Credential\
    Providers|\\Authentication\\Credential\ Provider\ Filters)
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Details':\ '\(Empty\)'\}|\{'TargetObject\|endswith':\ '\\\\NgcFirst\\\\ConsecutiveSwitchCount'\}|\{'Image\|endswith':\
    \['\\\\AppData\\\\Local\\\\Microsoft\\\\OneDrive\\\\Update\\\\OneDriveSetup\.exe',\
    '\\\\AppData\\\\Roaming\\\\Spotify\\\\Spotify\.exe',\ '\\\\AppData\\\\Local\\\\WebEx\\\\WebexHost\.exe'\]\}|\{'Image':\
    \['C:\\\\WINDOWS\\\\system32\\\\devicecensus\.exe',\ 'C:\\\\Windows\\\\system32\\\\winsat\.exe',\
    'C:\\\\Program\ Files\\\\Microsoft\ OneDrive\\\\StandaloneUpdater\\\\OneDriveSetup\.exe',\
    'C:\\\\Program\ Files\ \(x86\)\\\\Microsoft\ OneDrive\\\\StandaloneUpdater\\\\OneDriveSetup\.exe',\
    'C:\\\\Program\ Files\\\\Microsoft\ OneDrive\\\\Update\\\\OneDriveSetup\.exe',\
    'C:\\\\Program\ Files\ \(x86\)\\\\Microsoft\ OneDrive\\\\Update\\\\OneDriveSetup\.exe',\
    'C:\\\\Program\ Files\\\\Microsoft\ Office\\\\root\\\\integration\\\\Addons\\\\OneDriveSetup\.exe',\
    'C:\\\\Program\ Files\ \(x86\)\\\\Microsoft\ Office\\\\root\\\\integration\\\\Addons\\\\OneDriveSetup\.exe',\
    'C:\\\\Program\ Files\\\\KeePass\ Password\ Safe\ 2\\\\ShInstUtil\.exe',\ 'C:\\\\Program\
    Files\\\\Everything\\\\Everything\.exe',\ 'C:\\\\Program\ Files\ \(x86\)\\\\Microsoft\
    Office\\\\root\\\\integration\\\\integrator\.exe',\ 'C:\\\\Program\ Files\\\\Microsoft\
    Office\\\\root\\\\integration\\\\integrator\.exe'\]\})
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: None
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\system32\\LogonUI\.exe
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Authentication\\Credential\ Providers\\\{D6886603\-9D2F\-4EB2\-B667\-1971041FA96B\}\\|\\Authentication\\Credential\
    Providers\\\{BEC09223\-B018\-416D\-A0AC\-523971B639F5\}\\|\\Authentication\\Credential\
    Providers\\\{8AF662BF\-65A0\-4D0A\-A540\-A338A999D36F\}\\|\\Authentication\\Credential\
    Providers\\\{27FBDB57\-B613\-4AF2\-9D7E\-4FA7A66C21AD\}\\)
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^(C:\\Program\ Files\ \(x86\)\\Microsoft\\EdgeUpdate\\Install\\|C:\\Program\
    Files\ \(x86\)\\Microsoft\\EdgeWebView\\|C:\\Program\ Files\ \(x86\)\\Microsoft\\Edge\\Application\\msedge\.exe)
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Program\ Files\\Windows\ Defender\\MsMpEng\.exe
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Teams\\current\\Teams\.exe$
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: '(?i)\\Microsoft\\Teams\\Update\.exe\ \-\-processStart\ '
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\system32\\userinit\.exe
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)ctfmon\.exe\ /n
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\system32\\regsvr32\.exe
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DropboxExt
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)A251\-47B7\-93E1\-CDD82E34AF8B\}$
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\Opera\ Browser\
    Assistant$
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)C:\\Program\ Files\\Opera\\assistant\\browser_assistant\.exe
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Opera\ Stable$
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\\Opera\\launcher\.exe|C:\\Program\ Files\ \(x86\)\\Opera\\launcher\.exe)
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\iTunesHelper$
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)"C:\\Program\ Files\\iTunes\\iTunesHelper\.exe"
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\zoommsirepair$
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)"C:\\Program\ Files\\Zoom\\bin\\installer\.exe"\ /repair
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\Greenshot$
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)C:\\Program\ Files\\Greenshot\\Greenshot\.exe
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\GoogleDriveFS$
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: ^C:\\Program\ Files\\Google\\Drive\ File\ Stream\\
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\GoogleDriveFS\.exe
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)GoogleDrive
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{CFE8B367\-77A7\-41D7\-9C90\-75D16D7DC6B6\}|\{A8E52322\-8734\-481D\-A7E2\-27B309EF8D56\}|\{C973DA94\-CBDF\-4E77\-81D1\-E5B794FBD146\}|\{51EF1569\-67EE\-4AD6\-9646\-E726C3FFC8A2\})
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: ^(C:\\Windows\\system32\\cmd\.exe\ /q\ /c\ rmdir\ /s\ /q\ "C:\\Users\\|C:\\Windows\\system32\\cmd\.exe\
    /q\ /c\ del\ /q\ "C:\\Users\\)
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\AppData\\Local\\Microsoft\\OneDrive\\
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\\{
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\AppData\\Local\\Package\ Cache\\\{|\}\\python\-)
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\.exe"\ /burn\.runonce$
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^(C:\\Program\ Files\\Common\ Files\\Microsoft\ Shared\\ClickToRun\\|C:\\Program\
    Files\ \(x86\)\\Common\ Files\\Microsoft\ Shared\\ClickToRun\\)
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\OfficeClickToRun\.exe$
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Teams\\current\\Teams\.exe$
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Teams\\Update\.exe\ \-\-processStart
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\\AVG\\Antivirus\\Setup\\|C:\\Program\ Files\ \(x86\)\\AVG\\Antivirus\\Setup\\|\\instup\.exe)
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)("C:\\Program\ Files\\AVG\\Antivirus\\AvLaunch\.exe"\ /gui|"C:\\Program\
    Files\ \(x86\)\\AVG\\Antivirus\\AvLaunch\.exe"\ /gui|\{472083B0\-C522\-11CF\-8763\-00608CC02F24\}|\{472083B1\-C522\-11CF\-8763\-00608CC02F24\})
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\\Avast\ Software\\Avast\\Setup\\|C:\\Program\ Files\
    \(x86\)\\Avast\ Software\\Avast\\Setup\\|\\instup\.exe)
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)("C:\\Program\ Files\\Avast\ Software\\Avast\\AvLaunch\.exe"\ /gui|"C:\\Program\
    Files\ \(x86\)\\Avast\ Software\\Avast\\AvLaunch\.exe"\ /gui)
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\\AVG\\Antivirus\\avgToolsSvc\.exe|C:\\Program\
    Files\ \(x86\)\\AVG\\Antivirus\\avgToolsSvc\.exe)
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\StartupApproved\\Run\\
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)Binary\ Data
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\aurora\-agent\-64\.exe|\\aurora\-agent\.exe)$
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Windows\\CurrentVersion\\Run\\aurora\-dashboard$
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)C:\\Program\ Files\\Aurora\-Agent\\tools\\aurora\-dashboard\.exe
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Windows\\CurrentVersion\\Run\\Everything$
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Everything\\Everything\.exe"\ \-startup$
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Discord$
- name: '[Sigma] CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Discord\\Update\.exe\ \-\-processStart\ Discord\.exe$
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Windows\ NT\\CurrentVersion
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Winlogon\\VmApplet|\\Winlogon\\Userinit|\\Winlogon\\Taskman|\\Winlogon\\Shell|\\Winlogon\\GpExtensions|\\Winlogon\\AppSetup|\\Winlogon\\AlternateShells\\AvailableShells|\\Windows\\IconServiceLib|\\Windows\\Appinit_Dlls|\\Image\
    File\ Execution\ Options|\\Font\ Drivers|\\Drivers32|\\Windows\\Run|\\Windows\\Load)
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\(Empty\)
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: None
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\poqexec\.exe
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Image\ File\ Execution\ Options\\
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\DisableExceptionChainValidation|\\MitigationOptions)$
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\system32\\svchost\.exe
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Winlogon\\GPExtensions\\\{827D319E\-6EAC\-11D2\-A4EA\-00C04F79F83A\}\\PreviousPolicyAreas|\\Winlogon\\GPExtensions\\\{827D319E\-6EAC\-11D2\-A4EA\-00C04F79F83A\}\\MaxNoGPOListChangesInterval)
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(DWORD\ \(0x00000001\)|DWORD\ \(0x00000009\)|DWORD\ \(0x000003c0\))
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\RuntimeBroker\.exe
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\runtimebroker\.exe\\Microsoft\.Windows\.ShellExperienceHost
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^C:\\Program\ Files\ \(x86\)\\Microsoft\\Temp\\
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\MicrosoftEdgeUpdate\.exe$
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^(C:\\Program\ Files\ \(x86\)\\Avira\\Antivirus\\avguard\.exe|C:\\Program\
    Files\\Avira\\Antivirus\\avguard\.exe)
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)SOFTWARE\\WOW6432Node\\Avira\\Antivirus\\Overwrite_Keys\\HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\
    NT\\CurrentVersion\\Winlogon\\
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\userinit\\UseAsDefault|\\shell\\UseAsDefault)$
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(explorer\.exe|C:\\Windows\\system32\\userinit\.exe,)
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'TargetObject\|contains':\ \['\\\\ClickToRunStore\\\\HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\
    NT\\\\CurrentVersion\\\\',\ '\\\\ClickToRun\\\\REGISTRY\\\\MACHINE\\\\Software\\\\Microsoft\\\\Windows\
    NT\\\\CurrentVersion\\\\'\]\}|\{'Image':\ \['C:\\\\Program\ Files\\\\Microsoft\
    Office\\\\root\\\\integration\\\\integrator\.exe',\ 'C:\\\\Program\ Files\ \(x86\)\\\\Microsoft\
    Office\\\\root\\\\integration\\\\integrator\.exe'\]\})
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^(C:\\Program\ Files\\Common\ Files\\Microsoft\ Shared\\ClickToRun\\|C:\\Program\
    Files\\Common\ Files\\Microsoft\ Shared\\ClickToRun\\Updates\\)
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\OfficeClickToRun\.exe$
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^C:\\Windows\\Microsoft\.NET\\Framework
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\ngen\.exe$
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\AppData\\Local\\Microsoft\\OneDrive\\StandaloneUpdater\\OneDriveSetup\.exe$
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\Delete\ Cached\ Update\
    Binary$
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: ^C:\\Windows\\system32\\cmd\.exe\ /q\ /c\ del\ /q\ "C:\\Users\\
- name: '[Sigma] CurrentVersion NT Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\AppData\\Local\\Microsoft\\OneDrive\\Update\\OneDriveSetup\.exe"$
- name: '[Sigma] Internet Explorer Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Software\\Wow6432Node\\Microsoft\\Internet\ Explorer|\\Software\\Microsoft\\Internet\
    Explorer)
- name: '[Sigma] Internet Explorer Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Toolbar|\\Extensions|\\Explorer\ Bars)
- name: '[Sigma] Internet Explorer Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\(Empty\)
- name: '[Sigma] Internet Explorer Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Extensions\\\{2670000A\-7350\-4f3c\-8081\-5663EE0C6C49\}|\\Extensions\\\{31D09BA0\-12F5\-4CCE\-BE8A\-2923E76605DA\}|\\Extensions\\\{789FE86F\-6FC4\-46A1\-9849\-EDE0DB0C95CA\}|\\Extensions\\\{A95fe080\-8f5d\-11d2\-a20b\-00aa003c157a\})
- name: '[Sigma] Internet Explorer Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Toolbar\\ShellBrowser\\ITBar7Layout|\\Toolbar\\ShowDiscussionButton|\\Toolbar\\Locked)$
- name: '[Sigma] Office Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Software\\Wow6432Node\\Microsoft\\Office|\\Software\\Microsoft\\Office)
- name: '[Sigma] Office Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Word\\Addins|\\PowerPoint\\Addins|\\Outlook\\Addins|\\Onenote\\Addins|\\Excel\\Addins|\\Access\\Addins|test\\Special\\Perf)
- name: '[Sigma] Office Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\(Empty\)
- name: '[Sigma] Office Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^(C:\\Program\ Files\\Microsoft\ Office\\|C:\\Program\ Files\ \(x86\)\\Microsoft\
    Office\\|C:\\Windows\\System32\\msiexec\.exe|C:\\Windows\\System32\\regsvr32\.exe)
- name: '[Sigma] Office Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Excel\\Addins\\AdHocReportingExcelClientLib\.AdHocReportingExcelClientAddIn\.1\\|\\Excel\\Addins\\ExcelPlugInShell\.PowerMapConnect\\|\\Excel\\Addins\\NativeShim\\|\\Excel\\Addins\\NativeShim\.InquireConnector\.1\\|\\Excel\\Addins\\PowerPivotExcelClientAddIn\.NativeEntry\.1\\|\\Outlook\\AddIns\\AccessAddin\.DC\\|\\Outlook\\AddIns\\ColleagueImport\.ColleagueImportAddin\\|\\Outlook\\AddIns\\EvernoteCC\.EvernoteContactConnector\\|\\Outlook\\AddIns\\EvernoteOLRD\.Connect\\|\\Outlook\\Addins\\Microsoft\.VbaAddinForOutlook\.1\\|\\Outlook\\Addins\\OcOffice\.OcForms\\|\\Outlook\\Addins\\\\OneNote\.OutlookAddin|\\Outlook\\Addins\\OscAddin\.Connect\\|\\Outlook\\Addins\\OutlookChangeNotifier\.Connect\\|\\Outlook\\Addins\\UCAddin\.LyncAddin\.1|\\Outlook\\Addins\\UCAddin\.UCAddin\.1|\\Outlook\\Addins\\UmOutlookAddin\.FormRegionAddin\\|AddinTakeNotesService\\FriendlyName)
- name: '[Sigma] Office Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^(C:\\Program\ Files\\Common\ Files\\Microsoft\ Shared\\ClickToRun\\|C:\\Program\
    Files\\Common\ Files\\Microsoft\ Shared\\ClickToRun\\Updates\\)
- name: '[Sigma] Office Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\OfficeClickToRun\.exe$
- name: '[Sigma] Office Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\\AVG\\Antivirus\\RegSvr\.exe|C:\\Program\ Files\\AVG\\Antivirus\\x86\\RegSvr\.exe)
- name: '[Sigma] Office Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Office\\Outlook\\Addins\\Antivirus\.AsOutExt\\
- name: '[Sigma] Office Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\\Avast\ Software\\Avast\\RegSvr\.exe|C:\\Program\
    Files\\Avast\ Software\\Avast\\x86\\RegSvr\.exe)
- name: '[Sigma] Office Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Office\\Outlook\\Addins\\Avast\.AsOutExt\\
- name: '[Sigma] Session Manager Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001,attack.t1546.009
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\System\\CurrentControlSet\\Control\\Session\ Manager
- name: '[Sigma] Session Manager Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001,attack.t1546.009
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\SetupExecute|\\S0InitialCommand|\\KnownDlls|\\Execute|\\BootExecute|\\AppCertDlls)
- name: '[Sigma] Session Manager Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001,attack.t1546.009
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\(Empty\)
- name: '[Sigma] System Scripts Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Software\\Policies\\Microsoft\\Windows\\System\\Scripts
- name: '[Sigma] System Scripts Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Startup|\\Shutdown|\\Logon|\\Logoff)
- name: '[Sigma] System Scripts Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\(Empty\)
- name: '[Sigma] WinSock2 Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\System\\CurrentControlSet\\Services\\WinSock2\\Parameters
- name: '[Sigma] WinSock2 Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Protocol_Catalog9\\Catalog_Entries|\\NameSpace_Catalog5\\Catalog_Entries)
- name: '[Sigma] WinSock2 Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Details':\ '\(Empty\)'\}|\{'Image':\ 'C:\\\\Windows\\\\System32\\\\MsiExec\.exe'\}|\{'Image':\
    'C:\\\\Windows\\\\syswow64\\\\MsiExec\.exe'\})
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\ShellServiceObjectDelayLoad|\\Run\\|\\RunOnce\\|\\RunOnceEx\\|\\RunServices\\|\\RunServicesOnce\\|\\Explorer\\ShellServiceObjects|\\Explorer\\ShellIconOverlayIdentifiers|\\Explorer\\ShellExecuteHooks|\\Explorer\\SharedTaskScheduler|\\Explorer\\Browser\
    Helper\ Objects)
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\(Empty\)
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: None
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: ^"C:\\ProgramData\\Package\ Cache\\\{d21a4f20\-968a\-4b0c\-bf04\-a38da5f06e41\}\\windowsdesktop\-runtime\-
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\VC_redist\.x64\.exe$
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\}\\VC_redist\.x64\.exe"\ /burn\.runonce$
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^(C:\\ProgramData\\Package\ Cache|C:\\Windows\\Temp\\)
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\winsdksetup\.exe|\\windowsdesktop\-runtime\-|\\AspNetCoreSharedFrameworkBundle\-)
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\ /burn\.runonce$
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^C:\\Windows\\Installer\\MSI
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Explorer\\Browser\ Helper\ Objects
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\WINDOWS\\system32\\msiexec\.exe
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Run\\
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\ \(x86\)\\Microsoft\\EdgeUpdate\\Install\\\{|\\setup\.exe)
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Program\ Files\\Common\ Files\\Microsoft\ Shared\\ClickToRun\\OfficeClickToRun\.exe
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Office\\ClickToRun\\REGISTRY\\MACHINE\\Software\\Wow6432Node\\
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\\Microsoft\ Office\\root\\integration\\integrator\.exe|C:\\Program\
    Files\ \(x86\)\\Microsoft\ Office\\root\\integration\\integrator\.exe)
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Explorer\\Browser\ Helper\ Objects\\\{31D09BA0\-12F5\-4CCE\-BE8A\-2923E76605DA\}\\
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Details\|endswith':\ '\-A251\-47B7\-93E1\-CDD82E34AF8B\}'\}|\{'Details':\
    'grpconv\ \-o'\}|\{'Details\|contains\|all':\ \['C:\\\\Program\ Files',\ '\\\\Dropbox\\\\Client\\\\Dropbox\.exe',\
    '\ /systemstartup'\]\})
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Explorer\\Browser\ Helper\ Objects\\\{92EF2EAD\-A7CE\-4424\-B0DB\-499CF856608E\}\\NoExplorer$
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\windowsdesktop\-runtime\-
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\\{e2d1ae32\-dd1d\-4ad7\-a298\-10e42e7840fc\}|\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\\{7037b699\-7382\-448c\-89a7\-4765961d2537\})$
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: ^"C:\\ProgramData\\Package\ Cache\\
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\.exe"\ /burn\.runonce$
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^(C:\\Program\ Files\\Common\ Files\\Microsoft\ Shared\\ClickToRun\\|C:\\Program\
    Files\\Common\ Files\\Microsoft\ Shared\\ClickToRun\\Updates\\)
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\OfficeClickToRun\.exe$
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Run\\Discord$
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)Discord\.exe\ \-\-checkInstall$
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Avira\.OE\.Setup\.Bundle\.exe"\ /burn\.runonce$
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\Avira\.OE\.Setup\.Bundle\.exe$
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\instup\.exe$
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\AvRepair$
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)instup\.exe"\ /instop:repair\ /wait$
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\instup\.exe$
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ShellIconOverlayIdentifiers\\00avg\\\(Default\)|\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ShellIconOverlayIdentifiers\\00asw\\\(Default\))$
- name: '[Sigma] Wow6432Node CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\{472083B1\-C522\-11CF\-8763\-00608CC02F24\}|\{472083B0\-C522\-11CF\-8763\-00608CC02F24\})
- name: '[Sigma] Wow6432Node Classes Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Software\\Wow6432Node\\Classes
- name: '[Sigma] Wow6432Node Classes Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Folder\\ShellEx\\ExtShellFolderViews|\\Folder\\ShellEx\\DragDropHandlers|\\Folder\\ShellEx\\ColumnHandlers|\\Directory\\Shellex\\DragDropHandlers|\\Directory\\Shellex\\CopyHookHandlers|\\CLSID\\\{AC757296\-3522\-4E11\-9862\-C17BE5A1767E\}\\Instance|\\CLSID\\\{ABE3B9A4\-257D\-4B97\-BD1A\-294AF496222E\}\\Instance|\\CLSID\\\{7ED96837\-96F0\-4812\-B211\-F13C24117ED3\}\\Instance|\\CLSID\\\{083863F1\-70DE\-11d0\-BD40\-00A0C911CE86\}\\Instance|\\AllFileSystemObjects\\ShellEx\\DragDropHandlers|\\ShellEx\\PropertySheetHandlers|\\ShellEx\\ContextMenuHandlers)
- name: '[Sigma] Wow6432Node Classes Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\(Empty\)
- name: '[Sigma] Wow6432Node Windows NT CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\ NT\\CurrentVersion
- name: '[Sigma] Wow6432Node Windows NT CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Windows\\Appinit_Dlls|\\Image\ File\ Execution\ Options|\\Drivers32)
- name: '[Sigma] Wow6432Node Windows NT CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\(Empty\)
- name: '[Sigma] Wow6432Node Windows NT CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: None
- name: '[Sigma] Wow6432Node Windows NT CurrentVersion Autorun Keys Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Windows\ NT\\CurrentVersion\\Image\ File\ Execution\ Options$
- name: '[Sigma] New BgInfo.EXE Custom DB Path Registry Configuration'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Software\\Winternals\\BGInfo\\Database$
- name: '[Sigma] New BgInfo.EXE Custom VBScript Registry Configuration'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Software\\Winternals\\BGInfo\\UserFields\\
- name: '[Sigma] New BgInfo.EXE Custom VBScript Registry Configuration'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: ^4
- name: '[Sigma] New BgInfo.EXE Custom WMI Query Registry Configuration'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Software\\Winternals\\BGInfo\\UserFields\\
- name: '[Sigma] New BgInfo.EXE Custom WMI Query Registry Configuration'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: ^6
- name: '[Sigma] Bypass UAC Using DelegateExecute'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\open\\command\\DelegateExecute$
- name: '[Sigma] Bypass UAC Using DelegateExecute'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\(Empty\)
- name: '[Sigma] Bypass UAC Using Event Viewer'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.010
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)_Classes\\mscfile\\shell\\open\\command\\\(Default\)$
- name: '[Sigma] Bypass UAC Using Event Viewer'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.010
  score: 80
  target: Full_Path
  condition: regex
  pattern: ^%SystemRoot%\\system32\\mmc\.exe\ "%1"\ %
- name: '[Sigma] Bypass UAC Using SilentCleanup Task'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Environment\\windir$
- name: '[Sigma] Bypass UAC Using SilentCleanup Task'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)%SystemRoot%
- name: '[Sigma] Default RDP Port Changed to Non Standard Port'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.010
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Control\\Terminal\ Server\\WinStations\\RDP\-Tcp\\PortNumber$
- name: '[Sigma] Default RDP Port Changed to Non Standard Port'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.010
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000d3d\)
- name: '[Sigma] IE Change Domain Zone'
  tag: attack.persistence,attack.t1137
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet\ Settings\\ZoneMap\\Domains\\
- name: '[Sigma] IE Change Domain Zone'
  tag: attack.persistence,attack.t1137
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(DWORD\ \(0x00000000\)|DWORD\ \(0x00000001\)|\(Empty\))
- name: '[Sigma] Sysmon Driver Altitude Change'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Services\\
- name: '[Sigma] Sysmon Driver Altitude Change'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Instances\\Sysmon\ Instance\\Altitude$
- name: '[Sigma] Change Winevt Channel Access Permission Via Registry'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\
- name: '[Sigma] Change Winevt Channel Access Permission Via Registry'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\ChannelAccess$
- name: '[Sigma] Change Winevt Channel Access Permission Via Registry'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\(A;;0x1;;;LA\)|\(A;;0x1;;;SY\)|\(A;;0x5;;;BA\))
- name: '[Sigma] Change Winevt Channel Access Permission Via Registry'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\servicing\\TrustedInstaller\.exe
- name: '[Sigma] Change Winevt Channel Access Permission Via Registry'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^C:\\Windows\\WinSxS\\
- name: '[Sigma] Change Winevt Channel Access Permission Via Registry'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\TiWorker\.exe$
- name: '[Sigma] Running Chrome VPN Extensions via the Registry 2 VPN Extension'
  tag: attack.initial-access,attack.persistence,attack.t1133
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)Software\\Wow6432Node\\Google\\Chrome\\Extensions
- name: '[Sigma] Running Chrome VPN Extensions via the Registry 2 VPN Extension'
  tag: attack.initial-access,attack.persistence,attack.t1133
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)update_url$
- name: '[Sigma] Running Chrome VPN Extensions via the Registry 2 VPN Extension'
  tag: attack.initial-access,attack.persistence,attack.t1133
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(fdcgdnkidjaadafnichfpabhfomcebme|fcfhplploccackoneaefokcmbjfbkenj|bihmplhobchoageeokmgbdihknkjbknd|gkojfkhlekighikafcpjkiklfbnlmeio|jajilbjjinjmgcibalaakngmkilboobh|gjknjjomckknofjidppipffbpoekiipm|nabbmpekekjknlbkgpodfndbodhijjem|kpiecbcckbofpmkkkdibbllpinceiihk|nlbejmccbhkncgokjcmghpfloaajcffj|omghfjlpggmjjaagoclmmobgdodcjboh|bibjcjfmgapbfoljiojpipaooddpkpai|mpcaainmfjjigeicjnlkdfajbioopjko|jljopmgdobloagejpohpldgkiellmfnc|lochiccbgeohimldjooaakjllnafhaid|nhnfcgpcbfclhfafjlooihdfghaeinfc|ookhnhpkphagefgdiemllfajmkdkcaim|namfblliamklmeodpcelkokjbffgmeoo|nbcojefnccbanplpoffopkoepjmhgdgh|majdfhpaihoncoakbjgbdhglocklcgno|lnfdmdhmfbimhhpaeocncdlhiodoblbd|eppiocemhmnlbhjplcgkofciiegomcon|cocfojppfigjeefejbpfmedgjbpchcng|foiopecknacmiihiocgdjgbjokkpkohc|hhdobjgopfphlmjbmnpglhfcgppchgje|jgbaghohigdbgbolncodkdlpenhcmcge|inligpkjkhbpifecbdjhmdpcfhnlelja|higioemojdadgdbhbbbkfbebbdlfjbip|hipncndjamdcmphkgngojegjblibadbe|iolonopooapdagdemdoaihahlfkncfgg|nhfjkakglbnnpkpldhjmpmmfefifedcj|jpgljfpmoofbmlieejglhonfofmahini|fgddmllnllkalaagkghckoinaemmogpe|ejkaocphofnobjdedneohbbiilggdlbi|keodbianoliadkoelloecbhllnpiocoi|hoapmlpnmpaehilehggglehfdlnoegck|poeojclicodamonabcabmapamjkkmnnk|dfkdflfgjdajbhocmfjolpjbebdkcjog|kcdahmgmaagjhocpipbodaokikjkampi|klnkiajpmpkkkgpgbogmcgfjhdoljacg|lneaocagcijjdpkcabeanfpdbmapcjjg|pgfpignfckbloagkfnamnolkeaecfgfh|jplnlifepflhkbkgonidnobkakhmpnmh|jliodmnojccaloajphkingdnpljdhdok|hnmpcagpplmpfojmgmnngilcnanddlhb|ffbkglfijbcbgblgflchnbphjdllaogb|kcndmbbelllkmioekdagahekgimemejo|jdgilggpfmjpbodmhndmhojklgfdlhob|bihhflimonbpcfagfadcnbbdngpopnjb|ppajinakbfocjfnijggfndbdmjggcmde|oofgbpoabipfcfjapgnbbjjaenockbdp|bhnhkdgoefpmekcgnccpnhjfdgicfebm|knmmpciebaoojcpjjoeonlcjacjopcpf|dhadilbmmjiooceioladdphemaliiobo|jedieiamjmoflcknjdjhpieklepfglin|mhngpdlhojliikfknhfaglpnddniijfh|omdakjcmkglenbhjadbccaookpfjihpa|npgimkapccfidfkfoklhpkgmhgfejhbj|akeehkgglkmpapdnanoochpfmeghfdln|gbmdmipapolaohpinhblmcnpmmlgfgje|aigmfoeogfnljhnofglledbhhfegannp|cgojmfochfikphincbhokimmmjenhhgk|ficajfeojakddincjafebjmfiefcmanc|ifnaibldjfdmaipaddffmgcmekjhiloa|jbnmpdkcfkochpanomnkhnafobppmccn|apcfdffemoinopelidncddjbhkiblecc|mjolnodfokkkaichkcjipfgblbfgojpa|oifjbnnafapeiknapihcmpeodaeblbkn|plpmggfglncceinmilojdkiijhmajkjh|mjnbclmflcpookeapghfhapeffmpodij|bblcccknbdbplgmdjnnikffefhdlobhp|aojlhgbkmkahabcmcpifbolnoichfeep|lcmammnjlbmlbcaniggmlejfjpjagiia|knajdeaocbpmfghhmijicidfcmdgbdpm|bdlcnpceagnkjnjlbbbcepohejbheilk|edknjdjielmpdlnllkdmaghlbpnmjmgb|eidnihaadmmancegllknfbliaijfmkgo|ckiahbcmlmkpfiijecbpflfahoimklke|macdlemfnignjhclfcfichcdhiomgjjb|chioafkonnhbpajpengbalkececleldf|amnoibeflfphhplmckdbiajkjaoomgnj|llbhddikeonkpbhpncnhialfbpnilcnc|pcienlhnoficegnepejpfiklggkioccm|iocnglnmfkgfedpcemdflhkchokkfeii|igahhbkcppaollcjeaaoapkijbnphfhb|njpmifchgidinihmijhcfpbdmglecdlb|ggackgngljinccllcmbgnpgpllcjepgc|kchocjcihdgkoplngjemhpplmmloanja|bnijmipndnicefcdbhgcjoognndbgkep|lklekjodgannjcccdlbicoamibgbdnmi|dbdbnchagbkhknegmhgikkleoogjcfge|egblhcjfjmbjajhjhpmnlekffgaemgfh|ehbhfpfdkmhcpaehaooegfdflljcnfec|bkkgdjpomdnfemhhkalfkogckjdkcjkg|almalgbpmcfpdaopimbdchdliminoign|akkbkhnikoeojlhiiomohpdnkhbkhieh|gbfgfbopcfokdpkdigfmoeaajfmpkbnh|bniikohfmajhdcffljgfeiklcbgffppl|lejgfmmlngaigdmmikblappdafcmkndb|ffhhkmlgedgcliajaedapkdfigdobcif|gcknhkkoolaabfmlnjonogaaifnjlfnp|pooljnboifbodgifngpppfklhifechoe|fjoaledfpmneenckfbpdfhkmimnjocfa|aakchaleigkohafkfjfjbblobjifikek|dpplabbmogkhghncfbfdeeokoefdjegm|padekgcemlokbadohgkifijomclgjgif|bfidboloedlamgdmenmlbipfnccokknp)
- name: '[Sigma] ClickOnce Trust Prompt Tampering'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\MICROSOFT\\\.NETFramework\\Security\\TrustManager\\PromptingLevel\\
- name: '[Sigma] ClickOnce Trust Prompt Tampering'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Internet|\\LocalIntranet|\\MyComputer|\\TrustedSites|\\UntrustedSites)$
- name: '[Sigma] ClickOnce Trust Prompt Tampering'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)Enabled
- name: '[Sigma] Potential CobaltStrike Service Installations - Registry'
  tag: attack.persistence,attack.execution,attack.privilege-escalation,attack.lateral-movement,attack.t1021.002,attack.t1543.003,attack.t1569.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'TargetObject\|contains':\ '\\\\System\\\\CurrentControlSet\\\\Services'\}|\{'TargetObject\|contains\|all':\
    \['\\\\System\\\\ControlSet',\ '\\\\Services'\]\})
- name: '[Sigma] Potential CobaltStrike Service Installations - Registry'
  tag: attack.persistence,attack.execution,attack.privilege-escalation,attack.lateral-movement,attack.t1021.002,attack.t1543.003,attack.t1569.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Details\|contains\|all':\ \['ADMIN\$',\ '\.exe'\]\}|\{'Details\|contains\|all':\
    \['%COMSPEC%',\ 'start',\ 'powershell'\]\})
- name: '[Sigma] COM Hijack via Sdclt'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1546,attack.t1548
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Software\\Classes\\Folder\\shell\\open\\command\\DelegateExecute
- name: '[Sigma] CrashControl CrashDump Disabled'
  tag: attack.persistence,attack.defense-evasion,attack.t1564,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)SYSTEM\\CurrentControlSet\\Control\\CrashControl
- name: '[Sigma] CrashControl CrashDump Disabled'
  tag: attack.persistence,attack.defense-evasion,attack.t1564,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Service Binary in Suspicious Folder'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: ^HKLM\\System\\CurrentControlSet\\Services\\
- name: '[Sigma] Service Binary in Suspicious Folder'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Start$
- name: '[Sigma] Service Binary in Suspicious Folder'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\Users\\Public\\|\\Perflogs\\|\\ADMIN\$\\|\\Temp\\)
- name: '[Sigma] Service Binary in Suspicious Folder'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(DWORD\ \(0x00000000\)|DWORD\ \(0x00000001\)|DWORD\ \(0x00000002\))
- name: '[Sigma] Service Binary in Suspicious Folder'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: ^HKLM\\System\\CurrentControlSet\\Services\\
- name: '[Sigma] Service Binary in Suspicious Folder'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\ImagePath$
- name: '[Sigma] Service Binary in Suspicious Folder'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Users\\Public\\|\\Perflogs\\|\\ADMIN\$\\|\\Temp\\)
- name: '[Sigma] Service Binary in Suspicious Folder'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\Common\ Files\\|\\Temp\\)
- name: '[Sigma] Service Binary in Suspicious Folder'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\CurrentControlSet\\Services\\MBAMInstallerService\\ImagePath$
- name: '[Sigma] Service Binary in Suspicious Folder'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\AppData\\Local\\Temp\\MBAMInstallerService\.exe"$
- name: '[Sigma] Service Binary in Suspicious Folder'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\system32\\services\.exe
- name: '[Sigma] Custom File Open Handler Executes PowerShell'
  tag: attack.defense-evasion,attack.t1202
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)shell\\open\\command\\
- name: '[Sigma] Custom File Open Handler Executes PowerShell'
  tag: attack.defense-evasion,attack.t1202
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(powershell|\-command)
- name: '[Sigma] Potential Registry Persistence Attempt Via DbgManagedDebugger'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.persistence,attack.t1574
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\\.NETFramework\\DbgManagedDebugger$
- name: '[Sigma] Potential Registry Persistence Attempt Via DbgManagedDebugger'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.persistence,attack.t1574
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)"C:\\Windows\\system32\\vsjitdebugger\.exe"\ PID\ %d\ APPDOM\ %d\ EXTEXT\
    "%s"\ EVTHDL\ %d
- name: '[Sigma] Windows Defender Exclusions Added - Registry'
  tag: attack.defense-evasion,attack.t1562.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Windows\ Defender\\Exclusions
- name: '[Sigma] Potentially Suspicious Desktop Background Change Via Registry'
  tag: attack.persistence,attack.defense-evasion,attack.impact,attack.t1112,attack.t1491.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(Control\ Panel\\Desktop|CurrentVersion\\Policies\\ActiveDesktop|CurrentVersion\\Policies\\System)
- name: '[Sigma] Potentially Suspicious Desktop Background Change Via Registry'
  tag: attack.persistence,attack.defense-evasion,attack.impact,attack.t1112,attack.t1491.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)NoChangingWallpaper$
- name: '[Sigma] Potentially Suspicious Desktop Background Change Via Registry'
  tag: attack.persistence,attack.defense-evasion,attack.impact,attack.t1112,attack.t1491.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] Potentially Suspicious Desktop Background Change Via Registry'
  tag: attack.persistence,attack.defense-evasion,attack.impact,attack.t1112,attack.t1491.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Wallpaper$
- name: '[Sigma] Potentially Suspicious Desktop Background Change Via Registry'
  tag: attack.persistence,attack.defense-evasion,attack.impact,attack.t1112,attack.t1491.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\WallpaperStyle$
- name: '[Sigma] Potentially Suspicious Desktop Background Change Via Registry'
  tag: attack.persistence,attack.defense-evasion,attack.impact,attack.t1112,attack.t1491.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)2
- name: '[Sigma] Potentially Suspicious Desktop Background Change Via Registry'
  tag: attack.persistence,attack.defense-evasion,attack.impact,attack.t1112,attack.t1491.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\svchost\.exe$
- name: '[Sigma] Potentially Suspicious Desktop Background Change Via Registry'
  tag: attack.persistence,attack.defense-evasion,attack.impact,attack.t1112,attack.t1491.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Control\ Panel\\Desktop\\Wallpaper$
- name: '[Sigma] Potentially Suspicious Desktop Background Change Via Registry'
  tag: attack.persistence,attack.defense-evasion,attack.impact,attack.t1112,attack.t1491.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\(Empty\)
- name: '[Sigma] Potentially Suspicious Desktop Background Change Via Registry'
  tag: attack.persistence,attack.defense-evasion,attack.impact,attack.t1112,attack.t1491.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\Explorer\.EXE$
- name: '[Sigma] Potentially Suspicious Desktop Background Change Via Registry'
  tag: attack.persistence,attack.defense-evasion,attack.impact,attack.t1112,attack.t1491.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\\Amazon\\EC2Launch\\EC2Launch\.exe|C:\\Program\
    Files\ \(x86\)\\Amazon\\EC2Launch\\EC2Launch\.exe)
- name: '[Sigma] Potentially Suspicious Desktop Background Change Via Registry'
  tag: attack.persistence,attack.defense-evasion,attack.impact,attack.t1112,attack.t1491.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Control\ Panel\\Desktop\\Wallpaper$
- name: '[Sigma] Antivirus Filter Driver Disallowed On Dev Drive - Registry'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\FilterManager\\FltmgrDevDriveAllowAntivirusFilter$
- name: '[Sigma] Antivirus Filter Driver Disallowed On Dev Drive - Registry'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Hypervisor Enforced Code Integrity Disabled'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Control\\DeviceGuard\\HypervisorEnforcedCodeIntegrity|\\Control\\DeviceGuard\\Scenarios\\HypervisorEnforcedCodeIntegrity\\Enabled|\\Microsoft\\Windows\\DeviceGuard\\HypervisorEnforcedCodeIntegrity)$
- name: '[Sigma] Hypervisor Enforced Code Integrity Disabled'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Hypervisor Enforced Paging Translation Disabled'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\DisableHypervisorEnforcedPagingTranslation$
- name: '[Sigma] Hypervisor Enforced Paging Translation Disabled'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] DHCP Callout DLL Installation'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574.001,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Services\\DHCPServer\\Parameters\\CalloutDlls|\\Services\\DHCPServer\\Parameters\\CalloutEnabled)$
- name: '[Sigma] Disable Exploit Guard Network Protection on Windows Defender'
  tag: attack.defense-evasion,attack.t1562.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)SOFTWARE\\Policies\\Microsoft\\Windows\ Defender\ Security\ Center\\App\
    and\ Browser\ protection\\DisallowExploitProtectionOverride
- name: '[Sigma] Disable Exploit Guard Network Protection on Windows Defender'
  tag: attack.defense-evasion,attack.t1562.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(00000001\)
- name: '[Sigma] Disabled Windows Defender Eventlog'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft\-Windows\-Windows\
    Defender/Operational\\Enabled
- name: '[Sigma] Disabled Windows Defender Eventlog'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Disable PUA Protection on Windows Defender'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Policies\\Microsoft\\Windows\ Defender\\PUAProtection
- name: '[Sigma] Disable PUA Protection on Windows Defender'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Disable Tamper Protection on Windows Defender'
  tag: attack.defense-evasion,attack.t1562.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Windows\ Defender\\Features\\TamperProtection
- name: '[Sigma] Disable Tamper Protection on Windows Defender'
  tag: attack.defense-evasion,attack.t1562.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Disable Tamper Protection on Windows Defender'
  tag: attack.defense-evasion,attack.t1562.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^C:\\ProgramData\\Microsoft\\Windows\ Defender\\Platform\\
- name: '[Sigma] Disable Tamper Protection on Windows Defender'
  tag: attack.defense-evasion,attack.t1562.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\MsMpEng\.exe$
- name: '[Sigma] Disable Tamper Protection on Windows Defender'
  tag: attack.defense-evasion,attack.t1562.001
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Program\ Files\\Windows\ Defender\\MsMpEng\.exe
- name: '[Sigma] Disable Administrative Share Creation at Startup'
  tag: attack.defense-evasion,attack.t1070.005
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Services\\LanmanServer\\Parameters\\
- name: '[Sigma] Disable Administrative Share Creation at Startup'
  tag: attack.defense-evasion,attack.t1070.005
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\AutoShareWks|\\AutoShareServer)$
- name: '[Sigma] Disable Administrative Share Creation at Startup'
  tag: attack.defense-evasion,attack.t1070.005
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Potential AutoLogger Sessions Tampering'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\System\\CurrentControlSet\\Control\\WMI\\Autologger\\
- name: '[Sigma] Potential AutoLogger Sessions Tampering'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\EventLog\-|\\Defender)
- name: '[Sigma] Potential AutoLogger Sessions Tampering'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Enable|\\Start)$
- name: '[Sigma] Potential AutoLogger Sessions Tampering'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Potential AutoLogger Sessions Tampering'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\system32\\wevtutil\.exe
- name: '[Sigma] Potential AutoLogger Sessions Tampering'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^(C:\\ProgramData\\Microsoft\\Windows\ Defender\\Platform\\|C:\\Program\
    Files\\Windows\ Defender\\|C:\\Program\ Files\ \(x86\)\\Windows\ Defender\\)
- name: '[Sigma] Potential AutoLogger Sessions Tampering'
  tag: attack.defense-evasion
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\MsMpEng\.exe$
- name: '[Sigma] Potential AutoLogger Sessions Tampering'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\DefenderApiLogger\\|\\DefenderAuditLogger\\)
- name: '[Sigma] Disable Microsoft Defender Firewall via Registry'
  tag: attack.defense-evasion,attack.t1562.004
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\
- name: '[Sigma] Disable Microsoft Defender Firewall via Registry'
  tag: attack.defense-evasion,attack.t1562.004
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\EnableFirewall$
- name: '[Sigma] Disable Microsoft Defender Firewall via Registry'
  tag: attack.defense-evasion,attack.t1562.004
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Disable Internal Tools or Feature in Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\DisableCMD|SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoControlPanel|SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoRun|SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\StartMenuLogOff|SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableChangePassword|SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableLockWorkstation|SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableRegistryTools|SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableTaskmgr|SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\NoDispBackgroundPage|SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\NoDispCPL|SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer\\DisableNotificationCenter|SOFTWARE\\Policies\\Microsoft\\Windows\\System\\DisableCMD)$
- name: '[Sigma] Disable Internal Tools or Feature in Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] Disable Internal Tools or Feature in Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\ConsentPromptBehaviorAdmin|Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\InactivityTimeoutSecs|SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\shutdownwithoutlogon|SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\PushNotifications\\ToastEnabled|SYSTEM\\CurrentControlSet\\Control\\Storage\\Write\
    Protection|SYSTEM\\CurrentControlSet\\Control\\StorageDevicePolicies\\WriteProtect)$
- name: '[Sigma] Disable Internal Tools or Feature in Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Disable Macro Runtime Scan Scope'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\SOFTWARE\\|\\Microsoft\\Office\\|\\Common\\Security)
- name: '[Sigma] Disable Macro Runtime Scan Scope'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\MacroRuntimeScanScope$
- name: '[Sigma] Disable Macro Runtime Scan Scope'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Disable Privacy Settings Experience in Registry'
  tag: attack.defense-evasion,attack.t1562.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Policies\\Microsoft\\Windows\\OOBE\\DisablePrivacyExperience$
- name: '[Sigma] Disable Privacy Settings Experience in Registry'
  tag: attack.defense-evasion,attack.t1562.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Disable Windows Security Center Notifications'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)Windows\\CurrentVersion\\ImmersiveShell\\UseActionCenterExperience$
- name: '[Sigma] Disable Windows Security Center Notifications'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Registry Disable System Restore'
  tag: attack.impact,attack.t1490
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Policies\\Microsoft\\Windows\ NT\\SystemRestore|\\Microsoft\\Windows\
    NT\\CurrentVersion\\SystemRestore)
- name: '[Sigma] Registry Disable System Restore'
  tag: attack.impact,attack.t1490
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(DisableConfig|DisableSR)$
- name: '[Sigma] Registry Disable System Restore'
  tag: attack.impact,attack.t1490
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] Windows Defender Service Disabled - Registry'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Services\\WinDefend\\Start$
- name: '[Sigma] Windows Defender Service Disabled - Registry'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000004\)
- name: '[Sigma] Disable Windows Firewall by Registry'
  tag: attack.defense-evasion,attack.t1562.004
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\StandardProfile\\EnableFirewall|\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\EnableFirewall)$
- name: '[Sigma] Disable Windows Firewall by Registry'
  tag: attack.defense-evasion,attack.t1562.004
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Disable Windows Event Logging Via Registry'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\
- name: '[Sigma] Disable Windows Event Logging Via Registry'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Enabled$
- name: '[Sigma] Disable Windows Event Logging Via Registry'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Disable Windows Event Logging Via Registry'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\system32\\wevtutil\.exe
- name: '[Sigma] Disable Windows Event Logging Via Registry'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^C:\\Windows\\winsxs\\
- name: '[Sigma] Disable Windows Event Logging Via Registry'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\TiWorker\.exe$
- name: '[Sigma] Disable Windows Event Logging Via Registry'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\svchost\.exe
- name: '[Sigma] Disable Windows Event Logging Via Registry'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft\-Windows\-FileInfoMinifilter|\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft\-Windows\-ASN1\\|\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft\-Windows\-Kernel\-AppCompat\\|\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft\-Windows\-Runtime\\Error\\|\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft\-Windows\-CAPI2/Operational\\)
- name: '[Sigma] Disable Windows Event Logging Via Registry'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\servicing\\TrustedInstaller\.exe
- name: '[Sigma] Disable Windows Event Logging Via Registry'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft\-Windows\-Compat\-Appraiser
- name: '[Sigma] Disable Windows Event Logging Via Registry'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)
- name: '[Sigma] Disable Windows Event Logging Via Registry'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: None
- name: '[Sigma] Add DisallowRun Execution to Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\DisallowRun$
- name: '[Sigma] Add DisallowRun Execution to Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] Persistence Via Disk Cleanup Handler - Autorun'
  tag: attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\VolumeCaches\\
- name: '[Sigma] Persistence Via Disk Cleanup Handler - Autorun'
  tag: attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Autorun
- name: '[Sigma] Persistence Via Disk Cleanup Handler - Autorun'
  tag: attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] Persistence Via Disk Cleanup Handler - Autorun'
  tag: attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\CleanupString|\\PreCleanupString)
- name: '[Sigma] Persistence Via Disk Cleanup Handler - Autorun'
  tag: attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(cmd|powershell|rundll32|mshta|cscript|wscript|wsl|\\Users\\Public\\|\\Windows\\TEMP\\|\\Microsoft\\Windows\\Start\
    Menu\\Programs\\Startup\\)
- name: '[Sigma] DNS-over-HTTPS Enabled by Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1140,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Policies\\Microsoft\\Edge\\BuiltInDnsClientEnabled$
- name: '[Sigma] DNS-over-HTTPS Enabled by Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1140,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] DNS-over-HTTPS Enabled by Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1140,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Google\\Chrome\\DnsOverHttpsMode$
- name: '[Sigma] DNS-over-HTTPS Enabled by Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1140,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)secure
- name: '[Sigma] DNS-over-HTTPS Enabled by Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1140,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Policies\\Mozilla\\Firefox\\DNSOverHTTPS\\Enabled$
- name: '[Sigma] DNS-over-HTTPS Enabled by Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1140,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] New DNS ServerLevelPluginDll Installed'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1574.001,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\services\\DNS\\Parameters\\ServerLevelPluginDll$
- name: '[Sigma] ETW Logging Disabled In .NET Processes - Sysmon Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1112,attack.t1562
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)SOFTWARE\\Microsoft\\\.NETFramework\\ETWEnabled$
- name: '[Sigma] ETW Logging Disabled In .NET Processes - Sysmon Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1112,attack.t1562
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] ETW Logging Disabled In .NET Processes - Sysmon Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1112,attack.t1562
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\COMPlus_ETWEnabled|\\COMPlus_ETWFlags)$
- name: '[Sigma] ETW Logging Disabled In .NET Processes - Sysmon Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1112,attack.t1562
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(0|DWORD\ \(0x00000000\))
- name: '[Sigma] Directory Service Restore Mode(DSRM) Registry Value Tampering'
  tag: attack.defense-evasion,attack.credential-access,attack.persistence,attack.t1556
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Control\\Lsa\\DsrmAdminLogonBehavior$
- name: '[Sigma] Directory Service Restore Mode(DSRM) Registry Value Tampering'
  tag: attack.defense-evasion,attack.credential-access,attack.persistence,attack.t1556
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Periodic Backup For System Registry Hives Enabled'
  tag: attack.collection,attack.t1113
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Control\\Session\ Manager\\Configuration\ Manager\\EnablePeriodicBackup$
- name: '[Sigma] Periodic Backup For System Registry Hives Enabled'
  tag: attack.collection,attack.t1113
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] Windows Recall Feature Enabled - Registry'
  tag: attack.collection,attack.t1113
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Software\\Policies\\Microsoft\\Windows\\WindowsAI\\DisableAIDataAnalysis$
- name: '[Sigma] Windows Recall Feature Enabled - Registry'
  tag: attack.collection,attack.t1113
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Enabling COR Profiler Environment Variables'
  tag: attack.persistence,attack.privilege-escalation,attack.defense-evasion,attack.t1574.012
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\COR_ENABLE_PROFILING|\\COR_PROFILER|\\CORECLR_ENABLE_PROFILING)$
- name: '[Sigma] Enabling COR Profiler Environment Variables'
  tag: attack.persistence,attack.privilege-escalation,attack.defense-evasion,attack.t1574.012
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\CORECLR_PROFILER_PATH
- name: '[Sigma] Scripted Diagnostics Turn Off Check Enabled - Registry'
  tag: attack.defense-evasion,attack.t1562.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Policies\\Microsoft\\Windows\\ScriptedDiagnostics\\TurnOffCheck$
- name: '[Sigma] Scripted Diagnostics Turn Off Check Enabled - Registry'
  tag: attack.defense-evasion,attack.t1562.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] Potential EventLog File Location Tampering'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\SYSTEM\\CurrentControlSet\\Services\\EventLog\\
- name: '[Sigma] Potential EventLog File Location Tampering'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\File$
- name: '[Sigma] Potential EventLog File Location Tampering'
  tag: attack.defense-evasion,attack.t1562.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\System32\\Winevt\\Logs\\
- name: '[Sigma] Suspicious Application Allowed Through Exploit Guard'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)SOFTWARE\\Microsoft\\Windows\ Defender\\Windows\ Defender\ Exploit\
    Guard\\Controlled\ Folder\ Access\\AllowedApplications
- name: '[Sigma] Suspicious Application Allowed Through Exploit Guard'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Users\\Public\\|\\AppData\\Local\\Temp\\|\\Desktop\\|\\PerfLogs\\|\\Windows\\Temp\\)
- name: '[Sigma] Change User Account Associated with the FAX Service'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)HKLM\\System\\CurrentControlSet\\Services\\Fax\\ObjectName
- name: '[Sigma] Change User Account Associated with the FAX Service'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)NetworkService
- name: '[Sigma] Change the Fax Dll'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Software\\Microsoft\\Fax\\Device\ Providers\\|\\ImageName)
- name: '[Sigma] Change the Fax Dll'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)%systemroot%\\system32\\fxst30\.dll
- name: '[Sigma] New File Association Using Exefile'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)Classes\\\.
- name: '[Sigma] New File Association Using Exefile'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)exefile
- name: '[Sigma] Add Debugger Entry To Hangs Key For Persistence'
  tag: attack.persistence
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Windows\\Windows\ Error\ Reporting\\Hangs\\Debugger
- name: '[Sigma] Persistence Via Hhctrl.ocx'
  tag: attack.persistence
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\CLSID\\\{52A2AAAE\-085D\-4187\-97EA\-8C30DB990436\}\\InprocServer32\\\(Default\)
- name: '[Sigma] Persistence Via Hhctrl.ocx'
  tag: attack.persistence
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\hhctrl\.ocx
- name: '[Sigma] Registry Modification to Hidden File Extension'
  tag: attack.persistence,attack.t1137
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\HideFileExt$
- name: '[Sigma] Registry Modification to Hidden File Extension'
  tag: attack.persistence,attack.t1137
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] Registry Modification to Hidden File Extension'
  tag: attack.persistence,attack.t1137
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\Hidden$
- name: '[Sigma] Registry Modification to Hidden File Extension'
  tag: attack.persistence,attack.t1137
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000002\)
- name: '[Sigma] Displaying Hidden Files Feature Disabled'
  tag: attack.defense-evasion,attack.t1564.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\ShowSuperHidden|\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\Hidden)$
- name: '[Sigma] Displaying Hidden Files Feature Disabled'
  tag: attack.defense-evasion,attack.t1564.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Registry Hide Function from User'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\HideClock|SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\HideSCAHealth|SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\HideSCANetwork|SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\HideSCAPower|SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\HideSCAVolume)$
- name: '[Sigma] Registry Hide Function from User'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] Registry Hide Function from User'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\ShowInfoTip|SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\ShowCompColor)$
- name: '[Sigma] Registry Hide Function from User'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Hide Schedule Task Via Index Value Tamper'
  tag: attack.defense-evasion,attack.t1562
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\SOFTWARE\\Microsoft\\Windows\ NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\|Index)
- name: '[Sigma] Hide Schedule Task Via Index Value Tamper'
  tag: attack.defense-evasion,attack.t1562
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Driver Added To Disallowed Images In HVCI - Registry'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Control\\CI\\|\\HVCIDisallowedImages)
- name: '[Sigma] IE ZoneMap Setting Downgraded To MyComputer Zone For HTTP Protocols'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Windows\\CurrentVersion\\Internet\ Settings\\ZoneMap\\ProtocolDefaults
- name: '[Sigma] IE ZoneMap Setting Downgraded To MyComputer Zone For HTTP Protocols'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\http|\\https)$
- name: '[Sigma] IE ZoneMap Setting Downgraded To MyComputer Zone For HTTP Protocols'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Uncommon Extension In Keyboard Layout IME File Registry Value'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Control\\Keyboard\ Layouts\\|Ime\ File)
- name: '[Sigma] Uncommon Extension In Keyboard Layout IME File Registry Value'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\.ime$
- name: '[Sigma] Suspicious Path In Keyboard Layout IME File Registry Value'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Control\\Keyboard\ Layouts\\|Ime\ File)
- name: '[Sigma] Suspicious Path In Keyboard Layout IME File Registry Value'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(:\\Perflogs\\|:\\Users\\Public\\|:\\Windows\\Temp\\|\\AppData\\Local\\Temp\\|\\AppData\\Roaming\\|\\Temporary\
    Internet)
- name: '[Sigma] Suspicious Path In Keyboard Layout IME File Registry Value'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Details\|contains\|all':\ \[':\\\\Users\\\\',\ '\\\\Favorites\\\\'\]\}|\{'Details\|contains\|all':\
    \[':\\\\Users\\\\',\ '\\\\Favourites\\\\'\]\}|\{'Details\|contains\|all':\ \[':\\\\Users\\\\',\
    '\\\\Contacts\\\\'\]\})
- name: '[Sigma] New Root or CA or AuthRoot Certificate to Store'
  tag: attack.impact,attack.t1490
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\SOFTWARE\\Microsoft\\SystemCertificates\\Root\\Certificates\\|\\SOFTWARE\\Policies\\Microsoft\\SystemCertificates\\Root\\Certificates\\|\\SOFTWARE\\Microsoft\\EnterpriseCertificates\\Root\\Certificates\\|\\SOFTWARE\\Microsoft\\SystemCertificates\\CA\\Certificates\\|\\SOFTWARE\\Policies\\Microsoft\\SystemCertificates\\CA\\Certificates\\|\\SOFTWARE\\Microsoft\\EnterpriseCertificates\\CA\\Certificates\\|\\SOFTWARE\\Microsoft\\SystemCertificates\\AuthRoot\\Certificates\\|\\SOFTWARE\\Policies\\Microsoft\\SystemCertificates\\AuthRoot\\Certificates\\|\\SOFTWARE\\Microsoft\\EnterpriseCertificates\\AuthRoot\\Certificates\\)
- name: '[Sigma] New Root or CA or AuthRoot Certificate to Store'
  tag: attack.impact,attack.t1490
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Blob$
- name: '[Sigma] New Root or CA or AuthRoot Certificate to Store'
  tag: attack.impact,attack.t1490
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)Binary\ Data
- name: '[Sigma] Internet Explorer DisableFirstRunCustomize Enabled'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Internet\ Explorer\\Main\\DisableFirstRunCustomize$
- name: '[Sigma] Internet Explorer DisableFirstRunCustomize Enabled'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(DWORD\ \(0x00000001\)|DWORD\ \(0x00000002\))
- name: '[Sigma] Internet Explorer DisableFirstRunCustomize Enabled'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Windows\\explorer\.exe|C:\\Windows\\System32\\ie4uinit\.exe)
- name: '[Sigma] Internet Explorer DisableFirstRunCustomize Enabled'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\Temp\\|\\\.cr\\avira_)
- name: '[Sigma] Internet Explorer DisableFirstRunCustomize Enabled'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] Internet Explorer DisableFirstRunCustomize Enabled'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\ \(x86\)\\Foxit\ Software\\Foxit\ PDF\ Reader\\FoxitPDFReader\.exe|C:\\Program\
    Files\\Foxit\ Software\\Foxit\ PDF\ Reader\\FoxitPDFReader\.exe)
- name: '[Sigma] Internet Explorer DisableFirstRunCustomize Enabled'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] Potential Ransomware Activity Using LegalNotice Message'
  tag: attack.impact,attack.t1491.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LegalNoticeCaption|\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LegalNoticeText)
- name: '[Sigma] Potential Ransomware Activity Using LegalNotice Message'
  tag: attack.impact,attack.t1491.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(encrypted|Unlock\-Password|paying)
- name: '[Sigma] Lolbas OneDriveStandaloneUpdater.exe Proxy Download'
  tag: attack.command-and-control,attack.t1105
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\OneDrive\\UpdateOfficeConfig\\UpdateRingSettingURLFromOC
- name: '[Sigma] Lsass Full Dump Request Via DumpType Registry Settings'
  tag: attack.credential-access,attack.t1003.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\SOFTWARE\\Microsoft\\Windows\\Windows\ Error\ Reporting\\LocalDumps\\DumpType|\\SOFTWARE\\Microsoft\\Windows\\Windows\
    Error\ Reporting\\LocalDumps\\lsass\.exe\\DumpType)
- name: '[Sigma] Lsass Full Dump Request Via DumpType Registry Settings'
  tag: attack.credential-access,attack.t1003.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000002\)
- name: '[Sigma] RestrictedAdminMode Registry Value Tampering'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)System\\CurrentControlSet\\Control\\Lsa\\DisableRestrictedAdmin$
- name: '[Sigma] Potential Persistence Via Netsh Helper DLL - Registry'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.007
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\NetSh
- name: '[Sigma] Potential Persistence Via Netsh Helper DLL - Registry'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.007
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\.dll
- name: '[Sigma] Potential Persistence Via Netsh Helper DLL - Registry'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.007
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\poqexec\.exe
- name: '[Sigma] Potential Persistence Via Netsh Helper DLL - Registry'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.007
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(ipmontr\.dll|iasmontr\.dll|ippromon\.dll)
- name: '[Sigma] New Netsh Helper DLL Registered From A Suspicious Location'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.007
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\NetSh
- name: '[Sigma] New Netsh Helper DLL Registered From A Suspicious Location'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.007
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(:\\Perflogs\\|:\\Users\\Public\\|:\\Windows\\Temp\\|\\AppData\\Local\\Temp\\|\\Temporary\
    Internet)
- name: '[Sigma] New Netsh Helper DLL Registered From A Suspicious Location'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.007
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Details\|contains\|all':\ \[':\\\\Users\\\\',\ '\\\\Favorites\\\\'\]\}|\{'Details\|contains\|all':\
    \[':\\\\Users\\\\',\ '\\\\Favourites\\\\'\]\}|\{'Details\|contains\|all':\ \[':\\\\Users\\\\',\
    '\\\\Contacts\\\\'\]\}|\{'Details\|contains\|all':\ \[':\\\\Users\\\\',\ '\\\\Pictures\\\\'\]\})
- name: '[Sigma] NET NGenAssemblyUsageLog Registry Key Tamper'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)SOFTWARE\\Microsoft\\\.NETFramework\\NGenAssemblyUsageLog$
- name: '[Sigma] New Application in AppCompat'
  tag: attack.execution,attack.t1204.002
  score: 0
  target: Full_Path
  condition: regex
  pattern: (?i)\\AppCompatFlags\\Compatibility\ Assistant\\Store\\
- name: '[Sigma] Potential Credential Dumping Attempt Using New NetworkProvider -
    REG'
  tag: attack.credential-access,attack.t1003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\System\\CurrentControlSet\\Services\\|\\NetworkProvider)
- name: '[Sigma] Potential Credential Dumping Attempt Using New NetworkProvider -
    REG'
  tag: attack.credential-access,attack.t1003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\System\\CurrentControlSet\\Services\\WebClient\\NetworkProvider|\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\NetworkProvider|\\System\\CurrentControlSet\\Services\\RDPNP\\NetworkProvider)
- name: '[Sigma] Potential Credential Dumping Attempt Using New NetworkProvider -
    REG'
  tag: attack.credential-access,attack.t1003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\poqexec\.exe
- name: '[Sigma] New ODBC Driver Registered'
  tag: attack.persistence
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\ODBC\\ODBCINST\.INI\\
- name: '[Sigma] New ODBC Driver Registered'
  tag: attack.persistence
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)\\Driver$
- name: '[Sigma] New ODBC Driver Registered'
  tag: attack.persistence
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)\\SQL\ Server\\
- name: '[Sigma] New ODBC Driver Registered'
  tag: attack.persistence
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)%WINDIR%\\System32\\SQLSRV32\.dll
- name: '[Sigma] New ODBC Driver Registered'
  tag: attack.persistence
  score: 20
  target: Full_Path
  condition: regex
  pattern: '(?i)\\Microsoft\ Access\ '
- name: '[Sigma] New ODBC Driver Registered'
  tag: attack.persistence
  score: 20
  target: Full_Path
  condition: regex
  pattern: ^C:\\Progra
- name: '[Sigma] New ODBC Driver Registered'
  tag: attack.persistence
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)\\ACEODBC\.DLL$
- name: '[Sigma] New ODBC Driver Registered'
  tag: attack.persistence
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\ Excel\ Driver
- name: '[Sigma] New ODBC Driver Registered'
  tag: attack.persistence
  score: 20
  target: Full_Path
  condition: regex
  pattern: ^C:\\Progra
- name: '[Sigma] New ODBC Driver Registered'
  tag: attack.persistence
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)\\ACEODBC\.DLL$
- name: '[Sigma] Potentially Suspicious ODBC Driver Registered'
  tag: attack.credential-access,attack.persistence,attack.t1003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\ODBC\\ODBCINST\.INI\\
- name: '[Sigma] Potentially Suspicious ODBC Driver Registered'
  tag: attack.credential-access,attack.persistence,attack.t1003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Driver|\\Setup)$
- name: '[Sigma] Potentially Suspicious ODBC Driver Registered'
  tag: attack.credential-access,attack.persistence,attack.t1003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(:\\PerfLogs\\|:\\ProgramData\\|:\\Temp\\|:\\Users\\Public\\|:\\Windows\\Registration\\CRMLog|:\\Windows\\System32\\com\\dmp\\|:\\Windows\\System32\\FxsTmp\\|:\\Windows\\System32\\Microsoft\\Crypto\\RSA\\MachineKeys\\|:\\Windows\\System32\\spool\\drivers\\color\\|:\\Windows\\System32\\spool\\PRINTERS\\|:\\Windows\\System32\\spool\\SERVERS\\|:\\Windows\\System32\\Tasks_Migrated\\|:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\SyncCenter\\|:\\Windows\\SysWOW64\\com\\dmp\\|:\\Windows\\SysWOW64\\FxsTmp\\|:\\Windows\\SysWOW64\\Tasks\\Microsoft\\Windows\\PLA\\System\\|:\\Windows\\SysWOW64\\Tasks\\Microsoft\\Windows\\SyncCenter\\|:\\Windows\\Tasks\\|:\\Windows\\Temp\\|:\\Windows\\Tracing\\|\\AppData\\Local\\Temp\\|\\AppData\\Roaming\\)
- name: '[Sigma] Trust Access Disable For VBApplications'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Security\\AccessVBOM$
- name: '[Sigma] Trust Access Disable For VBApplications'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] Microsoft Office Protected View Disabled'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\SOFTWARE\\Microsoft\\Office\\|\\Security\\ProtectedView\\)
- name: '[Sigma] Microsoft Office Protected View Disabled'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] Microsoft Office Protected View Disabled'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\DisableAttachementsInPV|\\DisableInternetFilesInPV|\\DisableIntranetCheck|\\DisableUnsafeLocationsInPV)$
- name: '[Sigma] Microsoft Office Protected View Disabled'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Microsoft Office Protected View Disabled'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\enabledatabasefileprotectedview|\\enableforeigntextfileprotectedview)$
- name: '[Sigma] Python Function Execution Security Warning Disabled In Excel - Registry'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Office\\
- name: '[Sigma] Python Function Execution Security Warning Disabled In Excel - Registry'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Excel\\Security\\PythonFunctionWarnings$
- name: '[Sigma] Python Function Execution Security Warning Disabled In Excel - Registry'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] Enable Microsoft Dynamic Data Exchange'
  tag: attack.execution,attack.t1559.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Word\\Security\\AllowDDE$
- name: '[Sigma] Enable Microsoft Dynamic Data Exchange'
  tag: attack.execution,attack.t1559.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(DWORD\ \(0x00000001\)|DWORD\ \(0x00000002\))
- name: '[Sigma] Enable Microsoft Dynamic Data Exchange'
  tag: attack.execution,attack.t1559.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Excel\\Security\\DisableDDEServerLaunch|\\Excel\\Security\\DisableDDEServerLookup)$
- name: '[Sigma] Enable Microsoft Dynamic Data Exchange'
  tag: attack.execution,attack.t1559.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Potential Persistence Via Outlook LoadMacroProviderOnBoot Setting'
  tag: attack.privilege-escalation,attack.persistence,attack.command-and-control,attack.t1137,attack.t1008,attack.t1546
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Outlook\\LoadMacroProviderOnBoot$
- name: '[Sigma] Potential Persistence Via Outlook LoadMacroProviderOnBoot Setting'
  tag: attack.privilege-escalation,attack.persistence,attack.command-and-control,attack.t1137,attack.t1008,attack.t1546
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)0x00000001
- name: '[Sigma] Outlook Macro Execution Without Warning Setting Enabled'
  tag: attack.privilege-escalation,attack.persistence,attack.command-and-control,attack.t1137,attack.t1008,attack.t1546
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Outlook\\Security\\Level$
- name: '[Sigma] Outlook Macro Execution Without Warning Setting Enabled'
  tag: attack.privilege-escalation,attack.persistence,attack.command-and-control,attack.t1137,attack.t1008,attack.t1546
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)0x00000001
- name: '[Sigma] Outlook EnableUnsafeClientMailRules Setting Enabled - Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Outlook\\Security\\EnableUnsafeClientMailRules$
- name: '[Sigma] Outlook EnableUnsafeClientMailRules Setting Enabled - Registry'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] Outlook Security Settings Updated - Registry'
  tag: attack.persistence,attack.t1137
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\SOFTWARE\\Microsoft\\Office\\|\\Outlook\\Security\\)
- name: '[Sigma] Uncommon Microsoft Office Trusted Location Added'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)Security\\Trusted\ Locations\\Location
- name: '[Sigma] Uncommon Microsoft Office Trusted Location Added'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Path$
- name: '[Sigma] Uncommon Microsoft Office Trusted Location Added'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(%APPDATA%\\Microsoft\\Templates|%%APPDATA%%\\Microsoft\\Templates|%APPDATA%\\Microsoft\\Word\\Startup|%%APPDATA%%\\Microsoft\\Word\\Startup|:\\Program\
    Files\ \(x86\)\\Microsoft\ Office\\root\\Templates\\|:\\Program\ Files\\Microsoft\
    Office\ \(x86\)\\Templates|:\\Program\ Files\\Microsoft\ Office\\root\\Templates\\|:\\Program\
    Files\\Microsoft\ Office\\Templates\\)
- name: '[Sigma] Uncommon Microsoft Office Trusted Location Added'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i):\\Program\ Files\\Common\ Files\\Microsoft\ Shared\\ClickToRun\\
- name: '[Sigma] Uncommon Microsoft Office Trusted Location Added'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\OfficeClickToRun\.exe$
- name: '[Sigma] Uncommon Microsoft Office Trusted Location Added'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Program\ Files\\Microsoft\ Office\\|:\\Program\ Files\ \(x86\)\\Microsoft\
    Office\\)
- name: '[Sigma] Macro Enabled In A Potentially Suspicious Document'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Security\\Trusted\ Documents\\TrustRecords
- name: '[Sigma] Macro Enabled In A Potentially Suspicious Document'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(/AppData/Local/Microsoft/Windows/INetCache/|/AppData/Local/Temp/|/PerfLogs/|C:/Users/Public/|file:///D:/|file:///E:/)
- name: '[Sigma] Office Macros Warning Disabled'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Security\\VBAWarnings$
- name: '[Sigma] Office Macros Warning Disabled'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] MaxMpxCt Registry Value Changed'
  tag: attack.defense-evasion,attack.t1070.005
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)\\Services\\LanmanServer\\Parameters\\MaxMpxCt$
- name: '[Sigma] Potential Persistence Via New AMSI Providers - Registry'
  tag: attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\SOFTWARE\\Microsoft\\AMSI\\Providers\\|\\SOFTWARE\\WOW6432Node\\Microsoft\\AMSI\\Providers\\)
- name: '[Sigma] Potential Persistence Via New AMSI Providers - Registry'
  tag: attack.persistence
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\\Avast\ Software\\Avast\\RegSvr\.exe|C:\\Program\
    Files\\Avast\ Software\\Avast\\x86\\RegSvr\.exe)
- name: '[Sigma] Potential Persistence Via New AMSI Providers - Registry'
  tag: attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\\{FB904E4E\-D2C7\-4C8D\-8492\-B620BB9896B1\}
- name: '[Sigma] Potential Persistence Via New AMSI Providers - Registry'
  tag: attack.persistence
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\\AVG\\Antivirus\\RegSvr\.exe|C:\\Program\ Files\\AVG\\Antivirus\\x86\\RegSvr\.exe)
- name: '[Sigma] Potential Persistence Via New AMSI Providers - Registry'
  tag: attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\\{FB904E4E\-D2C7\-4C8D\-8492\-B620BB9896B1\}
- name: '[Sigma] Potential Persistence Via New AMSI Providers - Registry'
  tag: attack.persistence
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Program\ Files\\Avira\\Endpoint\ Protection\ SDK\\endpointprotection\.exe
- name: '[Sigma] Potential Persistence Via New AMSI Providers - Registry'
  tag: attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\\{00000001\-3DCC\-4B48\-A82E\-E2071FE58E05\}
- name: '[Sigma] Potential Persistence Using DebugPath'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.015
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)Classes\\ActivatableClasses\\Package\\Microsoft\.
- name: '[Sigma] Potential Persistence Using DebugPath'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.015
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\DebugPath$
- name: '[Sigma] Potential Persistence Using DebugPath'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.015
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Software\\Microsoft\\Windows\\CurrentVersion\\PackagedAppXDebug\\Microsoft\.
- name: '[Sigma] Potential Persistence Using DebugPath'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.015
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\\(Default\)$
- name: '[Sigma] Potential Persistence Via AppCompat RegisterAppRestart Layer'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.011
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Windows\ NT\\CurrentVersion\\AppCompatFlags\\Layers\\
- name: '[Sigma] Potential Persistence Via AppCompat RegisterAppRestart Layer'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.011
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)REGISTERAPPRESTART
- name: '[Sigma] Potential Persistence Via App Paths Default Property'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.012
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App\ Paths
- name: '[Sigma] Potential Persistence Via App Paths Default Property'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.012
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\(Default\)|Path)$
- name: '[Sigma] Potential Persistence Via App Paths Default Property'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.012
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Users\\Public|\\AppData\\Local\\Temp\\|\\Windows\\Temp\\|\\Desktop\\|\\Downloads\\|%temp%|%tmp%|iex|Invoke\-|rundll32|regsvr32|mshta|cscript|wscript|\.bat|\.hta|\.dll|\.ps1)
- name: '[Sigma] Potential Persistence Via AutodialDLL'
  tag: attack.persistence
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Services\\WinSock2\\Parameters\\AutodialDLL
- name: '[Sigma] Potential Persistence Via CHM Helper DLL'
  tag: attack.persistence
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Software\\Microsoft\\HtmlHelp\ Author\\Location|\\Software\\WOW6432Node\\Microsoft\\HtmlHelp\
    Author\\Location)
- name: '[Sigma] Potential PSFactoryBuffer COM Hijacking'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.015
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\CLSID\\\{c90250f3\-4d7d\-4991\-9b69\-a5c5bc1c2ae6\}\\InProcServer32\\\(Default\)$
- name: '[Sigma] Potential PSFactoryBuffer COM Hijacking'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.015
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(%windir%\\System32\\ActXPrxy\.dll|C:\\Windows\\System32\\ActXPrxy\.dll)
- name: '[Sigma] Potential COM Object Hijacking Via TreatAs Subkey - Registry'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.015
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(HKU\\|Classes\\CLSID\\|\\TreatAs)
- name: '[Sigma] Potential COM Object Hijacking Via TreatAs Subkey - Registry'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.015
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\WINDOWS\\system32\\svchost\.exe
- name: '[Sigma] Potential Persistence Via Custom Protocol Handler'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: ^HKCR\\
- name: '[Sigma] Potential Persistence Via Custom Protocol Handler'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: '^URL:'
- name: '[Sigma] Potential Persistence Via Custom Protocol Handler'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: ^URL:ms\-
- name: '[Sigma] Potential Persistence Via Custom Protocol Handler'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^(C:\\Program\ Files\ \(x86\)|C:\\Program\ Files\\|C:\\Windows\\System32\\|C:\\Windows\\SysWOW64\\)
- name: '[Sigma] Potential Persistence Via Event Viewer Events.asp'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Microsoft\\Windows\ NT\\CurrentVersion\\Event\ Viewer\\MicrosoftRedirectionProgram|\\Microsoft\\Windows\
    NT\\CurrentVersion\\Event\ Viewer\\MicrosoftRedirectionURL)
- name: '[Sigma] Potential Persistence Via Event Viewer Events.asp'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\WINDOWS\\system32\\svchost\.exe$
- name: '[Sigma] Potential Persistence Via Event Viewer Events.asp'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Windows\ NT\\CurrentVersion\\Event\ Viewer\\MicrosoftRedirectionProgram$
- name: '[Sigma] Potential Persistence Via Event Viewer Events.asp'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)%%SystemRoot%%\\PCHealth\\HelpCtr\\Binaries\\HelpCtr\.exe
- name: '[Sigma] Potential Persistence Via Event Viewer Events.asp'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\WINDOWS\\system32\\svchost\.exe$
- name: '[Sigma] Potential Persistence Via Event Viewer Events.asp'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Windows\ NT\\CurrentVersion\\Event\ Viewer\\MicrosoftRedirectionProgramCommandLineParameters$
- name: '[Sigma] Potential Persistence Via Event Viewer Events.asp'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\-url\ hcp://services/centers/support.topic=%%s
- name: '[Sigma] Potential Persistence Via Event Viewer Events.asp'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)http://go\.microsoft\.com/fwlink/events\.asp
- name: '[Sigma] Potential Persistence Via Event Viewer Events.asp'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\(Empty\)
- name: '[Sigma] Potential Persistence Via GlobalFlags'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1546.012,car.2013-01-002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Microsoft\\Windows\ NT\\CurrentVersion\\|\\Image\ File\ Execution\
    Options\\|\\GlobalFlag)
- name: '[Sigma] Potential Persistence Via GlobalFlags'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1546.012,car.2013-01-002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Microsoft\\Windows\ NT\\CurrentVersion\\|\\SilentProcessExit\\)
- name: '[Sigma] Potential Persistence Via GlobalFlags'
  tag: attack.privilege-escalation,attack.persistence,attack.defense-evasion,attack.t1546.012,car.2013-01-002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\ReportingMode|\\MonitorProcess)
- name: '[Sigma] Modification of IE Registry Settings'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet\ Settings
- name: '[Sigma] Modification of IE Registry Settings'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 20
  target: Full_Path
  condition: regex
  pattern: ^DWORD
- name: '[Sigma] Modification of IE Registry Settings'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 20
  target: Full_Path
  condition: regex
  pattern: None
- name: '[Sigma] Modification of IE Registry Settings'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(Cookie:|Visited:|\(Empty\))
- name: '[Sigma] Modification of IE Registry Settings'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Cache|\\ZoneMap|\\WpadDecision)
- name: '[Sigma] Modification of IE Registry Settings'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)Binary\ Data
- name: '[Sigma] Modification of IE Registry Settings'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet\ Settings\\Accepted\
    Documents
- name: '[Sigma] Register New IFiltre For Persistence'
  tag: attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\SOFTWARE\\Classes\\\.|\\PersistentHandler)
- name: '[Sigma] Register New IFiltre For Persistence'
  tag: attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\SOFTWARE\\Classes\\CLSID|\\PersistentAddinsRegistered\\\{89BCB740\-6119\-101A\-BCB7\-00DD010655AF\})
- name: '[Sigma] Register New IFiltre For Persistence'
  tag: attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\CLSID\\\{4F46F75F\-199F\-4C63\-8B7D\-86D48FE7970C\}\\|\\CLSID\\\{4887767F\-7ADC\-4983\-B576\-88FB643D6F79\}\\|\\CLSID\\\{D3B41FA1\-01E3\-49AF\-AA25\-1D0D824275AE\}\\|\\CLSID\\\{72773E1A\-B711\-4d8d\-81FA\-B9A43B0650DD\}\\|\\CLSID\\\{098f2470\-bae0\-11cd\-b579\-08002b30bfeb\}\\|\\CLSID\\\{1AA9BF05\-9A97\-48c1\-BA28\-D9DCE795E93C\}\\|\\CLSID\\\{2e2294a9\-50d7\-4fe7\-a09f\-e6492e185884\}\\|\\CLSID\\\{34CEAC8D\-CBC0\-4f77\-B7B1\-8A60CB6DA0F7\}\\|\\CLSID\\\{3B224B11\-9363\-407e\-850F\-C9E1FFACD8FB\}\\|\\CLSID\\\{3DDEB7A4\-8ABF\-4D82\-B9EE\-E1F4552E95BE\}\\|\\CLSID\\\{5645C8C1\-E277\-11CF\-8FDA\-00AA00A14F93\}\\|\\CLSID\\\{5645C8C4\-E277\-11CF\-8FDA\-00AA00A14F93\}\\|\\CLSID\\\{58A9EBF6\-5755\-4554\-A67E\-A2467AD1447B\}\\|\\CLSID\\\{5e941d80\-bf96\-11cd\-b579\-08002b30bfeb\}\\|\\CLSID\\\{698A4FFC\-63A3\-4E70\-8F00\-376AD29363FB\}\\|\\CLSID\\\{7E9D8D44\-6926\-426F\-AA2B\-217A819A5CCE\}\\|\\CLSID\\\{8CD34779\-9F10\-4f9b\-ADFB\-B3FAEABDAB5A\}\\|\\CLSID\\\{9694E38A\-E081\-46ac\-99A0\-8743C909ACB6\}\\|\\CLSID\\\{98de59a0\-d175\-11cd\-a7bd\-00006b827d94\}\\|\\CLSID\\\{AA10385A\-F5AA\-4EFF\-B3DF\-71B701E25E18\}\\|\\CLSID\\\{B4132098\-7A03\-423D\-9463\-163CB07C151F\}\\|\\CLSID\\\{d044309b\-5da6\-4633\-b085\-4ed02522e5a5\}\\|\\CLSID\\\{D169C14A\-5148\-4322\-92C8\-754FC9D018D8\}\\|\\CLSID\\\{DD75716E\-B42E\-4978\-BB60\-1497B92E30C4\}\\|\\CLSID\\\{E2F83EED\-62DE\-4A9F\-9CD0\-A1D40DCD13B6\}\\|\\CLSID\\\{E772CEB3\-E203\-4828\-ADF1\-765713D981B8\}\\|\\CLSID\\\{eec97550\-47a9\-11cf\-b952\-00aa0051fe20\}|\\CLSID\\\{FB10BD80\-A331\-4e9e\-9EB7\-00279903AD99\}\\)
- name: '[Sigma] Register New IFiltre For Persistence'
  tag: attack.persistence
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^(C:\\Windows\\System32\\|C:\\Program\ Files\ \(x86\)\\|C:\\Program\ Files\\)
- name: '[Sigma] Potential Persistence Via Logon Scripts - Registry'
  tag: attack.privilege-escalation,attack.t1037.001,attack.persistence,attack.lateral-movement
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)UserInitMprLogonScript
- name: '[Sigma] Potential Persistence Via LSA Extensions'
  tag: attack.persistence
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\SYSTEM\\CurrentControlSet\\Control\\LsaExtensionConfig\\LsaSrv\\Extensions
- name: '[Sigma] Potential Persistence Via Mpnotify'
  tag: attack.persistence
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Windows\ NT\\CurrentVersion\\Winlogon\\mpnotify
- name: '[Sigma] Potential Persistence Via MyComputer Registry Keys'
  tag: attack.persistence
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Windows\\CurrentVersion\\Explorer\\MyComputer
- name: '[Sigma] Potential Persistence Via MyComputer Registry Keys'
  tag: attack.persistence
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\(Default\)$
- name: '[Sigma] Potential Persistence Via DLLPathOverride'
  tag: attack.persistence
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\SYSTEM\\CurrentControlSet\\Control\\ContentIndex\\Language\\
- name: '[Sigma] Potential Persistence Via DLLPathOverride'
  tag: attack.persistence
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\StemmerDLLPathOverride|\\WBDLLPathOverride|\\StemmerClass|\\WBreakerClass)
- name: '[Sigma] Potential Persistence Via Visual Studio Tools for Office'
  tag: attack.t1137.006,attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Software\\Microsoft\\Office\\Outlook\\Addins\\|\\Software\\Microsoft\\Office\\Word\\Addins\\|\\Software\\Microsoft\\Office\\Excel\\Addins\\|\\Software\\Microsoft\\Office\\Powerpoint\\Addins\\|\\Software\\Microsoft\\VSTO\\Security\\Inclusion\\)
- name: '[Sigma] Potential Persistence Via Visual Studio Tools for Office'
  tag: attack.t1137.006,attack.persistence
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Windows\\System32\\msiexec\.exe|C:\\Windows\\SysWOW64\\msiexec\.exe|C:\\Windows\\System32\\regsvr32\.exe|C:\\Windows\\SysWOW64\\regsvr32\.exe)
- name: '[Sigma] Potential Persistence Via Visual Studio Tools for Office'
  tag: attack.t1137.006,attack.persistence
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^(C:\\Program\ Files\\Common\ Files\ \(x86\)\\Microsoft\ Shared\\ClickToRun\\|C:\\Program\
    Files\\Common\ Files\\Microsoft\ Shared\\ClickToRun\\)
- name: '[Sigma] Potential Persistence Via Visual Studio Tools for Office'
  tag: attack.t1137.006,attack.persistence
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\OfficeClickToRun\.exe$
- name: '[Sigma] Potential Persistence Via Visual Studio Tools for Office'
  tag: attack.t1137.006,attack.persistence
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\ \(x86\)\\Microsoft\ Office\\root\\integration\\integrator\.exe|C:\\Program\
    Files\\Microsoft\ Office\\root\\integration\\integrator\.exe)
- name: '[Sigma] Potential Persistence Via Visual Studio Tools for Office'
  tag: attack.t1137.006,attack.persistence
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^(C:\\Program\ Files\\Microsoft\ Office\\OFFICE|C:\\Program\ Files\ \(x86\)\\Microsoft\
    Office\\OFFICE|C:\\Program\ Files\\Microsoft\ Office\\Root\\OFFICE|C:\\Program\
    Files\ \(x86\)\\Microsoft\ Office\\Root\\OFFICE)
- name: '[Sigma] Potential Persistence Via Visual Studio Tools for Office'
  tag: attack.t1137.006,attack.persistence
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\excel\.exe|\\Integrator\.exe|\\outlook\.exe|\\powerpnt\.exe|\\Teams\.exe|\\visio\.exe|\\winword\.exe)$
- name: '[Sigma] Potential Persistence Via Visual Studio Tools for Office'
  tag: attack.t1137.006,attack.persistence
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\\AVG\\Antivirus\\RegSvr\.exe|C:\\Program\ Files\
    \(x86\)\\AVG\\Antivirus\\RegSvr\.exe)
- name: '[Sigma] Potential Persistence Via Visual Studio Tools for Office'
  tag: attack.t1137.006,attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Office\\Outlook\\Addins\\Antivirus\.AsOutExt\\
- name: '[Sigma] Potential Persistence Via Visual Studio Tools for Office'
  tag: attack.t1137.006,attack.persistence
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\\Avast\ Software\\Avast\\RegSvr\.exe|C:\\Program\
    Files\ \(x86\)\\Avast\ Software\\Avast\\RegSvr\.exe)
- name: '[Sigma] Potential Persistence Via Visual Studio Tools for Office'
  tag: attack.t1137.006,attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Office\\Outlook\\Addins\\Avast\.AsOutExt\\
- name: '[Sigma] Potential Persistence Via Outlook Home Page'
  tag: attack.defense-evasion,attack.persistence,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Software\\Microsoft\\Office\\|\\Outlook\\WebView\\)
- name: '[Sigma] Potential Persistence Via Outlook Home Page'
  tag: attack.defense-evasion,attack.persistence,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\URL$
- name: '[Sigma] Potential Persistence Via Outlook Today Page'
  tag: attack.defense-evasion,attack.persistence,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(Software\\Microsoft\\Office\\|\\Outlook\\Today\\)
- name: '[Sigma] Potential Persistence Via Outlook Today Page'
  tag: attack.defense-evasion,attack.persistence,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Stamp$
- name: '[Sigma] Potential Persistence Via Outlook Today Page'
  tag: attack.defense-evasion,attack.persistence,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] Potential Persistence Via Outlook Today Page'
  tag: attack.defense-evasion,attack.persistence,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\URL|\\UserDefinedUrl)$
- name: '[Sigma] Potential Persistence Via Outlook Today Page'
  tag: attack.defense-evasion,attack.persistence,attack.t1112
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^(C:\\Program\ Files\\Common\ Files\\Microsoft\ Shared\\ClickToRun\\|C:\\Program\
    Files\\Common\ Files\\Microsoft\ Shared\\ClickToRun\\Updates\\)
- name: '[Sigma] Potential Persistence Via Outlook Today Page'
  tag: attack.defense-evasion,attack.persistence,attack.t1112
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\OfficeClickToRun\.exe$
- name: '[Sigma] Potential WerFault ReflectDebugger Registry Value Abuse'
  tag: attack.defense-evasion,attack.t1036.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Windows\\Windows\ Error\ Reporting\\Hangs\\ReflectDebugger$
- name: '[Sigma] Potential Persistence Via Scrobj.dll COM Hijacking'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.015
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)InprocServer32\\\(Default\)$
- name: '[Sigma] Potential Persistence Via Scrobj.dll COM Hijacking'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.015
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)C:\\WINDOWS\\system32\\scrobj\.dll
- name: '[Sigma] Potential Persistence Via Shim Database Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.011
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\SOFTWARE\\Microsoft\\Windows\ NT\\CurrentVersion\\AppCompatFlags\\InstalledSDB\\|\\SOFTWARE\\Microsoft\\Windows\
    NT\\CurrentVersion\\AppCompatFlags\\Custom\\)
- name: '[Sigma] Potential Persistence Via Shim Database Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.011
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)
- name: '[Sigma] Potential Persistence Via Shim Database Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.011
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\(Empty\)
- name: '[Sigma] Potential Persistence Via Shim Database Modification'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.011
  score: 50
  target: Full_Path
  condition: regex
  pattern: None
- name: '[Sigma] Suspicious Shim Database Patching Activity'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.011
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Windows\ NT\\CurrentVersion\\AppCompatFlags\\Custom\\
- name: '[Sigma] Suspicious Shim Database Patching Activity'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.011
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\csrss\.exe|\\dllhost\.exe|\\explorer\.exe|\\RuntimeBroker\.exe|\\services\.exe|\\sihost\.exe|\\svchost\.exe|\\taskhostw\.exe|\\winlogon\.exe|\\WmiPrvSe\.exe)$
- name: '[Sigma] Potential Persistence Via Shim Database In Uncommon Location'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.011
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\SOFTWARE\\Microsoft\\Windows\ NT\\CurrentVersion\\AppCompatFlags\\InstalledSDB\\|\\DatabasePath)
- name: '[Sigma] Potential Persistence Via Shim Database In Uncommon Location'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.011
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i):\\Windows\\AppPatch\\Custom
- name: '[Sigma] Potential Persistence Via TypedPaths'
  tag: attack.persistence
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TypedPaths\\
- name: '[Sigma] Potential Persistence Via TypedPaths'
  tag: attack.persistence
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Windows\\explorer\.exe|C:\\Windows\\SysWOW64\\explorer\.exe)
- name: '[Sigma] Potential Persistence Via Excel Add-in - Registry'
  tag: attack.persistence,attack.t1137.006
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)Software\\Microsoft\\Office\\
- name: '[Sigma] Potential Persistence Via Excel Add-in - Registry'
  tag: attack.persistence,attack.t1137.006
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Excel\\Options$
- name: '[Sigma] Potential Persistence Via Excel Add-in - Registry'
  tag: attack.persistence,attack.t1137.006
  score: 80
  target: Full_Path
  condition: regex
  pattern: '^/R\ '
- name: '[Sigma] Potential Persistence Via Excel Add-in - Registry'
  tag: attack.persistence,attack.t1137.006
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\.xll$
- name: '[Sigma] Potential Attachment Manager Settings Associations Tamper'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Associations\\
- name: '[Sigma] Potential Attachment Manager Settings Associations Tamper'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\DefaultFileTypeRisk$
- name: '[Sigma] Potential Attachment Manager Settings Associations Tamper'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00006152\)
- name: '[Sigma] Potential Attachment Manager Settings Associations Tamper'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\LowRiskFileTypes$
- name: '[Sigma] Potential Attachment Manager Settings Associations Tamper'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\.zip;|\.rar;|\.exe;|\.bat;|\.com;|\.cmd;|\.reg;|\.msi;|\.htm;|\.html;)
- name: '[Sigma] Potential Attachment Manager Settings Attachments Tamper'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Attachments\\
- name: '[Sigma] Potential Attachment Manager Settings Attachments Tamper'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\HideZoneInfoOnProperties$
- name: '[Sigma] Potential Attachment Manager Settings Attachments Tamper'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] Potential Attachment Manager Settings Attachments Tamper'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\SaveZoneInformation$
- name: '[Sigma] Potential Attachment Manager Settings Attachments Tamper'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000002\)
- name: '[Sigma] Potential Attachment Manager Settings Attachments Tamper'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\ScanWithAntiVirus$
- name: '[Sigma] Potential Attachment Manager Settings Attachments Tamper'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] PowerShell as a Service in Registry'
  tag: attack.execution,attack.t1569.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Services\\
- name: '[Sigma] PowerShell as a Service in Registry'
  tag: attack.execution,attack.t1569.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\ImagePath$
- name: '[Sigma] PowerShell as a Service in Registry'
  tag: attack.execution,attack.t1569.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(powershell|pwsh)
- name: '[Sigma] PowerShell Script Execution Policy Enabled'
  tag: attack.execution
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)\\Policies\\Microsoft\\Windows\\PowerShell\\EnableScripts$
- name: '[Sigma] PowerShell Script Execution Policy Enabled'
  tag: attack.execution
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] Potential PowerShell Execution Policy Tampering'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\ShellIds\\Microsoft\.PowerShell\\ExecutionPolicy|\\Policies\\Microsoft\\Windows\\PowerShell\\ExecutionPolicy)$
- name: '[Sigma] Potential PowerShell Execution Policy Tampering'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(Bypass|Unrestricted)
- name: '[Sigma] Potential PowerShell Execution Policy Tampering'
  tag: attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(:\\Windows\\System32\\|:\\Windows\\SysWOW64\\)
- name: '[Sigma] Suspicious PowerShell In Registry Run Keys'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Software\\Microsoft\\Windows\\CurrentVersion\\Run|\\Software\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Run|\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run)
- name: '[Sigma] Suspicious PowerShell In Registry Run Keys'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(powershell|pwsh\ |FromBase64String|\.DownloadFile\(|\.DownloadString\(|\
    \-w\ hidden\ |\ \-w\ 1\ |\-windowstyle\ hidden|\-window\ hidden|\ \-nop\ |\ \-encodedcommand\
    |\-ExecutionPolicy\ Bypass|Invoke\-Expression|IEX\ \(|Invoke\-Command|ICM\ \-|Invoke\-WebRequest|IWR\
    |Invoke\-RestMethod|IRM\ |\ \-noni\ |\ \-noninteractive\ )
- name: '[Sigma] PowerShell Logging Disabled Via Registry Key Tampering'
  tag: attack.defense-evasion,attack.t1564.001,attack.t1112,attack.persistence
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Microsoft\\Windows\\PowerShell\\|\\Microsoft\\PowerShellCore\\)
- name: '[Sigma] PowerShell Logging Disabled Via Registry Key Tampering'
  tag: attack.defense-evasion,attack.t1564.001,attack.t1112,attack.persistence
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\ModuleLogging\\EnableModuleLogging|\\ScriptBlockLogging\\EnableScriptBlockLogging|\\ScriptBlockLogging\\EnableScriptBlockInvocationLogging|\\Transcription\\EnableTranscripting|\\Transcription\\EnableInvocationHeader|\\EnableScripts)$
- name: '[Sigma] PowerShell Logging Disabled Via Registry Key Tampering'
  tag: attack.defense-evasion,attack.t1564.001,attack.t1112,attack.persistence
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Potential Provisioning Registry Key Abuse For Binary Proxy Execution
    - REG'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Provisioning\\Commands\\
- name: '[Sigma] PUA - Sysinternal Tool Execution - Registry'
  tag: attack.resource-development,attack.t1588.002
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)\\EulaAccepted$
- name: '[Sigma] Suspicious Execution Of Renamed Sysinternals Tools - Registry'
  tag: attack.resource-development,attack.t1588.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Active\ Directory\ Explorer|\\Handle|\\LiveKd|\\ProcDump|\\Process\
    Explorer|\\PsExec|\\PsLoggedon|\\PsLoglist|\\PsPasswd|\\PsPing|\\PsService|\\SDelete)
- name: '[Sigma] Suspicious Execution Of Renamed Sysinternals Tools - Registry'
  tag: attack.resource-development,attack.t1588.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\EulaAccepted$
- name: '[Sigma] Suspicious Execution Of Renamed Sysinternals Tools - Registry'
  tag: attack.resource-development,attack.t1588.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\ADExplorer\.exe|\\ADExplorer64\.exe|\\handle\.exe|\\handle64\.exe|\\livekd\.exe|\\livekd64\.exe|\\procdump\.exe|\\procdump64\.exe|\\procexp\.exe|\\procexp64\.exe|\\PsExec\.exe|\\PsExec64\.exe|\\PsLoggedon\.exe|\\PsLoggedon64\.exe|\\psloglist\.exe|\\psloglist64\.exe|\\pspasswd\.exe|\\pspasswd64\.exe|\\PsPing\.exe|\\PsPing64\.exe|\\PsService\.exe|\\PsService64\.exe|\\sdelete\.exe)$
- name: '[Sigma] PUA - Sysinternals Tools Execution - Registry'
  tag: attack.resource-development,attack.t1588.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Active\ Directory\ Explorer|\\Handle|\\LiveKd|\\Process\ Explorer|\\ProcDump|\\PsExec|\\PsLoglist|\\PsPasswd|\\SDelete|\\Sysinternals)
- name: '[Sigma] PUA - Sysinternals Tools Execution - Registry'
  tag: attack.resource-development,attack.t1588.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\EulaAccepted$
- name: '[Sigma] Usage of Renamed Sysinternals Tools - RegistrySet'
  tag: attack.resource-development,attack.t1588.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\PsExec|\\ProcDump|\\Handle|\\LiveKd|\\Process\ Explorer|\\PsLoglist|\\PsPasswd|\\Active\
    Directory\ Explorer)
- name: '[Sigma] Usage of Renamed Sysinternals Tools - RegistrySet'
  tag: attack.resource-development,attack.t1588.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\EulaAccepted$
- name: '[Sigma] Usage of Renamed Sysinternals Tools - RegistrySet'
  tag: attack.resource-development,attack.t1588.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(\\PsExec\.exe|\\PsExec64\.exe|\\procdump\.exe|\\procdump64\.exe|\\handle\.exe|\\handle64\.exe|\\livekd\.exe|\\livekd64\.exe|\\procexp\.exe|\\procexp64\.exe|\\psloglist\.exe|\\psloglist64\.exe|\\pspasswd\.exe|\\pspasswd64\.exe|\\ADExplorer\.exe|\\ADExplorer64\.exe)$
- name: '[Sigma] Usage of Renamed Sysinternals Tools - RegistrySet'
  tag: attack.resource-development,attack.t1588.002
  score: 80
  target: Target_Path
  condition: regex
  pattern: None
- name: '[Sigma] ETW Logging Disabled For rpcrt4.dll'
  tag: attack.persistence,attack.defense-evasion,attack.t1112,attack.t1562
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Windows\ NT\\Rpc\\ExtErrorInformation$
- name: '[Sigma] ETW Logging Disabled For rpcrt4.dll'
  tag: attack.persistence,attack.defense-evasion,attack.t1112,attack.t1562
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)(DWORD\ \(0x00000000\)|DWORD\ \(0x00000002\))
- name: '[Sigma] Potentially Suspicious Command Executed Via Run Dialog Box - Registry'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RunMRU
- name: '[Sigma] Potentially Suspicious Command Executed Via Run Dialog Box - Registry'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(powershell|pwsh)
- name: '[Sigma] Potentially Suspicious Command Executed Via Run Dialog Box - Registry'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\ \-e\ |\ \-ec\ |\ \-en\ |\ \-enc\ |\ \-enco|ftp|Hidden|http|iex|Invoke\-)
- name: '[Sigma] Potentially Suspicious Command Executed Via Run Dialog Box - Registry'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)wmic
- name: '[Sigma] Potentially Suspicious Command Executed Via Run Dialog Box - Registry'
  tag: attack.execution,attack.t1059.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(shadowcopy|process\ call\ create)
- name: '[Sigma] ScreenSaver Registry Key Set'
  tag: attack.defense-evasion,attack.t1218.011
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\rundll32\.exe$
- name: '[Sigma] ScreenSaver Registry Key Set'
  tag: attack.defense-evasion,attack.t1218.011
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Control\ Panel\\Desktop\\SCRNSAVE\.EXE
- name: '[Sigma] ScreenSaver Registry Key Set'
  tag: attack.defense-evasion,attack.t1218.011
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\.scr$
- name: '[Sigma] ScreenSaver Registry Key Set'
  tag: attack.defense-evasion,attack.t1218.011
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(C:\\Windows\\System32\\|C:\\Windows\\SysWOW64\\)
- name: '[Sigma] Potential SentinelOne Shell Context Menu Scan Command Tampering'
  tag: attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\shell\\SentinelOneScan\\command\\
- name: '[Sigma] Potential SentinelOne Shell Context Menu Scan Command Tampering'
  tag: attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: ^(C:\\Program\ Files\\SentinelOne\\Sentinel\ Agent|C:\\Program\ Files\
    \(x86\)\\SentinelOne\\Sentinel\ Agent)
- name: '[Sigma] Potential SentinelOne Shell Context Menu Scan Command Tampering'
  tag: attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\SentinelScanFromContextMenu\.exe
- name: '[Sigma] Potential SentinelOne Shell Context Menu Scan Command Tampering'
  tag: attack.persistence
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\\SentinelOne\\|C:\\Program\ Files\ \(x86\)\\SentinelOne\\)$
- name: '[Sigma] ServiceDll Hijack'
  tag: attack.persistence,attack.privilege-escalation,attack.t1543.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\System\\|ControlSet|\\Services\\)
- name: '[Sigma] ServiceDll Hijack'
  tag: attack.persistence,attack.privilege-escalation,attack.t1543.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Parameters\\ServiceDll$
- name: '[Sigma] ServiceDll Hijack'
  tag: attack.persistence,attack.privilege-escalation,attack.t1543.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)C:\\Windows\\system32\\spool\\drivers\\x64\\3\\PrintConfig\.dll
- name: '[Sigma] ServiceDll Hijack'
  tag: attack.persistence,attack.privilege-escalation,attack.t1543.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\system32\\lsass\.exe
- name: '[Sigma] ServiceDll Hijack'
  tag: attack.persistence,attack.privilege-escalation,attack.t1543.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Services\\NTDS\\Parameters\\ServiceDll$
- name: '[Sigma] ServiceDll Hijack'
  tag: attack.persistence,attack.privilege-escalation,attack.t1543.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)%%systemroot%%\\system32\\ntdsa\.dll
- name: '[Sigma] ServiceDll Hijack'
  tag: attack.persistence,attack.privilege-escalation,attack.t1543.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\poqexec\.exe
- name: '[Sigma] ServiceDll Hijack'
  tag: attack.persistence,attack.privilege-escalation,attack.t1543.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\regsvr32\.exe$
- name: '[Sigma] ServiceDll Hijack'
  tag: attack.persistence,attack.privilege-escalation,attack.t1543.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\STAgent\.dll
- name: '[Sigma] ETW Logging Disabled For SCM'
  tag: attack.persistence,attack.defense-evasion,attack.t1112,attack.t1562
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)Software\\Microsoft\\Windows\ NT\\CurrentVersion\\Tracing\\SCM\\Regular\\TracingDisabled$
- name: '[Sigma] ETW Logging Disabled For SCM'
  tag: attack.persistence,attack.defense-evasion,attack.t1112,attack.t1562
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] Registry Explorer Policy Modification'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoLogOff|SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoDesktop|SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoRun|SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoFind|SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoControlPanel|SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoFileMenu|SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoClose|SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoSetTaskbar|SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoPropertiesMyDocuments|SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoTrayContextMenu)$
- name: '[Sigma] Registry Explorer Policy Modification'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] Persistence Via New SIP Provider'
  tag: attack.persistence,attack.defense-evasion,attack.t1553.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\SOFTWARE\\Microsoft\\Cryptography\\Providers\\|\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType|\\SOFTWARE\\WOW6432Node\\Microsoft\\Cryptography\\Providers\\|\\SOFTWARE\\WOW6432Node\\Microsoft\\Cryptography\\OID\\EncodingType)
- name: '[Sigma] Persistence Via New SIP Provider'
  tag: attack.persistence,attack.defense-evasion,attack.t1553.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Dll|\\\$DLL)
- name: '[Sigma] Persistence Via New SIP Provider'
  tag: attack.persistence,attack.defense-evasion,attack.t1553.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(WINTRUST\.DLL|mso\.dll)
- name: '[Sigma] Persistence Via New SIP Provider'
  tag: attack.persistence,attack.defense-evasion,attack.t1553.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\poqexec\.exe
- name: '[Sigma] Persistence Via New SIP Provider'
  tag: attack.persistence,attack.defense-evasion,attack.t1553.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\CryptSIPDll
- name: '[Sigma] Persistence Via New SIP Provider'
  tag: attack.persistence,attack.defense-evasion,attack.t1553.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\PsfSip\.dll
- name: '[Sigma] Tamper With Sophos AV Registry Keys'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Sophos\ Endpoint\ Defense\\TamperProtection\\Config\\SAVEnabled|\\Sophos\
    Endpoint\ Defense\\TamperProtection\\Config\\SEDEnabled|\\Sophos\\SAVService\\TamperProtection\\Enabled)
- name: '[Sigma] Tamper With Sophos AV Registry Keys'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Hiding User Account Via SpecialAccounts Registry Key'
  tag: attack.defense-evasion,attack.t1564.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Windows\ NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\UserList
- name: '[Sigma] Hiding User Account Via SpecialAccounts Registry Key'
  tag: attack.defense-evasion,attack.t1564.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Activate Suppression of Windows Security Center Notifications'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)SOFTWARE\\Policies\\Microsoft\\Windows\ Defender\\UX\ Configuration\\Notification_Suppress$
- name: '[Sigma] Activate Suppression of Windows Security Center Notifications'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] Suspicious Environment Variable Has Been Registered'
  tag: attack.defense-evasion,attack.persistence
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Environment\\
- name: '[Sigma] Suspicious Environment Variable Has Been Registered'
  tag: attack.defense-evasion,attack.persistence
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\{'Details':\ \['powershell',\ 'pwsh'\]\}|\{'Details\|contains':\
    \['\\\\AppData\\\\Local\\\\Temp\\\\',\ 'C:\\\\Users\\\\Public\\\\',\ 'TVqQAAMAAAAEAAAA',\
    'TVpQAAIAAAAEAA8A',\ 'TVqAAAEAAAAEABAA',\ 'TVoAAAAAAAAAAAAA',\ 'TVpTAQEAAAAEAAAA',\
    'SW52b2tlL',\ 'ludm9rZS',\ 'JbnZva2Ut',\ 'SQBuAHYAbwBrAGUALQ',\ 'kAbgB2AG8AawBlAC0A',\
    'JAG4AdgBvAGsAZQAtA'\]\}|\{'Details\|startswith':\ \['SUVY',\ 'SQBFAF',\ 'SQBuAH',\
    'cwBhA',\ 'aWV4',\ 'aQBlA',\ 'R2V0',\ 'dmFy',\ 'dgBhA',\ 'dXNpbm',\ 'H4sIA',\
    'Y21k',\ 'cABhAH',\ 'Qzpc',\ 'Yzpc'\]\})
- name: '[Sigma] Suspicious Keyboard Layout Load'
  tag: attack.resource-development,attack.t1588.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Keyboard\ Layout\\Preload\\|\\Keyboard\ Layout\\Substitutes\\)
- name: '[Sigma] Suspicious Keyboard Layout Load'
  tag: attack.resource-development,attack.t1588.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(00000429|00050429|0000042a)
- name: '[Sigma] Potential PendingFileRenameOperations Tampering'
  tag: attack.defense-evasion,attack.t1036.003
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\CurrentControlSet\\Control\\Session\ Manager\\PendingFileRenameOperations
- name: '[Sigma] Potential PendingFileRenameOperations Tampering'
  tag: attack.defense-evasion,attack.t1036.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\Users\\Public\\
- name: '[Sigma] Potential PendingFileRenameOperations Tampering'
  tag: attack.defense-evasion,attack.t1036.003
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\reg\.exe|\\regedit\.exe)$
- name: '[Sigma] Suspicious Printer Driver Empty Manufacturer'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1574,cve.2021-1675
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Control\\Print\\Environments\\Windows\ x64\\Drivers|\\Manufacturer)
- name: '[Sigma] Suspicious Printer Driver Empty Manufacturer'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1574,cve.2021-1675
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\(Empty\)
- name: '[Sigma] Suspicious Printer Driver Empty Manufacturer'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1574,cve.2021-1675
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\CutePDF\ Writer\ v4\.0\\
- name: '[Sigma] Suspicious Printer Driver Empty Manufacturer'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1574,cve.2021-1675
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\VNC\ Printer\ \(PS\)\\|\\VNC\ Printer\ \(UD\)\\)
- name: '[Sigma] Suspicious Printer Driver Empty Manufacturer'
  tag: attack.persistence,attack.defense-evasion,attack.privilege-escalation,attack.t1574,cve.2021-1675
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Version\-3\\PDF24\\
- name: '[Sigma] Registry Persistence via Explorer Run Key'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run$
- name: '[Sigma] Registry Persistence via Explorer Run Key'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(:\\\$Recycle\.bin\\|:\\ProgramData\\|:\\Temp\\|:\\Users\\Default\\|:\\Users\\Public\\|:\\Windows\\Temp\\|\\AppData\\Local\\Temp\\)
- name: '[Sigma] Suspicious Service Installed'
  tag: attack.t1562.001,attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(HKLM\\System\\CurrentControlSet\\Services\\NalDrv\\ImagePath|HKLM\\System\\CurrentControlSet\\Services\\PROCEXP152\\ImagePath)
- name: '[Sigma] Suspicious Service Installed'
  tag: attack.t1562.001,attack.defense-evasion
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(\\procexp64\.exe|\\procexp\.exe|\\procmon64\.exe|\\procmon\.exe|\\handle\.exe|\\handle64\.exe)$
- name: '[Sigma] Suspicious Service Installed'
  tag: attack.t1562.001,attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\WINDOWS\\system32\\Drivers\\PROCEXP152\.SYS
- name: '[Sigma] Modify User Shell Folders Startup Value'
  tag: attack.persistence,attack.privilege-escalation,attack.t1547.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User\ Shell\
    Folders
- name: '[Sigma] Modify User Shell Folders Startup Value'
  tag: attack.persistence,attack.privilege-escalation,attack.t1547.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)Startup$
- name: '[Sigma] Enable LM Hash Storage'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)System\\CurrentControlSet\\Control\\Lsa\\NoLMHash$
- name: '[Sigma] Enable LM Hash Storage'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Scheduled TaskCache Change by Uncommon Program'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053,attack.t1053.005
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)SOFTWARE\\Microsoft\\Windows\ NT\\CurrentVersion\\Schedule\\TaskCache\\
- name: '[Sigma] Scheduled TaskCache Change by Uncommon Program'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053,attack.t1053.005
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\(Empty\)
- name: '[Sigma] Scheduled TaskCache Change by Uncommon Program'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053,attack.t1053.005
  score: 80
  target: Full_Path
  condition: regex
  pattern: None
- name: '[Sigma] Scheduled TaskCache Change by Uncommon Program'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053,attack.t1053.005
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(Microsoft\\Windows\\UpdateOrchestrator|Microsoft\\Windows\\SoftwareProtectionPlatform\\SvcRestartTask\\Index|Microsoft\\Windows\\Flighting\\OneSettings\\RefreshCache\\Index)
- name: '[Sigma] Scheduled TaskCache Change by Uncommon Program'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\MoUsoCoreWorker\.exe$
- name: '[Sigma] Scheduled TaskCache Change by Uncommon Program'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\services\.exe$
- name: '[Sigma] Scheduled TaskCache Change by Uncommon Program'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^C:\\Windows\\
- name: '[Sigma] Scheduled TaskCache Change by Uncommon Program'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\TiWorker\.exe$
- name: '[Sigma] Scheduled TaskCache Change by Uncommon Program'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\WINDOWS\\system32\\svchost\.exe
- name: '[Sigma] Scheduled TaskCache Change by Uncommon Program'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^C:\\Windows\\Microsoft\.NET\\Framework
- name: '[Sigma] Scheduled TaskCache Change by Uncommon Program'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\ngen\.exe$
- name: '[Sigma] Scheduled TaskCache Change by Uncommon Program'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053,attack.t1053.005
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Microsoft\\Windows\ NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\\\{B66B135D\-DA06\-4FC4\-95F8\-7458E1D10129\}|\\Microsoft\\Windows\
    NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\Microsoft\\Windows\\\.NET\ Framework\\\.NET\
    Framework\ NGEN)
- name: '[Sigma] Scheduled TaskCache Change by Uncommon Program'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\\Microsoft\ Office\\root\\Integration\\Integrator\.exe|C:\\Program\
    Files\ \(x86\)\\Microsoft\ Office\\root\\Integration\\Integrator\.exe|C:\\Program\
    Files\\Common\ Files\\microsoft\ shared\\ClickToRun\\OfficeC2RClient\.exe|C:\\Program\
    Files\ \(x86\)\\Common\ Files\\microsoft\ shared\\ClickToRun\\OfficeC2RClient\.exe)
- name: '[Sigma] Scheduled TaskCache Change by Uncommon Program'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\msiexec\.exe
- name: '[Sigma] Scheduled TaskCache Change by Uncommon Program'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\explorer\.exe
- name: '[Sigma] Scheduled TaskCache Change by Uncommon Program'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053,attack.t1053.005
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Windows\ NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\Microsoft\\Windows\\PLA\\Server\
    Manager\ Performance\ Monitor\\
- name: '[Sigma] Scheduled TaskCache Change by Uncommon Program'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)System
- name: '[Sigma] Scheduled TaskCache Change by Uncommon Program'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\System32\\RuntimeBroker\.exe
- name: '[Sigma] Scheduled TaskCache Change by Uncommon Program'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\ \(x86\)\\Dropbox\\Update\\DropboxUpdate\.exe|C:\\Program\
    Files\\Dropbox\\Update\\DropboxUpdate\.exe)
- name: '[Sigma] Scheduled TaskCache Change by Uncommon Program'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\ \(x86\)\\Microsoft\\EdgeUpdate\\MicrosoftEdgeUpdate\.exe|C:\\Program\
    Files\\Microsoft\\EdgeUpdate\\MicrosoftEdgeUpdate\.exe)$
- name: '[Sigma] Scheduled TaskCache Change by Uncommon Program'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053,attack.t1053.005
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\ \(x86\)\\Microsoft\ OneDrive\\OneDrive\.exe|C:\\Program\
    Files\\Microsoft\ OneDrive\\OneDrive\.exe)$
- name: '[Sigma] Potential Registry Persistence Attempt Via Windows Telemetry'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Windows\ NT\\CurrentVersion\\AppCompatFlags\\TelemetryController\\
- name: '[Sigma] Potential Registry Persistence Attempt Via Windows Telemetry'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Command$
- name: '[Sigma] Potential Registry Persistence Attempt Via Windows Telemetry'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\.bat|\.bin|\.cmd|\.dat|\.dll|\.exe|\.hta|\.jar|\.js|\.msi|\.ps|\.sh|\.vb)
- name: '[Sigma] Potential Registry Persistence Attempt Via Windows Telemetry'
  tag: attack.privilege-escalation,attack.execution,attack.persistence,attack.t1053.005
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\system32\\CompatTelRunner\.exe|\\system32\\DeviceCensus\.exe)
- name: '[Sigma] RDP Sensitive Settings Changed to Zero'
  tag: attack.defense-evasion,attack.persistence,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\fDenyTSConnections|\\fSingleSessionPerUser|\\UserAuthentication)$
- name: '[Sigma] RDP Sensitive Settings Changed to Zero'
  tag: attack.defense-evasion,attack.persistence,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] RDP Sensitive Settings Changed'
  tag: attack.defense-evasion,attack.persistence,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Control\\Terminal\ Server\\|\\Windows\ NT\\Terminal\ Services\\)
- name: '[Sigma] RDP Sensitive Settings Changed'
  tag: attack.defense-evasion,attack.persistence,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Shadow$
- name: '[Sigma] RDP Sensitive Settings Changed'
  tag: attack.defense-evasion,attack.persistence,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(DWORD\ \(0x00000001\)|DWORD\ \(0x00000002\)|DWORD\ \(0x00000003\)|DWORD\
    \(0x00000004\))
- name: '[Sigma] RDP Sensitive Settings Changed'
  tag: attack.defense-evasion,attack.persistence,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Control\\Terminal\ Server\\|\\Windows\ NT\\Terminal\ Services\\)
- name: '[Sigma] RDP Sensitive Settings Changed'
  tag: attack.defense-evasion,attack.persistence,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\DisableRemoteDesktopAntiAlias|\\DisableSecuritySettings|\\fAllowUnsolicited|\\fAllowUnsolicitedFullControl)$
- name: '[Sigma] RDP Sensitive Settings Changed'
  tag: attack.defense-evasion,attack.persistence,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] RDP Sensitive Settings Changed'
  tag: attack.defense-evasion,attack.persistence,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Control\\Terminal\ Server\\InitialProgram|\\Control\\Terminal\ Server\\WinStations\\RDP\-Tcp\\InitialProgram|\\services\\TermService\\Parameters\\ServiceDll|\\Terminal\
    Server\\WinStations\\RDP\-Tcp\\SecurityLayer|\\Windows\ NT\\Terminal\ Services\\InitialProgram)
- name: '[Sigma] RDP Sensitive Settings Changed'
  tag: attack.defense-evasion,attack.persistence,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\SecurityLayer$
- name: '[Sigma] RDP Sensitive Settings Changed'
  tag: attack.defense-evasion,attack.persistence,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000002\)
- name: '[Sigma] New TimeProviders Registered With Uncommon DLL Name'
  tag: attack.persistence,attack.privilege-escalation,attack.t1547.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Services\\W32Time\\TimeProviders
- name: '[Sigma] New TimeProviders Registered With Uncommon DLL Name'
  tag: attack.persistence,attack.privilege-escalation,attack.t1547.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\DllName$
- name: '[Sigma] New TimeProviders Registered With Uncommon DLL Name'
  tag: attack.persistence,attack.privilege-escalation,attack.t1547.003
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(%SystemRoot%\\System32\\vmictimeprovider\.dll|%systemroot%\\system32\\w32time\.dll|C:\\Windows\\SYSTEM32\\w32time\.DLL)
- name: '[Sigma] Old TLS1.0/TLS1.1 Protocol Version Enabled'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS\ 1\.0\\|\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS\
    1\.1\\)
- name: '[Sigma] Old TLS1.0/TLS1.1 Protocol Version Enabled'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Enabled$
- name: '[Sigma] Old TLS1.0/TLS1.1 Protocol Version Enabled'
  tag: attack.defense-evasion
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] COM Hijacking via TreatAs'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.015
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)TreatAs\\\(Default\)$
- name: '[Sigma] COM Hijacking via TreatAs'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.015
  score: 50
  target: Target_Path
  condition: regex
  pattern: ^C:\\Program\ Files\\Common\ Files\\Microsoft\ Shared\\ClickToRun\\
- name: '[Sigma] COM Hijacking via TreatAs'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.015
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)\\OfficeClickToRun\.exe$
- name: '[Sigma] COM Hijacking via TreatAs'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.015
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Program\ Files\\Microsoft\ Office\\root\\integration\\integrator\.exe|C:\\Program\
    Files\ \(x86\)\\Microsoft\ Office\\root\\integration\\integrator\.exe)
- name: '[Sigma] COM Hijacking via TreatAs'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.015
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)C:\\Windows\\system32\\svchost\.exe
- name: '[Sigma] COM Hijacking via TreatAs'
  tag: attack.privilege-escalation,attack.persistence,attack.t1546.015
  score: 50
  target: Target_Path
  condition: regex
  pattern: (?i)(C:\\Windows\\system32\\msiexec\.exe|C:\\Windows\\SysWOW64\\msiexec\.exe)
- name: '[Sigma] Potential Signing Bypass Via Windows Developer Features - Registry'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Microsoft\\Windows\\CurrentVersion\\AppModelUnlock|\\Policies\\Microsoft\\Windows\\Appx\\)
- name: '[Sigma] Potential Signing Bypass Via Windows Developer Features - Registry'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\AllowAllTrustedApps|\\AllowDevelopmentWithoutDevLicense)$
- name: '[Sigma] Potential Signing Bypass Via Windows Developer Features - Registry'
  tag: attack.defense-evasion
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] UAC Bypass via Event Viewer'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002,car.2019-04-001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\mscfile\\shell\\open\\command$
- name: '[Sigma] UAC Bypass via Sdclt'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002,car.2019-04-001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)Software\\Classes\\exefile\\shell\\runas\\command\\isolatedCommand$
- name: '[Sigma] UAC Bypass via Sdclt'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002,car.2019-04-001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)Software\\Classes\\Folder\\shell\\open\\command\\SymbolicLinkValue$
- name: '[Sigma] UAC Bypass via Sdclt'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002,car.2019-04-001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\-1\[0\-9\]\{3\}\\\\Software\\\\Classes\\\\
- name: '[Sigma] UAC Bypass Abusing Winsat Path Parsing - Registry'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Root\\InventoryApplicationFile\\winsat\.exe\|
- name: '[Sigma] UAC Bypass Abusing Winsat Path Parsing - Registry'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\LowerCaseLongPath$
- name: '[Sigma] UAC Bypass Abusing Winsat Path Parsing - Registry'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: ^c:\\users\\
- name: '[Sigma] UAC Bypass Abusing Winsat Path Parsing - Registry'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\appdata\\local\\temp\\system32\\winsat\.exe$
- name: '[Sigma] UAC Bypass Using Windows Media Player - Registry'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Windows\ NT\\CurrentVersion\\AppCompatFlags\\Compatibility\
    Assistant\\Store\\C:\\Program\ Files\\Windows\ Media\ Player\\osk\.exe$
- name: '[Sigma] UAC Bypass Using Windows Media Player - Registry'
  tag: attack.defense-evasion,attack.privilege-escalation,attack.t1548.002
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)Binary\ Data
- name: '[Sigma] UAC Disabled'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1548.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\EnableLUA
- name: '[Sigma] UAC Disabled'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1548.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] UAC Notification Disabled'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1548.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Security\ Center\\UACDisableNotify
- name: '[Sigma] UAC Notification Disabled'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1548.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] UAC Secure Desktop Prompt Disabled'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1548.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\PromptOnSecureDesktop
- name: '[Sigma] UAC Secure Desktop Prompt Disabled'
  tag: attack.privilege-escalation,attack.defense-evasion,attack.t1548.002
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] VBScript Payload Stored in Registry'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)Software\\Microsoft\\Windows\\CurrentVersion
- name: '[Sigma] VBScript Payload Stored in Registry'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(vbscript:|jscript:|mshtml,|RunHTMLApplication|Execute\(|CreateObject|window\.close)
- name: '[Sigma] VBScript Payload Stored in Registry'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)Software\\Microsoft\\Windows\\CurrentVersion\\Run
- name: '[Sigma] VBScript Payload Stored in Registry'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\msiexec\.exe$
- name: '[Sigma] VBScript Payload Stored in Registry'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\
- name: '[Sigma] VBScript Payload Stored in Registry'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\Microsoft\.NET\\Primary\ Interop\ Assemblies\\Microsoft\.mshtml\.dll|<\\Microsoft\.mshtml,fileVersion=|_mshtml_dll_|<\\Microsoft\.mshtml,culture=)
- name: '[Sigma] Execution DLL of Choice Using WAB.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\Software\\Microsoft\\WAB\\DLLPath$
- name: '[Sigma] Execution DLL of Choice Using WAB.EXE'
  tag: attack.defense-evasion,attack.t1218
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)%CommonProgramFiles%\\System\\wab32\.dll
- name: '[Sigma] Wdigest Enable UseLogonCredential'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)WDigest\\UseLogonCredential$
- name: '[Sigma] Wdigest Enable UseLogonCredential'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] Disable Windows Defender Functionalities Via Registry Keys'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\SOFTWARE\\Microsoft\\Windows\ Defender\\|\\SOFTWARE\\Policies\\Microsoft\\Windows\
    Defender\ Security\ Center\\|\\SOFTWARE\\Policies\\Microsoft\\Windows\ Defender\\)
- name: '[Sigma] Disable Windows Defender Functionalities Via Registry Keys'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\DisableAntiSpyware|\\DisableAntiVirus|\\DisableBehaviorMonitoring|\\DisableBlockAtFirstSeen|\\DisableEnhancedNotifications|\\DisableIntrusionPreventionSystem|\\DisableIOAVProtection|\\DisableOnAccessProtection|\\DisableRealtimeMonitoring|\\DisableScanOnRealtimeEnable|\\DisableScriptScanning)$
- name: '[Sigma] Disable Windows Defender Functionalities Via Registry Keys'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] Disable Windows Defender Functionalities Via Registry Keys'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)(\\DisallowExploitProtectionOverride|\\Features\\TamperProtection|\\MpEngine\\MpEnablePus|\\PUAProtection|\\Signature\
    Update\\ForceUpdateFromMU|\\SpyNet\\SpynetReporting|\\SpyNet\\SubmitSamplesConsent|\\Windows\
    Defender\ Exploit\ Guard\\Controlled\ Folder\ Access\\EnableControlledFolderAccess)$
- name: '[Sigma] Disable Windows Defender Functionalities Via Registry Keys'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000000\)
- name: '[Sigma] Disable Windows Defender Functionalities Via Registry Keys'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: ^C:\\Program\ Files\\Symantec\\Symantec\ Endpoint\ Protection\\
- name: '[Sigma] Disable Windows Defender Functionalities Via Registry Keys'
  tag: attack.defense-evasion,attack.t1562.001
  score: 80
  target: Target_Path
  condition: regex
  pattern: (?i)\\sepWscSvc64\.exe$
- name: '[Sigma] Winget Admin Settings Modification'
  tag: attack.defense-evasion,attack.persistence
  score: 20
  target: Target_Path
  condition: regex
  pattern: (?i)\\winget\.exe$
- name: '[Sigma] Winget Admin Settings Modification'
  tag: attack.defense-evasion,attack.persistence
  score: 20
  target: Full_Path
  condition: regex
  pattern: ^\\REGISTRY\\A\\
- name: '[Sigma] Winget Admin Settings Modification'
  tag: attack.defense-evasion,attack.persistence
  score: 20
  target: Full_Path
  condition: regex
  pattern: (?i)\\LocalState\\admin_settings$
- name: '[Sigma] Enable Local Manifest Installation With Winget'
  tag: attack.defense-evasion,attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\AppInstaller\\EnableLocalManifestFiles$
- name: '[Sigma] Enable Local Manifest Installation With Winget'
  tag: attack.defense-evasion,attack.persistence
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)
- name: '[Sigma] Winlogon AllowMultipleTSSessions Enable'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)\\Microsoft\\Windows\ NT\\CurrentVersion\\Winlogon\\AllowMultipleTSSessions$
- name: '[Sigma] Winlogon AllowMultipleTSSessions Enable'
  tag: attack.persistence,attack.defense-evasion,attack.t1112
  score: 50
  target: Full_Path
  condition: regex
  pattern: (?i)DWORD\ \(0x00000001\)$
- name: '[Sigma] Winlogon Notify Key Logon Persistence'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.004
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\\SOFTWARE\\Microsoft\\Windows\ NT\\CurrentVersion\\Winlogon\\Notify\\logon$
- name: '[Sigma] Winlogon Notify Key Logon Persistence'
  tag: attack.privilege-escalation,attack.persistence,attack.t1547.004
  score: 80
  target: Full_Path
  condition: regex
  pattern: (?i)\.dll$
noise_filters: []
