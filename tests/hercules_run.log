C:\Users\user\.gemini\antigravity\scratch\SkiaHelios\tools\SH_HerculesReferee.py:1103: DeprecationWarning: `str.concat` is deprecated; use `str.join` instead. Note also that the default `delimiter` for `str.join` is an empty string, not a hyphen.
  pl.col("Action").str.concat(",").alias("__actions")
C:\Users\user\.gemini\antigravity\scratch\SkiaHelios\tools\SH_HerculesReferee.py:864: DeprecationWarning: `str.concat` is deprecated; use `str.join` instead. Note also that the default `delimiter` for `str.join` is an empty string, not a hyphen.
  pl.col("Tag").fill_null("").str.concat(",").map_elements(

      | | | | | |
    -- HERCULES --   [ Referee v5.0 UNBOUND ]
      | | | | | |    "Modular Justice Engine Active."
    
       >> [Themis] Optimizing 285 rules (Regex Batching)...
       >> [Themis] Optimization Complete. Rules compacted to 146 (Batched 55 groups).
DEBUG CONFIG: ['net user \\S+ /add', 'net localgroup.*administrators.*/add', '(?i)net\\s+localgroup.*remote.*desktop.*/add', '(?i)\\b4720\\b', '(?i)\\b4732\\b', '(?i)\\b4728\\b', '(?i)new-localuser', '(?i)add-localgroupmember']
    [i] No MFT CSV found in Helios_Output\case10_20260118_222301 (or fallback locations), skipping ADS detection
    -> [Hercules] Judging events with Modular Detectors...
    -> [Hercules] Phase 0: PowerShell History Ingestion...
    -> [Hercules] Running ConsoleHost Reconstruction (Phase 44)...
    [DEBUG] ConsoleHostDetector: Found 1 history files in tests
    [DEBUG] Found: tests\ConsoleHost_history.txt
[PROOF] EARLY SCORING APPLIED: Add-MpPreference -ExclusionPath "C:\Temp"... -> Score: 1000
[PROOF] EARLY SCORING APPLIED: .\win-updates.ps1 -Target 192.168.137.129... -> Score: 2000
    -> [Hercules] Applying Themis Triage Rules (Pre-Filter Scoring)...
       >> [Themis] Processing 67 rules on dataset...
    -> [Hercules] Applying Centralized Scoring Rules (mimikatz, A:\ etc)...
[PROOF] SCORING RULES APPLIED. Rules Count: 62
    -> [Hercules] Applying Adaptive Noise Profiling (Phase 28)...
       >> [Themis] Dropped 131596 rows. Auditing to: Helios_Output\noise_audit.csv
    -> [Hercules] Execution Hunting Phase (YAML-Driven)...
    -> [!] HUNT SUCCESS: Found 58 traces of targeted execution!
    -> [Hercules v6.5] Analyzing User Profiles from Target_Path...
       >> [INFO] Unique users from paths: {'manageusers', 'edituser', 'findusers', 'adduser'}
    -> [Hercules v6.5] Augmenting with User Creation/Group Add Events...
       >> [ALERT] New/Added Users Identified: ['manageusers', 'edituser', 'findusers', 'adduser']
    -> [Hercules v5.3] Sensitive Document & Internal Recon Detection...
    -> [Hercules v6.5] Sensitive Data Batch Access Detection...
    -> [Hercules] analyzing Ephemeral Files (Short-Lived)...
    -> [Metisfathom] Fathoming Contextual Correlations...
       >> [METISFATHOM] DETECTED 39 FAKE UPDATE SCENARIOS!
    -> [Detector] Running WebShellDetector...
    -> [Detector] Running AntiForensicsDetector...
    -> [Detector] Running ObfuscationDetector v2.0 (Sphinx's Soul + Deobfuscation)...
    -> [Detector] Running ADSDetector v1.0 (ADS Hunter with Noise Reduction)...
    -> [Detector] Running LnkDetector...
    -> [Detector] Running NetworkDetector...
    -> [Detector] Running UserActivityDetector...
    -> [Detector] Running NoiseFilter...
    [CHECKPOINT 0] Post-Detectors Shape: (42196, 25). C2_Rows: 0
    [CHECKPOINT 1] Pre-Dedup Shape: (42196, 25). C2_Rows: 0
    -> [Hercules] Normalizing Scores & Deduplicating Rows...
    [CHECKPOINT 2] Post-Dedup Shape: (39871, 25). C2_Rows: 0
    -> [Hercules] Finalizing Verdicts...
[+] Judgment Materialized: tests/Hercules_Judged_Timeline.csv
