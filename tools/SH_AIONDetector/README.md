# SH_AIONDetector (The Eye)
> **"Nothing lasts forever. Breaking the chain of eternity."**

[![Part of SkiaHelios](https://img.shields.io/badge/SkiaHelios-Module-blueviolet)](https://github.com/schutzz/SkiaHelios)
[![Python](https://img.shields.io/badge/Python-3.10%2B-blue)](https://www.python.org/)
[![Polars](https://img.shields.io/badge/Powered%20by-Polars-orange)](https://www.pola.rs/)

## üëÅÔ∏è Overview
**SH_AIONDetector** is the "Persistence Hunter" of the [SkiaHelios](https://github.com/schutzz/SkiaHelios) forensics suite.
It automates the analysis of Sysinternals **Autorunsc** logs to detect malware trying to survive reboots.

Unlike standard grep searches, AION uses a **Multi-Stage Logic Engine** to detect:
* **Masquerading:** Fake `svchost.exe` or `explorer.exe` running from wrong paths.
* **Living Off The Land (LOLBins):** Malicious use of `PowerShell`, `WMI`, or `Bitsadmin`.
* **Fileless Ghosts:** Registry keys pointing to deleted files (integrates with **SH_PandorasLink**).

## ‚ú® Key Features (v9.2 Sniper Edition)
* **Sniper Mode (`--dir`):** Can scan a massive KAPE output directory, automatically locking onto files named `*autoruns*` (csv/txt) while ignoring irrelevant logs.
* **Robust Loader:** Automatically handles mixed text encodings (UTF-16, UTF-8 BOM, CP932/Shift-JIS) commonly found in Autorunsc outputs.
* **Ecosystem Integration:** Extracts normalized `Target_FileName` keys to cross-reference with MFT analysis (Pandora), identifying "Ghost Persistence" (Deleted malware that still attempts to run).
* **Tag-Based Detection:** Outputs human-readable threat tags like `[MASQUERADE]`, `[WMI_EXECUTION]`, `[HIGH_ENTROPY]`.

## üöÄ Usage

### Requirements
* **Sysinternals Autorunsc:** `autorunsc64.exe` must be in the same directory.
* **Input:** CSV/TXT generated by Autorunsc, or KAPE output folder.

### Command
```bash
# [Sniper Mode] Scan KAPE output folder (Recommended)
# Automatically finds and scans all "autoruns" related files.
python SH_AIONDetector.py --dir "C:\Case\KAPE_Output"

# Single File Analysis
python SH_AIONDetector.py -f "C:\Case\autoruns.csv"

# Live System Scan (Requires Admin)
python SH_AIONDetector.py -d C:
```

## üìä Output Schema (`aion_report.csv`)

| Column | Description |
| :--- | :--- |
| **AION_Score** | Threat Score (0-100). Higher is critical. |
| **AION_Tags** | Detection logic tags (e.g., `UNSIGNED`, `SUSPICIOUS_PATH`). |
| **Target_FileName** | **Integration Key.** Used to check file existence in Pandora. |
| **Image Path** | The location of the binary. |
| **Launch String** | The actual command being executed. |

---
*Part of the **SkiaHelios** Ecosystem. "Ex Umbra in Solem".*